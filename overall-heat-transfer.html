<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Retained original title -->
    <title>Overall Heat Transfer Coefficient Calculator - Design Calculators</title>

    <!-- New meta tags, scripts, and links -->
    <meta name="description" content="Professional Overall Heat Transfer Coefficient (U-value) calculator for flat walls and cylindrical pipes. Includes convection, conduction, and fouling.">
    <meta name="keywords" content="overall heat transfer coefficient, u-value, u-value calculator, thermal resistance, cylindrical pipe, flat wall, fouling factor, TEMA">
    <meta name="author" content="Design Calculators">
    <meta name="robots" content="index, follow">

    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5936527763614780" crossorigin="anonymous"></script>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-23Y1V450SR"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-23Y1V450SR');
    </script>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Montserrat:wght@700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- MathJax script -->
    <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    
    <!-- Retained original MathJax configuration -->
    <script>
        MathJax = {
            tex: {
                inlineMath: [['\\(', '\\)']],
                displayMath: [['\\[', '\\]']],
                processEscapes: true
            }
        };
    </script>

    <!-- Favicons -->
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">

    <!-- New unified CSS -->
    <style>
        @keyframes fadeInUp {
        from { opacity: 0; transform: translateY(30px); }
        to { opacity: 1; transform: translateY(0); }
        }

        @keyframes slideIn {
        from { opacity: 0; transform: translateX(-20px); }
        to { opacity: 1; transform: translateX(0); }
        }

        @keyframes pulse {
        0%, 100% { transform: scale(1); }
        50% { transform: scale(1.05); }
        }

        @keyframes shimmer {
        0% { background-position: -1000px 0; }
        100% { background-position: 1000px 0; }
        }

        :root {
        --primary-color: #1E3A8A;
        --secondary-color: #2563EB;
        --accent-color: #F59E0B;
        --success-color: #10B981;
        --bg-color: #F8FAFC;
        --card-bg: #FFFFFF;
        --text-color: #4B5563;
        --heading-color: #111827;
        --footer-bg: #0F172A;
        --border-color: #E2E8F0;
        --gradient-primary: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
        --gradient-dark: linear-gradient(135deg, #0F172A, #1E293B);
        --card-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        body.dark-mode {
        --primary-color: #10B981;
        --secondary-color: #34D399;
        --bg-color: #0F172A;
        --card-bg: #1E293B;
        --text-color: #CBD5E1;
        --heading-color: #F1F5F9;
        --footer-bg: #020617;
        --border-color: #334155;
        }

        * { box-sizing: border-box; }
        html { scroll-behavior: smooth; }

        body {
        font-family: 'Inter', sans-serif;
        background-color: var(--bg-color);
        color: var(--text-color);
        line-height: 1.8;
        transition: background-color 0.3s, color 0.3s;
        margin: 0;
        padding: 0;
        }

        .container { max-width: 1280px; margin: 0 auto; padding: 0 24px; }

        /* HEADER */
        .header {
        background: var(--gradient-primary);
        color: white;
        padding: 24px 0;
        box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        animation: slideIn 0.5s ease;
        }

        .navbar {
        display: flex;
        justify-content: space-between;
        align-items: center;
        }

        .logo-container {
        display: flex;
        align-items: center;
        gap: 16px;
        text-decoration: none;
        color: white;
        }

        .logo-text {
        font-size: 1.75rem;
        font-weight: 800;
        font-family: 'Montserrat', sans-serif;
        }

        .nav-links {
        display: flex;
        gap: 24px;
        list-style: none;
        margin: 0;
        padding: 0;
        }

        .nav-links a {
        color: white;
        text-decoration: none;
        font-weight: 500;
        transition: all 0.3s;
        }

        .nav-links a:hover {
        color: var(--accent-color);
        transform: translateY(-2px);
        }

        .theme-toggle {
        display: flex;
        align-items: center;
        gap: 12px;
        }

        .theme-toggle .icon {
        color: white;
        font-size: 1.2rem;
        }

        .switch {
        position: relative;
        width: 56px;
        height: 30px;
        }

        .switch input {
        opacity: 0;
        width: 0;
        height: 0;
        }

        .slider {
        position: absolute;
        cursor: pointer;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: rgba(0,0,0,0.2);
        transition: .4s;
        border-radius: 30px;
        }

        .slider:before {
        position: absolute;
        content: "";
        height: 22px;
        width: 22px;
        left: 4px;
        bottom: 4px;
        background-color: white;
        transition: .4s;
        border-radius: 50%;
        }

        input:checked + .slider {
        background-color: var(--accent-color);
        }

        input:checked + .slider:before {
        transform: translateX(26px);
        }

        main {
        padding: 40px 0;
        max-width: 1000px;
        margin: 0 auto;
        }

        .tool-container {
        background-color: var(--card-bg);
        border-radius: 12px;
        padding: 30px;
        box-shadow: var(--card-shadow);
        margin-bottom: 30px;
        animation: fadeInUp 0.6s ease;
        }

        .tool-container h2 {
        color: var(--primary-color);
        border-bottom: 3px solid var(--primary-color);
        padding-bottom: 15px;
        margin-top: 0;
        margin-bottom: 25px;
        font-family: 'Montserrat', sans-serif;
        font-size: 1.8rem;
        }
        
        .tool-container h3 {
            color: var(--primary-color);
            margin-top: 25px;
        }
        
        .tool-container h4 {
            color: var(--secondary-color);
            margin-top: 20px;
        }

        .tool-description {
        margin-bottom: 25px;
        font-size: 1rem;
        line-height: 1.8;
        }
        
        .tool-description ul {
            list-style-type: disc;
            margin-left: 25px;
            padding-left: 0;
            margin-top: 15px;
        }
        .tool-description ul li {
            margin-bottom: 8px;
        }

        .calculator-form {
        background-color: var(--card-bg);
        border-radius: 12px;
        padding: 25px;
        margin-top: 25px;
        box-shadow: var(--card-shadow);
        }

        .form-group {
        margin-bottom: 20px;
        animation: slideIn 0.5s ease;
        }

        .form-group label {
        display: block;
        margin-bottom: 8px;
        font-weight: 600;
        color: var(--heading-color);
        }

        .form-group input, .form-group select {
        width: 100%;
        padding: 12px;
        border: 2px solid var(--border-color);
        border-radius: 6px;
        background-color: var(--bg-color);
        color: var(--text-color);
        font-size: 1rem;
        transition: all 0.3s;
        }

        .form-group input:focus, .form-group select:focus {
        border-color: var(--primary-color);
        box-shadow: 0 0 12px rgba(30, 58, 138, 0.25);
        outline: none;
        transform: scale(1.02);
        }

        .form-row {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
        }

        .button-group {
        display: flex;
        gap: 15px;
        margin-top: 20px;
        flex-wrap: wrap;
        }

        .calculate-btn, .reset-btn, .download-btn {
        padding: 14px 28px;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        font-size: 1rem;
        font-weight: 700;
        transition: all 0.3s;
        display: inline-flex;
        align-items: center;
        gap: 8px;
        }

        .calculate-btn {
        background: var(--gradient-primary);
        color: white;
        flex: 1;
        justify-content: center;
        box-shadow: 0 4px 12px rgba(30, 58, 138, 0.3);
        }

        .calculate-btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 8px 20px rgba(30, 58, 138, 0.4);
        animation: pulse 0.6s ease;
        }

        .reset-btn {
        background: linear-gradient(135deg, #EF4444, #DC2626);
        color: white;
        box-shadow: 0 4px 12px rgba(239, 68, 68, 0.3);
        }

        .reset-btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 8px 20px rgba(239, 68, 68, 0.4);
        }

        .download-btn {
        background: linear-gradient(135deg, #10B981, #059669);
        color: white;
        box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
        }

        .download-btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 8px 20px rgba(16, 185, 129, 0.4);
        }

        .result-container {
        margin-top: 40px;
        padding: 30px;
        border-radius: 12px;
        background-color: var(--card-bg);
        box-shadow: var(--card-shadow);
        display: none;
        opacity: 0;
        transform: translateY(20px);
        transition: all 0.6s ease;
        }

        .result-container.show {
        display: block;
        opacity: 1;
        transform: translateY(0);
        }

        .result-container h3 {
        color: var(--primary-color);
        margin-bottom: 25px;
        font-family: 'Montserrat', sans-serif;
        font-size: 1.6rem;
        }

        #calculation-details {
        background-color: var(--bg-color);
        border: 2px solid var(--border-color);
        border-radius: 8px;
        padding: 20px;
        margin-bottom: 25px;
        animation: fadeInUp 0.7s ease;
        }

        #calculation-details h4 {
        color: var(--secondary-color);
        margin-top: 0;
        margin-bottom: 15px;
        font-size: 1.2rem;
        }

        #calculation-details p.formula {
        font-family: 'Times New Roman', serif;
        font-size: 1.1rem;
        text-align: center;
        padding: 15px;
        background: linear-gradient(90deg, transparent, rgba(var(--border-color), 0.5), transparent);
        border-radius: 6px;
        margin: 15px 0;
        overflow-x: auto;
        }
        
        body.dark-mode #calculation-details p.formula {
             background: linear-gradient(90deg, transparent, rgba(var(--border-color), 0.1), transparent);
        }

        #calculation-details p.calculation-step {
        font-family: 'Courier New', monospace;
        background-color: var(--card-bg);
        padding: 10px 12px;
        border-radius: 4px;
        border-left: 4px solid var(--secondary-color);
        margin-bottom: 10px;
        word-wrap: break-word;
        }

        #calculation-details ul {
        list-style-type: disc;
        margin-left: 25px;
        padding-left: 0;
        }
        
        #calculation-details ul li {
            margin-bottom: 5px;
        }

        .result-table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 20px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        border-radius: 8px;
        overflow: hidden;
        animation: fadeInUp 0.8s ease;
        }

        .result-table th, .result-table td {
        padding: 14px;
        text-align: left;
        border-bottom: 1px solid var(--border-color);
        }

        .result-table th {
        background: var(--gradient-primary);
        color: white;
        font-weight: 700;
        }

        .result-table tr:nth-child(even) {
        background-color: rgba(0,0,0,0.02);
        }
        
        body.dark-mode .result-table tr:nth-child(even) {
            background-color: rgba(255,255,255,0.02);
        }

        .result-table tr:hover {
        background-color: rgba(37, 99, 235, 0.1);
        transform: scale(1.01);
        transition: all 0.3s;
        }
        
        body.dark-mode .result-table tr:hover {
            background-color: rgba(16, 185, 129, 0.1);
        }

        .standard-reference {
        margin-top: 25px;
        font-style: italic;
        font-size: 0.95rem;
        padding: 15px;
        background: linear-gradient(135deg, rgba(245,158,11,0.1), rgba(245,158,11,0.05));
        border-left: 4px solid var(--accent-color);
        border-radius: 6px;
        line-height: 1.7;
        animation: fadeInUp 0.9s ease;
        }

        .info-icon {
        color: var(--primary-color);
        margin-left: 6px;
        cursor: help;
        transition: transform 0.3s;
        }

        .info-icon:hover {
        transform: scale(1.2) rotate(10deg);
        }

        .tooltip {
        position: relative;
        display: inline-block;
        }

        .tooltip .tooltiptext {
        visibility: hidden;
        width: 260px;
        background-color: #333;
        color: #fff;
        text-align: center;
        border-radius: 6px;
        padding: 10px;
        position: absolute;
        z-index: 1000;
        bottom: 130%;
        left: 50%;
        margin-left: -130px;
        opacity: 0;
        transition: opacity 0.3s;
        font-size: 0.85rem;
        white-space: normal;
        box-shadow: 0 4px 8px rgba(0,0,0,0.3);
        }

        .tooltip:hover .tooltiptext {
        visibility: visible;
        opacity: 1;
        }

        #custom-message-box {
        position: fixed;
        top: 20px;
        left: 50%;
        transform: translateX(-50%) translateY(-100px);
        padding: 16px 28px;
        border-radius: 8px;
        box-shadow: 0 6px 16px rgba(0,0,0,0.25);
        z-index: 10000;
        font-weight: 600;
        color: white;
        opacity: 0;
        transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        #custom-message-box.show {
        opacity: 1;
        transform: translateX(-50%) translateY(0);
        }

        /* FOOTER */
        footer {
        background: var(--gradient-dark);
        color: #CBD5E1;
        padding: 50px 0 20px 0;
        margin-top: 40px; /* Added margin-top */
        }

        .footer-content {
        display: flex;
        justify-content: space-between;
        flex-wrap: wrap;
        gap: 40px;
        margin-bottom: 30px;
        }

        .footer-col {
        flex: 1;
        min-width: 200px;
        }

        .footer-col h4 {
        color: white;
        margin-bottom: 15px;
        font-weight: 700;
        }

        .footer-col ul {
        list-style: none;
        padding: 0;
        margin: 0;
        }

        .footer-col ul li {
        margin-bottom: 10px;
        }

        .footer-col a {
        color: #CBD5E1;
        text-decoration: none;
        transition: all 0.3s;
        }

        .footer-col a:hover {
        color: var(--accent-color);
        transform: translateX(3px);
        }

        .footer-disclaimer {
        text-align: center;
        margin: 30px auto;
        padding-top: 25px;
        border-top: 1px solid #334155;
        max-width: 800px;
        font-size: 0.9rem;
        line-height: 1.6;
        }

        .footer-bottom {
        text-align: center;
        padding-top: 20px;
        font-size: 0.9rem;
        color: #94A3B8;
        }

        .creator-name {
        color: var(--secondary-color);
        font-weight: bold;
        }

        .social-buttons {
        display: flex;
        gap: 12px;
        margin-top: 15px;
        }

        .social-btn {
        width: 40px;
        height: 40px;
        display: flex;
        justify-content: center;
        align-items: center;
        color: white;
        border-radius: 50%;
        text-decoration: none;
        transition: all 0.3s;
        box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .social-btn:hover {
        transform: translateY(-4px) scale(1.1);
        box-shadow: 0 8px 16px rgba(0,0,0,0.3);
        }

        .social-btn.linkedin { background-color: #0A66C2; }
        .social-btn.youtube { background-color: #FF0000; }
        .social-btn.twitter { background-color: #1DA1F2; }
        .social-btn.facebook { background-color: #1877F2; }
        .social-btn.whatsapp { background-color: #25D366; }
        .social-btn.email { background-color: #7f8c8d; } /* Added from original file */


        @media (max-width: 768px) {
        .navbar { flex-direction: column; gap: 20px; }
        .nav-links { flex-direction: column; gap: 12px; text-align: center; }
        .form-row { grid-template-columns: 1fr; }
        .button-group { flex-direction: column; }
        .calculate-btn, .reset-btn, .download-btn { width: 100%; }
        .footer-content { flex-direction: column; }
        }
    </style>
</head>
<body>

    <!-- NEW HEADER -->
    <header class="header">
        <div class="container">
        <nav class="navbar">
        <a href="/" class="logo-container">
        <span class="logo-text">Design Calculators</span>
        </a>
        <ul class="nav-links">
        <li><a href="/">Home</a></li>
        <li><a href='/articles'>Articles</a></li>
        <li><a href='/indexmech'>Mechanical</a></li>
        <li><a href='/indexele'>Electrical</a></li>
        <li><a href='/indexinst'>Instrumentation</a></li>
        </ul>
        <div class="theme-toggle">
        <i class="fas fa-sun icon"></i>
        <label class="switch">
        <input type="checkbox" id="theme-switch">
        <span class="slider"></span>
        </label>
        <i class="fas fa-moon icon"></i>
        </div>
        </nav>
        </div>
    </header>

    <main class="container">
        <!-- Back button removed -->
            
        <div class="tool-container">
            <h2><i class="fas fa-layer-group"></i> Overall Heat Transfer Coefficient (U-value) Calculator</h2>
            <div class="tool-description">
                <p>This calculator determines the overall heat transfer coefficient (U-value) for common industrial geometries. The U-value quantifies the rate of heat transfer through a composite barrier per unit area per unit temperature difference.</p>
                <p>This tool is upgraded for industrial use, supporting both <strong>Flat Walls</strong> (plates) and <strong>Cylindrical Pipes/Tubes</strong>.</p>
                <ul>
                    <li><strong>Overall Heat Transfer Coefficient (\(U\)):</strong> Represents the overall thermal transmittance. A higher U-value means greater heat transfer.</li>
                    <li><strong>Fouling Factors (\(R_f\)):</strong> Account for thermal resistance due to deposition of impurities on heat transfer surfaces, which is critical in industrial design.</li>
                </ul>
                <p><strong>Note:</strong> For cylindrical pipes, the calculator provides both \(U_i\) (based on inner area) and \(U_o\) (based on outer area), as both are common industrial standards. For flat walls, \(U_i = U_o\). Refer to <strong>TEMA</strong> standards for appropriate fouling factors.</p>
            </div>
            <div class="calculator-form">
                <form id="u-value-form">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="geometry-type">Geometry Type: <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Select the geometry. 'Cylindrical Pipe' is used for tubes in shell-and-tube exchangers.</span></span></label>
                            <select id="geometry-type" required>
                                <option value="flat">Flat Wall / Plate</option>
                                <option value="cylinder">Cylindrical Pipe / Tube</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="unit-system">Unit System: <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Select Metric (e.g., mm, W/mK, W/m²°C) or Imperial (e.g., in, BTU/h ft°F, BTU/h ft²°F) units.</span></span></label>
                            <select id="unit-system" required>
                                <option value="metric">Metric (\(\text{mm}\), \(\text{W/mK}\), \(\text{W/m}^2\text{°C}\))</option>
                                <option value="imperial">Imperial (\(\text{in}\), \(\text{BTU/h ft°F}\), \(\text{BTU/h ft}^2\text{°F}\))</option>
                            </select>
                        </div>
                    </div>
                    
                    <h3>Fluid & Material Properties</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="hi">Inner Convection Coefficient (\(h_i\)) <span class="convection-unit-label">(\(\text{W/m}^2\text{°C}\))</span>: <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Heat transfer coefficient for the fluid *inside* the wall/pipe.</span></span></label>
                            <input type="number" id="hi" step="0.1" value="1500" min="0.1" required>
                        </div>
                        <div class="form-group">
                            <label for="ho">Outer Convection Coefficient (\(h_o\)) <span class="convection-unit-label">(\(\text{W/m}^2\text{°C}\))</span>: <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Heat transfer coefficient for the fluid *outside* the wall/pipe.</span></span></label>
                            <input type="number" id="ho" step="0.1" value="100" min="0.1" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="k_wall">Wall Material Thermal Conductivity (\(k\)) <span class="conductivity-unit-label">(\(\text{W/mK}\))</span>: <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Thermal conductivity of the wall material (e.g., Carbon Steel: ~50, SS316: ~16).</span></span></label>
                            <input type="number" id="k_wall" step="0.1" value="50" min="0.1" required>
                        </div>
                    </div>

                    <h3>Dimensions</h3>
                    <!-- Flat Wall Inputs -->
                    <div id="flat-wall-inputs" class="form-row">
                        <div class="form-group">
                            <label for="dx_wall">Wall Thickness (\(\Delta x\)) <span class="length-unit-label">(\(\text{mm}\))</span>: <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Thickness of the flat wall.</span></span></label>
                            <input type="number" id="dx_wall" step="0.01" value="5" min="0.01" required>
                        </div>
                    </div>
                    <!-- Cylindrical Pipe Inputs -->
                    <div id="cyl-pipe-inputs" class="form-row" style="display: none;">
                        <div class="form-group">
                            <label for="di_pipe">Pipe Inner Diameter (\(D_i\)) <span class="diam-unit-label">(\(\text{mm}\))</span>: <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Inner diameter of the pipe.</span></span></label>
                            <input type="number" id="di_pipe" step="0.01" value="20" min="0.01">
                        </div>
                        <div class="form-group">
                            <label for="do_pipe">Pipe Outer Diameter (\(D_o\)) <span class="diam-unit-label">(\(\text{mm}\))</span>: <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Outer diameter of the pipe.</span></span></label>
                            <input type="number" id="do_pipe" step="0.01" value="25" min="0.01">
                        </div>
                    </div>
                    
                    <h3>Fouling Factors (TEMA)</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="rfi">Inner Fouling Factor (\(R_{f,i}\)) <span class="fouling-unit-label">(\(\text{m}^2\text{°C/W}\))</span>: <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Resistance due to fouling on the inner surface. Consult TEMA or specific industry guidelines. (e.g., 0.000176 for Treated Water).</span></span></label>
                            <input type="number" id="rfi" step="0.00001" value="0.000176" min="0" required>
                        </div>
                        <div class="form-group">
                            <label for="rfo">Outer Fouling Factor (\(R_{f,o}\)) <span class="fouling-unit-label">(\(\text{m}^2\text{°C/W}\))</span>: <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Resistance due to fouling on the outer surface. (e.g., 0.000352 for River Water).</span></span></label>
                            <input type="number" id="rfo" step="0.00001" value="0.000352" min="0" required>
                        </div>
                    </div>

                    <div class="button-group">
                        <button type="button" id="calculate-u-value-btn" class="calculate-btn">
                            <i class="fas fa-calculator"></i> Calculate U-value
                        </button>
                    </div>
                </form>
            </div>
            <div id="result-container" class="result-container">
                <h3><i class="fas fa-chart-line"></i> Calculation Results</h3>
                <div id="calculation-details"></div>
                <table class="result-table">
                    <thead>
                        <tr>
                            <th>Parameter</th>
                            <th>Value</th>
                        </tr>
                    </thead>
                    <tbody id="result-table-body"></tbody>
                </table>
                <div class="standard-reference" id="standard-reference"></div>
            </div>
        </div>

        <!-- NEW 800+ WORD INFORMATIVE SECTION -->
        <div class="tool-container" style="margin-top: 40px;">
            <h2><i class="fas fa-book-open"></i> Professional Guide to the Overall Heat Transfer Coefficient (U-value)</h2>

            <h3 style="color: var(--primary-color); margin-top: 25px;">What is the U-value? The "Master" Coefficient</h3>
            <p>The Overall Heat Transfer Coefficient, universally known as the <strong>U-value</strong>, is arguably the most important single parameter in heat exchanger design. It represents the total thermal resistance of a system (a wall, a pipe, a complete heat exchanger) and quantifies how easily heat can flow from the "hot side" fluid to the "cold side" fluid.</p>
            <p>Its primary purpose is to simplify a complex problem. Instead of calculating separate convection and conduction steps, the U-value combines all thermal resistances into one "master" coefficient. This allows engineers to use a single, powerful equation for heat exchanger design:</p>
            <p class="formula">\[ Q = U \cdot A \cdot \Delta T_{lm} \]</p>
            <p>Where \(Q\) is the total heat duty, \(A\) is the surface area, and \(\Delta T_{lm}\) is the log mean temperature difference. The U-value (in \(\text{W/m}^2\text{K}\) or \(\text{BTU/h ft}^2\text{°F}\)) acts as the proportionality constant. A high U-value means low resistance and efficient heat transfer. A low U-value means high resistance and poor heat transfer.</p>

            <h3 style="color: var(--primary-color); margin-top: 25px;">The Thermal Resistance Network</h3>
            <p>The U-value is calculated by modeling the system as a series of thermal resistances, just like resistors in an electrical circuit. Heat must overcome several barriers to move from the hot fluid to the cold fluid:</p>
            <ol>
                <li><strong>Inner Convection (\(R_i\)):</strong> Resistance from the bulk of the hot fluid to the inner wall surface.</li>
                <li><strong>Inner Fouling (\(R_{fi}\)):</strong> Resistance from the layer of dirt, scale, or rust on the inner wall.</li>
                <li><strong>Wall Conduction (\(R_w\)):</strong> Resistance to heat conducting *through* the physical wall material.</li>
                <li><strong>Outer Fouling (\(R_{fo}\)):</strong> Resistance from the layer of fouling on the outer wall.</li>
                <li><strong>Outer Convection (\(R_o\)):</strong> Resistance from the outer wall surface to the bulk of the cold fluid.</li>
            </ol>
            <p>The total resistance \(R_{\text{total}}\) is simply the sum of these individual resistances. The U-value is the reciprocal of this total resistance:</p>
            <p class="formula">\[ U = \frac{1}{R_{\text{total}}} = \frac{1}{R_i + R_{fi} + R_w + R_{fo} + R_o} \]</p>

            <h3 style="color: var(--primary-color); margin-top: 25px;">The Critical Difference: Flat Walls vs. Cylindrical Pipes</h3>
            <p>The formulas for these resistances depend entirely on the geometry, which is why this calculator is upgraded to handle both. This is the most common point of error in industrial calculations.</p>

            <h4>Case 1: Flat Wall / Plate</h4>
            <p>For a flat plate, the heat transfer area is the same on both sides (\(A_i = A_o = A\)). The calculation is straightforward:</p>
            <ul>
                <li>\(R_i = 1 / h_i\)</li>
                <li>\(R_{fi} = R_{f,i}\) (Fouling factor is already a resistance)</li>
                <li>\(R_w = \Delta x / k\) (where \(\Delta x\) is thickness, \(k\) is conductivity)</li>
                <li>\(R_{fo} = R_{f,o}\)</li>
                <li>\(R_o = 1 / h_o\)</li>
            </ul>
            <p class="formula">\[ U = \frac{1}{\frac{1}{h_i} + R_{f,i} + \frac{\Delta x}{k} + R_{f,o} + \frac{1}{h_o}} \]</p>

            <h4>Case 2: Cylindrical Pipe / Tube (The Industrial Standard)</h4>
            <p>This is where it gets complex. For a pipe, the inner surface area (\(A_i = \pi D_i L\)) is *smaller* than the outer surface area (\(A_o = \pi D_o L\)). Because the U-value is defined *per unit area*, we must specify *which area* we are referring to. Industry uses both \(U_i\) (referred to inner area) and \(U_o\) (referred to outer area).</p>
            <p>To calculate this, all resistances must be "referred" to the *same area*. This is done by multiplying them by an area ratio.</p>
            
            <p><strong>To calculate \(U_o\) (referred to Outer Area):</strong></p>
            <p class="formula">\[ U_o = \frac{1}{R_{\text{total, outer}}} \]</p>
            <p>Where \(R_{\text{total, outer}}\) is:</p>
            <p class="formula">\[ R_{\text{total, outer}} = \left(\frac{1}{h_i} \cdot \frac{A_o}{A_i}\right) + \left(R_{f,i} \cdot \frac{A_o}{A_i}\right) + \left(\frac{\ln(D_o/D_i)}{2 \pi k L} \cdot A_o \right) + R_{f,o} + \frac{1}{h_o} \]</p>
            <p>Simplifying (since \(A_o/A_i = D_o/D_i\) and \(R_w = \frac{D_o \ln(D_o/D_i)}{2k}\) for area \(A_o\)):</p>
            <p class="formula">\[ U_o = \frac{1}{\frac{D_o}{D_i h_i} + \frac{R_{f,i} D_o}{D_i} + \frac{D_o \ln(D_o/D_i)}{2k} + R_{f,o} + \frac{1}{h_o}} \]</p>

            <p><strong>To calculate \(U_i\) (referred to Inner Area):</strong></p>
            <p class="formula">\[ U_i = \frac{1}{\frac{1}{h_i} + R_{f,i} + \frac{D_i \ln(D_o/D_i)}{2k} + \frac{R_{f,o} D_i}{D_o} + \frac{D_i}{D_o h_o}} \]</p>
            <p>This calculator correctly computes both \(U_i\) and \(U_o\) for cylindrical geometry, which is essential for accurate industrial heat exchanger design.</p>

            <h3 style="color: var(--primary-color); margin-top: 25px;">The Industrial Killer: Fouling Factor (\(R_f\))</h3>
            <p>In a university textbook, \(R_f\) is often zero ("clean" surface). In industry, the fouling factor is the *most critical, uncertain, and impactful* variable. Fouling is the build-up of any unwanted material on the heat transfer surface, creating an extra insulating layer. Examples include:</p>
            <ul>
                <li><strong>Scaling:</strong> Hard mineral deposits from water (calcium carbonate, etc.).</li>
                <li><strong>Sedimentation:</strong> Settling of silt, mud, or sand from river water.</li>
                <li><strong>Biofouling:</strong> Growth of algae, slime, and bacteria.</li>
                <li><strong>Coking/Polymerization:</strong> Chemical-side deposits in refineries and polymer plants.</li>
            </ul>
            <p>The <strong>TEMA (Tubular Exchanger Manufacturers Association)</strong> standards provide extensive tables of recommended fouling factors. A "clean" U-value might be 1500 \(\text{W/m}^2\text{K}\), but after applying industrial fouling factors for river water and a crude oil stream, the "dirty" or "service" U-value might drop to 400 \(\text{W/m}^2\text{K}\). The heat exchanger must be designed using this *dirty* U-value to ensure it still performs its duty at the end of its operating cycle, just before it's shut down for cleaning.</p>
        </div>
    </main>

    <!-- NEW FOOTER -->
    <footer>
        <div class="container">
        <div class="footer-content">
        <div class="footer-col">
        <h4>Design Calculators</h4>
        <p style="font-size: 0.9rem; line-height: 1.6; margin-bottom: 15px;">The world's first comprehensive engineering calculator hub based on IEC, IEEE, ISA, ASME, and API standards.</p>
        <div class="social-buttons">
        <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://designcalculators.co.in" target="_blank" rel="noopener noreferrer" class="social-btn linkedin"><i class="fab fa-linkedin-in"></i></a>
        <a href="https://www.youtube.com/@designcalculators" target="_blank" rel="noopener noreferrer" class="social-btn youtube"><i class="fab fa-youtube"></i></a>
        <a href="https://twitter.com/intent/tweet?url=https://designcalculators.co.in" target="_blank" rel="noopener noreferrer" class="social-btn twitter"><i class="fab fa-twitter"></i></a>
        <a href="https://www.facebook.com/sharer/sharer.php?u=https://designcalculators.co.in" target="_blank" rel="noopener noreferrer" class="social-btn facebook"><i class="fab fa-facebook-f"></i></a>
        <a href="https://api.whatsapp.com/send?text=Check%20out%20this%20amazing%20engineering%20resource:%20https://designcalculators.co.in" target="_blank" rel="noopener noreferrer" class="social-btn whatsapp"><i class="fab fa-whatsapp"></i></a>
        <!-- Added email button from original file -->
        <a href="mailto:?subject=Check out Design Calculators - Mechanical!&body=I found this amazing Overall Heat Transfer Coefficient Calculator and other mechanical tools: https://designcalculators.co.in" class="social-btn email">
            <i class="fas fa-envelope"></i>
        </a>
        </div>
        </div>
        <div class="footer-col">
        <h4>Quick Links</h4>
        <ul>
        <li><a href="/">Home</a></li>
        <li><a href='/indexele'>Electrical</a></li>
        <li><a href='/indexmech'>Mechanical</a></li>
        <li><a href='/indexinst'>Instrumentation</a></li>
        <li><a href='/articles'>Articles</a></li>
        </ul>
        </div>
        <div class="footer-col">
        <h4>Resources</h4>
        <ul>
        <li><a href='/about'>About Us</a></li>
        <li><a href='/contact'>Contact</a></li>
        <li><a href='/faq'>FAQ</a></li>
        <li><a href='/privacy-policy'>Privacy Policy</a></li>
        <li><a href='/terms-of-service'>Terms of Service</a></li>
        </ul>
        </div>
        <div class="footer-col">
        <h4>More</h4>
        <ul>
        <li><a href="/blog.html">Blog</a></li>
        <li><a href='/sitemap2'>Sitemap</a></li>
        <li><a href="https://www.youtube.com/@designcalculators" target="_blank" rel="noopener noreferrer">YouTube Channel</a></li>
        </ul>
        </div>
        </div>

        <div class="footer-disclaimer">
            <!-- Updated disclaimer from original file -->
            <p>To ensure accuracy and reliability, always verify the results obtained from these tools against the relevant engineering standards and guidelines. All calculations based on fundamental heat and mass transfer principles per ASME and standard textbooks. Verify results for safety-critical applications.</p>
        </div>

        <div class="footer-bottom">
        <p>&copy; 2025 Design Calculators. Created by <span class="creator-name">A Sharma</span>. All rights reserved.</p>
        </div>
        </div>
    </footer>
    
    <!-- Message box for notifications -->
    <div id="custom-message-box"></div>

    <!-- Updated JavaScript -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const calculateBtn = document.getElementById('calculate-u-value-btn');
            const resultContainer = document.getElementById('result-container');
            const resultTableBody = document.getElementById('result-table-body');
            const standardReference = document.getElementById('standard-reference');
            const calculationDetailsDiv = document.getElementById('calculation-details');
            
            const unitSystemSelect = document.getElementById('unit-system');
            const geometryTypeSelect = document.getElementById('geometry-type');

            // Input fields
            const hiInput = document.getElementById('hi');
            const hoInput = document.getElementById('ho');
            const kWallInput = document.getElementById('k_wall');
            const rfiInput = document.getElementById('rfi');
            const rfoInput = document.getElementById('rfo');
            
            // Geometry-specific inputs
            const flatWallInputs = document.getElementById('flat-wall-inputs');
            const dxWallInput = document.getElementById('dx_wall');
            
            const cylPipeInputs = document.getElementById('cyl-pipe-inputs');
            const diPipeInput = document.getElementById('di_pipe');
            const doPipeInput = document.getElementById('do_pipe');

            // Unit labels
            const convectionUnitLabels = document.querySelectorAll('.convection-unit-label');
            const conductivityUnitLabels = document.querySelectorAll('.conductivity-unit-label');
            const lengthUnitLabels = document.querySelectorAll('.length-unit-label'); // For flat wall
            const diamUnitLabels = document.querySelectorAll('.diam-unit-label'); // For cylinder
            const foulingUnitLabels = document.querySelectorAll('.fouling-unit-label');

            /**
             * Displays a custom message box at the top of the screen.
             * (Using the new standardized function)
             */
            function displayMessage(message, type = "info") {
                const messageBox = document.getElementById('custom-message-box');
                if (!messageBox) {
                    console.error("Message box element not found.");
                    return;
                }
                messageBox.textContent = message;
                // Using new theme colors
                if (type === "error") {
                    messageBox.style.backgroundColor = '#EF4444'; // Red
                } else if (type === "warning") {
                    messageBox.style.backgroundColor = '#F59E0B'; // Amber
                } else {
                    messageBox.style.backgroundColor = '#10B981'; // Green
                }
                messageBox.classList.add('show');
                setTimeout(() => messageBox.classList.remove('show'), 5000);
            }

            function updateUI() {
                const unitSystem = unitSystemSelect.value;
                const geometryType = geometryTypeSelect.value;

                // Toggle visibility of geometry inputs
                if (geometryType === 'flat') {
                    flatWallInputs.style.display = 'grid';
                    cylPipeInputs.style.display = 'none';
                    dxWallInput.required = true;
                    diPipeInput.required = false;
                    doPipeInput.required = false;
                } else { // 'cylinder'
                    flatWallInputs.style.display = 'none';
                    cylPipeInputs.style.display = 'grid';
                    dxWallInput.required = false;
                    diPipeInput.required = true;
                    doPipeInput.required = true;
                }

                // Update unit labels
                if (unitSystem === 'imperial') {
                    convectionUnitLabels.forEach(label => label.innerHTML = '(\\(\text{BTU/h ft}^2\\text{°F}\\))');
                    conductivityUnitLabels.forEach(label => label.innerHTML = '(\\(\text{BTU/h ft°F}\\))');
                    lengthUnitLabels.forEach(label => label.innerHTML = '(\\(\text{in}\\))'); // Switched to inches for consistency
                    diamUnitLabels.forEach(label => label.innerHTML = '(\\(\text{in}\\))');
                    foulingUnitLabels.forEach(label => label.innerHTML = '(\\(\text{h ft}^2\\text{°F/BTU}\\))');
                    
                    // Auto-convert default values
                    if (hiInput.value === "1500") hiInput.value = "264"; // W/m2C to BTU/h ft2 F
                    if (hoInput.value === "100") hoInput.value = "17.6";
                    if (kWallInput.value === "50") kWallInput.value = "28.9"; // W/mK to BTU/h ft F
                    if (dxWallInput.value === "5") dxWallInput.value = "0.197"; // mm to in
                    if (diPipeInput.value === "20") diPipeInput.value = "0.787"; // mm to in
                    if (doPipeInput.value === "25") doPipeInput.value = "0.984"; // mm to in
                    if (rfiInput.value === "0.000176") rfiInput.value = "0.001"; // m2C/W to h ft2 F/BTU
                    if (rfoInput.value === "0.000352") rfoInput.value = "0.002";

                } else { // Metric
                    convectionUnitLabels.forEach(label => label.innerHTML = '(\\(\text{W/m}^2\\text{°C}\\))');
                    conductivityUnitLabels.forEach(label => label.innerHTML = '(\\(\text{W/mK}\\))');
                    lengthUnitLabels.forEach(label => label.innerHTML = '(\\(\text{mm}\\))'); // Switched to mm
                    diamUnitLabels.forEach(label => label.innerHTML = '(\\(\text{mm}\\))');
                    foulingUnitLabels.forEach(label => label.innerHTML = '(\\(\text{m}^2\\text{°C/W}\\))');
                    
                    // Auto-convert default values back
                    if (hiInput.value === "264") hiInput.value = "1500";
                    if (hoInput.value === "17.6") hoInput.value = "100";
                    if (kWallInput.value === "28.9") kWallInput.value = "50";
                    if (dxWallInput.value === "0.197") dxWallInput.value = "5";
                    if (diPipeInput.value === "0.787") diPipeInput.value = "20";
                    if (doPipeInput.value === "0.984") doPipeInput.value = "25";
                    if (rfiInput.value === "0.001") rfiInput.value = "0.000176";
                    if (rfoInput.value === "0.002") rfoInput.value = "0.000352";
                }
                
                if (window.MathJax && window.MathJax.typeset) {
                    window.MathJax.typeset();
                }
            }

            unitSystemSelect.addEventListener('change', updateUI);
            geometryTypeSelect.addEventListener('change', updateUI);
            updateUI(); // Initial UI update

            calculateBtn.addEventListener('click', function() {
                const unitSystem = unitSystemSelect.value;
                const geometryType = geometryTypeSelect.value;

                let hi = parseFloat(hiInput.value);
                let ho = parseFloat(hoInput.value);
                let k_wall = parseFloat(kWallInput.value);
                let rfi = parseFloat(rfiInput.value);
                let rfo = parseFloat(rfoInput.value);
                
                let dx_wall_val = parseFloat(dxWallInput.value);
                let di_pipe_val = parseFloat(diPipeInput.value);
                let do_pipe_val = parseFloat(doPipeInput.value);

                // Input validation
                const commonInputs = [hi, ho, k_wall, rfi, rfo];
                if (commonInputs.some(isNaN) || commonInputs.slice(0,3).some(v => v <= 0) || commonInputs.slice(3).some(v => v < 0)) {
                    displayMessage("Please enter valid numbers. h, k must be positive. R_f can be zero or positive.", "error");
                    return;
                }

                let hi_si, ho_si, k_wall_si, rfi_si, rfo_si;
                let U_unit_display, R_unit_display;

                // Convert all inputs to SI units for calculations
                if (unitSystem === 'imperial') {
                    // 1 BTU/h ft^2 °F = 5.67826 W/m^2 °C
                    // 1 BTU/h ft °F = 1.730735 W/mK
                    // 1 inch = 0.0254 m
                    // 1 h ft^2 °F / BTU = 0.17611 m^2 °C / W
                    hi_si = hi * 5.67826;
                    ho_si = ho * 5.67826;
                    k_wall_si = k_wall * 1.730735;
                    rfi_si = rfi * 0.17611;
                    rfo_si = rfo * 0.17611;
                    
                    dx_wall_val = dx_wall_val * 0.0254; // in to m
                    di_pipe_val = di_pipe_val * 0.0254; // in to m
                    do_pipe_val = do_pipe_val * 0.0254; // in to m

                    U_unit_display = '\\(\\text{BTU/h ft}^2\\text{°F}\\)';
                    R_unit_display = '\\(\\text{h ft}^2\\text{°F/BTU}\\)';
                } else { // Metric
                    hi_si = hi;
                    ho_si = ho;
                    k_wall_si = k_wall;
                    rfi_si = rfi;
                    rfo_si = rfo;
                    
                    dx_wall_val = dx_wall_val / 1000; // mm to m
                    di_pipe_val = di_pipe_val / 1000; // mm to m
                    do_pipe_val = do_pipe_val / 1000; // mm to m

                    U_unit_display = '\\(\\text{W/m}^2\\text{°C}\\)';
                    R_unit_display = '\\(\\text{m}^2\\text{°C/W}\\)';
                }
                
                let calculationHtml = '<h4>Detailed Calculation Steps (SI Units):</h4>';
                
                let R_inner_conv_i, R_inner_fouling_i, R_wall_cond_i, R_outer_fouling_i, R_outer_conv_i, R_total_si_inner, U_value_si_inner;
                let R_inner_conv_o, R_inner_fouling_o, R_wall_cond_o, R_outer_fouling_o, R_outer_conv_o, R_total_si_outer, U_value_si_outer;

                if (geometryType === 'flat') {
                    if (isNaN(dx_wall_val) || dx_wall_val <= 0) {
                         displayMessage("Wall thickness must be a valid positive number.", "error"); return;
                    }
                    calculationHtml += `<p><strong>Geometry: Flat Wall</strong></p>`;
                    calculationHtml += `<p><strong>1. Individual Resistances (\\(R\\)):</strong></p>`;
                    
                    R_inner_conv_i = 1 / hi_si;
                    R_inner_fouling_i = rfi_si;
                    R_wall_cond_i = dx_wall_val / k_wall_si;
                    R_outer_fouling_i = rfo_si;
                    R_outer_conv_i = 1 / ho_si;

                    calculationHtml += `<p class="calculation-step">\\(R_{conv,i} = 1 / h_i = 1 / ${hi_si.toFixed(2)} = ${R_inner_conv_i.toExponential(3)} \\)</p>`;
                    calculationHtml += `<p class="calculation-step">\\(R_{f,i} = ${rfi_si.toExponential(3)} \\)</p>`;
                    calculationHtml += `<p class="calculation-step">\\(R_{wall} = \\Delta x / k = ${dx_wall_val.toExponential(2)} / ${k_wall_si.toFixed(2)} = ${R_wall_cond_i.toExponential(3)} \\)</p>`;
                    calculationHtml += `<p class="calculation-step">\\(R_{f,o} = ${rfo_si.toExponential(3)} \\)</p>`;
                    calculationHtml += `<p class="calculation-step">\\(R_{conv,o} = 1 / h_o = 1 / ${ho_si.toFixed(2)} = ${R_outer_conv_i.toExponential(3)} \\)</p>`;
                    
                    R_total_si_inner = R_inner_conv_i + R_inner_fouling_i + R_wall_cond_i + R_outer_fouling_i + R_outer_conv_i;
                    R_total_si_outer = R_total_si_inner; // For flat plate, A_i = A_o
                    U_value_si_inner = 1 / R_total_si_inner;
                    U_value_si_outer = U_value_si_inner;
                    
                    calculationHtml += `<p><strong>2. Total Resistance (\\(R_{\\text{total}}\\)):</strong></p>`;
                    calculationHtml += `<p class="formula">\\( R_{\\text{total}} = R_{conv,i} + R_{f,i} + R_{wall} + R_{f,o} + R_{conv,o} \\)</p>`;
                    calculationHtml += `<p class="calculation-step">\\( R_{\\text{total}} = ${R_total_si_inner.toExponential(3)} \\text{ m}^2\\text{°C/W} \\)</p>`;
                    calculationHtml += `<p><strong>3. Overall Coefficient (\\(U\\)):</strong></p>`;
                    calculationHtml += `<p class="calculation-step">\\( U = 1 / R_{\\text{total}} = 1 / ${R_total_si_inner.toExponential(3)} = ${U_value_si_inner.toFixed(2)} \\text{ W/m}^2\\text{°C} \\)</p>`;

                } else { // 'cylinder'
                    if (isNaN(di_pipe_val) || isNaN(do_pipe_val) || di_pipe_val <= 0 || do_pipe_val <= 0 || di_pipe_val >= do_pipe_val) {
                         displayMessage("Pipe diameters must be positive, and outer diameter must be greater than inner diameter.", "error"); return;
                    }
                    let ri_si = di_pipe_val / 2;
                    let ro_si = do_pipe_val / 2;
                    
                    calculationHtml += `<p><strong>Geometry: Cylindrical Pipe</strong></p>`;
                    calculationHtml += `<p>SI Radii: \\(r_i = ${ri_si.toExponential(3)} \\text{ m}\\), \\(r_o = ${ro_si.toExponential(3)} \\text{ m}\\)</p>`;

                    // --- Calculation for U_i (referred to inner area) ---
                    calculationHtml += `<h4>Calculation for \(U_i\) (referred to inner area)</h4>`;
                    R_inner_conv_i = 1 / hi_si;
                    R_inner_fouling_i = rfi_si;
                    R_wall_cond_i = (ri_si * Math.log(ro_si / ri_si)) / k_wall_si;
                    R_outer_fouling_i = (rfo_si * ri_si) / ro_si;
                    R_outer_conv_i = (1 / ho_si) * (ri_si / ro_si);
                    R_total_si_inner = R_inner_conv_i + R_inner_fouling_i + R_wall_cond_i + R_outer_fouling_i + R_outer_conv_i;
                    U_value_si_inner = 1 / R_total_si_inner;
                    
                    calculationHtml += `<p><strong>1. Resistances referred to Inner Area (\\(R_i\\)):</strong></p>`;
                    calculationHtml += `<p class="calculation-step">\\(R_{conv,i} = 1 / h_i = ${R_inner_conv_i.toExponential(3)} \\)</p>`;
                    calculationHtml += `<p class="calculation-step">\\(R_{f,i} = ${R_inner_fouling_i.toExponential(3)} \\)</p>`;
                    calculationHtml += `<p class="calculation-step">\\(R_{wall,i} = \\frac{r_i \\ln(r_o/r_i)}{k} = ${R_wall_cond_i.toExponential(3)} \\)</p>`;
                    calculationHtml += `<p class="calculation-step">\\(R_{f,o,i} = R_{f,o} (r_i/r_o) = ${R_outer_fouling_i.toExponential(3)} \\)</p>`;
                    calculationHtml += `<p class="calculation-step">\\(R_{conv,o,i} = (1 / h_o) (r_i/r_o) = ${R_outer_conv_i.toExponential(3)} \\)</p>`;
                    calculationHtml += `<p class="calculation-step">\\(R_{\\text{total},i} = ${R_total_si_inner.toExponential(3)} \\text{ m}^2\\text{°C/W} \\)</p>`;
                    calculationHtml += `<p class="calculation-step">\\(U_i = 1 / R_{\\text{total},i} = ${U_value_si_inner.toFixed(2)} \\text{ W/m}^2\\text{°C} \\)</p>`;

                    // --- Calculation for U_o (referred to outer area) ---
                    calculationHtml += `<h4>Calculation for \(U_o\) (referred to outer area)</h4>`;
                    R_inner_conv_o = (1 / hi_si) * (ro_si / ri_si);
                    R_inner_fouling_o = (rfi_si * ro_si) / ri_si;
                    R_wall_cond_o = (ro_si * Math.log(ro_si / ri_si)) / k_wall_si;
                    R_outer_fouling_o = rfo_si;
                    R_outer_conv_o = 1 / ho_si;
                    R_total_si_outer = R_inner_conv_o + R_inner_fouling_o + R_wall_cond_o + R_outer_fouling_o + R_outer_conv_o;
                    U_value_si_outer = 1 / R_total_si_outer;

                    calculationHtml += `<p><strong>2. Resistances referred to Outer Area (\\(R_o\\)):</strong></p>`;
                    calculationHtml += `<p class="calculation-step">\\(R_{conv,i,o} = (1 / h_i) (r_o/r_i) = ${R_inner_conv_o.toExponential(3)} \\)</p>`;
                    calculationHtml += `<p class="calculation-step">\\(R_{f,i,o} = R_{f,i} (r_o/r_i) = ${R_inner_fouling_o.toExponential(3)} \\)</p>`;
                    calculationHtml += `<p class="calculation-step">\\(R_{wall,o} = \\frac{r_o \\ln(r_o/r_i)}{k} = ${R_wall_cond_o.toExponential(3)} \\)</p>`;
                    calculationHtml += `<p class="calculation-step">\\(R_{f,o} = ${R_outer_fouling_o.toExponential(3)} \\)</p>`;
                    calculationHtml += `<p class="calculation-step">\\(R_{conv,o} = 1 / h_o = ${R_outer_conv_o.toExponential(3)} \\)</p>`;
                    calculationHtml += `<p class="calculation-step">\\(R_{\\text{total},o} = ${R_total_si_outer.toExponential(3)} \\text{ m}^2\\text{°C/W} \\)</p>`;
                    calculationHtml += `<p class="calculation-step">\\(U_o = 1 / R_{\\text{total},o} = ${U_value_si_outer.toFixed(2)} \\text{ W/m}^2\\text{°C} \\)</p>`;
                }
                
                // Convert U_value back to original unit system for display
                let displayU_inner, displayU_outer, displayR_inner, displayR_outer;
                if (unitSystem === 'imperial') {
                    displayU_inner = U_value_si_inner / 5.67826;
                    displayU_outer = U_value_si_outer / 5.67826;
                    displayR_inner = R_total_si_inner / 0.17611;
                    displayR_outer = R_total_si_outer / 0.17611;
                } else {
                    displayU_inner = U_value_si_inner;
                    displayU_outer = U_value_si_outer;
                    displayR_inner = R_total_si_inner;
                    displayR_outer = R_total_si_outer;
                }
                
                calculationDetailsDiv.innerHTML = calculationHtml;
                if (window.MathJax) {
                    window.MathJax.typesetPromise([calculationDetailsDiv]);
                }

                // Populate results table
                resultTableBody.innerHTML = '';
                function addResultRow(parameterHtml, valueHtml) {
                    const row = resultTableBody.insertRow();
                    const paramCell = row.insertCell();
                    const valueCell = row.insertCell();
                    paramCell.innerHTML = parameterHtml;
                    valueCell.innerHTML = valueHtml;
                }
                
                if (geometryType === 'flat') {
                    addResultRow(`Total Thermal Resistance (\\(R_{\\text{total}}\\))`, `<strong>${displayR_inner.toExponential(3)} ${R_unit_display}</strong>`);
                    addResultRow(`Overall Heat Transfer Coefficient (\\(U\\))`, `<strong>${displayU_inner.toFixed(2)} ${U_unit_display}</strong>`);
                } else {
                    addResultRow(`Total Resistance (Inner Area, \\(R_{\\text{total},i}\\))`, `<strong>${displayR_inner.toExponential(3)} ${R_unit_display}</strong>`);
                    addResultRow(`U-value (Inner Area, \\(U_i\\))`, `<strong style="color:var(--primary-color); font-size:1.2em;">${displayU_inner.toFixed(2)} ${U_unit_display}</strong>`);
                    addResultRow(`Total Resistance (Outer Area, \\(R_{\\text{total},o}\\))`, `<strong>${displayR_outer.toExponential(3)} ${R_unit_display}</strong>`);
                    addResultRow(`U-value (Outer Area, \\(U_o\\))`, `<strong style="color:var(--primary-color); font-size:1.2em;">${displayU_outer.toFixed(2)} ${U_unit_display}</strong>`);
                }
                
                if (window.MathJax) {
                    window.MathJax.typesetPromise([resultTableBody]);
                }

                standardReference.innerHTML = "The calculation of the overall heat transfer coefficient (U-value) is fundamental in heat exchanger design. It is crucial to use accurate convection coefficients and, especially, appropriate fouling factors. Recommended sources for these values include: <ul><li><strong>TEMA (Tubular Exchanger Manufacturers Association) Standards</strong> for shell-and-tube heat exchangers, which provide detailed fouling resistance values for various fluids and operating conditions.</li><li><strong>ASHRAE Handbooks</strong> for building HVAC applications, which specify U-values and thermal properties for building materials.</li><li>Textbooks such as <strong>Holman, J. P., 'Heat Transfer'</strong> or <strong>Incropera, F. P., et al., 'Fundamentals of Heat and Mass Transfer'</strong> for general principles and correlations.</li></ul>Always verify results against industry-specific codes and regulations.";

                resultContainer.style.display = 'block';
                setTimeout(() => {
                    resultContainer.classList.add('show');
                }, 10);
                resultContainer.scrollIntoView({ behavior: 'smooth' });
                displayMessage("Calculation completed successfully!", "info");
            });

            // New theme switch logic
            const themeSwitch = document.getElementById('theme-switch');
            if (themeSwitch) {
                if (localStorage.getItem('theme') === 'dark') {
                    document.body.classList.add('dark-mode');
                    themeSwitch.checked = true;
                }
                themeSwitch.addEventListener('change', function() {
                    document.body.classList.toggle('dark-mode');
                    localStorage.setItem('theme', this.checked ? 'dark' : 'light');
                });
            }
        });
    </script>
</body>
</html>
