<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-23Y1V450SR"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-23Y1V450SR');
    </script>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5936527763614780"
     crossorigin="anonymous"></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Finned Tube Heat Transfer Calculator - Design Calculators - Mechanical</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- MathJax for LaTeX rendering -->
    <script type="text/javascript" id="MathJax-script" async
            src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
    </script>
    <script>
        MathJax = {
            tex: {
                inlineMath: [['\\(', '\\)']],
                displayMath: [['\\[', '\\]']],
                processEscapes: true
            }
        };
    </script>
    <style>
        :root {
            --primary-color: #2196F3;
            --secondary-color: #1976D2;
            --accent-color: #FFC107;
            --bg-color: #f4f7f6;
            --card-bg: #ffffff;
            --text-color: #333333;
            --header-bg: #2C3E50;
            --footer-bg: #34495E;
            --border-color: #cccccc;
            --card-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
            --hover-color: #e2e6ea;
            --primary-color-rgb: 33, 150, 243;
        }
        body.dark-mode {
            --primary-color: #5DADE2;
            --secondary-color: #2874A6;
            --bg-color: #252D3A;
            --card-bg: #2F3C4C;
            --text-color: #E0E6EB;
            --header-bg: #252D3A;
            --footer-bg: #252D3A;
            --border-color: #4C5C70;
            --card-shadow: 0 6px 12px rgba(0, 0, 0, 0.4);
            --hover-color: #3A475C;
            --primary-color-rgb: 93, 173, 226;
        }
        body {
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding: 0;
            background-color: var(--bg-color);
            background-image: radial-gradient(circle at center, var(--bg-color) 0%, rgba(244, 247, 246, 0.8) 100%);
            color: var(--text-color);
            line-height: 1.6;
            transition: background-color 0.3s, color 0.3s, background-image 0.3s;
        }
        .container {
            max-width: 960px;
            margin: 0 auto;
            padding: 20px;
        }
        header {
            background-color: var(--header-bg);
            color: white;
            padding: 25px 0;
            text-align: center;
            box-shadow: var(--card-shadow);
            position: relative;
        }
        header h1 {
            margin: 0;
            font-size: 2.8em;
            color: var(--primary-color);
            text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
        }
        header .subtitle {
            margin: 8px 0 0;
            font-size: 1.1em;
            color: #bdc3c7;
        }
        main {
            padding: 30px 0;
        }
        .tool-container {
            background-color: var(--card-bg);
            border-radius: 12px;
            padding: 30px;
            box-shadow: var(--card-shadow);
            margin-bottom: 25px;
            transition: transform 0.3s ease-in-out;
        }
        .tool-container:hover {
            transform: translateY(-5px);
        }
        .tool-container h2 {
            color: var(--primary-color);
            border-bottom: 2px solid var(--primary-color);
            padding-bottom: 12px;
            margin-top: 0;
            margin-bottom: 25px;
            font-size: 2em;
        }
        .tool-description {
            margin-bottom: 25px;
            color: var(--text-color);
            font-size: 1.05em;
        }
        .tool-description ul {
            list-style-type: disc;
            margin-left: 25px;
            padding-left: 0;
            margin-top: 15px;
        }
        .tool-description ul li {
            margin-bottom: 8px;
        }
        .tool-description strong {
            color: var(--primary-color);
        }
        .back-button {
            display: inline-block;
            background-color: var(--primary-color);
            color: white;
            padding: 12px 20px;
            border-radius: 8px;
            text-decoration: none;
            margin-bottom: 25px;
            transition: background-color 0.3s, transform 0.2s ease-in-out;
            font-weight: bold;
        }
        .back-button:hover {
            background-color: var(--secondary-color);
            transform: scale(1.03);
        }
        .theme-toggle {
            position: absolute;
            top: 25px;
            right: 25px;
            display: flex;
            align-items: center;
        }
        .theme-toggle .light-icon,
        .theme-toggle .dark-icon {
            color: white;
            margin: 0 8px;
            font-size: 1.3em;
        }
        .switch {
            position: relative;
            display: inline-block;
            width: 65px;
            height: 38px;
        }
        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
        }
        .slider:before {
            position: absolute;
            content: "";
            height: 30px;
            width: 30px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
        }
        input:checked + .slider {
            background-color: var(--primary-color);
        }
        input:focus + .slider {
            box-shadow: 0 0 1px var(--primary-color);
        }
        input:checked + .slider:before {
            transform: translateX(27px);
        }
        .slider.round {
            border-radius: 38px;
        }
        .slider.round:before {
            border-radius: 50%;
        }
        footer {
            background-color: var(--footer-bg);
            color: white;
            padding: 25px 0;
            text-align: center;
            box-shadow: 0 -3px 10px rgba(0, 0, 0, 0.2);
            margin-top: 40px;
        }
        footer .disclaimer h3,
        footer .social-share h3 {
            color: var(--primary-color);
            margin-bottom: 12px;
            font-size: 1.3em;
        }
        footer .disclaimer p {
            font-size: 0.95em;
            color: #bdc3c7;
        }
        .social-buttons {
            margin-top: 20px;
            display: flex;
            justify-content: center;
            gap: 15px;
        }
        .social-btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 45px;
            height: 45px;
            border-radius: 50%;
            color: white;
            text-decoration: none;
            font-size: 1.4em;
            transition: transform 0.3s ease-in-out, box-shadow 0.3s ease-in-out;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        .social-btn:hover {
            transform: translateY(-5px) scale(1.1);
            box-shadow: 0 8px 15px rgba(0,0,0,0.3);
        }
        .social-btn.linkedin { background-color: #0A66C2; }
        .social-btn.facebook { background-color: #1877F2; }
        .social-btn.twitter { background-color: #1DA1F2; }
        .social-btn.whatsapp { background-color: #25D366; }
        .social-btn.reddit { background-color: #FF4500; }
        .social-btn.email { background-color: #7f8c8d; }
        .calculator-form {
            background-color: var(--card-bg);
            border-radius: 12px;
            padding: 30px;
            margin-top: 25px;
            box-shadow: var(--card-shadow);
        }
        .form-group {
            margin-bottom: 20px;
        }
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            font-size: 1.05em;
        }
        .form-group input, .form-group select {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            background-color: var(--bg-color);
            color: var(--text-color);
            box-sizing: border-box;
            font-size: 1em;
            transition: border-color 0.3s, box-shadow 0.3s;
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.08);
        }
        .form-group input:focus, .form-group select:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(var(--primary-color-rgb), 0.3);
            outline: none;
        }
        .form-row {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
        }
        .form-row .form-group {
            flex: 1 1 calc(50% - 10px);
            min-width: 280px;
        }
        @media (max-width: 600px) {
            .form-row .form-group {
                flex: 1 1 100%;
            }
        }
        .calculate-btn {
            background-image: linear-gradient(to right, var(--primary-color), var(--secondary-color));
            color: white;
            border: none;
            padding: 18px 25px; /* Increased padding for taller button */
            border-radius: 8px;
            cursor: pointer;
            font-size: 17px;
            font-weight: bold;
            margin-top: 20px;
            transition: background-image 0.3s ease-in-out, transform 0.2s ease-in-out, box-shadow 0.3s ease-in-out;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        .calculate-btn:hover {
            background-image: linear-gradient(to right, var(--secondary-color), var(--primary-color));
            transform: translateY(-3px) scale(1.02);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
        }
        .result-container {
            margin-top: 40px;
            padding: 30px;
            border-radius: 12px;
            background-color: var(--card-bg);
            box-shadow: var(--card-shadow);
            display: none; /* Changed from block to none */
            opacity: 0;
            transition: opacity 0.6s ease-out;
            pointer-events: none;
        }
        .result-container.show {
            opacity: 1;
            pointer-events: auto;
        }
        .result-container h3 {
            color: var(--primary-color);
            margin-bottom: 20px;
            font-size: 1.8em;
        }
        .result-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        .result-table th, .result-table td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
        }
        .result-table th {
            background-color: var(--hover-color);
            font-weight: bold;
            font-size: 1.1em;
        }
        .result-table tr:last-child td {
            border-bottom: none;
        }
        .standard-reference {
            margin-top: 25px;
            font-style: italic;
            font-size: 0.95rem;
            line-height: 1.5;
            padding: 10px;
            background-color: var(--bg-color);
            border-radius: 8px;
            border: 1px solid var(--border-color);
        }
        .info-icon {
            color: var(--primary-color);
            margin-left: 8px;
            cursor: help;
            font-size: 1em;
        }
        .tooltip {
            position: relative;
            display: inline-block;
        }
        .tooltip .tooltiptext {
            visibility: hidden;
            width: 220px;
            background-color: #333;
            color: #fff;
            text-align: center;
            border-radius: 8px;
            padding: 8px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -110px;
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 0.85em;
        }
        .tooltip .tooltiptext::after {
            content: "";
            position: absolute;
            top: 100%;
            left: 50%;
            margin-left: -5px;
            border-width: 5px;
            border-style: solid;
            border-color: #333 transparent transparent transparent;
        }
        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }
        #custom-message-box {
            position: fixed;
            top: 30px;
            left: 50%;
            transform: translateX(-50%);
            padding: 18px 30px;
            border-radius: 10px;
            box-shadow: 0 6px 15px rgba(0,0,0,0.3);
            z-index: 1000;
            font-weight: bold;
            color: white;
            opacity: 0;
            transition: opacity 0.5s ease-in-out, transform 0.5s ease-in-out;
            pointer-events: none; /* Allow clicks through */
        }
        #custom-message-box.show {
            opacity: 1;
            transform: translate(-50%, 10px);
        }
        #calculation-details {
            background-color: var(--bg-color);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 25px;
            font-size: 0.98em;
        }
        #calculation-details h4 {
            color: var(--secondary-color);
            margin-top: 0;
            margin-bottom: 15px;
            font-size: 1.3em;
        }
        #calculation-details p.formula {
            font-family: 'Times New Roman', serif;
            font-style: italic;
            font-size: 1.2em;
            text-align: center;
            padding: 12px 0;
            background-color: var(--hover-color);
            border-radius: 6px;
            margin: 15px 0;
            overflow-x: auto;
            border: 1px dashed var(--border-color);
        }
        #calculation-details p.calculation-step {
            font-family: 'Courier New', monospace;
            background-color: var(--hover-color);
            padding: 8px 12px;
            border-radius: 5px;
            margin-bottom: 8px;
            font-size: 0.95em;
            word-wrap: break-word;
        }
        #calculation-details ul {
            list-style-type: disc;
            margin-left: 25px;
            padding-left: 0;
        }
        #calculation-details ul li {
            margin-bottom: 5px;
        }
    </style>
</head>
<body oncontextmenu="return false;">
    <header>
        <div class="container">
            <h1>Design Calculators - Mechanical</h1>
            <p class="subtitle">Smart Tools for Modern Mechanical Engineers</p>
            <div class="theme-toggle">
                <span class="light-icon"><i class="fas fa-sun"></i></span>
                <label class="switch">
                    <input type="checkbox" id="theme-switch">
                    <span class="slider round"></span>
                </label>
                <span class="dark-icon"><i class="fas fa-moon"></i></span>
            </div>
        </div>
    </header>
    <main class="container">
        <a class='back-button' href='/indexmech'>
            <i class="fas fa-arrow-left"></i> Back to Tools
        </a>
        <div class="tool-container">
            <h2>Finned Tube Heat Transfer Calculator</h2>
            <div class="tool-description">
                <p>This calculator estimates the heat transfer rate from finned tubes to the ambient environment. Finned tubes are widely used to enhance heat transfer, especially where the external convection coefficient is low (e.g., gas flow).</p>
                <p>The calculation considers the geometry of the fins, their thermal conductivity, and the external convection and radiation from both the fin surfaces and the exposed base tube surface.</p>
                <ul>
                    <li><strong>Fin Efficiency (\(\eta_f\)):</strong> Measures how effectively a fin transfers heat relative to a fin at its base temperature.</li>
                    <li><strong>Overall Surface Efficiency (\(\eta_o\)):</strong> Accounts for the heat transfer from both the finned and unfinned (exposed tube) sections.</li>
                </ul>
                <p><strong>Note:</strong> The external heat transfer coefficient and fin efficiency correlations used are simplified for this calculator. For accurate design and compliance with international standards, refer to specialized heat transfer literature and industry standards like <strong>TEMA (Tubular Exchanger Manufacturers Association)</strong>, <strong>ASHRAE</strong>, or comprehensive textbooks on heat exchangers and heat transfer.</p>
            </div>
            <div class="calculator-form">
                <form id="finned-tube-form">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="unit-system">Unit System: <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Select Metric (e.g., mm, m, °C, W/mK, W/m²°C) or Imperial (e.g., inch, ft, °F, BTU/h ft°F, BTU/h ft²°F) units.</span></span></label>
                            <select id="unit-system" required>
                                <option value="metric">Metric (\(\text{mm}\), \(\text{m}\), \(\text{°C}\), \(\text{W/mK}\), \(\text{W/m}^2\text{°C}\))</option>
                                <option value="imperial">Imperial (\(\text{inch}\), \(\text{ft}\), \(\text{°F}\), \(\text{BTU/h ft°F}\), \(\text{BTU/h ft}^2\text{°F}\))</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="tube-outer-diameter">Tube Outer Diameter (Root) <span class="diameter-unit-label">(\(\text{mm}\))</span>: <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">The outer diameter of the bare tube before fins are attached.</span></span></label>
                            <input type="number" id="tube-outer-diameter" step="0.1" value="25" min="0.1" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="fin-height">Fin Height <span class="length-unit-label">(\(\text{mm}\))</span>: <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">The height of the fin from the tube surface to its tip.</span></span></label>
                            <input type="number" id="fin-height" step="0.1" value="12.5" min="0.1" required>
                        </div>
                        <div class="form-group">
                            <label for="fin-thickness">Fin Thickness <span class="length-unit-label">(\(\text{mm}\))</span>: <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">The thickness of the fin material.</span></span></label>
                            <input type="number" id="fin-thickness" step="0.01" value="0.5" min="0.01" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="fins-per-unit-length">Number of Fins per Unit Length <span class="fins-unit-label">(\(\text{fins/m}\))</span>: <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">How many fins are present per meter or foot of tube length.</span></span></label>
                            <input type="number" id="fins-per-unit-length" step="1" value="394" min="1" required>
                        </div>
                        <div class="form-group">
                            <label for="fin-conductivity">Fin Material Conductivity <span class="conductivity-unit-label">(\(\text{W/mK}\))</span>: <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Thermal conductivity of the fin material (e.g., Aluminum: ~205, Copper: ~385).</span></span></label>
                            <input type="number" id="fin-conductivity" step="0.1" value="205" min="0.1" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="base-temperature">Tube Base Temperature <span class="temp-unit-label">(\(\text{°C}\))</span>: <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Temperature of the tube surface at the base of the fins.</span></span></label>
                            <input type="number" id="base-temperature" step="0.1" value="100" required>
                        </div>
                        <div class="form-group">
                            <label for="ambient-temperature">Ambient Fluid Temperature <span class="temp-unit-label">(\(\text{°C}\))</span>: <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Temperature of the fluid surrounding the finned tube.</span></span></label>
                            <input type="number" id="ambient-temperature" step="0.1" value="20" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="external-convection-coefficient">External Convection Coefficient <span class="convection-unit-label">(\(\text{W/m}^2\text{°C}\))</span>: <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Average convection coefficient over the finned surface. This value is typically determined through complex correlations based on fluid properties, flow velocity, and fin geometry. Common values range from 10-100 W/m²°C for gases, 500-10,000 W/m²°C for liquids.</span></span></label>
                            <input type="number" id="external-convection-coefficient" step="0.1" value="50" min="0.1" required>
                        </div>
                        <div class="form-group">
                            <label for="surface-emissivity">Surface Emissivity (\(\epsilon\)): <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Typically 0.95 for painted surfaces, 0.05 for polished metals.</span></span></label>
                            <input type="number" id="surface-emissivity" step="0.01" value="0.95" min="0" max="1" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="tube-length">Tube Length <span class="tube-length-unit-label">(\(\text{m}\))</span>: <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">The total length of the finned tube.</span></span></label>
                            <input type="number" id="tube-length" step="0.1" value="1" min="0.1" required>
                        </div>
                    </div>
                    <button type="button" id="calculate-finned-heat-transfer-btn" class="calculate-btn">Calculate Heat Transfer</button>
                </form>
            </div>
            <div id="result-container" class="result-container">
                <h3>Calculation Results</h3>
                <div id="calculation-details"></div>
                <table class="result-table">
                    <thead>
                        <tr>
                            <th>Parameter</th>
                            <th>Value</th>
                        </tr>
                    </thead>
                    <tbody id="result-table-body"></tbody>
                </table>
                <div class="standard-reference" id="standard-reference"></div>
            </div>
        </div>
    </main>
    <footer>
        <div class="container">
            <div class="disclaimer">
                <h3>Disclaimer</h3>
                <p>To ensure accuracy and reliability, always verify the results obtained from these tools against the relevant engineering standards and guidelines.</p>
            </div>
            <div class="credit">
                <p>Created by A Sharma</p>
            </div>
            <div class="social-share">
                <h3>Share This Site</h3>
                <div class="social-buttons">
                    <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://designcalculators.co.in&title=Design Calculators - Mechanical" target="_blank" class="social-btn linkedin">
                        <i class="fab fa-linkedin"></i>
                    </a>
                    <a href="https://www.facebook.com/sharer/sharer.php?u=https://designcalculators.co.in" target="_blank" class="social-btn facebook">
                        <i class="fab fa-facebook"></i>
                    </a>
                    <a href="https://twitter.com/intent/tweet?text=Check out this amazing Design Calculators - Mechanical!&url=https://designcalculators.co.in" target="_blank" class="social-btn twitter">
                        <i class="fab fa-twitter"></i>
                    </a>
                    <a href="https://api.whatsapp.com/send?text=Check out this amazing Design Calculators - Mechanical! https://designcalculators.co.in" target="_blank" class="social-btn whatsapp">
                        <i class="fab fa-whatsapp"></i>
                    </a>
                    <a href="https://www.reddit.com/submit?url=https://designcalculators.co.in&title=Design Calculators - Mechanical" target="_blank" class="social-btn reddit">
                        <i class="fab fa-reddit"></i>
                    </a>
                    <a href="mailto:?subject=Check out Design Calculators - Mechanical!&body=I found this amazing Finned Tube Heat Transfer Calculator and other mechanical tools: https://designcalculators.co.in" class="social-btn email">
                        <i class="fas fa-envelope"></i>
                    </a>
                </div>
            </div>
        </div>
    </footer>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // --- ANTI-CODE COPYING SCRIPT ---
            document.addEventListener('keydown', function(e) {
                // Disable Ctrl+U
                if (e.ctrlKey && e.key === 'u') {
                    e.preventDefault();
                }
                // Disable Ctrl+S
                if (e.ctrlKey && e.key === 's') {
                    e.preventDefault();
                }
                // Disable F12
                if (e.key === 'F12') {
                    e.preventDefault();
                }
            });
            
            // The oncontextmenu="return false;" in the body tag handles right-click

            // --- CALCULATOR LOGIC ---
            const calculateBtn = document.getElementById('calculate-finned-heat-transfer-btn');
            const resultContainer = document.getElementById('result-container');
            const resultTableBody = document.getElementById('result-table-body');
            const standardReference = document.getElementById('standard-reference');
            const calculationDetailsDiv = document.getElementById('calculation-details');
            
            const unitSystemSelect = document.getElementById('unit-system');
            const tubeOuterDiameterInput = document.getElementById('tube-outer-diameter');
            const finHeightInput = document.getElementById('fin-height');
            const finThicknessInput = document.getElementById('fin-thickness');
            const finsPerUnitLengthInput = document.getElementById('fins-per-unit-length');
            const finConductivityInput = document.getElementById('fin-conductivity');
            const baseTemperatureInput = document.getElementById('base-temperature');
            const ambientTemperatureInput = document.getElementById('ambient-temperature');
            const externalConvectionCoefficientInput = document.getElementById('external-convection-coefficient');
            const surfaceEmissivityInput = document.getElementById('surface-emissivity');
            const tubeLengthInput = document.getElementById('tube-length');

            const diameterUnitLabels = document.querySelectorAll('.diameter-unit-label');
            const lengthUnitLabels = document.querySelectorAll('.length-unit-label');
            const tubeLengthUnitLabel = document.querySelector('.tube-length-unit-label'); // Specific label for tube length
            const tempUnitLabels = document.querySelectorAll('.temp-unit-label');
            const finsUnitLabels = document.querySelectorAll('.fins-unit-label');
            const conductivityUnitLabels = document.querySelectorAll('.conductivity-unit-label');
            const convectionUnitLabels = document.querySelectorAll('.convection-unit-label');

            const STEFAN_BOLTZMANN = 5.67e-8; // Stefan-Boltzmann constant W/(m^2 K^4)
            
            function displayMessage(message, type = "info") {
                let messageBox = document.getElementById('custom-message-box');
                if (!messageBox) {
                    messageBox = document.createElement('div');
                    messageBox.id = 'custom-message-box';
                    document.body.appendChild(messageBox);
                }
                messageBox.textContent = message;
                if (type === "error") {
                    messageBox.style.backgroundColor = '#dc3545';
                    messageBox.style.color = 'white';
                } else if (type === "warning") {
                    messageBox.style.backgroundColor = '#ffc107';
                    messageBox.style.color = '#333';
                } else { // "info"
                    messageBox.style.backgroundColor = '#28a745';
                    messageBox.style.color = 'white';
                }
                
                messageBox.classList.add('show');
                
                setTimeout(() => {
                    messageBox.classList.remove('show');
                }, 5000);
            }

            function updateUI() {
                const unitSystem = unitSystemSelect.value;

                if (unitSystem === 'imperial') {
                    diameterUnitLabels.forEach(label => label.innerHTML = '(\\(\text{inch}\\))');
                    lengthUnitLabels.forEach(label => label.innerHTML = '(\\(\text{inch}\\))');
                    tubeLengthUnitLabel.innerHTML = '(\\(\text{ft}\\))';
                    tempUnitLabels.forEach(label => label.innerHTML = '(\\(\text{°F}\\))');
                    finsUnitLabels.forEach(label => label.innerHTML = '(\\(\text{fins/ft}\\))');
                    conductivityUnitLabels.forEach(label => label.innerHTML = '(\\(\text{BTU/h ft°F}\\))');
                    convectionUnitLabels.forEach(label => label.innerHTML = '(\\(\text{BTU/h ft}^2\text{°F}\\))');
                } else { // Metric
                    diameterUnitLabels.forEach(label => label.innerHTML = '(\\(\text{mm}\\))');
                    lengthUnitLabels.forEach(label => label.innerHTML = '(\\(\text{mm}\\))');
                    tubeLengthUnitLabel.innerHTML = '(\\(\text{m}\\))';
                    tempUnitLabels.forEach(label => label.innerHTML = '(\\(\text{°C}\\))');
                    finsUnitLabels.forEach(label => label.innerHTML = '(\\(\text{fins/m}\\))');
                    conductivityUnitLabels.forEach(label => label.innerHTML = '(\\(\text{W/mK}\\))');
                    convectionUnitLabels.forEach(label => label.innerHTML = '(\\(\text{W/m}^2\text{°C}\\))');
                }
                
                if (window.MathJax && window.MathJax.typeset) {
                    window.MathJax.typeset();
                }
            }

            unitSystemSelect.addEventListener('change', updateUI);
            updateUI(); // Initial UI update

            calculateBtn.addEventListener('click', function() {
                // 1. Read all raw input values
                const unitSystem = unitSystemSelect.value;
                const D_tube_outer_val = parseFloat(tubeOuterDiameterInput.value);
                const H_fin_val = parseFloat(finHeightInput.value);
                const t_fin_val = parseFloat(finThicknessInput.value);
                const N_fins_per_unit_length_val = parseFloat(finsPerUnitLengthInput.value);
                const k_fin_val = parseFloat(finConductivityInput.value);
                const T_base_val = parseFloat(baseTemperatureInput.value);
                const T_ambient_val = parseFloat(ambientTemperatureInput.value);
                const h_external_val = parseFloat(externalConvectionCoefficientInput.value);
                const epsilon_val = parseFloat(surfaceEmissivityInput.value);
                const L_tube_val = parseFloat(tubeLengthInput.value);

                // 2. Input validation
                const inputs = [D_tube_outer_val, H_fin_val, t_fin_val, N_fins_per_unit_length_val, k_fin_val, T_base_val, T_ambient_val, h_external_val, epsilon_val, L_tube_val];
                if (inputs.some(isNaN)) {
                    displayMessage("Please ensure all fields have valid numbers.", "error");
                    return;
                }
                if (inputs.slice(0, 8).some(v => v <= 0) || inputs[9] <= 0) {
                     displayMessage("All dimensional and thermal inputs must be positive numbers.", "error");
                     return;
                }
                 if (epsilon_val < 0 || epsilon_val > 1) {
                    displayMessage("Surface Emissivity must be between 0 and 1.", "error");
                    return;
                }
                if (T_base_val <= T_ambient_val) {
                    displayMessage("Tube Base Temperature must be greater than Ambient Fluid Temperature.", "error");
                    return;
                }

                // 3. Declare SI unit variables and perform conversions
                let D_tube_outer_m, H_fin_m, t_fin_m, N_fins_per_m, k_fin_si, T_base_K, T_ambient_K, h_external_si, L_tube_m;
                let Q_unit_display, T_unit_display, L_unit_display_short, D_unit_display_short, L_unit_display_long, Fins_unit_display, K_unit_display, H_unit_display;

                if (unitSystem === 'imperial') {
                    D_tube_outer_m = D_tube_outer_val * 0.0254; // inch to meter
                    H_fin_m = H_fin_val * 0.0254; // inch to meter
                    t_fin_m = t_fin_val * 0.0254; // inch to meter
                    N_fins_per_m = N_fins_per_unit_length_val * 3.28084; // fins/ft to fins/m
                    k_fin_si = k_fin_val * 1.730735; // BTU/h ft°F to W/mK
                    T_base_K = (T_base_val - 32) * 5 / 9 + 273.15; // °F to Kelvin
                    T_ambient_K = (T_ambient_val - 32) * 5 / 9 + 273.15; // °F to Kelvin
                    h_external_si = h_external_val * 5.67826; // BTU/h ft²°F to W/m²°C
                    L_tube_m = L_tube_val * 0.3048; // ft to meter
                    
                    Q_unit_display = '\\(\\text{BTU/h}\\)';
                } else { // Metric
                    D_tube_outer_m = D_tube_outer_val / 1000; // mm to meter
                    H_fin_m = H_fin_val / 1000; // mm to meter
                    t_fin_m = t_fin_val / 1000; // mm to meter
                    N_fins_per_m = N_fins_per_unit_length_val; // fins/m
                    k_fin_si = k_fin_val; // W/mK
                    T_base_K = T_base_val + 273.15; // °C to Kelvin
                    T_ambient_K = T_ambient_val + 273.15; // °C to Kelvin
                    h_external_si = h_external_val; // W/m²°C
                    L_tube_m = L_tube_val; // m

                    Q_unit_display = '\\(\\text{W}\\)';
                }

                // --- 4. Perform Calculations in SI units ---
                let calculationHtml = '<h4>Detailed Calculation Steps:</h4>';
                calculationHtml += `<p><strong>1. Input Parameters (Converted to SI Units):</strong></p><ul>
                    <li>Tube Outer Diameter (\\(D_{o}\\)): ${D_tube_outer_m.toFixed(4)} m</li>
                    <li>Fin Height (\\(H_{f}\\)): ${H_fin_m.toFixed(4)} m</li>
                    <li>Fin Thickness (\\(t_{f}\\)): ${t_fin_m.toExponential(2)} m</li>
                    <li>Fins per meter (\\(N_{f}\\)): ${N_fins_per_m.toFixed(1)} fins/m</li>
                    <li>Fin Conductivity (\\(k_{f}\\)): ${k_fin_si.toFixed(2)} W/mK</li>
                    <li>Base Temperature (\\(T_{b}\\)): ${T_base_K.toFixed(2)} K</li>
                    <li>Ambient Temperature (\\(T_{\\infty}\\)): ${T_ambient_K.toFixed(2)} K</li>
                    <li>Convection Coeff. (\\(h\\)): ${h_external_si.toFixed(2)} W/m²°C</li>
                    <li>Emissivity (\\(\\epsilon\\)): ${epsilon_val.toFixed(2)}</li>
                    <li>Tube Length (\\(L\\)): ${L_tube_m.toFixed(2)} m</li></ul>`;

                const r_tube = D_tube_outer_m / 2;
                const r_fin_tip = r_tube + H_fin_m;
                
                const m_param = Math.sqrt((2 * h_external_si) / (k_fin_si * t_fin_m));
                const L_corrected = H_fin_m + (t_fin_m / 2);
                const Xi = m_param * L_corrected;
                const fin_efficiency_eta_f = Xi < 1e-6 ? 1 : Math.tanh(Xi) / Xi;

                calculationHtml += `<p><strong>2. Intermediate Calculations:</strong></p>
                    <p class="calculation-step">Tube Radius (\\(r_{tube}\\)) = ${r_tube.toFixed(4)} m</p>
                    <p class="calculation-step">Fin Tip Radius (\\(r_{fin,tip}\\)) = ${r_fin_tip.toFixed(4)} m</p>
                    <p class="calculation-step">Parameter \\(m\\) = \\(\\sqrt{2h / (k_f t_f)}\\) = ${m_param.toFixed(3)} m⁻¹</p>
                    <p class="calculation-step">Corrected Fin Length (\\(L_c\\)) = ${L_corrected.toFixed(4)} m</p>
                    <p class="calculation-step">Fin Efficiency (\\(\\eta_f\\)) ≈ \\(\\tanh(m L_c) / (m L_c)\\) = ${fin_efficiency_eta_f.toFixed(4)}</p>`;

                const fin_side_area = Math.PI * (Math.pow(r_fin_tip, 2) - Math.pow(r_tube, 2));
                const fin_edge_area = 2 * Math.PI * r_fin_tip * t_fin_m;
                const A_fin_per_fin_total = 2 * fin_side_area; // Edge area often negligible and omitted for simplicity in many texts
                
                const A_fins_per_m = N_fins_per_m * A_fin_per_fin_total;
                
                const fin_pitch = 1 / N_fins_per_m;
                if (t_fin_m >= fin_pitch) {
                     displayMessage("Fin thickness is too large for the given number of fins. Fins are overlapping.", "error");
                     return;
                }
                const A_tube_exposed_per_m = Math.PI * D_tube_outer_m * (fin_pitch - t_fin_m) * N_fins_per_m;
                const A_total_outer_per_m = A_fins_per_m + A_tube_exposed_per_m;

                const overall_efficiency_eta_o = (A_tube_exposed_per_m + fin_efficiency_eta_f * A_fins_per_m) / A_total_outer_per_m;
                
                calculationHtml += `<p class="calculation-step">Area of all fins per meter (\\(A'_{fins}\\)) = ${A_fins_per_m.toFixed(3)} m²/m</p>
                    <p class="calculation-step">Area of exposed tube per meter (\\(A'_{tube}\\)) = ${A_tube_exposed_per_m.toFixed(3)} m²/m</p>
                    <p class="calculation-step">Total Outer Surface Area per meter (\\(A'_{total}\\)) = ${A_total_outer_per_m.toFixed(3)} m²/m</p>
                    <p class="calculation-step">Overall Surface Efficiency (\\(\\eta_o\\)) = \\((A'_{tube} + \\eta_f A'_{fins}) / A'_{total}\\) = ${overall_efficiency_eta_o.toFixed(4)}</p>`;
                
                const Q_convection_per_m = h_external_si * A_total_outer_per_m * overall_efficiency_eta_o * (T_base_K - T_ambient_K);
                const Q_radiation_per_m = epsilon_val * STEFAN_BOLTZMANN * A_total_outer_per_m * (Math.pow(T_base_K, 4) - Math.pow(T_ambient_K, 4));
                const Q_total_per_m = Q_convection_per_m + Q_radiation_per_m;
                const Q_total_si = Q_total_per_m * L_tube_m;

                calculationHtml += `<p><strong>3. Heat Transfer Calculation:</strong></p>
                    <p class="formula">\\( Q'_{conv} = h A'_{total} \\eta_o (T_b - T_{\\infty}) \\)</p>
                    <p class="calculation-step">\\( Q'_{conv} \\) = ${Q_convection_per_m.toFixed(2)} W/m</p>
                    <p class="formula">\\( Q'_{rad} = \\epsilon \\sigma A'_{total} (T_b^4 - T_{\\infty}^4) \\)</p>
                    <p class="calculation-step">\\( Q'_{rad} \\) = ${Q_radiation_per_m.toFixed(2)} W/m</p>
                    <p class="formula">\\( Q_{total} = (Q'_{conv} + Q'_{rad}) \\times L \\)</p>
                    <p class="calculation-step">\\( Q_{total} \\) = (${Q_convection_per_m.toFixed(2)} + ${Q_radiation_per_m.toFixed(2)}) W/m \\times ${L_tube_m.toFixed(2)} m = <strong>${Q_total_si.toFixed(2)} W</strong></p>`;

                // 5. Convert total Q back for display
                const displayQ = unitSystem === 'imperial' ? Q_total_si * 3.41214 : Q_total_si;

                calculationDetailsDiv.innerHTML = calculationHtml;

                // 6. Populate results table
                resultTableBody.innerHTML = '';
                const results = {
                    "Fin Efficiency (\\(\\eta_f\\))": `<strong>${fin_efficiency_eta_f.toFixed(4)}</strong>`,
                    "Overall Surface Efficiency (\\(\\eta_o\\))": `<strong>${overall_efficiency_eta_o.toFixed(4)}</strong>`,
                    "Convective Heat Transfer": `<strong>${(unitSystem === 'imperial' ? Q_convection_per_m * L_tube_m * 3.41214 : Q_convection_per_m * L_tube_m).toFixed(2)} ${Q_unit_display}</strong>`,
                    "Radiative Heat Transfer": `<strong>${(unitSystem === 'imperial' ? Q_radiation_per_m * L_tube_m * 3.41214 : Q_radiation_per_m * L_tube_m).toFixed(2)} ${Q_unit_display}</strong>`,
                    "Total Heat Transfer Rate (\\(Q\\))": `<strong style="color:var(--primary-color); font-size:1.2em;">${displayQ.toFixed(2)} ${Q_unit_display}</strong>`
                };
                
                for (const [key, value] of Object.entries(results)) {
                    const row = resultTableBody.insertRow();
                    row.insertCell().innerHTML = key;
                    row.insertCell().innerHTML = value;
                }
                
                if (window.MathJax && window.MathJax.typeset) {
                    window.MathJax.typeset([calculationDetailsDiv, resultTableBody]);
                }
                
                standardReference.innerHTML = "Finned tube heat transfer calculations are complex and often rely on empirical correlations and dimensionless numbers (e.g., Reynolds, Prandtl, Nusselt numbers) specific to fin geometry and flow conditions. For detailed design and compliance with international standards, refer to specialized heat transfer engineering handbooks such as <strong>Kern, D. Q., 'Process Heat Transfer'</strong>, <strong>Kays, W. M., & London, A. L., 'Compact Heat Exchangers'</strong>, and standards from organizations like TEMA, ASHRAE, and API.";
                
                resultContainer.style.display = 'block';
                setTimeout(() => {
                    resultContainer.classList.add('show');
                    resultContainer.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }, 10);
                
                displayMessage("Calculation completed successfully!", "info");
            });

            const themeSwitch = document.getElementById('theme-switch');
            if (themeSwitch) {
                // Check local storage for theme preference
                if (localStorage.getItem('theme') === 'dark') {
                    document.body.classList.add('dark-mode');
                    themeSwitch.checked = true;
                }
                themeSwitch.addEventListener('change', function() {
                    if (this.checked) {
                        document.body.classList.add('dark-mode');
                        localStorage.setItem('theme', 'dark');
                    } else {
                        document.body.classList.remove('dark-mode');
                        localStorage.setItem('theme', 'light');
                    }
                });
            }
        });
    </script>
</body>
</html>

