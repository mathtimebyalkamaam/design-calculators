<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>4-20 mA Signal Scaling - Design Calculators - Instrumentation</title>
    <!-- SEO Meta Tags -->
    <meta name="description" content="Professional 4-20mA scaling calculator for instrumentation. Convert mA signals to any engineering units (PSI, °C, GPM, % level) based on LRV and URV per IEC 60381 & NAMUR NE 43.">
    <meta name="keywords" content="4-20ma calculator, signal scaling, instrumentation, plc, dcs, lrv, urv, namur ne 43, iec 60381, process variable">
    <meta name="author" content="Design Calculators">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://designcalculators.co.in/signal-scaling.html" />
    <!-- AdSense & Analytics -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5936527763614780" crossorigin="anonymous"></script>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-23Y1V450SR"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-23Y1V450SR');
    </script>
    <!-- Fonts & Icons -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Montserrat:wght@700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- MathJax for Formulas -->
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['\\(', '\\)'], ['$', '$']],
                displayMath: [['\\[', '\\]'], ['$$', '$$']]
            },
            svg: { fontCache: 'global' }
        };
    </script>
    <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <!-- PDF Generation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.8.3/jspdf.plugin.autotable.min.js"></script>
    <!-- Favicon -->
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    
    <style>
        :root {
            --primary: #1E3A8A;
            --secondary: #2563EB;
            --accent: #F59E0B;
            --success: #10B981;
            --danger: #DC2626;
            --warning: #F59E0B;
            --bg: #F8FAFC;
            --card: #FFFFFF;
            --text: #4B5563;
            --heading: #111827;
            --footer-bg: #0F172A;
            --border: #E2E8F0;
            --grad: linear-gradient(135deg, var(--primary), var(--secondary));
            --grad-dark: linear-gradient(135deg, #0F172A, #1E293B);
            --shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
            --shadow-lg: 0 10px 20px rgba(0, 0, 0, 0.1);
        }

        body.dark-mode {
            --primary: #10B981;
            --secondary: #34D399;
            --bg: #0F172A;
            --card: #1E293B;
            --text: #CBD5E1;
            --heading: #F1F5F9;
            --footer-bg: #020617;
            --border: #334155;
        }

        * { box-sizing: border-box; }
        html { scroll-behavior: smooth; }
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg);
            color: var(--text);
            line-height: 1.7;
            margin: 0;
            padding: 0;
        }

        .container { max-width: 1280px; margin: 0 auto; padding: 0 24px; }

        /* Header & Nav */
        header {
            background: var(--grad);
            color: white;
            padding: 24px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .logo-container {
            display: flex;
            flex-direction: column;
            text-decoration: none;
            color: white;
        }
        .logo-text {
            font-size: 1.75rem;
            font-weight: 800;
            font-family: 'Montserrat', sans-serif;
        }
        .logo-subtitle {
            font-size: 0.8rem;
            margin: 4px 0 0 0;
            color: #E0E7FF;
            opacity: 0.9;
        }
        .nav-links {
            display: flex;
            gap: 24px;
            list-style: none;
            margin: 0;
            padding: 0;
        }
        .nav-links a {
            color: white;
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s;
        }
        .nav-links a:hover { color: var(--accent); }
        .theme-toggle {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .switch {
            position: relative;
            width: 56px;
            height: 30px;
        }
        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0,0,0,0.2);
            transition: .4s;
            border-radius: 30px;
        }
        .slider:before {
            position: absolute;
            content: "";
            height: 22px;
            width: 22px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        input:checked + .slider {
            background-color: var(--accent);
        }
        input:checked + .slider:before {
            transform: translateX(26px);
        }
        
        /* Main Content & Cards */
        main { padding: 40px 0; }
        .card {
            background: var(--card);
            border-radius: 12px;
            padding: 30px;
            box-shadow: var(--shadow);
            margin-bottom: 30px;
            border: 1px solid var(--border);
        }
        h2 {
            color: var(--primary);
            border-bottom: 3px solid var(--primary);
            padding-bottom: 15px;
            margin-top: 0;
            font-family: 'Montserrat', sans-serif;
            font-size: 1.8rem;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        h3 {
            color: var(--heading);
            font-family: 'Montserrat', sans-serif;
            font-size: 1.5rem;
            margin-top: 25px;
            margin-bottom: 20px;
        }
        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }
        .form-group {
            margin-bottom: 20px;
        }
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--heading);
        }
        .form-group input,
        .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--border);
            border-radius: 6px;
            background-color: var(--bg);
            color: var(--text);
            font-size: 1rem;
        }
        .form-group input:focus,
        .form-group select:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 3px rgba(30, 58, 138, 0.1);
        }
        body.dark-mode .form-group input:focus {
             box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1);
        }
        
        .btn {
            background: var(--grad);
            color: white;
            border: none;
            padding: 16px 30px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: 700;
            box-shadow: 0 4px 12px rgba(30, 58, 138, 0.3);
            transition: all 0.3s;
            width: 100%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(30, 58, 138, 0.4);
        }
        .btn-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        .btn-group .btn {
            flex: 1;
            min-width: 150px;
        }
        .btn.secondary {
            background: var(--secondary);
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3);
        }
        .btn.accent {
            background: var(--accent);
            box-shadow: 0 4px 12px rgba(245, 158, 11, 0.3);
        }

        /* CALCULATION STEPS DISPLAY */
        .steps-container {
            display: none;
            margin-top: 30px;
        }
        .steps-container.active {
            display: block;
        }
        .step-card {
            width: 100% !important;
            max-width: 100% !important;
            box-sizing: border-box; /* v6 */
            background: var(--card);
            border-radius: 12px;
            padding: 25px 30px;
            box-shadow: var(--shadow);
            border: 1px solid var(--border);
            animation: slideIn 0.6s ease-out;
            transition: all 0.3s;
            margin-bottom: 25px; /* Spacing between cards */
        }
        @keyframes slideIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .step-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }
        .step-card h4 {
            color: var(--primary);
            margin: 0 0 20px 0;
            font-size: 1.4rem;
            font-family: 'Montserrat', sans-serif;
            display: block; /* Changed from flex */
        }
        .step-card h4::after {
            content: "";
            display: table;
            clear: both;
        }
        .step-card .number {
            float: left; /* Changed to float */
            width: 40px;
            height: 40px;
            background: var(--primary);
            color: white;
            border-radius: 50%;
            text-align: center;
            line-height: 40px;
            font-weight: 700;
            margin-right: 15px;
            font-size: 1.3rem;
            /* Removed flex-shrink */
        }
        .step-content {
            width: 100% !important;
            max-width: 100% !important;
            box-sizing: border-box; /* v6 */
            display: grid;
            grid-template-columns: 1fr !important;
            gap: 25px;
            align-items: start;
        }
        .step-content > * { min-width: 0; }
        .step-content .formula-block {
            background: var(--bg);
            border-radius: 8px;
            padding: 20px;
            font-size: 1rem;
            border: 1px solid var(--border);
        }
        .step-content .formula-block p {
            margin-top: 0;
        }
        .step-content .formula {
            background: var(--bg);
            border-left: 3px solid var(--accent);
            padding: 15px;
            margin: 12px 0;
            font-size: 1rem;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            overflow-x: auto;
        }


        /* Results */
        .results-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            border-radius: 8px;
            overflow: hidden;
        }
        .results-table th,
        .results-table td {
            padding: 16px;
            text-align: left;
            border-bottom: 1px solid var(--border);
        }
        .results-table th {
            background: var(--grad);
            color: white;
            font-weight: 700;
        }
        .results-table tr:nth-child(even) {
            background-color: var(--bg);
        }
        .results-table td:first-child {
            font-weight: 600;
            color: var(--heading);
        }
        .results-table .highlight {
            font-weight: 700;
            font-size: 1.1rem;
            color: var(--success);
        }

        /* Educational Section */
        .education-section {
            margin-top: 60px;
        }
        .insight-card {
            background: linear-gradient(135deg, var(--card), rgba(37,99,235,0.03));
            border-radius: 12px;
            padding: 25px;
            margin: 20px 0;
            border-left: 5px solid var(--secondary);
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            transition: all 0.3s;
        }
        .insight-card:hover {
            transform: translateX(5px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        .insight-card h4 {
            color: var(--secondary);
            font-size: 1.3rem;
            margin: 0 0 15px 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .insight-card h4 i {
            font-size: 1.5rem;
        }
        .insight-card p {
            margin: 10px 0;
            line-height: 1.8;
        }
        .insight-card ul {
            padding-left: 20px;
            margin: 10px 0;
        }
        .insight-card li {
            margin-bottom: 10px;
        }
        .stat-highlight {
            display: inline-block;
            background: var(--accent);
            color: #333;
            padding: 4px 12px;
            border-radius: 20px;
            font-weight: 700;
            margin: 0 4px;
        }
        .danger-box {
            background: linear-gradient(135deg, rgba(220,38,38,0.1), rgba(220,38,38,0.05));
            border-left: 5px solid var(--danger);
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
        }
        .danger-box h4 {
            color: var(--danger);
            margin-top: 0;
        }
        .success-box {
            background: linear-gradient(135deg, rgba(16,185,129,0.1), rgba(16,185,129,0.05));
            border-left: 5px solid var(--success);
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
        }
        .success-box h4 {
            color: var(--success);
            margin-top: 0;
        }


        /* Message Box */
        .message-box {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            padding: 16px 28px;
            border-radius: 8px;
            box-shadow: 0 6px 16px rgba(0,0,0,0.25);
            z-index: 10000;
            font-weight: 600;
            color: white;
            opacity: 0;
            transition: all 0.4s;
            display: none;
        }
        .message-box.show {
            display: block;
            opacity: 1;
            top: 30px;
        }

        /* Footer */
        footer {
            background: var(--grad-dark);
            color: #CBD5E1;
            padding: 50px 0 20px 0;
            margin-top: 60px;
        }
        .footer-content {
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 40px;
            margin-bottom: 30px;
        }
        .footer-col {
            flex: 1;
            min-width: 200px;
        }
        .footer-col h4 {
            color: white;
            margin-bottom: 15px;
            font-weight: 700;
        }
        .footer-col ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        .footer-col a {
            color: #CBD5E1;
            text-decoration: none;
            transition: color 0.3s;
        }
        .footer-col a:hover {
            color: var(--accent);
        }
        .social-buttons {
            display: flex;
            gap: 12px;
            margin-top: 15px;
        }
        .social-btn {
            width: 40px;
            height: 40px;
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            border-radius: 50%;
            font-size: 1.1rem;
            transition: transform 0.3s;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        .social-btn:hover {
            transform: translateY(-4px);
        }
        .social-btn.linkedin { background-color: #0A66C2; }
        .social-btn.youtube { background-color: #FF0000; }
        .social-btn.twitter { background-color: #1DA1F2; }
        .social-btn.facebook { background-color: #1877F2; }
        .social-btn.whatsapp { background-color: #25D366; }
        .footer-disclaimer {
            text-align: center;
            padding-top: 25px;
            border-top: 1px solid #334155;
            max-width: 800px;
            margin: 0 auto;
            font-size: 0.9rem;
        }
        .footer-bottom {
            text-align: center;
            padding-top: 20px;
            font-size: 0.9rem;
            color: #94A3B8;
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .container { padding: 0 15px; }
            .navbar { flex-direction: column; gap: 20px; }
            .nav-links { flex-direction: column; gap: 12px; text-align: center; }
            .form-row { grid-template-columns: 1fr; }
            .card { padding: 20px; }
            .footer-content { flex-direction: column; gap: 25px; }
            .btn-group { flex-direction: column; }
        }
        .hidden { display: none; }
        
        /* Tooltip */
        .info-icon {
            color: var(--primary);
            margin-left: 5px;
            cursor: help;
        }
        .tooltip {
            position: relative;
            display: inline-block;
        }
        .tooltip .tooltiptext {
            visibility: hidden;
            width: 250px; /* Adjusted width */
            background-color: #333;
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 8px; /* Increased padding */
            position: absolute;
            z-index: 10;
            bottom: 125%;
            left: 50%;
            margin-left: -125px; /* Half of width */
            opacity: 0;
            transition: opacity 0.3s, transform 0.3s;
            transform: translateY(10px);
            font-family: 'Inter', sans-serif; /* Professional font */
            font-size: 0.85rem; /* Slightly smaller font size */
            line-height: 1.4; /* Better readability */
        }
        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
            transform: translateY(0);
        }

    </style>
    <link rel="stylesheet" href="styles.css">
    <meta property="og:title" content="4-20 mA Signal Scaling - Design Calculators - Instrumentation">
    <meta property="og:description" content="Professional 4-20mA scaling calculator for instrumentation. Convert mA signals to any engineering units (PSI, °C, GPM, % level) based on LRV and URV per IEC 60381 & NAMUR NE 43.">
</head>
<body>
    <div id="message-box" class="message-box"></div>

    <header class="header">
        <div class="header-bg-animation"></div>
        <div class="container">
            <nav class="navbar">
                <a href="/" class="logo-container">
                    <img src="logo.png" alt="Design Calculators Logo" class="logo">
                    <span class="logo-text">Design Calculators</span>
                </a>

                <div class="nav-menu">
                    <button class="mobile-menu-toggle" aria-label="Toggle menu">
                        <i class="fas fa-bars"></i>
                    </button>

                    <ul class="nav-links">
                        <li><a href="/index.html">Home</a></li>
                        
    <li class="dropdown">
        <a href="/indexele.html" class="dropdown-toggle">Electrical <i class="fas fa-chevron-down" style="font-size: 0.7em; margin-left: 4px;"></i></a>
        <div class="dropdown-menu">
            <div class="repo-grid"><div><a href="/arcflash.html">Arc Flash Calculator</a><a href="/breaker-sizing.html">Breaker Sizing</a><a href="/cable-thermal-rating.html">Cable Ampacity</a><a href="/comm-cable-loss.html">Comm Cable Loss</a><a href="/earth-conductor-size.html">Earth Conductor Size</a><a href="/generatorsizing.html">Generator Sizing</a><a href="/harmonicsanalyser.html">Harmonics Analyser</a><a href="/insulationresistance.html">Insulation Resistance</a><a href="/logicgate.html">Logic Gates Simulator</a><a href="/motor-starting.html">Motor Starting Current</a><a href="/pcbtrace.html">PCB Trace Width</a><a href="/protection-device.html">Protection Device</a><a href="/resistor.html">Resistor Color Code</a><a href="/solarcable.html">Solar Cable Sizing</a><a href="/systemxrcalculator.html">System X/R Ratio</a><a href="/transmissionline.html">Transmission Line</a><a href="/vfd-selection.html">VFD Selection Tool</a></div><div><a href="/batterylife.html">Battery Life Estimator</a><a href="/busbarampacity.html">Busbar Ampacity</a><a href="/cablepulling.html">Cable Pulling Tension</a><a href="/conduit-fill.html">Conduit Fill Calculator</a><a href="/earthingfaultsimulator.html">Earthing Fault Simulator</a><a href="/grounding.html">Grounding System Design</a><a href="/hvac-sizing.html">HVAC Sizing Calculator</a><a href="/lcresonancecalculator.html">LC Resonance Calculator</a><a href="/maintenance-guide.html">Maintenance Guide</a><a href="/nemaipconvertor.html">NEMA to IP Converter</a><a href="/power-factor.html">Power Factor Correction</a><a href="/relay-coordination.html">Relay Coordination</a><a href="/short-circuit.html">Short Circuit Current</a><a href="/solarpvarray.html">Solar PV Array</a><a href="/transformer-calculator.html">Transformer Calculator</a><a href="/unit-converter.html">Unit Converter</a><a href="/voltage-drop.html">Voltage Drop Calculator</a></div><div><a href="/battery-sizing.html">Battery Sizing (AH)</a><a href="/busbarshortcircuit.html">Busbar Short Circuit</a><a href="/cable-sizing.html">Cable Sizing Calculator</a><a href="/ctsaturation.html">CT Saturation</a><a href="/equipment-relay.html">Equipment Relay Setting</a><a href="/harmonic-distortion.html">Harmonic Distortion</a><a href="/industriallighting.html">Industrial Lighting</a><a href="/lighting-calulator.html">Lighting Calculator</a><a href="/motor-efficiency.html">Motor Efficiency</a><a href="/neutral-earth-fault-current.html">Neutral Earth Fault</a><a href="/powertriangletool.html">Power Triangle</a><a href="/electricalresidentialload.html">Residential Load Calc</a><a href="/skindepth.html">Skin Depth Calculator</a><a href="/symmetricalcomponents.html">Symmetrical Components</a><a href="/transformerinrush.html">Transformer Inrush</a><a href="/ups-sizing.html">UPS Sizing</a></div>
            </div>
            <div class="view-all-container">
                <a href="/indexele.html" class="view-all-link">View All Electrical Tools â†’</a>
            </div>
        </div>
    </li>
                        
    <li class="dropdown">
        <a href="/indexinst.html" class="dropdown-toggle">Instrumentation <i class="fas fa-chevron-down" style="font-size: 0.7em; margin-left: 4px;"></i></a>
        <div class="dropdown-menu">
            <div class="repo-grid"><div><a href="/adc-resolution.html">ADC Resolution</a><a href="/capillarylengthtemperatureerror.html">Capillary Error</a><a href="/cv-kv-valve.html">Cv/Kv Valve Sizing</a><a href="/dp-level.html">DP Level Measurement</a><a href="/hydrostatic-level.html">Hydrostatic Level</a><a href="/instrument-range.html">Instrument Range</a><a href="/loop-impedance.html">Loop Impedance</a><a href="/orifice-plate.html">Orifice Plate Beta</a><a href="/pid-tuning.html">PID Tuning</a><a href="/profibus.html">Profibus Calculator</a><a href="/tempsensorresponse.html">Response Time (Tau)</a><a href="/rtd-lead-comp.html">RTD Lead Wire Comp.</a><a href="/sealfluidzeroshift.html">Seal Fluid Shift</a><a href="/snr-calculator.html">SNR Calculator</a><a href="/thermocoupleextensioncable.html">TC Extension Cable</a><a href="/thermowellwakefreq.html">Thermowell Frequency</a><a href="/pressuretransmitteroverrange.html">Tx Overrange</a><a href="/valvecavitationcalculator.html">Valve Cavitation</a><a href="/vibrationtransmitter.html">Vibration Tx</a><a href="/zoneclassificationhelper.html">Zone Classification</a></div><div><a href="/baud-rate.html">Baud Rate Calculator</a><a href="/gascompressibility.html">Compressibility (Z)</a><a href="/dbcalculator.html">dB Gain/Loss Calc</a><a href="/flowprofiledistortioncalculator.html">Flow Distortion</a><a href="/impulselinefreezing.html">Impulse Freezing</a><a href="/intrinsic-safety.html">Intrinsic Safety Loop</a><a href="/measurement.html">Measurement Uncertainty</a><a href="/ph-temp-comp.html">pH Temp Compensation</a><a href="/plcscantime.html">PLC Scan Time</a><a href="/pressurereliefvalve.html">PRV Sizing (API 520)</a><a href="/reynoldsnumbercal.html">Reynolds Number</a><a href="/rtdselfheating.html">RTD Self-Heating</a><a href="/signal-scaling.html">Signal Scaling</a><a href="/staticheadcal.html">Static Head</a><a href="/temperaturesensorlag.html">Temp Sensor Lag</a><a href="/thermowell-wake.html">Thermowell Wake</a><a href="/ultrasoniclevel.html">Ultrasonic Level</a><a href="/valve-cv.html">Valve Cv Viewer</a><a href="/wetlegdensitycompensation.html">Wet Leg Compensation</a></div><div><a href="/capacitance-level.html">Capacitance Level</a><a href="/controlvalvenoise.html">Control Valve Noise</a><a href="/dp-flow-conversion.html">DP Flow Conversion</a><a href="/hartdevices.html">HART Devices</a><a href="/impulse-pressure-drop.html">Impulse Pressure Drop</a><a href="/junctionbox.html">Junction Box Sizing</a><a href="/orifice-flow.html">Orifice Flow Calculator</a><a href="/pid-symbol-library.html">PID Symbol Library</a><a href="/power-supply-load.html">Power Supply Load</a><a href="/prvsizing.html">Relief Orifice Area</a><a href="/rtdexcitationcurrentselection.html">RTD Excitation</a><a href="/rtd-tc-conversion.html">RTD/TC Conversion</a><a href="/sil.html">SIL Calculator</a><a href="/steamflow.html">Steam Flow</a><a href="/thermocouplecjccalculator.html">Thermocouple CJC</a><a href="/turndown.html">Turndown Ratio</a><a href="/controlvalveauthority.html">Valve Authority</a><a href="/controlvalveleakage.html">Valve Leakage Class</a><a href="/wirelesshart.html">WirelessHART Range</a></div>
            </div>
            <div class="view-all-container">
                <a href="/indexinst.html" class="view-all-link">View All Instrumentation Tools â†’</a>
            </div>
        </div>
    </li>
                        
    <li class="dropdown">
        <a href="/indexmech.html" class="dropdown-toggle">Mechanical <i class="fas fa-chevron-down" style="font-size: 0.7em; margin-left: 4px;"></i></a>
        <div class="dropdown-menu">
            <div class="repo-grid"><div><a href="/aircompressorfad.html">Air Compressor FAD</a><a href="/asme-vessel.html">ASME Vessel Design</a><a href="/belt-pulley.html">Belt & Pulley</a><a href="/bolt-torque.html">Bolt Torque</a><a href="/controlvalveactuator.html">Control Valve Actuator</a><a href="/frictionfactortool.html">Darcy Friction Factor</a><a href="/fatigue.html">Fatigue Analysis</a><a href="/fuel-combustion.html">Fuel Combustion</a><a href="/gas.html">Gas Properties</a><a href="/heat-exchanger.html">Heat Exchanger</a><a href="/hydroliccylinder.html">Hydraulic Cylinder</a><a href="/material-compatibility.html">Material Compatibility</a><a href="/nozzle-reinforcement.html">Nozzle Reinforcement</a><a href="/openchannelflow.html">Open Channel Flow</a><a href="/pipescheduletool.html">Pipe Schedule & Stress</a><a href="/pump-head.html">Pump Head</a><a href="/shaft-power-torque.html">Shaft Power & Torque</a><a href="/steam-table.html">Steam Table</a><a href="/vibrationanalysis.html">Vibration Analysis</a></div><div><a href="/air-flow-duct.html">Air Flow Duct Sizing</a><a href="/beam-deflection.html">Beam Deflection</a><a href="/bernoulli-equation.html">Bernoulli Equation</a><a href="/chiller-capacity.html">Chiller Capacity</a><a href="/cooling-tower-sizing.html">Cooling Tower Sizing</a><a href="/darcy-weisbach.html">Darcy-Weisbach</a><a href="/finned-tube-heat-transfer.html">Finned Tube Heat</a><a href="/furnace-heat-duty.html">Furnace Heat Duty</a><a href="/gear-design.html">Gear Design</a><a href="/heat-loss-pipes.html">Heat Loss Pipes</a><a href="/jacketed-vessel-heat-transfer.html">Jacketed Vessel</a><a href="/metalweight.html">Metal Weight Calculator</a><a href="/nptbspthreadcalculator.html">NPT/BSP Threads</a><a href="/overall-heat-transfer.html">Overall Heat Transfer</a><a href="/pipe-stress-flexibility.html">Pipe Stress</a><a href="/pump-power.html">Pump Power</a><a href="/specific-heat-enthalpy.html">Specific Heat</a><a href="/storage-tank-volume.html">Storage Tank Volume</a><a href="/weldingstress.html">Welding Stress</a></div><div><a href="/allowable-stress-safety-factor.html">Allowable Stress</a><a href="/bearinglife.html">Bearing Life Calculator</a><a href="/boiler-efficiency.html">Boiler Efficiency</a><a href="/compressor-power.html">Compressor Power</a><a href="/corrosion-rate.html">Corrosion Rate</a><a href="/fan-laws.html">Fan Laws</a><a href="/foundation.html">Foundation Design</a><a href="/gas-laws.html">Gas Laws</a><a href="/hardness.html">Hardness Converter</a><a href="/conduction-convection-radiation.html">Heat Transfer Modes</a><a href="/machining.html">Machining Calculator</a><a href="/momentofinertia.html">Moment of Inertia</a><a href="/oring.html">O-Ring Sizing</a><a href="/pipe-flow.html">Pipe Flow Calculator</a><a href="/psychrometric.html">Psychrometric Calc</a><a href="/reynolds-number.html">Reynolds Number</a><a href="/spring.html">Spring Design</a><a href="/thermal-expansion.html">Thermal Expansion</a></div>
            </div>
            <div class="view-all-container">
                <a href="/indexmech.html" class="view-all-link">View All Mechanical Tools â†’</a>
            </div>
        </div>
    </li>
                        <li><a href="/index.html#articles">Articles</a></li>
                        <li><a href="/sitemap2.html">Site Map</a></li>
                    </ul>

                    <div class="theme-toggle">
                        <i class="fas fa-sun icon"></i>
                        <label class="switch">
                            <input type="checkbox" id="theme-switch">
                            <span class="slider"></span>
                        </label>
                        <i class="fas fa-moon icon"></i>
                    </div>
                </div>
            </nav>
    </header>

    <main class="container">
        <div class="card">
            <h2><i class="fas fa-arrows-alt-h"></i> 4-20 mA Signal Scaling Calculator</h2>
            
            <p>This calculator provides a robust and precise method to convert a raw 4-20 mA current signal from any industrial instrument (e.g., pressure transmitter, temperature sensor, flow meter) into its corresponding engineering unit value. It is designed for universal application in all types of industries worldwide, ensuring accurate and reliable interpretation of process signals for even the most complex control systems.</p>
            
            <div class="calculator-form">
                <form id="ma-scaling-form">
                    <h3>Scaling Parameters</h3>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="lrv" id="label-lrv">Lower Range Value (LRV) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext" id="tooltip-lrv">The minimum value of the physical process variable that the instrument is calibrated to measure. This corresponds to 4 mA. E.g., 0 PSI, 0 °C.</span></span></label>
                            <input type="number" id="lrv" step="any" value="0" required>
                        </div>
                        <div class="form-group">
                            <label for="urv" id="label-urv">Upper Range Value (URV) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext" id="tooltip-urv">The maximum value of the physical process variable that the instrument is calibrated to measure. This corresponds to 20 mA. E.g., 100 PSI, 100 °C.</span></span></label>
                            <input type="number" id="urv" step="any" value="100" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="current-input-ma" id="label-current-input-ma">Current Signal Input (mA) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext" id="tooltip-current-input-ma">The raw current signal received from the instrument, typically ranging from 4 mA to 20 mA. Values outside this range (e.g., < 3.8 mA or > 20.5 mA) often indicate an abnormal condition (e.g., fault, over-range) as per NAMUR NE 43.</span></span></label>
                            <input type="number" id="current-input-ma" min="0" step="0.01" value="12" required>
                        </div>
                        <div class="form-group">
                            <label for="process-variable">Process Variable (Unit)</label>
                            <input type="text" id="process-variable" value="°C" placeholder="e.g., PSI, °C, GPM, %">
                        </div>
                    </div>

                    <div class="btn-group" style="margin-top: 25px;">
                        <button type="button" id="calculate-scaling-btn" class="btn"><i class="fas fa-calculator"></i> Calculate</button>
                        <button type="button" id="reset-form-btn" class="btn accent"><i class="fas fa-sync-alt"></i> Reset</button>
                        <button type="button" id="pdf-btn" class="btn secondary" style="display: none;"><i class="fas fa-file-pdf"></i> Download PDF</button>
                    </div>
                </form>
            </div>
        </div>
        
        <!-- NEW Step-by-Step Results Container -->
        <div id="steps-container" class="steps-container math-content">
            <!-- Step cards will be dynamically inserted here -->
        </div>

        <!-- NEW Results Table -->
        <div id="results-section" class="card hidden" style="margin-top: 40px;">
            <h3><i class="fas fa-clipboard-check"></i> Calculation Summary</h3>
            <table class="results-table">
                <thead>
                    <tr>
                        <th>Parameter</th>
                        <th>Value</th>
                    </tr>
                </thead>
                <tbody id="results-tbody">
                    <!-- Results will be dynamically inserted here -->
                </tbody>
            </table>
        </div>
        
        <!-- NEW/EXPANDED EDUCATIONAL INSIGHTS SECTION -->
        <div id="education-section" class="education-section card">
            <h2><i class="fas fa-lightbulb"></i> Professional Insights: The 4-20mA Current Loop</h2>

            <div class="insight-card">
                <h4><i class="fas fa-cogs"></i> What is a 4-20mA Loop? The Industry Standard</h4>
                <p>The 4-20mA current loop is the dominant analog signaling standard used in industrial control systems (PLCs, DCS) worldwide. It's a simple, robust, and reliable way for a field instrument (like a temperature or pressure transmitter) to send its measurement to a control system, often over very long distances (thousands of feet or kilometers).</p>
                <p><strong>The Analogy:</strong> Think of it like the gas pedal in your car, but for industry.
                    <ul>
                        <li><strong>4mA (Pedal Up):</strong> Represents the "zero" or minimum reading (e.g., 0 PSI, 0°C). This is the <strong>Lower Range Value (LRV)</strong>.</li>
                        <li><strong>20mA (Pedal Down):</strong> Represents the "full" or maximum reading (e.g., 100 PSI, 1000°C). This is the <strong>Upper Range Value (URV)</strong>.</li>
                        <li><strong>12mA (Pedal Halfway):</strong> Represents the 50% reading (e.g., 50 PSI, 500°C).</li>
                    </ul>
                The control system reads this current level and scales it back to its engineering unit to know the exact state of the process. This calculator performs that exact scaling calculation.
                </p>
            </div>

            <div class="success-box">
                <h4><i class="fas fa-check-circle"></i> The "Live Zero" (4mA): Why Not 0-20mA?</h4>
                <p>This is the most brilliant part of the 4-20mA standard. Using 4mA as the "zero" point (a "live zero") provides critical, built-in fault detection. Consider the two scenarios:</p>
                <p><strong>1. Old 0-20mA Standard (Obsolete):</strong>
                    <ul>
                        <li>A reading of <strong>0mA</strong> could mean...
                            <ul>
                                <li>A) The process is at its zero point (0 PSI).</li>
                                <li>B) The wire has been cut and the loop is dead.</li>
                            </ul>
                        </li>
                        <li>The control system **cannot tell the difference** between a normal "zero" reading and a catastrophic wiring failure. This is extremely dangerous.</li>
                    </ul>
                </p>
                <p><strong>2. Modern 4-20mA Standard (Live Zero):</strong>
                    <ul>
                        <li>A reading of <strong>4mA</strong> means: The process is at its zero point (0 PSI) and the loop is healthy.</li>
                        <li>A reading of <strong>0mA</strong> means: The wire is cut or the transmitter has failed. This is a clear, unambiguous <strong>fault condition</strong>.</li>
                    </ul>
                This "live zero" allows a control system to immediately distinguish between a normal process and a sensor/wiring failure, enabling safe shutdowns and immediate alarming.</p>
            </div>

            <div class="insight-card">
                <h4><i class="fas fa-tachometer-alt"></i> Understanding NAMUR NE 43</h4>
                <p><strong>NAMUR (Normenarbeitsgemeinschaft für Mess- und Regeltechnik in der chemischen Industrie)</strong> is a German standards body that sets best practices for instrumentation. Their <strong>NE 43</strong> recommendation is the global standard for how 4-20mA transmitters should behave during normal and fault conditions.</p>
                <p>It extends the 4-20mA range to provide even more diagnostic information:</p>
                <ul>
                    <li><strong>$3.8mA$ to $20.5mA$:</strong> The "Normal Operating Range." The signal is considered valid.</li>
                    <li><strong>$< 3.6mA$:</strong> "Fault" or "Underrange" condition. The transmitter is actively signaling a failure (e.g., sensor burnout, internal fault, broken wire).</li>
                    <li><strong>$> 21.0mA$:</strong> "Fault" or "Overrange" condition. The transmitter is signaling a failure or that the process value has exceeded its maximum calibrated limit.</li>
                </ul>
                <p>This is why a well-configured control system will alarm if it sees a signal of 3.5mA or 21.5mA, as it's a clear diagnostic message from the instrument, not a valid process reading.</p>
            </div>
            
            <div class="insight-card">
                <h4><i class="fas fa-project-diagram"></i> 2-Wire vs. 3-Wire vs. 4-Wire Transmitters</h4>
                <p>When selecting an instrument, you'll see these terms. They describe how the instrument is powered and how it sends its signal.</p>
                <ul>
                    <li><strong>2-Wire (Loop Powered):</strong> This is the most common and desirable type. The *same two wires* are used for both powering the transmitter and sending the 4-20mA signal. The transmitter "sips" a tiny amount of power from the loop (less than 4mA) to run its electronics, and then modulates the current between 4 and 20mA to send its signal. This is simple, cheap to wire, and inherently safe.</li>
                    <li><strong>4-Wire (Separately Powered):</strong> This is for "active" or high-power instruments (e.g., radar level transmitters, gas analyzers).
                        <ul>
                            <li>2 Wires (AC or DC) are used *only* to provide power to the instrument.</li>
                            <li>2 separate Wires are used to *output* the 4-20mA signal.</li>
                        </ul>
                    This requires more wiring (and cost) but is necessary for devices that need more power than a 2-wire loop can provide.</li>
                    <li><strong>3-Wire:</strong> A less common hybrid, often seen in older or non-standard instruments. It shares a common ground for the power supply and the signal.</li>
                </ul>
            </div>

            <div class="danger-box">
                <h4><i class="fas fa-exclamation-triangle"></i> Common Loop Troubleshooting</h4>
                <p>When a 4-20mA signal is incorrect, instrumentation technicians perform these checks:</p>
                <ul>
                    <li><strong>Check for Power:</strong> Is the loop power supply (typically 24VDC) on? A 2-wire loop is a series circuit; if any part fails, the whole loop dies.</li>
                    <li><strong>Check for Voltage Drop:</strong> The transmitter needs a minimum voltage to operate (e.g., 12 VDC). If the wires are too long or too thin, the resistance ($R$) of the wire causes the voltage to "drop" (Ohm's Law: $V = IR$). If the voltage at the transmitter drops below its minimum, it will fail.</li>
                    <li><strong>Check for Ground Loops:</strong> This is a complex but common problem. If the signal cable's shield is grounded at *both* the transmitter end and the PLC end, small differences in ground potential between the two locations can cause a "ground loop" current to flow, which interferes with and distorts the true 4-20mA signal. The best practice is almost always to ground the shield at *one end only* (typically the PLC/DCS side).</li>
                    <li><strong>Check the Resistor:</strong> A PLC/DCS analog input card cannot read current directly. It reads voltage. To read the 4-20mA signal, a high-precision <strong>250 Ohm resistor</strong> is placed across the input terminals. The current then creates a voltage (Ohm's Law again) that the PLC reads:
                        <ul>
                            <li>$4mA \times 250\Omega = 1 \text{ Volt}$</li>
                            <li>$20mA \times 250\Omega = 5 \text{ Volts}$</li>
                        </ul>
                    The PLC is actually reading <strong>1-5 VDC</strong>. If this resistor is damaged or missing, the loop won't work.</li>
                </ul>
            </div>

        </div>

    </main>

    <!-- FOOTER -->
        <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-left">
                    <a href="/" class="footer-logo">
                        <img src="logo.png" alt="Design Calculators Logo" loading="lazy" decoding="async">
                        <span class="footer-logo-text">Design Calculators</span>
                    </a>
                    <p class="footer-description">A comprehensive engineering calculator hub based on IEC, IEEE, and
                        global standards.</p>
                    <div class="social-buttons">
                        <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://designcalculators.co.in"
                            target="_blank" rel="noopener noreferrer" class="social-btn linkedin"
                            aria-label="LinkedIn"><i class="fab fa-linkedin-in"></i></a>
                        <a href="https://www.youtube.com/@designcalculators" target="_blank" rel="noopener noreferrer"
                            class="social-btn youtube" aria-label="YouTube"><i class="fab fa-youtube"></i></a>
                        <a href="https://twitter.com/intent/tweet?url=https://designcalculators.co.in&text=Check%20out%20this%20amazing%20engineering%20calculator%20hub!"
                            target="_blank" rel="noopener noreferrer" class="social-btn twitter" aria-label="Twitter"><i
                                class="fab fa-twitter"></i></a>
                        <a href="https://www.facebook.com/sharer/sharer.php?u=https://designcalculators.co.in"
                            target="_blank" rel="noopener noreferrer" class="social-btn facebook"
                            aria-label="Facebook"><i class="fab fa-facebook-f"></i></a>
                        <a href="https://api.whatsapp.com/send?text=Check%20out%20this%20amazing%20engineering%20resource:%20https://designcalculators.co.in"
                            target="_blank" rel="noopener noreferrer" class="social-btn whatsapp"
                            aria-label="WhatsApp"><i class="fab fa-whatsapp"></i></a>
                    </div>
                </div>
                <div class="footer-right">
                    <div class="footer-col">
                        <h4>Quick Links</h4>
                        <ul>
                            <li><a href='/indexele.html'>Electrical Tools</a></li>
                            <li><a href='/indexmech.html'>Mechanical Tools</a></li>
                            <li><a href='/indexinst.html'>Instrumentation Tools</a></li>
                            <li><a href='/about.html'>About Us</a></li>
                            <li><a href='/faq.html'>FAQ</a></li>
                        </ul>
                    </div>
                    <div class="footer-col">
                        <h4>Learn More</h4>
                        <ul>
                            <li><a href="https://www.youtube.com/@designcalculators" target="_blank"
                                    rel="noopener noreferrer">YouTube Channel</a></li>
                            <li><a href='/contact.html'>Contact Us</a></li>
                            <li><a href='/privacy-policy.html'>Privacy Policy</a></li>
                            <li><a href='/terms-of-service.html'>Terms of Service</a></li>
                            <li><a href='/sitemap2.html'>Sitemap</a></li>
                        </ul>
                    </div>
                    <div class="footer-col">
                        <h4>Our Network</h4>
                        <ul>
                            <li style="margin-bottom: 12px;">
                                <a href="https://reliabilitytools.co.in/" target="_blank" rel="noopener"
                                   style="font-weight: 600; display: block; margin-bottom: 2px;">Reliability Tools</a>
                                <span style="font-size: 0.85rem; color: #94a3b8; line-height: 1.3; display: block;">Reliability
                                    & maintenance engineering calculators.</span>
                            </li>
                            <li style="margin-bottom: 12px;">
                                <a href="https://electrosafe.homes/" target="_blank" rel="noopener"
                                   style="font-weight: 600; display: block; margin-bottom: 2px;">ElectroSafe</a>
                                <span style="font-size: 0.85rem; color: #94a3b8; line-height: 1.3; display: block;">Dedicated
                                    to home electrical safety & protection.</span>
                            </li>
                            <li>
                                <a href="https://knowyourname.co.in/" target="_blank" rel="noopener"
                                   style="font-weight: 600; display: block; margin-bottom: 2px;">KnowYourName</a>
                                <span style="font-size: 0.85rem; color: #94a3b8; line-height: 1.3; display: block;">Scientific
                                    name analysis: Phonetics, Ergonomics & Acoustics.</span>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="footer-disclaimer">
                <p>All calculations are for preliminary engineering design guidance. Final designs must comply with all applicable local and international standards (including but not limited to ASHRAE 90.1, ARI 550/590). Always verify calculations and consult with a licensed professional engineer before implementation or construction.</p>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 Design Calculators. Created by <span style="color: var(--secondary); font-weight: bold;">Anil Sharma</span>. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // --- Elements ---
            const form = document.getElementById('ma-scaling-form');
            const calculateScalingBtn = document.getElementById('calculate-scaling-btn');
            const resetFormBtn = document.getElementById('reset-form-btn');
            const pdfBtn = document.getElementById('pdf-btn');
            
            const stepsContainer = document.getElementById('steps-container');
            const resultsSection = document.getElementById('results-section');
            const resultsTbody = document.getElementById('results-tbody');
            const messageBox = document.getElementById('message-box');
            
            const themeSwitch = document.getElementById('theme-switch');
            
            let lastInputs = null; // For PDF generation
            
            // Default values for resetting form
            const defaultValues = {
                'lrv': "0",
                'urv': "100",
                'current-input-ma': "12",
                'process-variable': "°C"
            };

            // --- Event Listeners ---
            calculateScalingBtn.addEventListener('click', calculateScaling);
            resetFormBtn.addEventListener('click', resetForm);
            pdfBtn.addEventListener('click', generatePDF);

            // Theme Toggle
            if (localStorage.getItem('theme') === 'dark') {
                document.body.classList.add('dark-mode');
                themeSwitch.checked = true;
            }
            themeSwitch.addEventListener('change', function() {
                if (this.checked) {
                    document.body.classList.add('dark-mode');
                    localStorage.setItem('theme', 'dark');
                } else {
                    document.body.classList.remove('dark-mode');
                    localStorage.setItem('theme', 'light');
                }
            });

            // --- Utility Functions ---

            function showMessage(msg, type = 'success') {
                messageBox.textContent = msg;
                if (type === 'error') {
                    messageBox.style.backgroundColor = 'var(--danger)';
                } else if (type === 'warning') {
                     messageBox.style.backgroundColor = 'var(--warning)';
                     messageBox.style.color = '#333'; // Dark text
                } else {
                    messageBox.style.backgroundColor = 'var(--success)';
                    messageBox.style.color = 'white';
                }
                messageBox.classList.add('show');
                setTimeout(() => messageBox.classList.remove('show'), 4000);
            }
            
            function format(num, decimals = 3) {
                 // Use toFixed for precision, then remove trailing zeros and the decimal point if it's .000
                return parseFloat(num.toFixed(decimals)).toString();
            }

            // --- Form & Calculation Logic ---
            
            function resetForm() {
                for (const id in defaultValues) {
                    const input = document.getElementById(id);
                    if (input) {
                        input.value = defaultValues[id];
                    }
                }
                stepsContainer.classList.remove('active');
                stepsContainer.innerHTML = '';
                resultsSection.classList.add('hidden');
                pdfBtn.style.display = 'none';
                lastInputs = null;
                showMessage("Form reset to default values.", "success");
            }

            function calculateScaling() {
                stepsContainer.innerHTML = ''; // Clear previous steps
                
                try {
                    // 1. Get Inputs
                    const lrv = parseFloat(document.getElementById('lrv').value);
                    const urv = parseFloat(document.getElementById('urv').value);
                    const currentInputMa = parseFloat(document.getElementById('current-input-ma').value);
                    const pvUnit = document.getElementById('process-variable').value || "Units";
                    
                    // 2. Input Validation
                    if (isNaN(lrv) || isNaN(urv) || isNaN(currentInputMa)) {
                        throw new Error("Please enter valid numerical values for all fields.");
                    }
                    if (urv <= lrv) {
                        throw new Error("Upper Range Value (URV) must be greater than Lower Range Value (LRV).");
                    }
                    
                    // NAMUR NE 43 check
                    if (currentInputMa < 3.8 || currentInputMa > 20.5) {
                        showMessage("Signal is outside the standard NAMUR NE 43 operating range (3.8-20.5mA), indicating a potential fault or over-range condition.", "warning");
                    }
                    
                    // 3. Calculations
                    const currentSpan = 16; // 20 mA - 4 mA
                    const engineeringSpan = urv - lrv;
                    const currentFraction = (currentInputMa - 4) / currentSpan;
                    const scaledValue = (currentFraction * engineeringSpan) + lrv;
                    
                    // Store for PDF
                    lastInputs = {
                        lrv: format(lrv),
                        urv: format(urv),
                        currentInputMa: format(currentInputMa),
                        pvUnit: pvUnit,
                        scaledValue: format(scaledValue)
                    };
                    
                    // --- 4. Populate Step-by-Step Cards ---

                    // Step 1: Define Spans
                    let step1Html = `
                        <div class="step-card">
                            <h4><span class="number">1</span>Define Range & Signal Spans</h4>
                            <div class="step-content">
                                <p>First, we define the "span" (the total range) for both your engineering units and the 4-20mA signal. This is the foundation for the scaling conversion.</p>
                                <div class="formula-block">
                                    <p><strong>Engineering Span (Process):</strong><br>
                                    Span = URV - LRV<br>
                                    <span class="formula">Span = ${format(urv)} - ${format(lrv)} = <strong>${format(engineeringSpan)} ${pvUnit}</strong></span></p>
                                    
                                    <p style="margin-top:15px;"><strong>Signal Span (Current):</strong><br>
                                    Span = Max mA - Min mA<br>
                                    <span class="formula">Span = 20.0mA - 4.0mA = <strong>16.0 mA</strong></span></p>
                                </div>
                            </div>
                        </div>
                    `;
                    
                    // Step 2: Calculate Percentage
                    let step2Html = `
                        <div class="step-card">
                            <h4><span class="number">2</span>Calculate Signal Percentage</h4>
                            <div class="step-content">
                                <p>Next, we find the position of your input signal (12.0 mA) within the 16mA span. This gives us a percentage or fraction (0.0 to 1.0) of how "full" the signal is.</p>
                                <div class="formula-block math-content">
                                    <p><strong>Signal Percentage:</strong><br>
                                    $\\% = \\frac{\\text{Current Input} - 4.0mA}{16.0mA}$</p>
                                    
                                    <p><span class="formula">\\% = (${format(currentInputMa)}mA - 4.0mA) / 16.0mA = <strong>${format(currentFraction * 100, 2)}%</strong></span></p>
                                </div>
                            </div>
                        </div>
                    `;

                    // Step 3: Scale to Engineering Units
                    let step3Html = `
                        <div class="step-card">
                            <h4><span class="number">3</span>Scale to Final Engineering Value</h4>
                            <div class="step-content">
                                <p>Finally, we apply this percentage to your engineering span and add it back to your "zero" point (LRV) to get the final process value.</p>
                                <div class="formula-block math-content">
                                    <p><strong>Final Value:</strong><br>
                                    $Value = (\\% \\times \\text{Eng. Span}) + LRV$</p>
                                    
                                    <p><span class="formula">Value = (${format(currentFraction * 100, 2)}% \\times ${format(engineeringSpan)}) + ${format(lrv)}</span></p>
                                    <p style="font-size: 1.5rem; text-align: center; color: var(--success); font-weight: 700; margin-top: 15px;">
                                        Value = ${format(scaledValue)} ${pvUnit}
                                    </p>
                                </div>
                            </div>
                        </div>
                    `;
                    
                    stepsContainer.innerHTML = step1Html + step2Html + step3Html;

                    // --- 5. Populate Summary Table ---
                    resultsTbody.innerHTML = `
                        <tr>
                            <td>Lower Range Value (LRV)</td>
                            <td>${format(lrv)} ${pvUnit} (at 4 mA)</td>
                        </tr>
                        <tr>
                            <td>Upper Range Value (URV)</td>
                            <td>${format(urv)} ${pvUnit} (at 20 mA)</td>
                        </tr>
                        <tr>
                            <td>Current Signal Input</td>
                            <td>${format(currentInputMa)} mA</td>
                        </tr>
                        <tr>
                            <td><strong>Scaled Engineering Value</strong></td>
                            <td class="highlight">${format(scaledValue)} ${pvUnit}</td>
                        </tr>
                        <tr>
                            <td>Signal Percentage</td>
                            <td>${format(currentFraction * 100, 2)} %</td>
                        </tr>
                    `;

                    // --- 6. Show Results & Typeset Math ---
                    stepsContainer.classList.add('active');
                    resultsSection.classList.remove('hidden');
                    pdfBtn.style.display = 'inline-flex';

                    setTimeout(() => {
                        resultsSection.scrollIntoView({ behavior: 'smooth' });
                    }, 100); 

                    if (window.MathJax && typeof window.MathJax.typesetPromise === 'function') {
                        setTimeout(() => {
                            window.MathJax.typesetPromise([stepsContainer]);
                        }, 50); 
                    }
                    
                    showMessage("Calculation successful!", "success");

                } catch (e) {
                    showMessage(e.message, "error");
                    // Hide results on error
                    stepsContainer.classList.remove('active');
                    resultsSection.classList.add('hidden');
                    pdfBtn.style.display = 'none';
                    lastInputs = null;
                }
            }
            
            // --- PDF Generation ---
            function generatePDF() {
                if (!lastInputs) {
                    showMessage('Please run a calculation first.', 'error');
                    return;
                }
                
                try {
                    const { jsPDF } = window.jspdf;
                    const pdf = new jsPDF('p', 'mm', 'a4');
                    let y = 15;
                    const { lrv, urv, currentInputMa, pvUnit, scaledValue } = lastInputs;

                    pdf.setFont('helvetica', 'bold');
                    pdf.setFontSize(16);
                    pdf.text('4-20mA Signal Scaling Report', 105, y, { align: 'center' });
                    y += 8;

                    pdf.setFont('helvetica', 'normal');
                    pdf.setFontSize(9);
                    pdf.text(`Generated by Design Calculators | ${new Date().toLocaleString()}`, 105, y, { align: 'center' });
                    y += 10;
                    
                    pdf.setFont('helvetica', 'bold');
                    pdf.setFontSize(12);
                    pdf.text('Input Parameters', 14, y);
                    y += 2;
                    
                    const inputRows = [
                        ["Lower Range Value (LRV)", `${lrv} ${pvUnit}`],
                        ["Upper Range Value (URV)", `${urv} ${pvUnit}`],
                        ["Current Signal Input", `${currentInputMa} mA`]
                    ];
                    
                    pdf.autoTable({
                        startY: y,
                        head: [['Parameter', 'Value']],
                        body: inputRows,
                        margin: { left: 14, right: 14 },
                        theme: 'grid',
                        headStyles: { fillColor: [30, 58, 138] },
                    });
                    y = pdf.autoTable.previous.finalY + 10;

                    // Add Results
                    pdf.setFont('helvetica', 'bold');
                    pdf.setFontSize(12);
                    pdf.text('Calculation Summary', 14, y);
                    y += 2;
                    
                    const resultRows = Array.from(resultsTbody.querySelectorAll('tr')).map(tr => [
                        tr.cells[0].textContent,
                        tr.cells[1].textContent
                    ]);
                    
                    pdf.autoTable({
                        startY: y,
                        head: [['Parameter', 'Value']],
                        body: resultRows,
                        margin: { left: 14, right: 14 },
                        theme: 'grid',
                        headStyles: { fillColor: [30, 58, 138] },
                        didParseCell: function (data) {
                            if (data.cell.text[0].includes('Scaled Engineering Value')) {
                                data.cell.styles.textColor = [16, 185, 129]; // Green
                                data.cell.styles.fontStyle = 'bold';
                                data.row.cells[1].styles.textColor = [16, 185, 129];
                                data.row.cells[1].styles.fontStyle = 'bold';
                            }
                        }
                    });
                    y = pdf.autoTable.previous.finalY + 15;

                    // Add footer
                    pdf.setFont('helvetica', 'normal');
                    pdf.setFontSize(10);
                    pdf.setTextColor(40, 40, 40);
                    pdf.text('For more calculators and information, visit http://designcalculators.co.in', 105, y, { align: 'center' });
                    y += 5;
                    pdf.setFontSize(8);
                    pdf.setTextColor(100, 100, 100);
                    pdf.text('This report is for guidance only. Always verify scaling and calibration in your PLC/DCS.', 105, y, { align: 'center' });

                    pdf.save('4-20mA-Scaling-Report.pdf');
                    showMessage('PDF downloaded successfully');

                } catch (e) {
                    showMessage(`Error generating PDF: ${e.message}`, 'error');
                }
            }
            
            // Re-render MathJax on load if needed
            if (window.MathJax && window.MathJax.typeset) {
                window.MathJax.typeset();
            }
        });
    </script>
</body>
</html>

