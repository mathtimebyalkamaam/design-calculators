<!DOCTYPE html>
<html lang="en">
<head>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5936527763614780"
     crossorigin="anonymous"></script>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-23Y1V450SR"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-23Y1V450SR');
    </script>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5936527763614780"
     crossorigin="anonymous"></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pipe Flow Calculator - Design Calculators - Mechanical</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- MathJax for LaTeX rendering -->
    <script type="text/javascript" id="MathJax-script" async
            src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
    </script>
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="icon" href="/favicon.ico" type="image/x-icon">

    <style>
        /* Basic CSS Variables for a consistent theme */
        :root {
            --primary-color: #4CAF50; /* Green */
            --secondary-color: #45a049; /* Darker Green */
            --accent-color: #FFC107; /* Amber */
            --bg-color: #f4f7f6; /* Light Greyish Green */
            --card-bg: #ffffff; /* White */
            --text-color: #333333; /* Dark Grey */
            --header-bg: #2C3E50; /* Dark Blue Grey */
            --footer-bg: #34495E; /* Slightly Lighter Dark Blue Grey */
            --border-color: #cccccc;
            --card-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            --hover-color: #e2e6ea;
        }

        /* Dark Mode Variables */
        body.dark-mode {
            --bg-color: #2c3e50;
            --card-bg: #34495e;
            --text-color: #ecf0f1;
            --header-bg: #2c3e50;
            --footer-bg: #2c3e50;
            --border-color: #555555;
            --card-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
            --hover-color: #446688;
        }

        /* General Body Styling */
        body {
            font-family: 'Inter', sans-serif; /* Using Inter as specified */
            margin: 0;
            padding: 0;
            background-color: var(--bg-color);
            color: var(--text-color);
            line-height: 1.6;
            transition: background-color 0.3s, color 0.3s;
        }

        .container {
            max-width: 960px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            background-color: var(--header-bg);
            color: white;
            padding: 20px 0;
            text-align: center;
            box-shadow: var(--card-shadow);
            position: relative; /* For theme toggle positioning */
        }

        header h1 {
            margin: 0;
            font-size: 2.5em;
            color: var(--primary-color);
        }

        header .subtitle {
            margin: 5px 0 0;
            font-size: 1em;
            color: #bdc3c7;
        }

        main {
            padding: 20px 0;
        }

        .tool-container {
            background-color: var(--card-bg);
            border-radius: 8px;
            padding: 20px;
            box-shadow: var(--card-shadow);
            margin-bottom: 20px;
        }

        .tool-container h2 {
            color: var(--primary-color);
            border-bottom: 2px solid var(--primary-color);
            padding-bottom: 10px;
            margin-top: 0;
            margin-bottom: 20px;
        }

        .tool-description {
            margin-bottom: 20px;
            color: var(--text-color);
        }

        .back-button {
            display: inline-block;
            background-color: var(--primary-color);
            color: white;
            padding: 10px 15px;
            border-radius: 4px;
            text-decoration: none;
            margin-bottom: 20px;
            transition: background-color 0.3s;
        }

        .back-button:hover {
            background-color: var(--secondary-color);
        }

        /* Theme Toggle */
        .theme-toggle {
            position: absolute;
            top: 20px;
            right: 20px;
            display: flex;
            align-items: center;
        }

        .theme-toggle .light-icon,
        .theme-toggle .dark-icon {
            color: white;
            margin: 0 5px;
        }

        .switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 34px;
        }

        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            -webkit-transition: .4s;
            transition: .4s;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 26px;
            width: 26px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            -webkit-transition: .4s;
            transition: .4s;
        }

        input:checked + .slider {
            background-color: var(--primary-color);
        }

        input:focus + .slider {
            box-shadow: 0 0 1px var(--primary-color);
        }

        input:checked + .slider:before {
            -webkit-transform: translateX(26px);
            -ms-transform: translateX(26px);
            transform: translateX(26px);
        }

        /* Rounded sliders */
        .slider.round {
            border-radius: 34px;
        }

        .slider.round:before {
            border-radius: 50%;
        }

        /* Footer Styling */
        footer {
            background-color: var(--footer-bg);
            color: white;
            padding: 20px 0;
            text-align: center;
            box-shadow: 0 -2px 8px rgba(0, 0, 0, 0.1);
            margin-top: 30px;
        }

        footer .disclaimer h3,
        footer .social-share h3 {
            color: var(--primary-color);
            margin-bottom: 10px;
        }

        footer .disclaimer p {
            font-size: 0.9em;
            color: #bdc3c7;
        }

        .social-buttons {
            margin-top: 15px;
            display: flex;
            justify-content: center;
            gap: 10px;
        }

        .social-btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            color: white;
            text-decoration: none;
            font-size: 1.2em;
            transition: transform 0.3s ease-in-out;
        }

        .social-btn:hover {
            transform: translateY(-3px);
        }

        .social-btn.linkedin { background-color: #0A66C2; }
        .social-btn.facebook { background-color: #1877F2; }
        .social-btn.twitter { background-color: #1DA1F2; }
        .social-btn.whatsapp { background-color: #25D366; }
        .social-btn.reddit { background-color: #FF4500; }

        /* Styles for Calculator Forms and Results */
        .calculator-form {
            background-color: var(--card-bg);
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
            box-shadow: var(--card-shadow);
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        
        .form-group input, .form-group select {
            width: 100%;
            padding: 10px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            background-color: var(--bg-color);
            color: var(--text-color);
            box-sizing: border-box; /* Ensures padding doesn't increase width */
        }
        
        .form-row {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        .form-row .form-group {
            flex: 1 1 200px;
        }
        
        .calculate-btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            margin-top: 10px;
            transition: background-color 0.3s;
        }
        
        .calculate-btn:hover {
            background-color: var(--secondary-color);
        }
        
        .result-container {
            margin-top: 30px;
            padding: 20px;
            border-radius: 8px;
            background-color: var(--card-bg);
            box-shadow: var(--card-shadow);
            display: none; /* Hidden by default */
        }
        
        .result-container h3 {
            color: var(--primary-color);
            margin-bottom: 15px;
        }
        
        .result-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        
        .result-table th, .result-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
        }
        
        .result-table th {
            background-color: var(--hover-color);
        }
        
        .standard-reference {
            margin-top: 20px;
            font-style: italic;
            font-size: 0.9rem;
        }
        
        .info-icon {
            color: var(--primary-color);
            margin-left: 5px;
            cursor: help;
        }
        
        .tooltip {
            position: relative;
            display: inline-block;
        }
        
        .tooltip .tooltiptext {
            visibility: hidden;
            width: 200px;
            background-color: #333;
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 5px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -100px;
            opacity: 0;
            transition: opacity 0.3s;
        }
        
        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }

        /* Custom message box style */
        #custom-message-box {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            padding: 15px 25px;
            border-radius: 8px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
            z-index: 1000;
            font-weight: bold;
            color: white;
            opacity: 0;
            transition: opacity 0.5s ease-in-out;
        }

        /* Styles for calculation details */
        #calculation-details {
            background-color: var(--bg-color);
            border: 1px solid var(--border-color);
            border-radius: 4px;
            padding: 15px;
            margin-bottom: 20px;
            font-size: 0.95em;
        }
        #calculation-details h4 {
            color: var(--secondary-color);
            margin-top: 0;
            margin-bottom: 10px;
        }
        #calculation-details p.formula {
            font-family: 'Times New Roman', serif; /* A font suitable for mathematical formulas */
            font-style: italic;
            font-size: 1.1em;
            text-align: center;
            padding: 10px 0;
            background-color: var(--hover-color);
            border-radius: 4px;
            margin: 10px 0;
            overflow-x: auto; /* Allow horizontal scrolling for long formulas */
        }
        #calculation-details p.calculation-step {
            font-family: 'Courier New', monospace; /* Monospace for steps */
            background-color: var(--hover-color);
            padding: 5px 10px;
            border-radius: 3px;
            margin-bottom: 5px;
        }
        #calculation-details ul {
            list-style-type: disc;
            margin-left: 20px;
            padding-left: 0;
        }
        #calculation-details ul li {
            margin-bottom: 5px;
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <h1>Design Calculators - Mechanical</h1>
            <p class="subtitle">Smart Tools for Modern Mechanical Engineers</p>
            <div class="theme-toggle">
                <span class="light-icon"><i class="fas fa-sun"></i></span>
                <label class="switch">
                    <input type="checkbox" id="theme-switch">
                    <span class="slider round"></span>
                </label>
                <span class="dark-icon"><i class="fas fa-moon"></i></span>
            </div>
        </div>
    </header>

    <main class="container">
        <a href="indexMech.html" class="back-button">
            <i class="fas fa-arrow-left"></i> Back to Tools
        </a>
        
        <div class="tool-container">
            <h2>Pipe Flow Calculator</h2>
            
            <div class="tool-description">
                <p>This calculator determines pressure drop, velocity, and flow rate for fluid flow in pipes, based on fundamental fluid mechanics principles and industry-standard empirical correlations like the Darcy-Weisbach equation.</p>
            </div>
        
            <div class="calculator-form">
                <form id="pipe-flow-form">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="fluid-type">Fluid Type <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Select the type of fluid flowing through the pipe. This affects its density and viscosity.</span></span></label>
                            <select id="fluid-type" required>
                                <!-- Changed options to indicate temperature is now dynamic -->
                                <option value="water">Water</option>
                                <option value="air">Air</option>
                                <option value="oil">Engine Oil (SAE 30)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="pipe-material">Pipe Material <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">The material of the pipe affects its roughness, which is a key factor in friction loss calculations.</span></span></label>
                            <select id="pipe-material" required>
                                <option value="steel">Commercial Steel</option>
                                <option value="cast_iron">Cast Iron</option>
                                <option value="pvc">PVC</option>
                                <option value="copper">Copper</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-row">
                        <!-- NEW: Fluid Temperature Input -->
                        <div class="form-group">
                            <label for="fluid-temperature">Fluid Temperature (&#8451;) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Enter the temperature of the fluid in degrees Celsius. This will be used to determine fluid properties.</span></span></label>
                            <input type="number" id="fluid-temperature" min="-50" step="0.1" value="20" required>
                        </div>
                        <!-- END NEW -->
                        <div class="form-group">
                            <label for="pipe-diameter">Pipe Internal Diameter (mm) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">The internal diameter of the pipe. Ensure consistent units.</span></span></label>
                            <input type="number" id="pipe-diameter" min="1" step="0.1" value="50" required>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="pipe-length">Pipe Length (m) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">The total length of the pipe section for which pressure drop is calculated.</span></span></label>
                            <input type="number" id="pipe-length" min="0.1" step="0.1" value="100" required>
                        </div>
                        <div class="form-group">
                            <label for="flow-input-type">Input Type <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Choose which parameter you will input. The other two will be calculated.</span></span></label>
                            <select id="flow-input-type" required>
                                <option value="flow_rate">Flow Rate</option>
                                <option value="velocity">Velocity</option>
                                <option value="pressure_drop">Pressure Drop</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="flow-rate-input" id="flow-rate-label">Flow Rate (m3/s) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Volumetric flow rate of the fluid.</span></span></label>
                            <input type="number" id="flow-rate-input" min="0.000001" step="0.000001" value="0.005" required>
                            
                            <label for="velocity-input" id="velocity-label" style="display: none;">Velocity (m/s) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Average velocity of the fluid in the pipe.</span></span></label>
                            <input type="number" id="velocity-input" min="0.0001" step="0.0001" value="0.5" required style="display: none;">

                            <label for="pressure-drop-input" id="pressure-drop-label" style="display: none;">Pressure Drop (Pa) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">The total pressure drop across the pipe section in Pascals.</span></span></label>
                            <input type="number" id="pressure-drop-input" min="0.1" step="0.1" value="10000" required style="display: none;">
                        </div>
                    </div>

                    <button type="button" id="calculate-pipe-flow-btn" class="calculate-btn">Calculate Pipe Flow</button>
                </form>
            </div>
            
            <div id="result-container" class="result-container">
                <h3>Pipe Flow Results</h3>
                <div id="calculation-details">
                    <!-- Calculation steps will be inserted here -->
                </div>
                <table class="result-table">
                    <thead>
                        <tr>
                            <th>Parameter</th>
                            <th>Value</th>
                        </tr>
                    </thead>
                    <tbody id="result-table-body">
                        <!-- Results will be dynamically inserted here -->
                    </tbody>
                </table>
                <div class="standard-reference" id="standard-reference">
                    <!-- Standard reference text will be inserted here -->
                </div>
            </div>
        </div>
    </main>

    <footer>
        <div class="container">
            <div class="disclaimer">
                <h3>Disclaimer</h3>
                <p>To ensure accuracy and reliability, always verify the results obtained from these tools against the relevant engineering standards and guidelines.</p>
            </div>
            <div class="credit">
                <p>Created by A Sharma</p>
            </div>
            <div class="social-share">
                <h3>Share This Site</h3>
                <div class="social-buttons">
                    <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://designcalculators.co.in&title=Design Calculators - Mechanical" target="_blank" class="social-btn linkedin">
                        <i class="fab fa-linkedin"></i>
                    </a>
                    <a href="https://www.facebook.com/sharer/sharer.php?u=https://designcalculators.co.in" target="_blank" class="social-btn facebook">
                        <i class="fab fa-facebook"></i>
                    </a>
                    <a href="https://twitter.com/intent/tweet?text=Check out this amazing Design Calculators - Mechanical!&url=https://designcalculators.co.in" target="_blank" class="social-btn twitter">
                        <i class="fab fa-twitter"></i>
                    </a>
                    <a href="https://api.whatsapp.com/send?text=Check out this amazing Design Calculators - Mechanical! https://designcalculators.co.in" target="_blank" class="social-btn whatsapp">
                        <i class="fab fa-whatsapp"></i>
                    </a>
                    <a href="https://www.reddit.com/submit?url=https://designcalculators.co.in&title=Design Calculators - Mechanical" target="_blank" class="social-btn reddit">
                        <i class="fab fa-reddit"></i>
                    </a>
                </div>
            </div>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const calculateBtn = document.getElementById('calculate-pipe-flow-btn');
            const resultContainer = document.getElementById('result-container');
            const resultTableBody = document.getElementById('result-table-body');
            const standardReference = document.getElementById('standard-reference');
            const calculationDetailsDiv = document.getElementById('calculation-details');

            const fluidTypeSelect = document.getElementById('fluid-type');
            const pipeMaterialSelect = document.getElementById('pipe-material');
            const fluidTemperatureInput = document.getElementById('fluid-temperature'); // NEW: Get temperature input
            const pipeDiameterInput = document.getElementById('pipe-diameter');
            const pipeLengthInput = document.getElementById('pipe-length');
            const flowInputTypeSelect = document.getElementById('flow-input-type');
            const flowRateInput = document.getElementById('flow-rate-input');
            const velocityInput = document.getElementById('velocity-input');
            const pressureDropInput = document.getElementById('pressure-drop-input');
            const flowRateLabel = document.getElementById('flow-rate-label');
            const velocityLabel = document.getElementById('velocity-label');
            const pressureDropLabel = document.getElementById('pressure-drop-label');

            // --- IMPORTANT: FLUID PROPERTIES ARE NOW TEMPERATURE DEPENDENT ---
            // The previous 'fluidProperties' object with fixed values has been removed.
            // You need to implement functions to get density and viscosity based on fluid type AND temperature.
            // For production, consider a more comprehensive database or correlations.

            // Example function for water properties (simplified for demonstration)
            function getWaterProperties(temperatureCelsius) {
                // These are example values. For real applications, use accurate correlations or lookup tables.
                // Viscosity generally decreases with temperature for liquids.
                // Density of water is maximal at ~4C and decreases slightly with higher temperatures.
                let density; // kg/m3
                let viscosity; // Pa·s

                if (temperatureCelsius <= 0) {
                    density = 1000; viscosity = 0.001792; // Approx. at 0°C
                } else if (temperatureCelsius <= 10) {
                    density = 999.7; viscosity = 0.001307; // Approx. at 10°C
                } else if (temperatureCelsius <= 20) {
                    density = 998.2; viscosity = 0.001002; // Approx. at 20°C
                } else if (temperatureCelsius <= 30) {
                    density = 995.7; viscosity = 0.0007978; // Approx. at 30°C
                } else if (temperatureCelsius <= 40) {
                    density = 992.2; viscosity = 0.0006529; // Approx. at 40°C
                } else if (temperatureCelsius <= 60) {
                    density = 983.2; viscosity = 0.0004665; // Approx. at 60°C
                } else if (temperatureCelsius <= 80) {
                    density = 971.8; viscosity = 0.0003550; // Approx. at 80°C
                } else if (temperatureCelsius <= 100) {
                    density = 958.4; viscosity = 0.0002821; // Approx. at 100°C
                } else {
                    // Fallback for temperatures outside defined range (or extrapolate if needed)
                    density = 998.2; // Default to 20C if outside common range
                    viscosity = 0.001002;
                    displayMessage("Warning: Water properties outside typical range (0-100°C). Using approximate values.", "warning");
                }
                return { density: density, viscosity: viscosity };
            }

            // Example function for air properties (simplified for demonstration)
            function getAirProperties(temperatureCelsius) {
                // Ideal gas law for density: rho = P / (R_specific * T_abs)
                // For viscosity, a simple correlation or lookup table is often used.
                // These are approximate values.
                const atmosphericPressure_Pa = 101325; // 1 atm in Pascals
                const R_specific_air = 287.05; // J/(kg·K)
                const temperatureKelvin = temperatureCelsius + 273.15;

                let density = atmosphericPressure_Pa / (R_specific_air * temperatureKelvin); // kg/m3

                // Viscosity of air (Sutherland's formula or lookup table more accurate)
                // Simplified linear approximation for small temp ranges
                let viscosity; // Pa·s
                if (temperatureCelsius <= 0) {
                    viscosity = 0.00001716; // Approx. at 0°C
                } else if (temperatureCelsius <= 20) {
                    viscosity = 0.00001825; // Approx. at 20°C
                } else if (temperatureCelsius <= 40) {
                    viscosity = 0.00001930; // Approx. at 40°C
                } else {
                    viscosity = 0.00002000; // General higher temp
                }
                return { density: density, viscosity: viscosity };
            }

            // For Engine Oil (SAE 30), properties are highly dependent on exact oil composition
            // and vary significantly with temperature. A simple function here would be a
            // very rough approximation. For accuracy, a detailed lookup table or specialized
            // industrial data would be required.
            function getOilProperties(temperatureCelsius) {
                // These are highly approximate and illustrative.
                let density = 880; // Typically less sensitive to temp than viscosity for oils
                let viscosity;
                if (temperatureCelsius <= 0) {
                    viscosity = 0.8; // Very viscous at low temps
                } else if (temperatureCelsius <= 20) {
                    viscosity = 0.29; // As originally specified
                } else if (temperatureCelsius <= 40) {
                    viscosity = 0.1;
                } else if (temperatureCelsius <= 60) {
                    viscosity = 0.05;
                } else {
                    viscosity = 0.02; // Much less viscous at high temps
                }
                return { density: density, viscosity: viscosity };
            }


            // Data for pipe roughness (epsilon in meters)
            const pipeRoughness = {
                'steel': 0.000045, // Commercial steel
                'cast_iron': 0.00026, // Cast iron
                'pvc': 0.0000015, // PVC (smooth)
                'copper': 0.0000015, // Copper (smooth)
            };

            // Function to display custom messages (replaces alert())
            function displayMessage(message, type = "info") {
                let messageBox = document.getElementById('custom-message-box');
                if (!messageBox) {
                    messageBox = document.createElement('div');
                    messageBox.id = 'custom-message-box';
                    document.body.appendChild(messageBox);
                }

                messageBox.textContent = message;
                if (type === "error") {
                    messageBox.style.backgroundColor = '#dc3545'; /* Red */
                    messageBox.style.color = 'white';
                } else if (type === "warning") {
                    messageBox.style.backgroundColor = '#ffc107'; /* Amber */
                    messageBox.style.color = '#333';
                } else {
                    messageBox.style.backgroundColor = '#28a745'; /* Green */
                    messageBox.style.color = 'white';
                }
                messageBox.style.opacity = 1;

                // Hide after 5 seconds
                setTimeout(() => {
                    messageBox.style.opacity = 0;
                }, 5000);
            }

            // Function to toggle input fields based on selection
            function toggleFlowInput() {
                // Hide all inputs initially
                flowRateLabel.style.display = 'none';
                flowRateInput.style.display = 'none';
                flowRateInput.required = false;
                velocityLabel.style.display = 'none';
                velocityInput.style.display = 'none';
                velocityInput.required = false;
                pressureDropLabel.style.display = 'none';
                pressureDropInput.style.display = 'none';
                pressureDropInput.required = false;

                if (flowInputTypeSelect.value === 'flow_rate') {
                    flowRateLabel.style.display = 'block';
                    flowRateInput.style.display = 'block';
                    flowRateInput.required = true;
                } else if (flowInputTypeSelect.value === 'velocity') {
                    velocityLabel.style.display = 'block';
                    velocityInput.style.display = 'block';
                    velocityInput.required = true;
                } else if (flowInputTypeSelect.value === 'pressure_drop') {
                    pressureDropLabel.style.display = 'block';
                    pressureDropInput.style.display = 'block';
                    pressureDropInput.required = true;
                }
            }

            flowInputTypeSelect.addEventListener('change', toggleFlowInput);
            toggleFlowInput(); // Initial call to set up inputs correctly

            calculateBtn.addEventListener('click', function() {
                // Initialize variables to hold results
                let flowRate_m3s, velocity_ms, pressureDrop_pa, reynoldsNumber, frictionFactor, flowRegime;

                // Get input values
                const fluidType = fluidTypeSelect.value;
                const pipeMaterial = pipeMaterialSelect.value;
                const fluidTemperature = parseFloat(fluidTemperatureInput.value); // NEW: Get temperature input
                let diameter_mm = parseFloat(pipeDiameterInput.value);
                let length_m = parseFloat(pipeLengthInput.value);
                let inputType = flowInputTypeSelect.value;
                
                // Input validation for common parameters
                if (isNaN(diameter_mm) || diameter_mm <= 0 || isNaN(length_m) || length_m <= 0 || isNaN(fluidTemperature)) {
                    displayMessage("Please enter valid positive values for Pipe Diameter and Pipe Length, and a valid Fluid Temperature.", "error");
                    return;
                }

                // Convert diameter to meters
                const diameter_m = diameter_mm / 1000; // D in meters

                // Determine fluid properties based on selected fluid type AND temperature
                let density, viscosity;
                if (fluidType === 'water') {
                    const waterProps = getWaterProperties(fluidTemperature);
                    density = waterProps.density;
                    viscosity = waterProps.viscosity;
                } else if (fluidType === 'air') {
                    const airProps = getAirProperties(fluidTemperature);
                    density = airProps.density;
                    viscosity = airProps.viscosity;
                } else if (fluidType === 'oil') {
                    const oilProps = getOilProperties(fluidTemperature);
                    density = oilProps.density;
                    viscosity = oilProps.viscosity;
                } else {
                    displayMessage("Unsupported fluid type selected.", "error");
                    return;
                }


                // Pipe roughness
                const roughness_e = pipeRoughness[pipeMaterial]; // epsilon in meters

                let calculationHtml = '<h4>Detailed Calculation Steps:</h4>';

                // Step 1: Calculate Cross-sectional Area of the Pipe
                const area_m2 = Math.PI * Math.pow(diameter_m / 2, 2); // A in m2
                calculationHtml += `<p><strong>1. Calculate Pipe Cross-sectional Area:</strong></p>`;
                calculationHtml += `<p>The cross-sectional area of the pipe is calculated using its internal diameter. This area is fundamental for relating flow rate and velocity.</p>`;
                calculationHtml += `<p class="formula">$$A = \\frac{\\pi D^2}{4}$$</p>`;
                calculationHtml += `<ul>
                    <li>Pipe Internal Diameter (D) = ${diameter_mm} mm = ${diameter_m.toFixed(4)} m</li>
                </ul>`;
                calculationHtml += `<p class="calculation-step">
                    A = &pi; * (${diameter_m.toFixed(4)})<sup>2</sup> / 4 = ${area_m2.toFixed(6)} m<sup>2</sup>
                </p>`;

                // Step 2: Handle calculation based on Input Type (Flow Rate, Velocity, or Pressure Drop)
                if (inputType === 'flow_rate') {
                    flowRate_m3s = parseFloat(flowRateInput.value);
                    if (isNaN(flowRate_m3s) || flowRate_m3s <= 0) {
                        displayMessage("Please enter a valid positive value for Flow Rate.", "error");
                        return;
                    }
                    velocity_ms = flowRate_m3s / area_m2;

                    calculationHtml += `<p><strong>2. Calculate Velocity from Input Flow Rate:</strong></p>`;
                    calculationHtml += `<p>Velocity is determined by dividing the volumetric flow rate by the pipe's cross-sectional area. This assumes uniform flow across the pipe's cross-section.</p>`;
                    calculationHtml += `<p class="formula">$$V = \\frac{Q}{A}$$</p>`;
                    calculationHtml += `<ul>
                        <li>Flow Rate (Q) = ${flowRate_m3s.toExponential(2)} m<sup>3</sup>/s</li>
                        <li>Pipe Cross-sectional Area (A) = ${area_m2.toFixed(6)} m<sup>2</sup></li>
                    </ul>`;
                    calculationHtml += `<p class="calculation-step">
                        V = ${flowRate_m3s.toExponential(2)} / ${area_m2.toFixed(6)} = ${velocity_ms.toFixed(4)} m/s
                    </p>`;

                } else if (inputType === 'velocity') {
                    velocity_ms = parseFloat(velocityInput.value);
                    if (isNaN(velocity_ms) || velocity_ms <= 0) {
                        displayMessage("Please enter a valid positive value for Velocity.", "error");
                        return;
                    }
                    flowRate_m3s = velocity_ms * area_m2;

                    calculationHtml += `<p><strong>2. Calculate Flow Rate from Input Velocity:</strong></p>`;
                    calculationHtml += `<p>Flow rate is calculated by multiplying the fluid's average velocity by the pipe's cross-sectional area. This gives the volume of fluid passing through a section per unit time.</p>`;
                    calculationHtml += `<p class="formula">$$Q = V \\times A$$</p>`;
                    calculationHtml += `<ul>
                        <li>Velocity (V) = ${velocity_ms.toFixed(4)} m/s</li>
                        <li>Pipe Cross-sectional Area (A) = ${area_m2.toFixed(6)} m<sup>2</sup></li>
                    </ul>`;
                    calculationHtml += `<p class="calculation-step">
                        Q = ${velocity_ms.toFixed(4)} x ${area_m2.toFixed(6)} = ${flowRate_m3s.toExponential(2)} m<sup>3</sup>/s
                    </p>`;

                } else if (inputType === 'pressure_drop') {
                    const pressureDrop_pa_input = parseFloat(pressureDropInput.value);
                    if (isNaN(pressureDrop_pa_input) || pressureDrop_pa_input <= 0) {
                        displayMessage("Please enter a valid positive value for Pressure Drop.", "error");
                        return;
                    }
                    pressureDrop_pa = pressureDrop_pa_input; // Assign input pressure drop to the main variable

                    // Iterative solution for velocity and flow rate when pressure drop is known
                    let f_guess = 0.02; // Initial guess for friction factor (common for turbulent flow)
                    let maxIterations = 100;
                    let tolerance = 0.0001; // Convergence tolerance for friction factor

                    calculationHtml += `<p><strong>2. Iteratively Determine Velocity and Flow Rate from Input Pressure Drop:</strong></p>`;
                    calculationHtml += `<p>When the pressure drop is known, finding the fluid velocity (and subsequently flow rate) requires an iterative solution because the friction factor, which is part of the Darcy-Weisbach equation, depends on the velocity. We use a method of successive approximations to converge on the correct velocity and friction factor.</p>`;
                    calculationHtml += `<p class="formula">$$V = \\sqrt{\\frac{2 \\Delta P D}{f \\rho L}}$$</p>`;
                    calculationHtml += `<ul>
                        <li>Input Pressure Drop ($\Delta$P) = ${pressureDrop_pa_input.toFixed(2)} Pa</li>
                        <li>Pipe Internal Diameter (D) = ${diameter_m.toFixed(4)} m</li>
                        <li>Fluid Density ($\\rho$) = ${density} kg/m<sup>3</sup></li>
                        <li>Pipe Length (L) = ${length_m} m</li>
                    </ul>`;

                    let converged = false;
                    for (let i = 0; i < maxIterations; i++) {
                        let V_calc = Math.sqrt((2 * pressureDrop_pa_input * diameter_m) / (f_guess * density * length_m));
                        let Re_calc = (density * V_calc * diameter_m) / viscosity;

                        let f_calc;
                        if (Re_calc < 2000) { // Laminar flow
                            f_calc = 64 / Re_calc;
                        } else { // Turbulent or Transitional flow (Swamee-Jain approximation)
                            const relativeRoughness = roughness_e / diameter_m;
                            f_calc = 0.25 / Math.pow(Math.log10((relativeRoughness / 3.7) + (5.74 / Math.pow(Re_calc, 0.9))), 2);
                        }

                        calculationHtml += `<p class="calculation-step">Iteration ${i + 1}:</p>`;
                        calculationHtml += `<p class="calculation-step">&nbsp;&nbsp;&nbsp;Assumed f = ${f_guess.toFixed(6)}</p>`;
                        calculationHtml += `<p class="calculation-step">&nbsp;&nbsp;&nbsp;Calculated V = ${V_calc.toFixed(4)} m/s</p>`;
                        calculationHtml += `<p class="calculation-step">&nbsp;&nbsp;&nbsp;Calculated Re = ${Re_calc.toExponential(4)}</p>`;
                        calculationHtml += `<p class="calculation-step">&nbsp;&nbsp;&nbsp;Calculated New f = ${f_calc.toFixed(6)}</p>`;

                        if (Math.abs(f_calc - f_guess) / f_guess < tolerance) {
                            velocity_ms = V_calc;
                            frictionFactor = f_calc;
                            reynoldsNumber = Re_calc;
                            converged = true;
                            calculationHtml += `<p class="calculation-step">Converged after ${i + 1} iterations. Final f = ${frictionFactor.toFixed(6)}</p>`;
                            break;
                        }
                        f_guess = f_calc;
                    }

                    if (!converged) {
                        displayMessage("Warning: Calculation did not converge within maximum iterations. Results may be approximate. Try adjusting initial guess or tolerance if precision is critical.", "warning");
                    }
                    
                    flowRate_m3s = velocity_ms * area_m2;
                }

                // Determine flow regime based on the calculated (or converged) Reynolds Number
                if (reynoldsNumber < 2000) {
                    flowRegime = 'Laminar';
                } else if (reynoldsNumber > 4000) {
                    flowRegime = 'Turbulent';
                } else {
                    flowRegime = 'Transitional';
                }

                // Step 3: Calculate Reynolds Number (this step is now contextualized by input type)
                // This section re-iterates the calculation if it wasn't the direct result of input
                if (inputType !== 'pressure_drop') { // If Re wasn't calculated in iterative step
                    reynoldsNumber = (density * velocity_ms * diameter_m) / viscosity;
                    calculationHtml += `<p><strong>3. Calculate Reynolds Number:</strong></p>`;
                    calculationHtml += `<p>The Reynolds number ($$Re$$) is a dimensionless quantity used to predict flow patterns. It helps determine if the flow is laminar (smooth), turbulent ( chaotic), or transitional. Laminar flow occurs at low $$Re$$ values (typically $$Re < 2000$$), turbulent flow at high $$Re$$ values (typically $$Re > 4000$$), and transitional flow in between.</p>`;
                    calculationHtml += `<p class="formula">$$Re = \\frac{\\rho V D}{\\mu}$$</p>`;
                    calculationHtml += `<ul>
                        <li>Density ($\\rho$) = ${density} kg/m<sup>3</sup> (${fluidType} at ${fluidTemperature}&#8451;)</li>
                        <li>Velocity (V) = ${velocity_ms.toFixed(4)} m/s</li>
                        <li>Pipe Internal Diameter (D) = ${diameter_m.toFixed(4)} m</li>
                        <li>Dynamic Viscosity ($\\mu$) = ${viscosity.toExponential(3)} Pa&#xB7;s (${fluidType} at ${fluidTemperature}&#8451;)</li>
                    </ul>`;
                    calculationHtml += `<p class="calculation-step">
                        Re = (${density} x ${velocity_ms.toFixed(4)} x ${diameter_m.toFixed(4)}) / ${viscosity.toExponential(3)} = ${reynoldsNumber.toExponential(4)}
                    </p>`;
                    calculationHtml += `<p class="calculation-step">
                        Flow Regime: ${flowRegime}
                    </p>`;
                } else {
                    // If pressure drop was input, Re was calculated during iteration, so just summarize
                    calculationHtml += `<p><strong>3. Determined Reynolds Number:</strong></p>`;
                    calculationHtml += `<p>Based on the converged velocity, the Reynolds number for the flow is:</p>`;
                    calculationHtml += `<p class="calculation-step">
                        Re = ${reynoldsNumber.toExponential(4)}
                    </p>`;
                    calculationHtml += `<p class="calculation-step">
                        Flow Regime: ${flowRegime}
                    </p>`;
                }

                // Step 4: Calculate Friction Factor (this step is also contextualized)
                if (inputType !== 'pressure_drop') { // If friction factor wasn't calculated in iterative step
                    let frictionFormula = '';
                    let colebrookDetails = '';
                    if (reynoldsNumber < 2000) { // Laminar flow (Hagen-Poiseuille equation)
                        frictionFactor = 64 / reynoldsNumber;
                        frictionFormula = `$$f = \\frac{64}{Re}$$ (For Laminar Flow)`;
                    } else { // Turbulent or Transitional flow (Swamee-Jain approximation)
                        const relativeRoughness = roughness_e / diameter_m; // epsilon/D
                        frictionFactor = 0.25 / Math.pow(Math.log10((relativeRoughness / 3.7) + (5.74 / Math.pow(reynoldsNumber, 0.9))), 2);
                        frictionFormula = `$$f = \\frac{0.25}{\\left[\\log_{10}\\left(\\frac{\\epsilon}{3.7D} + \\frac{5.74}{Re^{0.9}}\\right)\\right]^2}$$ (Swamee-Jain equation for Turbulent Flow)`;
                        colebrookDetails = `This uses the Swamee-Jain equation, an explicit approximation of the implicit Colebrook-White equation, which is widely used for turbulent flow in pipes.`;
                        calculationHtml += `<p class="calculation-step">Relative Roughness ($\\epsilon$/D) = ${roughness_e.toExponential(2)} / ${diameter_m.toFixed(4)} = ${relativeRoughness.toExponential(2)}</p>`;
                    }
                    calculationHtml += `<p><strong>4. Calculate Friction Factor:</strong></p>`;
                    calculationHtml += `<p>The friction factor ($$f$$) accounts for the resistance to flow caused by the pipe's internal surface. It is determined differently for laminar and turbulent flows. ${colebrookDetails}</p>`;
                    calculationHtml += `<p class="formula">${frictionFormula}</p>`;
                    calculationHtml += `<ul>
                        <li>Reynolds Number (Re) = ${reynoldsNumber.toExponential(4)}</li>
                        <li>Pipe Roughness ($\\epsilon$) = ${roughness_e.toExponential(2)} m (${pipeMaterial})</li>
                        <li>Pipe Internal Diameter (D) = ${diameter_m.toFixed(4)} m</li>
                    </ul>`;
                    calculationHtml += `<p class="calculation-step">
                        f = ${frictionFactor.toFixed(6)}
                    </p>`;
                } else {
                    // If pressure drop was input, f was calculated during iteration, so just summarize
                    calculationHtml += `<p><strong>4. Determined Friction Factor:</strong></p>`;
                    calculationHtml += `<p>Based on the converged velocity and Reynolds number, the friction factor for the flow is:</p>`;
                    calculationHtml += `<p class="calculation-step">
                        f = ${frictionFactor.toFixed(6)}
                    </p>`;
                }

                // Step 5: Calculate Pressure Drop (if not input) using Darcy-Weisbach Equation
                if (inputType !== 'pressure_drop') {
                    pressureDrop_pa = frictionFactor * (length_m / diameter_m) * (density * Math.pow(velocity_ms, 2) / 2);
                    calculationHtml += `<p><strong>5. Calculate Pressure Drop using Darcy-Weisbach Equation:</strong></p>`;
                    calculationHtml += `<p>The Darcy-Weisbach equation is a widely accepted empirical equation that calculates the major head loss (pressure drop) due to friction in a pipe. It considers the pipe length, diameter, fluid velocity, fluid density, and the friction factor.</p>`;
                    calculationHtml += `<p class="formula">$$\\Delta P = f \\frac{L}{D} \\frac{\\rho V^2}{2}$$</p>`;
                    calculationHtml += `<ul>
                        <li>Friction Factor (f) = ${frictionFactor.toFixed(6)}</li>
                        <li>Pipe Length (L) = ${length_m} m</li>
                        <li>Pipe Internal Diameter (D) = ${diameter_m.toFixed(4)} m</li>
                        <li>Density ($\\rho$) = ${density} kg/m<sup>3</sup></li>
                        <li>Velocity (V) = ${velocity_ms.toFixed(4)} m/s</li>
                    </ul>`;
                    calculationHtml += `<p class="calculation-step">
                        $\Delta$P = ${frictionFactor.toFixed(6)} x (${length_m} / ${diameter_m.toFixed(4)}) x (${density} x ${velocity_ms.toFixed(4)}<sup>2</sup> / 2) = ${pressureDrop_pa.toFixed(2)} Pa
                    </p>`;
                } else {
                    // If pressure drop was input, just confirm it
                    calculationHtml += `<p><strong>5. Input Pressure Drop Confirmed:</strong></p>`;
                    calculationHtml += `<p>The pressure drop for this calculation was provided as an input parameter.</p>`;
                    calculationHtml += `<p class="calculation-step">
                        $\Delta$P = ${pressureDrop_pa.toFixed(2)} Pa
                    </p>`;
                }
                
                calculationDetailsDiv.innerHTML = calculationHtml;
                // Trigger MathJax to render the new content
                if (window.MathJax) {
                    window.MathJax.typesetPromise([calculationDetailsDiv]);
                }

                // Display summarized results in the table
                resultTableBody.innerHTML = ''; // Clear previous results
                
                function addResultRow(parameter, value) {
                    const row = resultTableBody.insertRow();
                    const paramCell = row.insertCell();
                    const valueCell = row.insertCell();
                    paramCell.textContent = parameter;
                    valueCell.textContent = value;
                }

                addResultRow("Fluid Type", fluidType.charAt(0).toUpperCase() + fluidType.slice(1));
                addResultRow("Fluid Temperature", `${fluidTemperature}&#8451;`); // NEW: Display fluid temperature
                addResultRow("Pipe Material", pipeMaterial.replace('_', ' ').split(' ').map(word => word.charAt(0).toUpperCase() + word.slice(1)).join(' '));
                addResultRow("Pipe Internal Diameter", `${diameter_mm} mm`);
                addResultRow("Pipe Length", `${length_m} m`);
                addResultRow("Fluid Density", `${density.toFixed(3)} kg/m3`); // Display with more precision
                addResultRow("Fluid Viscosity", `${viscosity.toExponential(3)} Pa&#xB7;s`); // Display with more precision
                addResultRow("Pipe Roughness", `${roughness_e.toExponential(2)} m`);
                addResultRow("Pipe Cross-sectional Area", `${area_m2.toFixed(6)} m2`);
                addResultRow("Velocity", `${velocity_ms.toFixed(4)} m/s`);
                addResultRow("Flow Rate", `${flowRate_m3s.toExponential(4)} m3/s`);
                addResultRow("Reynolds Number", `${reynoldsNumber.toExponential(4)} (${flowRegime} Flow)`);
                addResultRow("Friction Factor", frictionFactor.toFixed(6));
                addResultRow("Pressure Drop", `${(pressureDrop_pa / 1000).toFixed(2)} kPa (${pressureDrop_pa.toFixed(2)} Pa)`);

                standardReference.innerHTML = "Pipe flow calculations are based on fundamental principles of fluid mechanics, including the conservation of mass and energy. The pressure drop due to friction is calculated using the Darcy-Weisbach equation, which is widely recognized and used in hydraulic engineering. The friction factor is determined based on the Reynolds number and pipe roughness, utilizing correlations such as the Swamee-Jain equation, an explicit approximation of the Colebrook-White equation for turbulent flow, and the Hagen-Poiseuille equation for laminar flow. Always refer to international mechanical engineering standards like ISO, ASME, or relevant handbooks for definitive requirements and more complex scenarios (e.g., minor losses, non-Newtonian fluids, compressible flow).";
                resultContainer.style.display = 'block';
                resultContainer.scrollIntoView({ behavior: 'smooth' }); // Scroll to results
                displayMessage("Calculation completed successfully!", "info");
            });

            // Theme switch logic (copied from the provided file)
            const themeSwitch = document.getElementById('theme-switch');
            if (themeSwitch) {
                if (localStorage.getItem('theme') === 'dark') {
                    document.body.classList.add('dark-mode');
                    themeSwitch.checked = true;
                }

                themeSwitch.addEventListener('change', function() {
                    if (this.checked) {
                        document.body.classList.add('dark-mode');
                        localStorage.setItem('theme', 'dark');
                    } else {
                        document.body.classList.remove('dark-mode');
                        localStorage.setItem('theme', 'light');
                    }
                });
            }
        });
    </script>
</body>

</html>


