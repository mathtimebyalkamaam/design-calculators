<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Instrument Power Supply Load Calculator - Design Calculators - Instrumentation</title>
    <!-- SEO Meta Tags -->
    <meta name="description" content="Professional calculator for sizing instrument power supplies (PSU). Calculates total load, current, and power, including safety factors and efficiency.">
    <meta name="keywords" content="power supply calculator, psu sizing, instrumentation, 24vdc load, power budget, electrical load, process control">
    <meta name="author" content="Design Calculators">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://designcalculators.co.in/power-supply-load.html" />
    
    <!-- AdSense & Analytics (from new header) -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5936527763614780" crossorigin="anonymous"></script>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-23Y1V450SR"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-23Y1V450SR');
    </script>
    
    <!-- Fonts & Icons (from new header) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Montserrat:wght@700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- MathJax for Formulas (from new header) -->
    <script>
    window.MathJax = {
        tex: {
            inlineMath: [['\\(', '\\)'], ['$', '$']],
            displayMath: [['\\[', '\\]'], ['$$', '$$']]
        },
        svg: { fontCache: 'global' },
        options: {
            processHtmlClass: 'math-content', // Process elements with this class
            ignoreHtmlClass: 'no-mathjax' // Ignore elements with this class
        }
    };
    </script>
    <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    
    <!-- PDF Generation (Not used by this tool but included in header) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.8.3/jspdf.plugin.autotable.min.js"></script>
    
    <!-- Favicon (from new header) -->
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">

    <!-- New Styles from file.txt -->
    <style>
        :root {
            --primary: #1E3A8A;
            --secondary: #2563EB;
            --accent: #F59E0B;
            --success: #10B981;
            --danger: #DC2626;
            --warning: #F59E0B;
            --bg: #F8FAFC;
            --card: #FFFFFF;
            --text: #4B5563;
            --heading: #111827;
            --footer-bg: #0F172A;
            --border: #E2E8F0;
            --grad: linear-gradient(135deg, var(--primary), var(--secondary));
            --grad-dark: linear-gradient(135deg, #0F172A, #1E293B);
            --shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
            --shadow-lg: 0 10px 20px rgba(0, 0, 0, 0.1);
            /* Specific colors for this tool, matching the old theme */
            --ok-color: #10B981; /* Green for OK status */
            --error-color: #DC2626; /* Red for error status */
            --warning-color: #F59E0B; /* Amber for warnings */
        }

        body.dark-mode {
            --primary: #10B981;
            --secondary: #34D399;
            --bg: #0F172A;
            --card: #1E293B;
            --text: #CBD5E1;
            --heading: #F1F5F9;
            --footer-bg: #020617;
            --border: #334155;
            --ok-color: #10B981;
            --error-color: #e74c3c;
            --warning-color: #F59E0B;
        }

        * { box-sizing: border-box; }
        html { scroll-behavior: smooth; }
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg);
            color: var(--text);
            line-height: 1.7;
            margin: 0;
            padding: 0;
        }

        .container { max-width: 1280px; margin: 0 auto; padding: 0 24px; }

        /* Header & Nav */
        header {
            background: var(--grad);
            color: white;
            padding: 24px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .logo-container {
            display: flex;
            flex-direction: column;
            text-decoration: none;
            color: white;
        }
        .logo-text {
            font-size: 1.75rem;
            font-weight: 800;
            font-family: 'Montserrat', sans-serif;
        }
        .logo-subtitle {
            font-size: 0.8rem;
            margin: 4px 0 0 0;
            color: #E0E7FF;
            opacity: 0.9;
        }
        .nav-links {
            display: flex;
            gap: 24px;
            list-style: none;
            margin: 0;
            padding: 0;
        }
        .nav-links a {
            color: white;
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s;
        }
        .nav-links a:hover { color: var(--accent); }
        .theme-toggle {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .switch {
            position: relative;
            width: 56px;
            height: 30px;
        }
        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0,0,0,0.2);
            transition: .4s;
            border-radius: 30px;
        }
        .slider:before {
            position: absolute;
            content: "";
            height: 22px;
            width: 22px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        input:checked + .slider {
            background-color: var(--accent);
        }
        input:checked + .slider:before {
            transform: translateX(26px);
        }

        /* Main Content & Cards */
        main { padding: 40px 0; }
        .card {
            background: var(--card);
            border-radius: 12px;
            padding: 30px;
            box-shadow: var(--shadow);
            margin-bottom: 30px;
            border: 1px solid var(--border);
        }
        /* Applied to the tool container */
        .tool-container {
            background: var(--card);
            border-radius: 12px;
            padding: 30px;
            box-shadow: var(--shadow);
            margin-bottom: 30px;
            border: 1px solid var(--border);
        }
        .tool-description {
            margin-bottom: 20px;
            color: var(--text);
            font-size: 1.05rem;
        }
        h2 {
            color: var(--primary);
            border-bottom: 3px solid var(--primary);
            padding-bottom: 15px;
            margin-top: 0;
            font-family: 'Montserrat', sans-serif;
            font-size: 1.8rem;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        h3 {
            color: var(--heading);
            font-family: 'Montserrat', sans-serif;
            font-size: 1.5rem;
            margin-top: 25px;
            margin-bottom: 20px;
        }
        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }
        .form-group {
            margin-bottom: 20px;
        }
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--heading);
        }
        .form-group input,
        .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--border);
            border-radius: 6px;
            background-color: var(--bg);
            color: var(--text);
            font-size: 1rem;
            transition: border-color 0.3s, box-shadow 0.3s;
        }
        .form-group input:focus,
        .form-group select:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 3px rgba(30, 58, 138, 0.1);
        }
        body.dark-mode .form-group input:focus {
            box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1);
        }
        .calculator-form {
            background-color: var(--card); /* Re-using card style */
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
        }
        .form-section {
            background-color: var(--bg);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 25px; /* Space between sections */
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.05);
            opacity: 0; /* Initial state for fade-in animation */
            transform: translateY(10px); /* Initial state for slide-up animation */
            transition: opacity 0.5s ease-out, transform 0.5s ease-out;
        }
        .form-section.fade-in {
            opacity: 1;
            transform: translateY(0);
        }
        .form-section h3 {
            color: var(--secondary);
            margin-top: 0;
            margin-bottom: 15px;
            border-bottom: 1px dashed var(--border);
            padding-bottom: 10px;
        }
        .btn {
            background: var(--grad);
            color: white;
            border: none;
            padding: 16px 30px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: 700;
            box-shadow: 0 4px 12px rgba(30, 58, 138, 0.3);
            transition: all 0.3s;
            width: 100%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(30, 58, 138, 0.4);
        }
        .btn-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        .btn-group .btn {
            flex: 1;
            min-width: 150px;
        }
        .btn.secondary {
            background: var(--secondary);
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3);
        }
        .btn.accent {
            background: var(--accent);
            box-shadow: 0 4px 12px rgba(245, 158, 11, 0.3);
        }
        .btn.accent:hover {
             box-shadow: 0 8px 20px rgba(245, 158, 11, 0.4);
        }
        .btn.danger {
            background: var(--danger);
             box-shadow: 0 4px 12px rgba(220, 38, 38, 0.3);
        }
        .btn.danger:hover {
            box-shadow: 0 8px 20px rgba(220, 38, 38, 0.4);
        }
        .btn.small {
            padding: 8px 16px;
            font-size: 0.9rem;
        }


        /* CALCULATION STEPS DISPLAY */
        .steps-container {
            display: none;
            margin-top: 30px;
        }
        .steps-container.active {
            display: block;
        }
        .step-card {
            width: 100% !important;
            max-width: 100% !important;
            box-sizing: border-box; /* v6 */
            background: var(--card);
            border-radius: 12px;
            padding: 25px 30px;
            box-shadow: var(--shadow);
            border: 1px solid var(--border);
            animation: slideIn 0.6s ease-out;
            transition: all 0.3s;
            margin-bottom: 25px; /* Spacing between cards */
        }
        @keyframes slideIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .step-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }
        .step-card h4 {
            color: var(--primary);
            margin: 0 0 20px 0;
            font-size: 1.4rem;
            font-family: 'Montserrat', sans-serif;
            display: block; /* Changed from flex */
        }
        .step-card h4::after {
            content: "";
            display: table;
            clear: both;
        }
        .step-card .number {
            float: left; /* Changed to float */
            width: 40px;
            height: 40px;
            background: var(--primary);
            color: white;
            border-radius: 50%;
            text-align: center;
            line-height: 40px;
            font-weight: 700;
            margin-right: 15px;
            font-size: 1.3rem;
            /* Removed flex-shrink */
        }
        .step-content {
            width: 100% !important;
            max-width: 100% !important;
            box-sizing: border-box; /* v6 */
            display: grid;
            grid-template-columns: 1fr !important;
            gap: 25px;
            align-items: start;
        }
        .step-content > * { min-width: 0; }
        .step-content .formula-block {
            background: var(--bg);
            border-radius: 8px;
            padding: 20px;
            font-size: 1rem;
            border: 1px solid var(--border);
        }
        .step-content .formula-block p {
            margin-top: 0;
        }
        .step-content .formula {
            background: var(--bg);
            border-left: 3px solid var(--accent);
            padding: 15px;
            margin: 12px 0;
            font-size: 1rem;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            overflow-x: auto;
        }
        .step-value {
            font-size: 2.2rem;
            font-weight: 800;
            color: var(--success);
            margin: 10px 0;
            line-height: 1.2;
        }
        .step-unit {
            font-size: 1rem;
            color: var(--text);
            opacity: 0.8;
            font-weight: 500;
            margin-left: 5px;
        }
        .step-explanation {
            font-size: 1.05rem;
            line-height: 1.8;
        }
        /* Specific class for calculation steps */
        .calculation-step {
            font-family: 'Courier New', monospace;
            background-color: var(--bg);
            padding: 8px 15px;
            border-radius: 4px;
            margin-bottom: 8px;
            color: var(--text);
            white-space: pre-wrap;
            word-break: break-word;
            border: 1px solid var(--border);
        }


        /* Results */
        .results-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            border-radius: 8px;
            overflow: hidden;
        }
        .results-table th,
        .results-table td {
            padding: 16px;
            text-align: left;
            border-bottom: 1px solid var(--border);
        }
        .results-table th {
            background: var(--grad);
            color: white;
            font-weight: 700;
        }
        .results-table tr:nth-child(even) {
            background-color: var(--bg);
        }
        .results-table td:first-child {
            font-weight: 600;
            color: var(--heading);
        }
        .results-table .highlight {
            font-weight: 700;
            font-size: 1.1rem;
            color: var(--success);
        }
        .results-table .warning {
            font-weight: 700;
            color: var(--warning);
        }
        .results-table .error {
            font-weight: 700;
            color: var(--danger);
        }

        /* Educational Section */
        .education-section {
            margin-top: 60px;
        }
        .insight-card {
            background: linear-gradient(135deg, var(--card), rgba(37,99,235,0.03));
            border-radius: 12px;
            padding: 25px;
            margin: 20px 0;
            border-left: 5px solid var(--secondary);
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            transition: all 0.3s;
        }
        .insight-card:hover {
            transform: translateX(5px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        .insight-card h4 {
            color: var(--secondary);
            font-size: 1.3rem;
            margin: 0 0 15px 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .insight-card h4 i {
            font-size: 1.5rem;
        }
        .insight-card p {
            margin: 10px 0;
            line-height: 1.8;
        }
        .insight-card ol,
        .insight-card ul {
            padding-left: 20px;
            margin: 10px 0;
        }
        .insight-card li {
            margin-bottom: 10px;
        }
        .stat-highlight {
            display: inline-block;
            background: var(--accent);
            color: #333;
            padding: 4px 12px;
            border-radius: 20px;
            font-weight: 700;
            margin: 0 4px;
        }
        .danger-box {
            background: linear-gradient(135deg, rgba(220,38,38,0.1), rgba(220,38,38,0.05));
            border-left: 5px solid var(--danger);
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
        }
        .danger-box h4 {
            color: var(--danger);
            margin-top: 0;
        }
        .success-box {
            background: linear-gradient(135deg, rgba(16,185,129,0.1), rgba(16,185,129,0.05));
            border-left: 5px solid var(--success);
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
        }
        .success-box h4 {
            color: var(--success);
            margin-top: 0;
        }


        /* Message Box */
        .message-box {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            padding: 16px 28px;
            border-radius: 8px;
            box-shadow: 0 6px 16px rgba(0,0,0,0.25);
            z-index: 10000;
            font-weight: 600;
            color: white;
            opacity: 0;
            transition: all 0.4s;
            display: none;
        }
        .message-box.show {
            display: block;
            opacity: 1;
            top: 30px;
        }

        /* Footer */
        footer {
            background: var(--grad-dark);
            color: #CBD5E1;
            padding: 50px 0 20px 0;
            margin-top: 60px;
        }
        .footer-content {
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 40px;
            margin-bottom: 30px;
        }
        .footer-col {
            flex: 1;
            min-width: 200px;
        }
        .footer-col h4 {
            color: white;
            margin-bottom: 15px;
            font-weight: 700;
        }
        .footer-col ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        .footer-col a {
            color: #CBD5E1;
            text-decoration: none;
            transition: color 0.3s;
        }
        .footer-col a:hover {
            color: var(--accent);
        }
        .social-buttons {
            display: flex;
            gap: 12px;
            margin-top: 15px;
        }
        .social-btn {
            width: 40px;
            height: 40px;
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            border-radius: 50%;
            font-size: 1.1rem;
            transition: transform 0.3s;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        .social-btn:hover {
            transform: translateY(-4px);
        }
        .social-btn.linkedin { background-color: #0A66C2; }
        .social-btn.youtube { background-color: #FF0000; }
        .social-btn.twitter { background-color: #1DA1F2; }
        .social-btn.facebook { background-color: #1877F2; }
        .social-btn.whatsapp { background-color: #25D366; }
        .footer-disclaimer {
            text-align: center;
            padding-top: 25px;
            border-top: 1px solid #334155;
            max-width: 800px;
            margin: 0 auto;
            font-size: 0.9rem;
        }
        .footer-bottom {
            text-align: center;
            padding-top: 20px;
            font-size: 0.9rem;
            color: #94A3B8;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .container { padding: 0 15px; }
            .navbar { flex-direction: column; gap: 20px; }
            .nav-links { flex-direction: column; gap: 12px; text-align: center; }
            .form-row { grid-template-columns: 1fr; }
            .card { padding: 20px; }
            .footer-content { flex-direction: column; gap: 25px; }
            .btn-group { flex-direction: column; }
        }
        .hidden { display: none; }

        /* Tooltip */
        .info-icon {
            color: var(--primary);
            margin-left: 5px;
            cursor: help;
        }
        .tooltip {
            position: relative;
            display: inline-block;
        }
        .tooltip .tooltiptext {
            visibility: hidden;
            width: 250px; /* Adjusted width */
            background-color: #333;
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 8px; /* Increased padding */
            position: absolute;
            z-index: 10;
            bottom: 125%;
            left: 50%;
            margin-left: -125px; /* Half of width */
            opacity: 0;
            transition: opacity 0.3s, transform 0.3s;
            transform: translateY(10px);
            font-family: 'Inter', sans-serif; /* Professional font */
            font-size: 0.85rem; /* Slightly smaller font size */
            line-height: 1.4; /* Better readability */
        }
        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
            transform: translateY(0);
        }

        /* Specific styles for Power Supply Calculator */
        .status-display {
            font-weight: bold;
            font-size: 1.1em;
            margin-top: 15px;
            padding: 10px 20px;
            border-radius: 5px;
            transition: background-color 0.5s, color 0.5s;
            text-align: center;
            width: 100%;
        }
        .status-display.optimal {
            background-color: var(--ok-color);
            color: white;
        }
        .status-display.sufficient {
            background-color: #34D399; /* Lighter green */
            color: white;
        }
        .status-display.adequate {
            background-color: #60A5FA; /* Light blue */
            color: white;
        }
        .status-display.marginal {
            background-color: var(--warning-color);
            color: var(--heading);
        }
        .status-display.insufficient {
            background-color: var(--error-color);
            color: white;
        }

        /* Dynamic Device Entry Styling (from old file, adapted) */
        .device-entry {
            display: grid;
            grid-template-columns: 1fr 0.8fr 0.8fr 0.5fr auto; /* Name, Voltage, Current, Quantity, Remove Button */
            gap: 15px;
            align-items: center;
            margin-bottom: 15px;
            padding: 10px;
            border: 1px solid var(--border);
            border-radius: 8px;
            background-color: var(--card); /* Use card bg for contrast */
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            transition: all 0.3s ease-in-out;
        }
        .device-entry:hover {
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }
        .device-entry .form-group {
            margin-bottom: 0; /* Override default form-group margin */
        }
        /* No need to override input bg, default is good */
        
        .remove-device-btn {
            background: var(--danger);
            color: white;
            border: none;
            padding: 12px 16px; /* Make it a bit larger */
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 700;
            transition: all 0.3s ease-in-out;
            box-shadow: 0 2px 5px rgba(220, 38, 38, 0.2);
        }
        .remove-device-btn:hover {
            background: #b91c1c; /* Darker red */
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(220, 38, 38, 0.3);
        }

        /* Responsive adjustments for device entries */
        @media (max-width: 768px) {
            .device-entry {
                grid-template-columns: 1fr; /* Stack elements on small screens */
            }
            .device-entry .remove-device-btn {
                width: 100%;
                margin-left: 0;
                margin-top: 10px;
            }
        }

        /* Standard Reference / Recommendations */
        #dynamic-recommendations {
            margin-top: 20px;
            padding: 20px;
            border-radius: 8px;
            background-color: var(--bg);
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.05);
            color: var(--text);
            border: 1px solid var(--border);
        }
        #dynamic-recommendations h4 {
            color: var(--secondary);
            margin-top: 0;
            margin-bottom: 15px;
            border-bottom: 1px dashed var(--border);
            padding-bottom: 10px;
        }
        #dynamic-recommendations ul {
            list-style-type: disc;
            margin-left: 25px;
            padding-left: 0;
        }
        #dynamic-recommendations ul li {
            margin-bottom: 8px;
        }

    </style>
    <link rel="stylesheet" href="styles.css">
    <meta property="og:title" content="Instrument Power Supply Load Calculator - Design Calculators - Instrumentation">
    <meta property="og:description" content="Professional calculator for sizing instrument power supplies (PSU). Calculates total load, current, and power, including safety factors and efficiency.">
</head>
<body>
    <!-- Message box for notifications -->
    <div id="message-box" class="message-box"></div>

    <!-- New Header from file.txt -->
    <header class="header">
        <div class="header-bg-animation"></div>
        <div class="container">
            <nav class="navbar">
                <a href="/" class="logo-container">
                    <img src="logo.png" alt="Design Calculators Logo" class="logo">
                    <span class="logo-text">Design Calculators</span>
                </a>

                <div class="nav-menu">
                    <button class="mobile-menu-toggle" aria-label="Toggle menu">
                        <i class="fas fa-bars"></i>
                    </button>

                    <ul class="nav-links">
                        <li><a href="/index.html">Home</a></li>
                        
    <li class="dropdown">
        <a href="/indexele.html" class="dropdown-toggle">Electrical <i class="fas fa-chevron-down" style="font-size: 0.7em; margin-left: 4px;"></i></a>
        <div class="dropdown-menu">
            <div class="repo-grid"><div><a href="/arcflash.html">Arc Flash Calculator</a><a href="/breaker-sizing.html">Breaker Sizing</a><a href="/cable-thermal-rating.html">Cable Ampacity</a><a href="/comm-cable-loss.html">Comm Cable Loss</a><a href="/earth-conductor-size.html">Earth Conductor Size</a><a href="/generatorsizing.html">Generator Sizing</a><a href="/harmonicsanalyser.html">Harmonics Analyser</a><a href="/insulationresistance.html">Insulation Resistance</a><a href="/logicgate.html">Logic Gates Simulator</a><a href="/motor-starting.html">Motor Starting Current</a><a href="/pcbtrace.html">PCB Trace Width</a><a href="/protection-device.html">Protection Device</a><a href="/resistor.html">Resistor Color Code</a><a href="/solarcable.html">Solar Cable Sizing</a><a href="/systemxrcalculator.html">System X/R Ratio</a><a href="/transmissionline.html">Transmission Line</a><a href="/vfd-selection.html">VFD Selection Tool</a></div><div><a href="/batterylife.html">Battery Life Estimator</a><a href="/busbarampacity.html">Busbar Ampacity</a><a href="/cablepulling.html">Cable Pulling Tension</a><a href="/conduit-fill.html">Conduit Fill Calculator</a><a href="/earthingfaultsimulator.html">Earthing Fault Simulator</a><a href="/grounding.html">Grounding System Design</a><a href="/hvac-sizing.html">HVAC Sizing Calculator</a><a href="/lcresonancecalculator.html">LC Resonance Calculator</a><a href="/maintenance-guide.html">Maintenance Guide</a><a href="/nemaipconvertor.html">NEMA to IP Converter</a><a href="/power-factor.html">Power Factor Correction</a><a href="/relay-coordination.html">Relay Coordination</a><a href="/short-circuit.html">Short Circuit Current</a><a href="/solarpvarray.html">Solar PV Array</a><a href="/transformer-calculator.html">Transformer Calculator</a><a href="/unit-converter.html">Unit Converter</a><a href="/voltage-drop.html">Voltage Drop Calculator</a></div><div><a href="/battery-sizing.html">Battery Sizing (AH)</a><a href="/busbarshortcircuit.html">Busbar Short Circuit</a><a href="/cable-sizing.html">Cable Sizing Calculator</a><a href="/ctsaturation.html">CT Saturation</a><a href="/equipment-relay.html">Equipment Relay Setting</a><a href="/harmonic-distortion.html">Harmonic Distortion</a><a href="/industriallighting.html">Industrial Lighting</a><a href="/lighting-calulator.html">Lighting Calculator</a><a href="/motor-efficiency.html">Motor Efficiency</a><a href="/neutral-earth-fault-current.html">Neutral Earth Fault</a><a href="/powertriangletool.html">Power Triangle</a><a href="/electricalresidentialload.html">Residential Load Calc</a><a href="/skindepth.html">Skin Depth Calculator</a><a href="/symmetricalcomponents.html">Symmetrical Components</a><a href="/transformerinrush.html">Transformer Inrush</a><a href="/ups-sizing.html">UPS Sizing</a></div>
            </div>
            <div class="view-all-container">
                <a href="/indexele.html" class="view-all-link">View All Electrical Tools â†’</a>
            </div>
        </div>
    </li>
                        
    <li class="dropdown">
        <a href="/indexinst.html" class="dropdown-toggle">Instrumentation <i class="fas fa-chevron-down" style="font-size: 0.7em; margin-left: 4px;"></i></a>
        <div class="dropdown-menu">
            <div class="repo-grid"><div><a href="/adc-resolution.html">ADC Resolution</a><a href="/capillarylengthtemperatureerror.html">Capillary Error</a><a href="/cv-kv-valve.html">Cv/Kv Valve Sizing</a><a href="/dp-level.html">DP Level Measurement</a><a href="/hydrostatic-level.html">Hydrostatic Level</a><a href="/instrument-range.html">Instrument Range</a><a href="/loop-impedance.html">Loop Impedance</a><a href="/orifice-plate.html">Orifice Plate Beta</a><a href="/pid-tuning.html">PID Tuning</a><a href="/profibus.html">Profibus Calculator</a><a href="/tempsensorresponse.html">Response Time (Tau)</a><a href="/rtd-lead-comp.html">RTD Lead Wire Comp.</a><a href="/sealfluidzeroshift.html">Seal Fluid Shift</a><a href="/snr-calculator.html">SNR Calculator</a><a href="/thermocoupleextensioncable.html">TC Extension Cable</a><a href="/thermowellwakefreq.html">Thermowell Frequency</a><a href="/pressuretransmitteroverrange.html">Tx Overrange</a><a href="/valvecavitationcalculator.html">Valve Cavitation</a><a href="/vibrationtransmitter.html">Vibration Tx</a><a href="/zoneclassificationhelper.html">Zone Classification</a></div><div><a href="/baud-rate.html">Baud Rate Calculator</a><a href="/gascompressibility.html">Compressibility (Z)</a><a href="/dbcalculator.html">dB Gain/Loss Calc</a><a href="/flowprofiledistortioncalculator.html">Flow Distortion</a><a href="/impulselinefreezing.html">Impulse Freezing</a><a href="/intrinsic-safety.html">Intrinsic Safety Loop</a><a href="/measurement.html">Measurement Uncertainty</a><a href="/ph-temp-comp.html">pH Temp Compensation</a><a href="/plcscantime.html">PLC Scan Time</a><a href="/pressurereliefvalve.html">PRV Sizing (API 520)</a><a href="/reynoldsnumbercal.html">Reynolds Number</a><a href="/rtdselfheating.html">RTD Self-Heating</a><a href="/signal-scaling.html">Signal Scaling</a><a href="/staticheadcal.html">Static Head</a><a href="/temperaturesensorlag.html">Temp Sensor Lag</a><a href="/thermowell-wake.html">Thermowell Wake</a><a href="/ultrasoniclevel.html">Ultrasonic Level</a><a href="/valve-cv.html">Valve Cv Viewer</a><a href="/wetlegdensitycompensation.html">Wet Leg Compensation</a></div><div><a href="/capacitance-level.html">Capacitance Level</a><a href="/controlvalvenoise.html">Control Valve Noise</a><a href="/dp-flow-conversion.html">DP Flow Conversion</a><a href="/hartdevices.html">HART Devices</a><a href="/impulse-pressure-drop.html">Impulse Pressure Drop</a><a href="/junctionbox.html">Junction Box Sizing</a><a href="/orifice-flow.html">Orifice Flow Calculator</a><a href="/pid-symbol-library.html">PID Symbol Library</a><a href="/power-supply-load.html">Power Supply Load</a><a href="/prvsizing.html">Relief Orifice Area</a><a href="/rtdexcitationcurrentselection.html">RTD Excitation</a><a href="/rtd-tc-conversion.html">RTD/TC Conversion</a><a href="/sil.html">SIL Calculator</a><a href="/steamflow.html">Steam Flow</a><a href="/thermocouplecjccalculator.html">Thermocouple CJC</a><a href="/turndown.html">Turndown Ratio</a><a href="/controlvalveauthority.html">Valve Authority</a><a href="/controlvalveleakage.html">Valve Leakage Class</a><a href="/wirelesshart.html">WirelessHART Range</a></div>
            </div>
            <div class="view-all-container">
                <a href="/indexinst.html" class="view-all-link">View All Instrumentation Tools â†’</a>
            </div>
        </div>
    </li>
                        
    <li class="dropdown">
        <a href="/indexmech.html" class="dropdown-toggle">Mechanical <i class="fas fa-chevron-down" style="font-size: 0.7em; margin-left: 4px;"></i></a>
        <div class="dropdown-menu">
            <div class="repo-grid"><div><a href="/aircompressorfad.html">Air Compressor FAD</a><a href="/asme-vessel.html">ASME Vessel Design</a><a href="/belt-pulley.html">Belt & Pulley</a><a href="/bolt-torque.html">Bolt Torque</a><a href="/controlvalveactuator.html">Control Valve Actuator</a><a href="/frictionfactortool.html">Darcy Friction Factor</a><a href="/fatigue.html">Fatigue Analysis</a><a href="/fuel-combustion.html">Fuel Combustion</a><a href="/gas.html">Gas Properties</a><a href="/heat-exchanger.html">Heat Exchanger</a><a href="/hydroliccylinder.html">Hydraulic Cylinder</a><a href="/material-compatibility.html">Material Compatibility</a><a href="/nozzle-reinforcement.html">Nozzle Reinforcement</a><a href="/openchannelflow.html">Open Channel Flow</a><a href="/pipescheduletool.html">Pipe Schedule & Stress</a><a href="/pump-head.html">Pump Head</a><a href="/shaft-power-torque.html">Shaft Power & Torque</a><a href="/steam-table.html">Steam Table</a><a href="/vibrationanalysis.html">Vibration Analysis</a></div><div><a href="/air-flow-duct.html">Air Flow Duct Sizing</a><a href="/beam-deflection.html">Beam Deflection</a><a href="/bernoulli-equation.html">Bernoulli Equation</a><a href="/chiller-capacity.html">Chiller Capacity</a><a href="/cooling-tower-sizing.html">Cooling Tower Sizing</a><a href="/darcy-weisbach.html">Darcy-Weisbach</a><a href="/finned-tube-heat-transfer.html">Finned Tube Heat</a><a href="/furnace-heat-duty.html">Furnace Heat Duty</a><a href="/gear-design.html">Gear Design</a><a href="/heat-loss-pipes.html">Heat Loss Pipes</a><a href="/jacketed-vessel-heat-transfer.html">Jacketed Vessel</a><a href="/metalweight.html">Metal Weight Calculator</a><a href="/nptbspthreadcalculator.html">NPT/BSP Threads</a><a href="/overall-heat-transfer.html">Overall Heat Transfer</a><a href="/pipe-stress-flexibility.html">Pipe Stress</a><a href="/pump-power.html">Pump Power</a><a href="/specific-heat-enthalpy.html">Specific Heat</a><a href="/storage-tank-volume.html">Storage Tank Volume</a><a href="/weldingstress.html">Welding Stress</a></div><div><a href="/allowable-stress-safety-factor.html">Allowable Stress</a><a href="/bearinglife.html">Bearing Life Calculator</a><a href="/boiler-efficiency.html">Boiler Efficiency</a><a href="/compressor-power.html">Compressor Power</a><a href="/corrosion-rate.html">Corrosion Rate</a><a href="/fan-laws.html">Fan Laws</a><a href="/foundation.html">Foundation Design</a><a href="/gas-laws.html">Gas Laws</a><a href="/hardness.html">Hardness Converter</a><a href="/conduction-convection-radiation.html">Heat Transfer Modes</a><a href="/machining.html">Machining Calculator</a><a href="/momentofinertia.html">Moment of Inertia</a><a href="/oring.html">O-Ring Sizing</a><a href="/pipe-flow.html">Pipe Flow Calculator</a><a href="/psychrometric.html">Psychrometric Calc</a><a href="/reynolds-number.html">Reynolds Number</a><a href="/spring.html">Spring Design</a><a href="/thermal-expansion.html">Thermal Expansion</a></div>
            </div>
            <div class="view-all-container">
                <a href="/indexmech.html" class="view-all-link">View All Mechanical Tools â†’</a>
            </div>
        </div>
    </li>
                        <li><a href="/index.html#articles">Articles</a></li>
                        <li><a href="/sitemap2.html">Site Map</a></li>
                    </ul>

                    <div class="theme-toggle">
                        <i class="fas fa-sun icon"></i>
                        <label class="switch">
                            <input type="checkbox" id="theme-switch">
                            <span class="slider"></span>
                        </label>
                        <i class="fas fa-moon icon"></i>
                    </div>
                </div>
            </nav>
    </header>

    <main class="container">
        <!-- Main Tool Container -->
        <div class="tool-container">
            <h2><i class="fas fa-bolt"></i> Instrument Power Supply Load Calculator</h2>
                        
            <div class="tool-description">
                <p>This calculator assists instrumentation engineers in determining the appropriate power source sizing for their field devices. Accurately calculating the total current and power draw helps prevent overloading, ensures stable operation, and aids in selecting the correct power supply unit (PSU) or distributed control system (DCS) power module.</p>
            </div>
                    
            <div class="calculator-form">
                <form id="power-supply-calculator-form">
                    <!-- Global Parameters -->
                    <div class="form-section">
                        <h3><i class="fas fa-globe"></i> Global System Parameters</h3>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="safety-factor">Safety Factor (%) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">An additional percentage added to the calculated load to account for future expansion, inrush currents, or unforeseen demands. Typically 10-25%.</span></span></label>
                                <input type="number" id="safety-factor" step="0.1" min="0" value="20" required>
                            </div>
                            <div class="form-group">
                                <label for="power-supply-voltage">Nominal Power Supply Voltage (V<sub>DC</sub>) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">The nominal output voltage of the power supply (e.g., 24 VDC).</span></span></label>
                                <input type="number" id="power-supply-voltage" step="any" min="1" value="24" required>
                            </div>
                            <div class="form-group">
                                <label for="psu-efficiency">Power Supply Efficiency (%) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">The efficiency of the power supply unit. A higher percentage means less power is wasted as heat. Typically 80-95%.</span></span></label>
                                <input type="number" id="psu-efficiency" step="0.1" min="1" max="100" value="85" required>
                            </div>
                            <div class="form-group">
                                <label for="peak-current-multiplier">Peak Current Multiplier <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">A factor to account for inrush currents or momentary peak loads. E.g., 1.2 for 20% over continuous.</span></span></label>
                                <input type="number" id="peak-current-multiplier" step="0.01" min="1" value="1.2" required>
                            </div>
                        </div>
                    </div>

                    <!-- Load Input Mode Selection -->
                    <div class="form-section" id="load-input-mode-section">
                        <h3><i class="fas fa-tasks"></i> Load Input Method</h3>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="load-input-mode">Choose Input Method</label>
                                <select id="load-input-mode" required>
                                    <option value="per-device">Calculate Per Device</option>
                                    <option value="total-panel-load">Enter Total Panel Load</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Connected Field Devices -->
                    <div class="form-section" id="per-device-input-section">
                        <h3><i class="fas fa-plug"></i> Connected Field Devices</h3>
                        <div id="device-list">
                            <!-- Device entries will be dynamically added here -->
                            <div class="device-entry">
                                <div class="form-group">
                                    <label for="device-type-0">Device Type</label>
                                    <select id="device-type-0" class="device-type" required>
                                        <option value="Transmitter">Transmitter (4-20mA)</option>
                                        <option value="Solenoid Valve">Solenoid Valve</option>
                                        <option value="Positioner">Valve Positioner</option>
                                        <option value="Indicator">Panel Indicator</option>
                                        <option value="Actuator">Actuator</option>
                                        <option value="Other">Other</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="operating-voltage-0">Operating Voltage (V)</label>
                                    <input type="number" id="operating-voltage-0" class="operating-voltage" step="any" min="0" value="24" required>
                                </div>
                                <div class="form-group">
                                    <label for="current-consumption-0">Current Consumption (mA)</label>
                                    <input type="number" id="current-consumption-0" class="current-consumption" step="any" min="0" value="20" required>
                                </div>
                                <div class="form-group">
                                    <label for="quantity-0">Quantity</label>
                                    <input type="number" id="quantity-0" class="quantity" step="1" min="1" value="1" required>
                                </div>
                                <button type="button" class="remove-device-btn" style="display:none;"><i class="fas fa-trash"></i></button>
                            </div>
                        </div>
                        <button type="button" id="add-device-btn" class="btn accent" style="width: auto; padding: 12px 24px; margin-top: 15px;"><i class="fas fa-plus-circle"></i> Add Device</button>
                    </div>

                    <!-- Total Panel Load Section -->
                    <div class="form-section" id="total-panel-load-input-section" style="display: none;">
                        <h3><i class="fas fa-clipboard-list"></i> Total Panel Load Details</h3>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="total-load-value">Total Load Value <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">The total load of the panel.</span></span></label>
                                <input type="number" id="total-load-value" step="any" min="0" value="100" required>
                            </div>
                            <div class="form-group">
                                <label for="total-load-unit">Total Load Unit</label>
                                <select id="total-load-unit" required>
                                    <option value="W">Watts (W)</option>
                                    <option value="VA">Volt-Amperes (VA)</option>
                                    <option value="A">Amperes (A)</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Calculation Buttons -->
                    <div class="btn-group" style="margin-top: 25px;">
                        <button type="button" id="calculate-btn" class="btn"><i class="fas fa-calculator"></i> Calculate Load</button>
                        <button type="button" id="reset-form-btn" class="btn accent"><i class="fas fa-sync-alt"></i> Reset Form</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- NEW Step-by-Step Results Container -->
        <div id="steps-container" class="steps-container math-content">
            <!-- Step cards will be dynamically inserted here -->
        </div>

        <!-- Updated Results Section -->
        <div id="results-section" class="card hidden">
            <h3><i class="fas fa-clipboard-check"></i> Calculation Summary</h3>
            <p class="status-display" id="load-status-display">Power Supply Load Status: N/A</p>
            
            <table class="results-table">
                <thead>
                    <tr>
                        <th>Parameter</th>
                        <th>Value</th>
                    </tr>
                </thead>
                <tbody id="result-table-body">
                    <!-- Results will be dynamically inserted here -->
                </tbody>
            </table>

            <!-- Dynamic Recommendations (from old file) -->
            <div id="dynamic-recommendations" style="display: none;">
                <h4><i class="fas fa-lightbulb"></i> Practical Considerations & Recommendations</h4>
                <ul id="recommendations-list">
                    <!-- Recommendations will be dynamically inserted here -->
                </ul>
            </div>

            <div class="btn-group" style="justify-content: center; margin-top: 20px;">
                <button type="button" id="clear-results-btn" class="btn accent"><i class="fas fa-times-circle"></i> Clear Results</button>
            </div>

            <!-- Static Standard Reference (from old file) -->
            <div class="insight-card" id="standard-reference" style="margin-top: 30px;">
                 <h4><i class="fas fa-book"></i> Applicable Standards and Guidelines</h4>
                 <p>Proper power supply sizing and design in industrial automation are critical for system reliability and safety. Key standards and considerations include:</p>
                 <ul>
                    <li><strong>IEC 61131-2: Programmable Controllers - Part 2: Equipment Requirements and Tests.</strong> This standard covers power supply requirements for PLCs and associated modules.</li>
                    <li><strong>NFPA 70 / National Electrical Code (NEC):</strong> Provides guidelines for electrical installations, including wiring, overcurrent protection, and power distribution.</li>
                    <li><strong>UL 508 / CSA C22.2 No. 14: Industrial Control Equipment.</strong> Standards for industrial control panels and their components, including power supplies.</li>
                    <li><strong>EMC Standards (e.g., IEC 61000 series):</strong> Ensures power supplies and connected devices operate without electromagnetic interference.</li>
                    <li><strong>Redundancy and Reliability:</strong> For critical applications, consider redundant power supplies (e.g., 1+1 or N+1 configurations) and battery backup systems (UPS) to ensure continuous operation.</li>
                    <li><strong>Voltage Drop Calculations:</strong> For long cable runs, calculate voltage drop to ensure devices receive adequate voltage.</li>
                    <li><strong>Inrush Current:</strong> Account for the temporary high current drawn by devices when first powered on.</li>
                    <li><strong>Temperature Derating:</strong> Power supply capacity may derate at higher operating temperatures. Ensure the selected PSU can deliver the required current at the maximum expected ambient temperature.</li>
                </ul>
                <p>This tool provides an initial estimate for power supply sizing. A detailed design should always consider specific device datasheets, cable lengths, environmental conditions, and applicable local electrical codes.</p>
            </div>
        </div>

        <!-- NEW 800-word Educational Section -->
        <div id="education-section" class="education-section card math-content">
            <h2><i class="fas fa-book-open"></i> Engineer's Guide to Power Supply Sizing & Selection</h2>

            <div class="tool-description">
                <p>In any instrumentation or control system, the power supply unit (PSU) is the heart. A failure here brings the entire system down. Correctly sizing a power supply isn't just about matching voltage; it's a critical engineering task that balances load, efficiency, safety, and future-proofing. An undersized PSU will lead to nuisance trips and instability, while a grossly oversized PSU is a waste of capital and energy. This guide covers the essential principles for getting it right.</p>
            </div>

            <div class="insight-card">
                <h4><i class="fas fa-key"></i> Key Concepts in Power Supply Sizing</h4>
                <p>Before calculating, it's essential to understand the language of power supplies.</p>
                <ol>
                    <li><strong>Voltage (V):</strong> This is the "electrical pressure." For instrumentation, <strong>24VDC</strong> is the near-universal standard. This calculator assumes you're working with a DC system.</li>
                    <li><strong>Current (A or mA):</strong> This is the "flow" of electricity. It's the primary value you need to calculate. Every device in your system draws a certain amount of current (e.g., a transmitter at 20mA, a solenoid at 150mA).</li>
                    <li><strong>Power (W):</strong> This is the total rate of energy consumption, calculated as $P = V \times I$. While current is often used for sizing, power (in Watts) is crucial for understanding heat load and overall energy use.</li>
                    <li><strong>Inrush Current:</strong> The momentary, high-current surge that some devices (like solenoids, actuators, and the PSU itself) draw when first powered on. This peak can be 10-20 times the steady-state current. The PSU must be able to "survive" this surge without tripping its internal protection.</li>
                    <li><strong>Efficiency (%):</strong> No power supply is 100% efficient. A 90% efficient PSU drawing 100W from the wall will only *deliver* 90W to your devices. The other 10W is lost as <strong>heat</strong> inside your panel. This is critical for thermal management.</li>
                </ol>
            </div>

            <div class="success-box">
                <h4><i class="fas fa-calculator"></i> The 4-Step Sizing Calculation</h4>
                <p>A robust power calculation follows a clear, conservative process. This calculator automates these steps.</p>
                <ol>
                    <li><strong>Step 1: Sum the Continuous Base Load</strong>
                        <p>First, find the "worst-case continuous" load. This means assuming every device is operating at its maximum *normal* draw. For a 4-20mA transmitter, this is 20mA (or ~22mA in a fault condition). For a solenoid, it's its energized holding current. Make a list of every device and its quantity.</p>
                        <p class="formula">$$I_{base} = (N_{tx} \times I_{tx}) + (N_{sol} \times I_{sol}) + (N_{other} \times I_{other}) + ...$$</p>
                    </li>
                    <li><strong>Step 2: Apply the Safety & Future-Proofing Factor</strong>
                        <p><strong>This is the golden rule:</strong> Never size a power supply to 100% of its base load. You *must* add a safety margin. This margin accounts for:
                        <ul>
                            <li><strong>Future Expansion:</strong> The inevitable "one more instrument" you'll be asked to add next year.</li>
                            <li><strong>Unknowns:</strong> Small loads that were missed (e.g., panel lights, interface relays).</li>
                            <li><strong>PSU Health:</strong> A power supply running at 100% load 24/7 will have a significantly shorter life than one running at 75%.</li>
                        </ul>
                        <p>A typical safety factor is <strong>20-25%</strong>. This tool uses 20% as a default.</p>
                        <p class="formula">$$I_{required} = I_{base} \times (1 + \frac{SafetyFactor\%}{100})$$</p>
                    </li>
                    <li><strong>Step 3: Check Peak & Inrush Loads</strong>
                        <p>Now, consider the "worst-case peak" load. What's the chance all your solenoids will energize at the *exact* same millisecond? Low, but possible. The PSU's "peak load capability" (often listed for a few seconds) must be able to handle this. This calculator uses a simple "Peak Current Multiplier" to estimate this. Your calculated $I_{required}$ is the *continuous* rating your PSU needs, and $I_{required} \times Multiplier$ is the *peak* rating it must be able to handle.</p>
                    </li>
                    <li><strong>Step 4: Calculate Input Power</strong>
                        <p>Finally, to size the upstream breaker (e.g., the 120VAC or 230VAC supply *to* the PSU), you must account for efficiency. The power *drawn* from the wall is higher than the power *delivered* to your instruments.</p>
                        <p class="formula">$$P_{input} = \frac{P_{output\_required}}{Efficiency\%}$$</p>
                    </li>
                </ol>
            </div>

            <div class="insight-card">
                <h4><i class="fas fa-tasks"></i> Practical Selection Criteria</h4>
                <p>Once you have your required current (e.g., "I need a 24VDC, 5A continuous PSU"), you're not done. You must select the right *type* of PSU.</p>
                <ul>
                    <li><strong>Switched-Mode (SMPS) vs. Linear:</strong> 99% of modern industrial PSUs are <strong>SMPS</strong>. They are highly efficient (85-95%), lightweight, compact, and accept a wide range of input voltages (e.g., 85-264VAC), making them globally compatible. Linear PSUs are simple and have very clean (low-noise) output, but are massive, heavy, inefficient (30-60%), and have fixed input taps.</li>
                    <li><strong>Redundancy (1+1 vs. N+1):</strong> For critical systems (like a plant's main DCS or ESD system), you can never have a single point of failure. <strong>1+1 Redundancy</strong> uses two identical PSUs, each capable of handling 100% of the load. Their outputs are combined using a "diode-or" or "redundancy module." If one PSU fails, the other takes the full load instantly with zero interruption.</li>
                    <li><strong>Environmental Rating:</strong> Where will the PSU live?
                        <ul>
                            <li><strong>Temperature:</strong> All PSUs have a "derating curve." A 5A PSU might only be a 4A PSU at 60°C. Check the datasheet!</li>
                            <li><strong>IP Rating:</strong> Is it in a clean panel (IP20) or a washdown area (IP67)?</li>
                            <li><strong>Hazardous Area:</strong> Does it need to be in an explosion-proof (Ex d) box or is it powering Intrinsically Safe (Ex i) devices via a barrier?</li>
                        </ul>
                    </li>
                    <li><strong>Protection Features:</strong> A good industrial PSU will have built-in protection for overload, short-circuit, and over-voltage. This is non-negotiable for protecting your expensive instruments.</li>
                </ul>
            </div>

            <div class="danger-box">
                <h4><i class="fas fa-exclamation-triangle"></i> Critical Installation & Safety Pitfalls</h4>
                <p>A perfectly sized PSU can be rendered useless by poor installation.</p>
                <ul>
                    <li><strong>Voltage Drop:</strong> This is the silent killer. You have a perfect 24.0V at the PSU, but after 200 meters of thin 0.5mm² wire, the transmitter only receives 19.5V and fails. You must calculate voltage drop ($V_{drop} = I \times R_{wire}$) for your longest, highest-current runs and ensure all devices receive their minimum required voltage. The fix is using thicker gauge wire.</li>
                    <li><strong>Grounding:</strong> This is a massive topic, but two rules are key: 1) The PSU chassis *must* be connected to protective earth (safety ground) to prevent shock. 2) The 0VDC (common) side of your 24VDC loop is often connected to this same earth at a *single point* to create a stable signal reference and prevent noise.</li>
                    <li><strong>Heat Dissipation:</strong> That 10W of heat from efficiency loss has to go somewhere. PSUs need to breathe. Follow the manufacturer's clearance specs (e.g., "2 inches above and below"). Do not pack them tightly between two cable ducts. Heat is the #1 killer of electronics.</li>
                    <li><strong>Circuit Protection:</strong> Each 24VDC circuit *leaving* the PSU should be individually protected by a fuse or circuit breaker. If a single transmitter shorts to ground, you want that one fuse to blow—not your main 5A PSU, which would shut down the entire panel.</li>
                </ul>
            </div>
        </div>
    </main>

    <!-- New Footer from file.txt -->
        <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-left">
                    <a href="/" class="footer-logo">
                        <img src="logo.png" alt="Design Calculators Logo" loading="lazy" decoding="async">
                        <span class="footer-logo-text">Design Calculators</span>
                    </a>
                    <p class="footer-description">A comprehensive engineering calculator hub based on IEC, IEEE, and
                        global standards.</p>
                    <div class="social-buttons">
                        <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://designcalculators.co.in"
                            target="_blank" rel="noopener noreferrer" class="social-btn linkedin"
                            aria-label="LinkedIn"><i class="fab fa-linkedin-in"></i></a>
                        <a href="https://www.youtube.com/@designcalculators" target="_blank" rel="noopener noreferrer"
                            class="social-btn youtube" aria-label="YouTube"><i class="fab fa-youtube"></i></a>
                        <a href="https://twitter.com/intent/tweet?url=https://designcalculators.co.in&text=Check%20out%20this%20amazing%20engineering%20calculator%20hub!"
                            target="_blank" rel="noopener noreferrer" class="social-btn twitter" aria-label="Twitter"><i
                                class="fab fa-twitter"></i></a>
                        <a href="https://www.facebook.com/sharer/sharer.php?u=https://designcalculators.co.in"
                            target="_blank" rel="noopener noreferrer" class="social-btn facebook"
                            aria-label="Facebook"><i class="fab fa-facebook-f"></i></a>
                        <a href="https://api.whatsapp.com/send?text=Check%20out%20this%20amazing%20engineering%20resource:%20https://designcalculators.co.in"
                            target="_blank" rel="noopener noreferrer" class="social-btn whatsapp"
                            aria-label="WhatsApp"><i class="fab fa-whatsapp"></i></a>
                    </div>
                </div>
                <div class="footer-right">
                    <div class="footer-col">
                        <h4>Quick Links</h4>
                        <ul>
                            <li><a href='/indexele.html'>Electrical Tools</a></li>
                            <li><a href='/indexmech.html'>Mechanical Tools</a></li>
                            <li><a href='/indexinst.html'>Instrumentation Tools</a></li>
                            <li><a href='/about.html'>About Us</a></li>
                            <li><a href='/faq.html'>FAQ</a></li>
                        </ul>
                    </div>
                    <div class="footer-col">
                        <h4>Learn More</h4>
                        <ul>
                            <li><a href="https://www.youtube.com/@designcalculators" target="_blank"
                                    rel="noopener noreferrer">YouTube Channel</a></li>
                            <li><a href='/contact.html'>Contact Us</a></li>
                            <li><a href='/privacy-policy.html'>Privacy Policy</a></li>
                            <li><a href='/terms-of-service.html'>Terms of Service</a></li>
                            <li><a href='/sitemap2.html'>Sitemap</a></li>
                        </ul>
                    </div>
                    <div class="footer-col">
                        <h4>Our Network</h4>
                        <ul>
                            <li style="margin-bottom: 12px;">
                                <a href="https://reliabilitytools.co.in/" target="_blank" rel="noopener"
                                   style="font-weight: 600; display: block; margin-bottom: 2px;">Reliability Tools</a>
                                <span style="font-size: 0.85rem; color: #94a3b8; line-height: 1.3; display: block;">Reliability
                                    & maintenance engineering calculators.</span>
                            </li>
                            <li style="margin-bottom: 12px;">
                                <a href="https://electrosafe.homes/" target="_blank" rel="noopener"
                                   style="font-weight: 600; display: block; margin-bottom: 2px;">ElectroSafe</a>
                                <span style="font-size: 0.85rem; color: #94a3b8; line-height: 1.3; display: block;">Dedicated
                                    to home electrical safety & protection.</span>
                            </li>
                            <li>
                                <a href="https://knowyourname.co.in/" target="_blank" rel="noopener"
                                   style="font-weight: 600; display: block; margin-bottom: 2px;">KnowYourName</a>
                                <span style="font-size: 0.85rem; color: #94a3b8; line-height: 1.3; display: block;">Scientific
                                    name analysis: Phonetics, Ergonomics & Acoustics.</span>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="footer-disclaimer">
                <p>All calculations are for preliminary engineering design guidance. Final designs must comply with all applicable local and international standards (including but not limited to ASHRAE 90.1, ARI 550/590). Always verify calculations and consult with a licensed professional engineer before implementation or construction.</p>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 Design Calculators. Created by <span style="color: var(--secondary); font-weight: bold;">Anil Sharma</span>. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <!-- Updated JavaScript -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // --- Form Elements ---
            const safetyFactorInput = document.getElementById('safety-factor');
            const powerSupplyVoltageInput = document.getElementById('power-supply-voltage');
            const psuEfficiencyInput = document.getElementById('psu-efficiency');
            const peakCurrentMultiplierInput = document.getElementById('peak-current-multiplier');
            const deviceListDiv = document.getElementById('device-list');
            const addDeviceBtn = document.getElementById('add-device-btn');
            
            const loadInputModeSelect = document.getElementById('load-input-mode');
            const perDeviceInputSection = document.getElementById('per-device-input-section');
            const totalPanelLoadInputSection = document.getElementById('total-panel-load-input-section');
            const totalLoadValueInput = document.getElementById('total-load-value');
            const totalLoadUnitSelect = document.getElementById('total-load-unit');

            // --- Button & Result Elements ---
            const calculateBtn = document.getElementById('calculate-btn');
            const resetFormBtn = document.getElementById('reset-form-btn');
            const clearResultsBtn = document.getElementById('clear-results-btn');
            
            const resultsSection = document.getElementById('results-section');
            const stepsContainer = document.getElementById('steps-container');
            const resultTableBody = document.getElementById('result-table-body');
            const loadStatusDisplay = document.getElementById('load-status-display');
            const dynamicRecommendationsDiv = document.getElementById('dynamic-recommendations');
            const recommendationsList = document.getElementById('recommendations-list');
            const messageBox = document.getElementById('message-box');

            let deviceCount = 1; // Start with 1 device already in the HTML

            // --- Default values for resetting form ---
            const defaultValues = {
                'safety-factor': 20,
                'power-supply-voltage': 24,
                'psu-efficiency': 85,
                'peak-current-multiplier': 1.2,
                'load-input-mode': 'per-device',
                'total-load-value': 100,
                'total-load-unit': 'W',
                'device-type-0': 'Transmitter',
                'operating-voltage-0': 24,
                'current-consumption-0': 20,
                'quantity-0': 1
            };

            // --- New showMessage function (from template) ---
            function showMessage(msg, type = 'success') {
                messageBox.textContent = msg;
                if (type === 'error') {
                    messageBox.style.backgroundColor = 'var(--danger)';
                    messageBox.style.color = 'white';
                } else if (type === 'warning') {
                    messageBox.style.backgroundColor = 'var(--warning)';
                    messageBox.style.color = '#333';
                } else {
                    messageBox.style.backgroundColor = 'var(--success)';
                    messageBox.style.color = 'white';
                }
                messageBox.classList.add('show');
                setTimeout(() => messageBox.classList.remove('show'), 4000);
            }

            // --- Helper function to add rows to the result table ---
            function addResultRow(parameter, value, statusClass = '') {
                const row = resultTableBody.insertRow();
                const paramCell = row.insertCell();
                const valueCell = row.insertCell();
                paramCell.innerHTML = parameter;
                valueCell.innerHTML = value;
                if (statusClass) {
                    valueCell.classList.add(statusClass);
                }
            }

            // --- Function to update visibility of input sections ---
            function updateLoadInputSectionVisibility() {
                if (loadInputModeSelect.value === 'per-device') {
                    perDeviceInputSection.style.display = 'block';
                    totalPanelLoadInputSection.style.display = 'none';
                    // Clear total load values
                    totalLoadValueInput.value = '';
                    totalLoadUnitSelect.value = defaultValues['total-load-unit'];
                } else {
                    perDeviceInputSection.style.display = 'none';
                    totalPanelLoadInputSection.style.display = 'block';
                    // Clear device list
                    while (deviceListDiv.children.length > 1) {
                        deviceListDiv.removeChild(deviceListDiv.lastChild);
                    }
                    resetFirstDevice();
                    deviceCount = 1;
                }
            }

            function resetFirstDevice() {
                const firstDeviceEntry = deviceListDiv.querySelector('.device-entry:first-child');
                if (firstDeviceEntry) {
                    firstDeviceEntry.querySelector('.device-type').value = defaultValues['device-type-0'];
                    firstDeviceEntry.querySelector('.operating-voltage').value = defaultValues['operating-voltage-0'];
                    firstDeviceEntry.querySelector('.current-consumption').value = defaultValues['current-consumption-0'];
                    firstDeviceEntry.querySelector('.quantity').value = defaultValues['quantity-0'];
                    firstDeviceEntry.querySelector('.remove-device-btn').style.display = 'none';
                }
            }

            // --- Function to add a new device entry ---
            function addDeviceEntry(initialValues = {}) {
                const newDeviceEntry = document.createElement('div');
                newDeviceEntry.className = 'device-entry';
                newDeviceEntry.innerHTML = `
                    <div class="form-group">
                        <label for="device-type-${deviceCount}">Device Type</label>
                        <select id="device-type-${deviceCount}" class="device-type" required>
                            <option value="Transmitter">Transmitter (4-20mA)</option>
                            <option value="Solenoid Valve">Solenoid Valve</option>
                            <option value="Positioner">Valve Positioner</option>
                            <option value="Indicator">Panel Indicator</option>
                            <option value="Actuator">Actuator</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="operating-voltage-${deviceCount}">Operating Voltage (V)</label>
                        <input type="number" id="operating-voltage-${deviceCount}" class="operating-voltage" step="any" min="0" value="${initialValues.operatingVoltage || 24}" required>
                    </div>
                    <div class="form-group">
                        <label for="current-consumption-${deviceCount}">Current Consumption (mA)</label>
                        <input type="number" id="current-consumption-${deviceCount}" class="current-consumption" step="any" min="0" value="${initialValues.currentConsumption || 20}" required>
                    </div>
                    <div class="form-group">
                        <label for="quantity-${deviceCount}">Quantity</label>
                        <input type="number" id="quantity-${deviceCount}" class="quantity" step="1" min="1" value="${initialValues.quantity || 1}" required>
                    </div>
                    <button type="button" class="remove-device-btn"><i class="fas fa-trash"></i></button>
                `;
                deviceListDiv.appendChild(newDeviceEntry);

                if (initialValues.deviceType) {
                    newDeviceEntry.querySelector('.device-type').value = initialValues.deviceType;
                }

                newDeviceEntry.querySelector('.remove-device-btn').addEventListener('click', function() {
                    newDeviceEntry.remove();
                    updateRemoveButtonVisibility();
                    showMessage('Device removed.', 'success');
                });

                updateRemoveButtonVisibility();
                deviceCount++;
            }

            function updateRemoveButtonVisibility() {
                const deviceEntries = deviceListDiv.querySelectorAll('.device-entry');
                deviceEntries.forEach((entry, index) => {
                    const removeBtn = entry.querySelector('.remove-device-btn');
                    if (deviceEntries.length > 1) {
                        removeBtn.style.display = 'inline-block';
                    } else {
                        removeBtn.style.display = 'none';
                    }
                });
            }

            // --- Clear Results Function ---
            function clearResults() {
                resultsSection.classList.add('hidden');
                stepsContainer.innerHTML = '';
                stepsContainer.classList.remove('active');
                resultTableBody.innerHTML = '';
                dynamicRecommendationsDiv.style.display = 'none';
                recommendationsList.innerHTML = '';
                loadStatusDisplay.textContent = 'Power Supply Load Status: N/A';
                loadStatusDisplay.className = 'status-display';
                showMessage("Results cleared.", "success");
            }

            // --- Reset Form Function ---
            function resetForm() {
                safetyFactorInput.value = defaultValues['safety-factor'];
                powerSupplyVoltageInput.value = defaultValues['power-supply-voltage'];
                psuEfficiencyInput.value = defaultValues['psu-efficiency'];
                peakCurrentMultiplierInput.value = defaultValues['peak-current-multiplier'];
                loadInputModeSelect.value = defaultValues['load-input-mode'];
                totalLoadValueInput.value = defaultValues['total-load-value'];
                totalLoadUnitSelect.value = defaultValues['total-load-unit'];

                while (deviceListDiv.children.length > 1) {
                    deviceListDiv.removeChild(deviceListDiv.lastChild);
                }
                
                resetFirstDevice();
                deviceCount = 1;
                updateLoadInputSectionVisibility();
                clearResults();
                showMessage("Form reset to default values.", "success");
            }
            
            // --- Event Listeners ---
            addDeviceBtn.addEventListener('click', () => addDeviceEntry());
            deviceListDiv.querySelector('.remove-device-btn').addEventListener('click', function() {
                if (deviceListDiv.children.length > 1) {
                    this.closest('.device-entry').remove();
                    updateRemoveButtonVisibility();
                    showMessage('Device removed.', 'success');
                }
            });
            
            loadInputModeSelect.addEventListener('change', updateLoadInputSectionVisibility);
            calculateBtn.addEventListener('click', calculateLoad);
            resetFormBtn.addEventListener('click', resetForm);
            clearResultsBtn.addEventListener('click', clearResults);

            // --- Main Calculation Function ---
            function calculateLoad() {
                clearResults(); // Clear previous results, but keep message
                
                const safetyFactor = parseFloat(safetyFactorInput.value);
                const nominalSupplyVoltage = parseFloat(powerSupplyVoltageInput.value);
                const psuEfficiency = parseFloat(psuEfficiencyInput.value);
                const peakCurrentMultiplier = parseFloat(peakCurrentMultiplierInput.value);

                let totalCurrent_mA = 0;
                let totalPower_W = 0;
                let validationError = false;
                let stepsHtml = '';

                // --- Input Validation ---
                if (isNaN(safetyFactor) || safetyFactor < 0) {
                    showMessage('Safety Factor must be a non-negative number.', 'error'); return;
                }
                if (isNaN(nominalSupplyVoltage) || nominalSupplyVoltage <= 0) {
                    showMessage('Nominal Power Supply Voltage must be a positive number.', 'error'); return;
                }
                if (isNaN(psuEfficiency) || psuEfficiency <= 0 || psuEfficiency > 100) {
                    showMessage('Power Supply Efficiency must be between 1 and 100.', 'error'); return;
                }
                if (isNaN(peakCurrentMultiplier) || peakCurrentMultiplier < 1) {
                    showMessage('Peak Current Multiplier must be 1 or greater.', 'error'); return;
                }
                
                // --- Step 1: Global Parameters ---
                stepsHtml += `<div class="step-card">
                    <h4><span class="number">1</span>Global System Parameters</h4>
                    <div class="step-content">
                        <div class="step-explanation">
                            <p>These are the core parameters for the entire power supply calculation.</p>
                            <p class="calculation-step">Nominal Voltage (V<sub>nominal</sub>): ${nominalSupplyVoltage.toFixed(2)} V</p>
                            <p class="calculation-step">Safety Factor: ${safetyFactor.toFixed(1)} %</p>
                            <p class="calculation-step">PSU Efficiency (η): ${psuEfficiency.toFixed(1)} %</p>
                            <p class="calculation-step">Peak Multiplier: ${peakCurrentMultiplier.toFixed(2)}x</p>
                        </div>
                        <div class="formula-block">
                            <p>These values will be used to derive the final PSU rating from the base load.</p>
                        </div>
                    </div>
                </div>`;

                let deviceCalcsHtml = '';
                
                // --- Step 2: Calculate Base Load ---
                if (loadInputModeSelect.value === 'per-device') {
                    const deviceEntries = deviceListDiv.querySelectorAll('.device-entry');
                    if (deviceEntries.length === 0) {
                        showMessage('Please add at least one device.', 'error'); return;
                    }
                    
                    deviceEntries.forEach((entry, index) => {
                        const deviceType = entry.querySelector('.device-type').value;
                        const operatingVoltage = parseFloat(entry.querySelector('.operating-voltage').value);
                        const currentConsumption = parseFloat(entry.querySelector('.current-consumption').value);
                        const quantity = parseInt(entry.querySelector('.quantity').value);

                        if (isNaN(operatingVoltage) || operatingVoltage <= 0) {
                            showMessage(`Device ${index + 1}: Operating Voltage must be positive.`, 'error'); validationError = true;
                        }
                        if (isNaN(currentConsumption) || currentConsumption < 0) {
                            showMessage(`Device ${index + 1}: Current Consumption must be non-negative.`, 'error'); validationError = true;
                        }
                        if (isNaN(quantity) || quantity <= 0 || !Number.isInteger(quantity)) {
                            showMessage(`Device ${index + 1}: Quantity must be a positive integer.`, 'error'); validationError = true;
                        }
                        if (validationError) return;

                        const deviceCurrent_mA = currentConsumption * quantity;
                        const devicePower_W = (operatingVoltage * deviceCurrent_mA) / 1000;
                        totalCurrent_mA += deviceCurrent_mA;
                        totalPower_W += devicePower_W;

                        deviceCalcsHtml += `<p class="calculation-step">Device ${index + 1} (${deviceType}) x ${quantity}:<br>` +
                                           `  Current: ${currentConsumption.toFixed(2)} mA/ea * ${quantity} = ${deviceCurrent_mA.toFixed(2)} mA<br>` +
                                           `  Power: (${operatingVoltage.toFixed(2)} V * ${deviceCurrent_mA.toFixed(2)} mA) / 1000 = ${devicePower_W.toFixed(2)} W</p>`;
                    });

                    if (validationError) return;

                    stepsHtml += `<div class="step-card">
                        <h4><span class="number">2</span>Calculate Total Base Load (Per-Device)</h4>
                        <div class="step-content">
                            <div class="step-explanation">
                                <p>Summing the power and current for all listed devices at their specified operating voltage.</p>
                                ${deviceCalcsHtml}
                            </div>
                            <div class="formula-block">
                                <p><strong>Formulas:</strong></p>
                                <p class="formula">$$I_{device} = I_{ea} \times Qty$$</p>
                                <p class="formula">$$P_{device} = \frac{V_{op} \times I_{device}}{1000}$$</p>
                                <p class="formula">$$I_{base} = \sum I_{device}$$</p>
                                <p class="formula">$$P_{base} = \sum P_{device}$$</p>
                                <p><strong>Total Base Current (I<sub>base</sub>):</strong></p>
                                <div class="step-value" style="font-size: 1.5rem;">${totalCurrent_mA.toFixed(2)}<span class="step-unit">mA</span></div>
                                <p><strong>Total Base Power (P<sub>base</sub>):</strong></p>
                                <div class="step-value" style="font-size: 1.5rem;">${totalPower_W.toFixed(2)}<span class="step-unit">W</span></div>
                            </div>
                        </div>
                    </div>`;

                } else { // 'total-panel-load'
                    const totalLoadValue = parseFloat(totalLoadValueInput.value);
                    const totalLoadUnit = totalLoadUnitSelect.value;
                    if (isNaN(totalLoadValue) || totalLoadValue < 0) {
                        showMessage('Total Load Value must be non-negative.', 'error'); return;
                    }

                    switch (totalLoadUnit) {
                        case 'W':
                            totalPower_W = totalLoadValue;
                            totalCurrent_mA = (totalPower_W / nominalSupplyVoltage) * 1000;
                            deviceCalcsHtml = `<p class="calculation-step">Input is ${totalPower_W.toFixed(2)} W.<br>Current is derived: ${totalPower_W.toFixed(2)} W / ${nominalSupplyVoltage.toFixed(2)} V = ${totalCurrent_mA.toFixed(0)} mA</p>`;
                            break;
                        case 'VA':
                            totalPower_W = totalLoadValue; // Assume PF=1 for DC
                            totalCurrent_mA = (totalPower_W / nominalSupplyVoltage) * 1000;
                            deviceCalcsHtml = `<p class="calculation-step">Input is ${totalLoadValue.toFixed(2)} VA. Assuming PF=1 for DC, P<sub>base</sub> = ${totalPower_W.toFixed(2)} W.<br>Current is derived: ${totalPower_W.toFixed(2)} W / ${nominalSupplyVoltage.toFixed(2)} V = ${totalCurrent_mA.toFixed(0)} mA</p>`;
                            break;
                        case 'A':
                            totalCurrent_mA = totalLoadValue * 1000;
                            totalPower_W = (nominalSupplyVoltage * totalCurrent_mA) / 1000;
                            deviceCalcsHtml = `<p class="calculation-step">Input is ${totalLoadValue.toFixed(2)} A (${totalCurrent_mA.toFixed(0)} mA).<br>Power is derived: ${nominalSupplyVoltage.toFixed(2)} V * ${totalLoadValue.toFixed(2)} A = ${totalPower_W.toFixed(2)} W</p>`;
                            break;
                    }

                    stepsHtml += `<div class="step-card">
                        <h4><span class="number">2</span>Calculate Total Base Load (Panel Total)</h4>
                        <div class="step-content">
                            <div class="step-explanation">
                                <p>Calculating base power and current from the total panel load input.</p>
                                ${deviceCalcsHtml}
                            </div>
                            <div class="formula-block">
                                <p><strong>Total Base Current (I<sub>base</sub>):</strong></p>
                                <div class="step-value" style="font-size: 1.5rem;">${totalCurrent_mA.toFixed(2)}<span class="step-unit">mA</span></div>
                                <p><strong>Total Base Power (P<sub>base</sub>):</strong></p>
                                <div class="step-value" style="font-size: 1.5rem;">${totalPower_W.toFixed(2)}<span class="step-unit">W</span></div>
                            </div>
                        </div>
                    </div>`;
                }
                
                // --- Step 3: Apply Safety Factor ---
                const safetyFactorDecimal = safetyFactor / 100;
                const totalCurrentWithSafety_mA = totalCurrent_mA * (1 + safetyFactorDecimal);
                const totalPowerWithSafety_W = totalPower_W * (1 + safetyFactorDecimal);

                stepsHtml += `<div class="step-card">
                    <h4><span class="number">3</span>Apply Safety & Future-Proofing Factor</h4>
                    <div class="step-content">
                        <div class="step-explanation">
                            <p>The base load is increased by the ${safetyFactor.toFixed(1)}% safety factor to account for future expansion, unknowns, and to ensure the PSU does not run at 100% capacity, which improves longevity.</p>
                            <p class="calculation-step">Required Current = ${totalCurrent_mA.toFixed(2)} mA * (1 + ${safetyFactorDecimal.toFixed(2)})</p>
                            <p class="calculation-step">Required Power = ${totalPower_W.toFixed(2)} W * (1 + ${safetyFactorDecimal.toFixed(2)})</p>
                        </div>
                        <div class="formula-block">
                            <p><strong>Required Output Current (I<sub>req</sub>):</strong></p>
                            <div class="step-value">${totalCurrentWithSafety_mA.toFixed(2)}<span class="step-unit">mA</span></div>
                            <p><strong>Required Output Power (P<sub>req</sub>):</strong></p>
                            <div class="step-value">${totalPowerWithSafety_W.toFixed(2)}<span class="step-unit">W</span></div>
                        </div>
                    </div>
                </div>`;

                // --- Step 4: Calculate Recommended PSU Rating (Output) ---
                const recommendedContinuousCurrent_A = totalCurrentWithSafety_mA / 1000;
                const recommendedPeakCurrent_A = recommendedContinuousCurrent_A * peakCurrentMultiplier;

                stepsHtml += `<div class="step-card">
                    <h4><span class="number">4</span>Recommended PSU Output Rating</h4>
                    <div class="step-content">
                        <div class="step-explanation">
                            <p>This is the <strong>continuous output rating</strong> your PSU should have, at minimum. The peak rating provides a buffer for inrush currents.</p>
                            <p class="calculation-step">Continuous Current = ${totalCurrentWithSafety_mA.toFixed(2)} mA / 1000</p>
                            <p class="calculation-step">Peak Current = ${recommendedContinuousCurrent_A.toFixed(2)} A * ${peakCurrentMultiplier.toFixed(2)}</p>
                        </div>
                        <div class="formula-block">
                            <p><strong>Recommended Continuous Current:</strong></p>
                            <div class="step-value">${recommendedContinuousCurrent_A.toFixed(2)}<span class="step-unit">A</span></div>
                            <p><strong>Recommended Peak Current:</strong></p>
                            <div class="step-value">${recommendedPeakCurrent_A.toFixed(2)}<span class="step-unit">A</span></div>
                        </div>
                    </div>
                </div>`;

                // --- Step 5: Calculate Required PSU Input Power ---
                const psuEfficiencyDecimal = psuEfficiency / 100;
                const requiredInputPower_W = totalPowerWithSafety_W / psuEfficiencyDecimal;
                // Assuming AC input, e.g., 120V
                const requiredInputCurrent_120V_A = requiredInputPower_W / 120;
                // Assuming AC input, e.g., 230V
                const requiredInputCurrent_230V_A = requiredInputPower_W / 230;

                stepsHtml += `<div class="step-card">
                    <h4><span class="number">5</span>Required PSU Input Power (Wall Draw)</h4>
                    <div class="step-content">
                        <div class="step-explanation">
                            <p>This is the power the PSU will draw from the wall (e.g., 120/230VAC), accounting for its ${psuEfficiency.toFixed(1)}% efficiency. This value is used for sizing the upstream breaker and for thermal load (heat) calculations.</p>
                            <p class="calculation-step">Input Power = ${totalPowerWithSafety_W.toFixed(2)} W / ${psuEfficiencyDecimal.toFixed(2)}</p>
                        </div>
                        <div class="formula-block">
                            <p><strong>Required Input Power (P<sub>in</sub>):</strong></p>
                            <div class="step-value">${requiredInputPower_W.toFixed(2)}<span class="step-unit">W</span></div>
                            <p><strong>Est. Input Current @ 120VAC:</strong> ${requiredInputCurrent_120V_A.toFixed(2)} A</p>
                            <p><strong>Est. Input Current @ 230VAC:</strong> ${requiredInputCurrent_230V_A.toFixed(2)} A</p>
                        </div>
                    </div>
                </div>`;
                
                // --- Show Step-by-Step ---
                stepsContainer.innerHTML = stepsHtml;
                stepsContainer.classList.add('active');

                // --- Populate Summary Table ---
                resultTableBody.innerHTML = '';
                addResultRow(`<strong>Recommended PSU Continuous Rating</strong>`, `<strong>${recommendedContinuousCurrent_A.toFixed(2)} A @ ${nominalSupplyVoltage.toFixed(1)} VDC</strong>`, "highlight");
                addResultRow(`<strong>Recommended PSU Peak Rating</strong>`, `<strong>${recommendedPeakCurrent_A.toFixed(2)} A @ ${nominalSupplyVoltage.toFixed(1)} VDC</strong>`, "highlight");
                addResultRow(`Total Required Output Power (with Safety Factor)`, `${totalPowerWithSafety_W.toFixed(2)} W`);
                addResultRow(`Total Required Output Current (with Safety Factor)`, `${totalCurrentWithSafety_mA.toFixed(2)} mA`);
                addResultRow(`Total Base Load (Power)`, `${totalPower_W.toFixed(2)} W`);
                addResultRow(`Total Base Load (Current)`, `${totalCurrent_mA.toFixed(2)} mA`);
                addResultRow(`Total Required Input Power (Wall Draw)`, `${requiredInputPower_W.toFixed(2)} W`);
                addResultRow(`Safety Factor`, `${safetyFactor.toFixed(1)} %`);
                addResultRow(`PSU Efficiency`, `${psuEfficiency.toFixed(1)} %`);

                // --- Update Status Display and Dynamic Recommendations ---
                let statusText = 'Power Supply Load Status: ';
                let statusClass = 'status-display ';
                let recommendations = [];

                if (recommendedContinuousCurrent_A < 0.5) {
                    statusText += 'Optimal (Very Low Load)';
                    statusClass += 'optimal';
                    recommendations.push("Load is very low. A standard small power supply (e.g., 1-2A) is sufficient. Ensure PSU minimum load requirements are met.");
                } else if (recommendedContinuousCurrent_A <= 2) {
                    statusText += 'Sufficient (Low Load)';
                    statusClass += 'sufficient';
                    recommendations.push("Load is low. A 2A or 3A power supply provides a healthy margin.");
                } else if (recommendedContinuousCurrent_A <= 4) {
                    statusText += 'Adequate (Medium Load)';
                    statusClass += 'adequate';
                    recommendations.push("This is a standard load. A 5A PSU is recommended to provide ample room for inrush and future additions.");
                } else if (recommendedContinuousCurrent_A <= 8) {
                    statusText += 'Marginal (High Load)';
                    statusClass += 'marginal';
                    recommendations.push("Load is high. A 10A PSU is recommended. Pay close attention to wire sizing for voltage drop.");
                    recommendations.push("Consider if the load can be split across two 5A PSUs for better load distribution and potential redundancy.");
                } else { // > 8A
                    statusText += 'Insufficient (Very High Load)';
                    statusClass += 'insufficient';
                    recommendations.push("Load is very high. A single 10A PSU is insufficient. Strongly consider splitting the load across multiple PSUs (e.g., two 10A or a 20A unit).");
                    recommendations.push("Verify all device current consumptions. High loads require careful panel layout for heat dissipation.");
                    recommendations.push("Redundancy (1+1) is highly recommended for such a critical load.");
                }

                recommendations.push(`Select a PSU rated for <strong>${recommendedContinuousCurrent_A.toFixed(2)} A continuous</strong> and <strong>${recommendedPeakCurrent_A.toFixed(2)} A peak</strong>, at minimum.`);
                recommendations.push(`Always check the manufacturer's datasheet for temperature derating curves.`);
                
                recommendationsList.innerHTML = '';
                recommendations.forEach(rec => {
                    const li = document.createElement('li');
                    li.innerHTML = rec;
                    recommendationsList.appendChild(li);
                });
                dynamicRecommendationsDiv.style.display = 'block';

                loadStatusDisplay.textContent = statusText;
                loadStatusDisplay.className = statusClass;

                // --- Show Results ---
                resultsSection.classList.remove('hidden');
                
                // Typeset MathJax
                if (window.MathJax && typeof window.MathJax.typesetPromise === 'function') {
                    setTimeout(() => {
                        window.MathJax.typesetPromise([stepsContainer, document.getElementById('education-section')]);
                    }, 50); 
                }

                setTimeout(() => {
                    stepsContainer.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }, 100);
            }
            
            // --- Theme switch logic (from new file) ---
            const themeSwitch = document.getElementById('theme-switch');
            if (themeSwitch) {
                if (localStorage.getItem('theme') === 'dark') {
                    document.body.classList.add('dark-mode');
                    themeSwitch.checked = true;
                }
                themeSwitch.addEventListener('change', function() {
                    if (this.checked) {
                        document.body.classList.add('dark-mode');
                        localStorage.setItem('theme', 'dark');
                    } else {
                        document.body.classList.remove('dark-mode');
                        localStorage.setItem('theme', 'light');
                    }
                });
            }

            // --- Initial setup calls ---
            updateLoadInputSectionVisibility();
            updateRemoveButtonVisibility();
            
            // Initial fade-in for form sections
            const formSections = document.querySelectorAll('.form-section');
            formSections.forEach((section, index) => {
                setTimeout(() => {
                    section.classList.add('fade-in');
                }, 100 * index); // Staggered fade-in
            });
        });
    </script>
</body>
</html>

