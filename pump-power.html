<!DOCTYPE html>
<html lang="en">
<head>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-23Y1V450SR"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-23Y1V450SR');
</script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5936527763614780"
     crossorigin="anonymous"></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pump Power Calculator - Design Calculators - Mechanical</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- MathJax for LaTeX rendering -->
    <script type="text/javascript" id="MathJax-script" async
            src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
    </script>
    <script>
        // MathJax configuration to support inline and display LaTeX
        MathJax = {
            tex: {
                inlineMath: [['\\(', '\\)']],
                displayMath: [['\\[', '\\]']],
                processEscapes: true
            }
        };
    </script>
    <style>
        /* CSS Variables for theming (light and dark mode) */
        :root {
            --primary-color: #2196F3;
            --secondary-color: #1976D2;
            --accent-color: #FFC107;
            --bg-color: #f4f7f6;
            --card-bg: #ffffff;
            --text-color: #333333;
            --header-bg: #2C3E50;
            --footer-bg: #34495E;
            --border-color: #cccccc;
            --card-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
            --hover-color: #e2e6ea;
            --primary-color-rgb: 33, 150, 243;
            --success-color: #28a745;
            --error-color: #dc3545;
        }
        /* Dark mode overrides */
        body.dark-mode {
            --primary-color: #5DADE2;
            --secondary-color: #2874A6;
            --bg-color: #252D3A;
            --card-bg: #2F3C4C;
            --text-color: #E0E6EB;
            --header-bg: #252D3A;
            --footer-bg: #252D3A;
            --border-color: #4C5C70;
            --card-shadow: 0 6px 12px rgba(0, 0, 0, 0.4);
            --hover-color: #3A475C;
            --primary-color-rgb: 93, 173, 226;
            --success-color: #4CAF50;
            --error-color: #F44336;
        }
        /* Base body styling */
        body {
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding: 0;
            background-color: var(--bg-color);
            background-image: radial-gradient(circle at center, var(--bg-color) 0%, rgba(244, 247, 246, 0.8) 100%);
            color: var(--text-color);
            line-height: 1.6;
            transition: background-color 0.3s, color 0.3s, background-image 0.3s;
        }
        /* Container for content width limitation and centering */
        .container {
            max-width: 960px;
            margin: 0 auto;
            padding: 20px;
        }
        /* Header styling */
        header {
            background-color: var(--header-bg);
            color: white;
            padding: 25px 0;
            text-align: center;
            box-shadow: var(--card-shadow);
            position: relative;
        }
        header h1 {
            margin: 0;
            font-size: 2.8em;
            color: var(--primary-color);
            text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
        }
        header .subtitle {
            margin: 8px 0 0;
            font-size: 1.1em;
            color: #bdc3c7;
        }
        /* Main content area styling */
        main {
            padding: 30px 0;
        }
        /* Tool container styling */
        .tool-container {
            background-color: var(--card-bg);
            border-radius: 12px;
            padding: 30px;
            box-shadow: var(--card-shadow);
            margin-bottom: 25px;
            transition: transform 0.3s ease-in-out;
        }
        .tool-container:hover {
            transform: translateY(-5px);
        }
        .tool-container h2 {
            color: var(--primary-color);
            border-bottom: 2px solid var(--primary-color);
            padding-bottom: 12px;
            margin-top: 0;
            margin-bottom: 25px;
            font-size: 2em;
        }
        .tool-description {
            margin-bottom: 25px;
            color: var(--text-color);
            font-size: 1.05em;
        }
        .tool-description ul {
            list-style-type: disc;
            margin-left: 25px;
            padding-left: 0;
            margin-top: 15px;
        }
        .tool-description ul li {
            margin-bottom: 8px;
        }
        .tool-description strong {
            color: var(--primary-color);
        }
        /* Back button styling */
        .back-button {
            display: inline-block;
            background-color: var(--primary-color);
            color: white;
            padding: 12px 20px;
            border-radius: 8px;
            text-decoration: none;
            margin-bottom: 25px;
            transition: background-color 0.3s, transform 0.2s ease-in-out;
            font-weight: bold;
        }
        .back-button:hover {
            background-color: var(--secondary-color);
            transform: scale(1.03);
        }
        /* Theme toggle switch styling */
        .theme-toggle {
            position: absolute;
            top: 25px;
            right: 25px;
            display: flex;
            align-items: center;
        }
        .theme-toggle .light-icon,
        .theme-toggle .dark-icon {
            color: white;
            margin: 0 8px;
            font-size: 1.3em;
        }
        .switch {
            position: relative;
            display: inline-block;
            width: 65px;
            height: 38px;
        }
        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
        }
        .slider:before {
            position: absolute;
            content: "";
            height: 30px;
            width: 30px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
        }
        input:checked + .slider {
            background-color: var(--primary-color);
        }
        input:focus + .slider {
            box-shadow: 0 0 1px var(--primary-color);
        }
        input:checked + .slider:before {
            transform: translateX(27px);
        }
        .slider.round {
            border-radius: 38px;
        }
        .slider.round:before {
            border-radius: 50%;
        }
        /* Footer styling */
        footer {
            background-color: var(--footer-bg);
            color: white;
            padding: 25px 0;
            text-align: center;
            box-shadow: 0 -3px 10px rgba(0, 0, 0, 0.2);
            margin-top: 40px;
        }
        footer .disclaimer h3,
        footer .social-share h3 {
            color: var(--primary-color);
            margin-bottom: 12px;
            font-size: 1.3em;
        }
        footer .disclaimer p {
            font-size: 0.95em;
            color: #bdc3c7;
        }
        .social-buttons {
            margin-top: 20px;
            display: flex;
            justify-content: center;
            gap: 15px;
        }
        .social-btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 45px;
            height: 45px;
            border-radius: 50%;
            color: white;
            text-decoration: none;
            font-size: 1.4em;
            transition: transform 0.3s ease-in-out, box-shadow 0.3s ease-in-out;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        .social-btn:hover {
            transform: translateY(-5px) scale(1.1);
            box-shadow: 0 8px 15px rgba(0,0,0,0.3);
        }
        /* Specific social button colors */
        .social-btn.linkedin { background-color: #0A66C2; }
        .social-btn.facebook { background-color: #1877F2; }
        .social-btn.twitter { background-color: #1DA1F2; }
        .social-btn.whatsapp { background-color: #25D366; }
        .social-btn.reddit { background-color: #FF4500; }
        .social-btn.email { background-color: #7f8c8d; }
        /* Calculator form styling */
        .calculator-form {
            background-color: var(--card-bg);
            border-radius: 12px;
            padding: 30px;
            margin-top: 25px;
            box-shadow: var(--card-shadow);
        }
        .form-group {
            margin-bottom: 20px;
        }
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            font-size: 1.05em;
        }
        .form-group input, .form-group select {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            background-color: var(--bg-color);
            color: var(--text-color);
            box-sizing: border-box;
            font-size: 1em;
            transition: border-color 0.3s, box-shadow 0.3s;
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.08);
        }
        .form-group input:focus, .form-group select:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(var(--primary-color-rgb), 0.3);
            outline: none;
        }
        /* Responsive form row layout */
        .form-row {
            display: flex;
            gap: 20px;
            flex-wrap: wrap; /* Allows items to wrap on smaller screens */
        }
        .form-row .form-group {
            flex: 1 1 calc(50% - 10px); /* Two columns, with gap */
            min-width: 280px; /* Minimum width before wrapping */
        }
        /* Media query for single column on small screens */
        @media (max-width: 600px) {
            .form-row .form-group {
                flex: 1 1 100%; /* Single column */
            }
        }
        /* Calculate button styling */
        .calculate-btn {
            background-image: linear-gradient(to right, var(--primary-color), var(--secondary-color));
            color: white;
            border: none;
            padding: 18px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 17px;
            font-weight: bold;
            margin-top: 20px;
            transition: background-image 0.3s ease-in-out, transform 0.2s ease-in-out, box-shadow 0.3s ease-in-out;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            width: 100%; /* Full width button */
        }
        .calculate-btn:hover {
            background-image: linear-gradient(to right, var(--secondary-color), var(--primary-color));
            transform: translateY(-3px) scale(1.02);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
        }
        /* Result container styling */
        .result-container {
            margin-top: 40px;
            padding: 30px;
            border-radius: 12px;
            background-color: var(--card-bg);
            box-shadow: var(--card-shadow);
            display: block; /* Always block, but opacity controls visibility */
            opacity: 0;
            transition: opacity 0.6s ease-out;
            pointer-events: none; /* Prevents interaction when hidden */
        }
        .result-container.show {
            opacity: 1;
            pointer-events: auto; /* Allows interaction when shown */
        }
        .result-container h3 {
            color: var(--primary-color);
            margin-bottom: 20px;
            font-size: 1.8em;
        }
        /* Result table styling */
        .result-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        .result-table th, .result-table td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
        }
        .result-table th {
            background-color: var(--hover-color);
            font-weight: bold;
            font-size: 1.1em;
        }
        .result-table tr:last-child td {
            border-bottom: none;
        }
        /* Standard reference text styling */
        .standard-reference {
            margin-top: 25px;
            font-style: italic;
            font-size: 0.95rem;
            line-height: 1.5;
            padding: 10px;
            background-color: var(--bg-color);
            border-radius: 8px;
            border: 1px solid var(--border-color);
        }
        /* Tooltip styling */
        .info-icon {
            color: var(--primary-color);
            margin-left: 8px;
            cursor: help;
            font-size: 1em;
        }
        .tooltip {
            position: relative;
            display: inline-block;
        }
        .tooltip .tooltiptext {
            visibility: hidden;
            width: 220px;
            background-color: #333;
            color: #fff;
            text-align: center;
            border-radius: 8px;
            padding: 8px;
            position: absolute;
            z-index: 1;
            bottom: 125%; /* Position above the element */
            left: 50%;
            margin-left: -110px; /* Center the tooltip */
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 0.85em;
        }
        .tooltip .tooltiptext::after {
            content: "";
            position: absolute;
            top: 100%; /* Arrow at the bottom */
            left: 50%;
            margin-left: -5px;
            border-width: 5px;
            border-style: solid;
            border-color: #333 transparent transparent transparent;
        }
        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }
        /* Custom message box for alerts */
        #custom-message-box {
            position: fixed;
            top: 30px;
            left: 50%;
            transform: translateX(-50%);
            padding: 18px 30px;
            border-radius: 10px;
            box-shadow: 0 6px 15px rgba(0,0,0,0.3);
            z-index: 1000;
            font-weight: bold;
            color: white;
            opacity: 0;
            transition: opacity 0.5s ease-in-out, background-color 0.3s;
            font-size: 1.1em;
        }
        #custom-message-box.info {
            background-color: var(--success-color);
        }
        #custom-message-box.error {
            background-color: var(--error-color);
        }
        #custom-message-box.warning {
            background-color: var(--accent-color);
            color: #333;
        }

        /* Calculation details section styling */
        #calculation-details {
            background-color: var(--bg-color);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 25px;
            font-size: 0.98em;
            overflow-x: auto; /* Allow horizontal scrolling for formulas if needed */
        }
        #calculation-details h4 {
            color: var(--secondary-color);
            margin-top: 0;
            margin-bottom: 15px;
            font-size: 1.3em;
        }
        #calculation-details p.formula {
            font-family: 'Times New Roman', serif;
            font-style: italic;
            font-size: 1.2em;
            text-align: center;
            padding: 12px 0;
            background-color: var(--hover-color);
            border-radius: 6px;
            margin: 15px 0;
            border: 1px dashed var(--border-color);
            white-space: nowrap; /* Prevent formula from wrapping */
        }
        #calculation-details p.calculation-step {
            font-family: 'Courier New', monospace;
            background-color: var(--hover-color);
            padding: 8px 12px;
            border-radius: 5px;
            margin-bottom: 8px;
            font-size: 0.95em;
            white-space: nowrap; /* Prevent calculation steps from wrapping */
        }
        #calculation-details ul {
            list-style-type: disc;
            margin-left: 25px;
            padding-left: 0;
        }
        #calculation-details ul li {
            margin-bottom: 5px;
        }
        /* Specific styling for required inputs to highlight visually */
        input:required:invalid {
            border-color: var(--error-color);
        }
        input:required:valid {
            border-color: var(--success-color);
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <h1>Design Calculators - Mechanical</h1>
            <p class="subtitle">Smart Tools for Modern Mechanical Engineers</p>
            <div class="theme-toggle">
                <span class="light-icon"><i class="fas fa-sun"></i></span>
                <label class="switch">
                    <input type="checkbox" id="theme-switch">
                    <span class="slider round"></span>
                </label>
                <span class="dark-icon"><i class="fas fa-moon"></i></span>
            </div>
        </div>
    </header>

    <main class="container">
        <!-- Back to Tools link -->
        <a href="indexMech.html" class="back-button">
            <i class="fas fa-arrow-left"></i> Back to Tools
        </a>

        <div class="tool-container">
            <h2>Pump Power Calculator</h2>
            <div class="tool-description">
                <p>This calculator determines the hydraulic power (water power) and the brake horsepower (input power) required for a pump, based on fluid flow rate, total head, fluid density, and pump efficiency.</p>
                <p><strong>Key Inputs:</strong></p>
                <ul>
                    <li><strong>Unit System:</strong> Select Metric (m&#179;/hr, m, kg/m&#179;, kW) or Imperial (GPM, ft, lb/ft&#179;, HP).</li>
                    <li><strong>Flow Rate (\(Q\)):</strong> The volumetric flow rate of the fluid being pumped.</li>
                    <li><strong>Total Head (\(H\)):</strong> The total equivalent height the fluid is lifted, including elevation, pressure, and friction losses.</li>
                    <li><strong>Fluid Density (\(\rho\)):</strong> The mass density of the fluid.</li>
                    <li><strong>Pump Efficiency (\(\eta\)):</strong> The overall efficiency of the pump, typically given as a percentage.</li>
                </ul>
                <p><strong>Calculated Outputs:</strong></p>
                <ul>
                    <li><strong>Hydraulic Power (\(P_{hyd}\) / Water Power):</strong> The power actually imparted to the fluid.</li>
                    <li><strong>Brake Horsepower (\(P_{bhp}\) / Input Power):</strong> The mechanical power required at the pump shaft, accounting for pump inefficiencies.</li>
                </ul>
            </div>

            <div class="calculator-form">
                <form id="pump-power-form">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="unit-system">Unit System: <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Select Metric (m&#179;/hr, m, kg/m&#179;, kW) or Imperial (GPM, ft, lb/ft&#179;, HP) units.</span></span></label>
                            <select id="unit-system" required>
                                <option value="metric">Metric (m&#179;/hr, m, kg/m&#179;, kW)</option>
                                <option value="imperial">Imperial (GPM, ft, lb/ft&#179;, HP)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="flow-rate">Flow Rate (\(Q\)) <span class="flow-unit-label">(m&#179;/hr)</span>: <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">The volume of fluid moved per unit time.</span></span></label>
                            <input type="number" id="flow-rate" step="any" value="10" required min="0.01">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="total-head">Total Head (\(H\)) <span class="head-unit-label">(m)</span>: <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">The total energy per unit weight of fluid. Includes elevation, pressure, and friction head.</span></span></label>
                            <input type="number" id="total-head" step="any" value="20" required min="0.01">
                        </div>
                        <div class="form-group">
                            <label for="fluid-density">Fluid Density (\(\rho\)) <span class="density-unit-label">(kg/m&#179;)</span>: <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Mass per unit volume of the fluid (e.g., Water is 1000 kg/m&#179; or 62.4 lb/ft&#179;).</span></span></label>
                            <input type="number" id="fluid-density" step="any" value="1000" required min="0.01">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="pump-efficiency">Pump Efficiency (\(\eta\)) (%): <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">The ratio of hydraulic power output to mechanical power input, as a percentage (e.g., 75 for 75%).</span></span></label>
                        <input type="number" id="pump-efficiency" step="any" value="75" required min="1" max="100">
                    </div>

                    <button type="button" id="calculate-pump-power-btn" class="calculate-btn">Calculate Pump Power</button>
                </form>
            </div>

            <div id="result-container" class="result-container">
                <h3>Calculation Results</h3>
                <div id="calculation-details"></div>
                <table class="result-table">
                    <thead>
                        <tr>
                            <th>Parameter</th>
                            <th>Value</th>
                        </tr>
                    </thead>
                    <tbody id="result-table-body"></tbody>
                </table>
                <div class="standard-reference" id="standard-reference"></div>
            </div>
        </div>
    </main>

    <footer>
        <div class="container">
            <div class="disclaimer">
                <h3>Disclaimer</h3>
                <p>This tool provides theoretical calculations for pump power based on fundamental fluid dynamics principles. It simplifies the actual complexities involved in pump sizing and selection.</p>
                <p><strong>It does NOT account for:</strong> Specific pump curves, NPSH requirements, cavitation, viscosity effects, fluid non-idealities, variations in efficiency with operating point, motor efficiency, or system transient conditions.</p>
                <p>For accurate design, selection, and safety in real-world applications, it is <strong>imperative</strong> to consult pump manufacturer's data, comprehensive fluid mechanics handbooks, specialized pump selection software, and qualified mechanical or hydraulic engineers. This tool is for preliminary estimation and educational purposes only.</p>
            </div>
            <div class="credit">
                <p>Created by A Sharma</p>
            </div>
            <div class="social-share">
                <h3>Share This Site</h3>
                <div class="social-buttons">
                    <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://designcalculators.co.in&title=Design Calculators - Mechanical" target="_blank" class="social-btn linkedin">
                        <i class="fab fa-linkedin"></i>
                    </a>
                    <a href="https://www.facebook.com/sharer/sharer.php?u=https://designcalculators.co.in" target="_blank" class="social-btn facebook">
                        <i class="fab fa-facebook"></i>
                    </a>
                    <a href="https://twitter.com/intent/tweet?text=Check out this amazing Design Calculators - Mechanical!&url=https://designcalculators.co.in" target="_blank" class="social-btn twitter">
                        <i class="fab fa-twitter"></i>
                    </a>
                    <a href="https://api.whatsapp.com/send?text=Check out this amazing Design Calculators - Mechanical! https://designcalculators.co.in" target="_blank" class="social-btn whatsapp">
                        <i class="fab fa-whatsapp"></i>
                    </a>
                    <a href="https://www.reddit.com/submit?url=https://designcalculators.co.in&title=Design Calculators - Mechanical" target="_blank" class="social-btn reddit">
                        <i class="fab fa-reddit"></i>
                    </a>
                    <a href="mailto:?subject=Check out Design Calculators - Mechanical!&body=I found this amazing Pump Power Calculator and other mechanical tools: https://designcalculators.co.in" class="social-btn email">
                        <i class="fas fa-envelope"></i>
                    </a>
                </div>
            </div>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Get references to DOM elements
            const calculateBtn = document.getElementById('calculate-pump-power-btn');
            const resultContainer = document.getElementById('result-container');
            const resultTableBody = document.getElementById('result-table-body');
            const standardReference = document.getElementById('standard-reference');
            const calculationDetailsDiv = document.getElementById('calculation-details');

            // Input fields
            const unitSystemSelect = document.getElementById('unit-system');
            const flowRateInput = document.getElementById('flow-rate');
            const totalHeadInput = document.getElementById('total-head');
            const fluidDensityInput = document.getElementById('fluid-density');
            const pumpEfficiencyInput = document.getElementById('pump-efficiency');

            // Unit labels
            const flowUnitLabel = document.querySelector('.flow-unit-label');
            const headUnitLabel = document.querySelector('.head-unit-label');
            const densityUnitLabel = document.querySelector('.density-unit-label');

            // Constants
            const g_metric = 9.81; // m/s^2
            const g_imperial = 32.2; // ft/s^2 (approx, more precisely 32.174 ft/s^2)

            /**
             * Displays a custom message box at the top of the screen.
             * @param {string} message - The message to display.
             * @param {string} type - The type of message ('info', 'error', 'warning').
             */
            function displayMessage(message, type = "info") {
                let messageBox = document.getElementById('custom-message-box');
                if (!messageBox) {
                    messageBox = document.createElement('div');
                    messageBox.id = 'custom-message-box';
                    document.body.appendChild(messageBox);
                }
                messageBox.textContent = message;
                messageBox.className = ''; // Clear previous classes
                messageBox.classList.add(type); // Add type class for styling
                messageBox.style.opacity = 1;

                // Hide message after 5 seconds
                setTimeout(() => {
                    messageBox.style.opacity = 0;
                }, 5000);
            }

            /**
             * Updates unit labels and input defaults based on the selected unit system.
             */
            function updateUnitLabelsAndDefaults() {
                const unitSystem = unitSystemSelect.value;

                if (unitSystem === 'metric') {
                    flowUnitLabel.innerHTML = '(m&#179;/hr)';
                    headUnitLabel.innerHTML = '(m)';
                    densityUnitLabel.innerHTML = '(kg/m&#179;)';

                    // Set metric defaults
                    flowRateInput.value = "10";
                    totalHeadInput.value = "20";
                    fluidDensityInput.value = "1000"; // Water
                    pumpEfficiencyInput.value = "75";

                } else { // Imperial
                    flowUnitLabel.innerHTML = '(GPM)';
                    headUnitLabel.innerHTML = '(ft)';
                    densityUnitLabel.innerHTML = '(lb/ft&#179;)';

                    // Set imperial defaults
                    flowRateInput.value = "100"; // GPM
                    totalHeadInput.value = "50"; // ft
                    fluidDensityInput.value = "62.4"; // Water
                    pumpEfficiencyInput.value = "75";
                }
            }

            // Event listener for unit system change
            unitSystemSelect.addEventListener('change', updateUnitLabelsAndDefaults);

            // Initial UI setup on load
            updateUnitLabelsAndDefaults();

            /**
             * Adds a row to the result table.
             * @param {string} parameterHtml - The HTML content for the parameter column.
             * @param {string} valueHtml - The HTML content for the value column.
             */
            function addResultRow(parameterHtml, valueHtml) {
                const row = resultTableBody.insertRow();
                const paramCell = row.insertCell();
                const valueCell = row.insertCell();
                paramCell.innerHTML = parameterHtml;
                valueCell.innerHTML = valueHtml;
            }

            // Main Calculation Logic
            calculateBtn.addEventListener('click', function() {
                const form = document.getElementById('pump-power-form');
                if (!form.checkValidity()) {
                    displayMessage("Please fill in all required fields correctly.", "error");
                    form.reportValidity(); // Show native browser validation messages
                    return;
                }

                const unitSystem = unitSystemSelect.value;

                const Q_input = parseFloat(flowRateInput.value);
                const H_input = parseFloat(totalHeadInput.value);
                const rho_input = parseFloat(fluidDensityInput.value);
                const eta_input_percent = parseFloat(pumpEfficiencyInput.value);

                // Input validation
                if (Q_input <= 0 || H_input <= 0 || rho_input <= 0 || eta_input_percent <= 0 || eta_input_percent > 100) {
                    displayMessage("All input values (Flow Rate, Total Head, Fluid Density) must be positive. Pump Efficiency must be between 1 and 100.", "error");
                    return;
                }

                const eta = eta_input_percent / 100; // Convert efficiency to a decimal

                let Q_si, H_si, rho_si; // Standardized to SI units: m^3/s, m, kg/m^3
                let P_hyd_watts; // Hydraulic power in Watts
                let P_bhp_watts; // Brake horsepower in Watts

                let calculationHtml = '<h4>Detailed Calculation Steps:</h4>';
                calculationHtml += `<p><strong>1. Input Parameters (Converted to SI Units for calculation):</strong></p><ul>`;

                if (unitSystem === 'metric') {
                    Q_si = Q_input / 3600; // m³/hr to m³/s
                    H_si = H_input; // m
                    rho_si = rho_input; // kg/m³

                    calculationHtml += `<li>Flow Rate (\\(Q\\)): ${Q_input.toFixed(2)} m&#179;/hr \\( \\rightarrow \\) ${Q_si.toExponential(3)} m&#179;/s</li>`;
                    calculationHtml += `<li>Total Head (\\(H\\)): ${H_input.toFixed(2)} m</li>`;
                    calculationHtml += `<li>Fluid Density (\\(\\rho\\)): ${rho_input.toFixed(2)} kg/m&#179;</li>`;
                    calculationHtml += `<li>Pump Efficiency (\\(\\eta\\)): ${eta_input_percent.toFixed(1)}% \\( \\rightarrow \\) ${eta.toFixed(2)} (decimal)</li>`;
                    calculationHtml += `<li>Acceleration due to Gravity (\\(g\\)): ${g_metric} m/s&#178;</li>`;

                    // Calculate Hydraulic Power (Water Power) in Watts
                    P_hyd_watts = rho_si * g_metric * Q_si * H_si;
                    calculationHtml += `<p><strong>2. Calculate Hydraulic Power (Water Power):</strong></p>`;
                    calculationHtml += `<p class="formula">\\[ P_{hyd} = \\rho \\cdot g \\cdot Q \\cdot H \\]</p>`;
                    calculationHtml += `<p class="calculation-step">
                        \\( P_{hyd} \\) = ${rho_si.toFixed(2)} kg/m&#179; \\( \\times \\) ${g_metric.toFixed(2)} m/s&#178; \\( \\times \\) ${Q_si.toExponential(3)} m&#179;/s \\( \\times \\) ${H_si.toFixed(2)} m = ${P_hyd_watts.toFixed(2)} Watts
                    </p>`;

                } else { // Imperial
                    // GPM to ft³/s (1 GPM = 0.002228 ft³/s) OR (1 GPM = 1/448.83 ft³/s)
                    Q_si = Q_input * 0.002228; // GPM to ft³/s (common conversion factor)
                    H_si = H_input; // ft
                    rho_si = rho_input; // lb/ft³
                    // Note: Imperial calculations often use "specific weight" (gamma = rho * g) directly in lbf/ft^3,
                    // but since density is an input, we'll convert it conceptually.
                    // Power = Q (ft^3/s) * H (ft) * rho (lb/ft^3) = (ft^3/s) * ft * (lb/ft^3) = ft-lb/s
                    // Then convert ft-lb/s to HP (1 HP = 550 ft-lb/s)

                    calculationHtml += `<li>Flow Rate (\\(Q\\)): ${Q_input.toFixed(2)} GPM \\( \\rightarrow \\) ${Q_si.toExponential(3)} ft&#179;/s</li>`;
                    calculationHtml += `<li>Total Head (\\(H\\)): ${H_input.toFixed(2)} ft</li>`;
                    calculationHtml += `<li>Fluid Density (\\(\\rho\\)): ${rho_input.toFixed(2)} lb/ft&#179;</li>`;
                    calculationHtml += `<li>Pump Efficiency (\\(\\eta\\)): ${eta_input_percent.toFixed(1)}% \\( \\rightarrow \\) ${eta.toFixed(2)} (decimal)</li>`;
                    // For Imperial, often specific weight is used (gamma = rho_imp * g_imp) implicitly in the formula with 3960 or 33000 factor.
                    // Direct conversion to SI and then back to HP is robust.
                    // Or, using standard imperial pump power formula: (Q_GPM * H_ft * SG) / (3960 * efficiency) for HP, where SG is specific gravity (rho_fluid / rho_water_imperial).
                    // Given input is density, it's safer to convert to SI.
                    // Or use (Q_GPM * H_ft * rho_lbf_per_ft3) / (33000 * efficiency) where 33000 is ft-lb/min per HP
                    // Let's use the explicit rho*g*Q*H concept and convert units for consistency.
                    // Q in ft3/s, H in ft, rho in lb/ft3.
                    // Power in ft-lb/s = rho * Q * H * g (if rho is mass density)
                    // If rho is given as weight density (lbf/ft3), then Power = Q * H * rho. Fluid density is mass density.
                    // So we must include g.
                    // P_hyd_ft_lbf_per_s = rho_input * Q_si * H_si * g_imperial (if rho_input is mass density and g_imperial in ft/s^2).
                    // If fluidDensityInput is in lb/ft^3, this is mass density.
                    // Power = (mass density) * g * Flow * Head
                    // So in imperial: Power (lbf-ft/s) = (rho in slugs/ft3) * g (ft/s2) * Q (ft3/s) * H (ft)
                    // 1 slug = 32.174 lbm. So if rho_input is in lbm/ft3, need to convert to slugs/ft3 by dividing by 32.174 (g_imperial).
                    // So rho_slugs = rho_input / g_imperial
                    // P_hyd_ft_lbf_per_s = (rho_input / g_imperial) * g_imperial * Q_si * H_si = rho_input * Q_si * H_si (conceptually)
                    // This means if density is lbm/ft3, and we want lbf-ft/s, we use (rho * Q * H) directly.
                    // Example: 62.4 lbm/ft3 * 1 ft3/s * 1 ft = 62.4 lbm-ft/s. Convert lbm to lbf by dividing by g.
                    // So, (rho_lbm/ft3 * Q_ft3/s * H_ft) / (g_imperial_ft/s2) * g_imperial_ft/s2 = rho_lbm/ft3 * Q_ft3/s * H_ft.
                    // This is still in lbm units.
                    // 1 HP = 550 lbf-ft/s.
                    // P_hyd_lbf_ft_per_s = rho_input * Q_si * H_si; // This is if density is in (lbm/ft^3) and results in lbm-ft/s
                    // To convert lbm-ft/s to lbf-ft/s, divide by g_imperial (for unit consistency)
                    P_hyd_watts = (rho_input * Q_si * H_si) * 1.35582; // Convert ft-lbf/s to Watts for final consistency in formula explanation.
                    // Q_si is ft³/s. H_si is ft. rho_input is lb/ft³. (lb/ft³ * ft³/s * ft) = lb-ft/s.
                    // Convert lb-ft/s to Watts: 1 lb-ft/s = 1.35582 W.
                    
                    calculationHtml += `<li>Acceleration due to Gravity (\\(g\\)): ${g_imperial.toFixed(2)} ft/s&#178; (Used for conceptual clarity, actual Imperial formula often combines factors)</li>`;

                    calculationHtml += `<p><strong>2. Calculate Hydraulic Power (Water Power):</strong></p>`;
                    calculationHtml += `<p class="calculation-step">
                        For Imperial Units, a common formula for Hydraulic Power in ft&#183;lbf/s is \\( P_{hyd, ft&#183;lbf/s} = \\rho \\cdot Q \\cdot H \\) (where \\( \\rho \\) is in lb/ft&#179;, \\( Q \\) in ft&#179;/s, \\( H \\) in ft).
                    </p>`;
                    const P_hyd_ft_lbf_per_s = rho_input * Q_si * H_si; // This is in lbf-ft/s assuming rho_input is weight density or combined with g
                    calculationHtml += `<p class="calculation-step">
                        \\( P_{hyd, ft&#183;lbf/s} \\) = ${rho_input.toFixed(2)} lb/ft&#179; \\( \\times \\) ${Q_si.toExponential(3)} ft&#179;/s \\( \\times \\) ${H_si.toFixed(2)} ft = ${P_hyd_ft_lbf_per_s.toFixed(2)} ft&#183;lbf/s
                    </p>`;
                    P_hyd_watts = P_hyd_ft_lbf_per_s * 1.35582; // Convert to Watts for unified next step

                }
                
                // Calculate Brake Horsepower (Input Power) in Watts
                P_bhp_watts = P_hyd_watts / eta;

                calculationHtml += `<p><strong>3. Calculate Brake Horsepower (Input Power):</strong></p>`;
                calculationHtml += `<p class="formula">\\[ P_{bhp} = \\frac{P_{hyd}}{\\eta} \\]</p>`;
                calculationHtml += `<p class="calculation-step">
                    \\( P_{bhp} \\) = ${P_hyd_watts.toFixed(2)} Watts / ${eta.toFixed(2)} = ${P_bhp_watts.toFixed(2)} Watts
                </p>`;


                // Prepare results for display
                resultTableBody.innerHTML = ''; // Clear previous results
                calculationDetailsDiv.innerHTML = calculationHtml;

                addResultRow("Unit System", unitSystem === 'imperial' ? 'Imperial' : 'Metric');
                addResultRow("Flow Rate (\\(Q\\))", `${Q_input.toFixed(2)} ${unitSystem === 'metric' ? 'm&#179;/hr' : 'GPM'}`);
                addResultRow("Total Head (\\(H\\))", `${H_input.toFixed(2)} ${unitSystem === 'metric' ? 'm' : 'ft'}`);
                addResultRow("Fluid Density (\\(\\rho\\))", `${rho_input.toFixed(2)} ${unitSystem === 'metric' ? 'kg/m&#179;' : 'lb/ft&#179;'}`);
                addResultRow("Pump Efficiency (\\(\\eta\\))", `${eta_input_percent.toFixed(1)}%`);
                
                let P_hyd_display, P_bhp_display;
                if (unitSystem === 'metric') {
                    P_hyd_display = P_hyd_watts / 1000; // Watts to kW
                    P_bhp_display = P_bhp_watts / 1000; // Watts to kW
                    addResultRow("Hydraulic Power (\\(P_{hyd}\\))", `<strong>\\( ${P_hyd_display.toFixed(2)} \\) kW</strong>`);
                    addResultRow("Brake Horsepower (\\(P_{bhp}\\))", `<strong>\\( ${P_bhp_display.toFixed(2)} \\) kW</strong>`);
                } else { // Imperial
                    P_hyd_display = P_hyd_watts / 745.7; // Watts to HP (1 HP = 745.7 Watts)
                    P_bhp_display = P_bhp_watts / 745.7; // Watts to HP
                    addResultRow("Hydraulic Power (\\(P_{hyd}\\))", `<strong>\\( ${P_hyd_display.toFixed(2)} \\) HP</strong>`);
                    addResultRow("Brake Horsepower (\\(P_{bhp}\\))", `<strong>\\( ${P_bhp_display.toFixed(2)} \\) HP</strong>`);
                }

                // Re-render MathJax equations - ensure MathJax is fully loaded
                if (window.MathJax && typeof window.MathJax.typesetPromise === 'function') {
                    window.MathJax.typesetPromise([calculationDetailsDiv, resultTableBody]);
                }

                // Display standard reference
                standardReference.innerHTML = "This tool provides theoretical calculations for pump power based on fundamental fluid dynamics principles. It simplifies the actual complexities involved in pump sizing and selection. For accurate design, selection, and safety in real-world applications, it is <strong>imperative</strong> to consult pump manufacturer's data, comprehensive fluid mechanics handbooks, specialized pump selection software, and qualified mechanical or hydraulic engineers. This tool is for preliminary estimation and educational purposes only.";

                // Show results container
                resultContainer.style.display = 'block';
                setTimeout(() => {
                    resultContainer.classList.add('show');
                }, 10);
                resultContainer.scrollIntoView({ behavior: 'smooth' });

                displayMessage("Pump Power Calculation completed successfully!", "info");
            });

            // Theme switch functionality
            const themeSwitch = document.getElementById('theme-switch');
            if (themeSwitch) {
                if (localStorage.getItem('theme') === 'dark') {
                    document.body.classList.add('dark-mode');
                    themeSwitch.checked = true;
                }
                themeSwitch.addEventListener('change', function() {
                    if (this.checked) {
                        document.body.classList.add('dark-mode');
                        localStorage.setItem('theme', 'dark');
                    } else {
                        document.body.classList.remove('dark-mode');
                        localStorage.setItem('theme', 'light');
                    }
                });
            }
        });
    </script>
</body>
</html>

