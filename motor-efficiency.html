<!DOCTYPE html>
<html lang="en">
<head>
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5936527763614780"
     crossorigin="anonymous"></script>
                <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-23Y1V450SR"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-23Y1V450SR');   
    </script>
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5936527763614780"
     crossorigin="anonymous"></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NEMA Motor Efficiency Calculator - Design Calculators - Electrical</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="icon" href="/favicon.ico" type="image/x-icon">

    <style>
        /* Basic CSS Variables for a consistent theme */
        :root {
            --primary-color: #4CAF50; /* Green */
            --secondary-color: #45a049; /* Darker Green */
            --accent-color: #FFC107; /* Amber */
            --bg-color: #f4f7f6; /* Light Greyish Green */
            --card-bg: #ffffff; /* White */
            --text-color: #333333; /* Dark Grey */
            --header-bg: #2C3E50; /* Dark Blue Grey */
            --footer-bg: #34495E; /* Slightly Lighter Dark Blue Grey */
            --border-color: #cccccc;
            --card-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            --hover-color: #e2e6ea;
        }

        /* Dark Mode Variables */
        body.dark-mode {
            --bg-color: #2c3e50;
            --card-bg: #34495e;
            --text-color: #ecf0f1;
            --header-bg: #2c3e50;
            --footer-bg: #2c3e50;
            --border-color: #555555;
            --card-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
            --hover-color: #446688;
        }

        /* General Body Styling */
        body {
            font-family: 'Inter', sans-serif; /* Using Inter as specified */
            margin: 0;
            padding: 0;
            background-color: var(--bg-color);
            color: var(--text-color);
            line-height: 1.6;
            transition: background-color 0.3s, color 0.3s;
        }

        .container {
            max-width: 960px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            background-color: var(--header-bg);
            color: white;
            padding: 20px 0;
            text-align: center;
            box-shadow: var(--card-shadow);
            position: relative; /* For theme toggle positioning */
        }

        header h1 {
            margin: 0;
            font-size: 2.5em;
            color: var(--primary-color);
        }

        header .subtitle {
            margin: 5px 0 0;
            font-size: 1em;
            color: #bdc3c7;
        }

        main {
            padding: 20px 0;
        }

        .tool-container {
            background-color: var(--card-bg);
            border-radius: 8px;
            padding: 20px;
            box-shadow: var(--card-shadow);
            margin-bottom: 20px;
            transition: transform 0.3s ease-out, box-shadow 0.3s ease-out; /* Animation */
        }

        .tool-container:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
        }

        .tool-container h2 {
            color: var(--primary-color);
            border-bottom: 2px solid var(--primary-color);
            padding-bottom: 10px;
            margin-top: 0;
            margin-bottom: 20px;
        }
        /* Ensure H2 is visible in dark mode */
        body.dark-mode .tool-container h2 {
            color: white; /* Explicitly set to white for visibility */
            border-bottom-color: white;
        }

        .tool-description {
            margin-bottom: 20px;
            color: var(--text-color);
        }

        .back-button {
            display: inline-block;
            background-color: var(--primary-color);
            color: white;
            padding: 10px 15px;
            border-radius: 4px;
            text-decoration: none;
            margin-bottom: 20px;
            transition: background-color 0.3s;
        }

        .back-button:hover {
            background-color: var(--secondary-color);
        }

        /* Theme Toggle */
        .theme-toggle {
            position: absolute;
            top: 20px;
            right: 20px;
            display: flex;
            align-items: center;
        }

        .theme-toggle .light-icon,
        .theme-toggle .dark-icon {
            color: white;
            margin: 0 5px;
        }

        .switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 34px;
        }

        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            -webkit-transition: .4s;
            transition: .4s;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 26px;
            width: 26px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            -webkit-transition: .4s;
            transition: .4s;
        }

        input:checked + .slider {
            background-color: var(--primary-color);
        }

        input:focus + .slider {
            box-shadow: 0 0 1px var(--primary-color);
        }

        input:checked + .slider:before {
            -webkit-transform: translateX(26px);
            -ms-transform: translateX(26px);
            transform: translateX(26px);
        }

        /* Rounded sliders */
        .slider.round {
            border-radius: 34px;
        }

        .slider.round:before {
            border-radius: 50%;
        }

        /* Footer Styling */
        footer {
            background-color: var(--footer-bg);
            color: white;
            padding: 20px 0;
            text-align: center;
            box-shadow: 0 -2px 8px rgba(0, 0, 0, 0.1);
            margin-top: 30px;
        }

        footer .disclaimer h3,
        footer .social-share h3 {
            color: var(--primary-color);
            margin-bottom: 10px;
        }

        footer .disclaimer p {
            font-size: 0.9em;
            color: #bdc3c7;
        }

        .social-buttons {
            margin-top: 15px;
            display: flex;
            justify-content: center;
            gap: 10px;
        }

        .social-btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            color: white;
            text-decoration: none;
            font-size: 1.2em;
            transition: transform 0.3s ease-in-out;
        }

        .social-btn:hover {
            transform: translateY(-3px);
        }

        .social-btn.linkedin { background-color: #0A66C2; }
        .social-btn.facebook { background-color: #1877F2; }
        .social-btn.twitter { background-color: #1DA1F2; }
        .social-btn.whatsapp { background-color: #25D366; }
        .social-btn.reddit { background-color: #FF4500; }

        /* Styles for Calculator Form */
        .calculator-form {
            background-color: var(--card-bg);
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
            box-shadow: var(--card-shadow);
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: var(--text-color); /* Ensure label text is visible */
        }
        
        .form-group input, .form-group select {
            width: 100%;
            padding: 10px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            background-color: var(--bg-color);
            color: var(--text-color);
            transition: border-color 0.3s, box-shadow 0.3s;
        }

        .form-group input:focus, .form-group select:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 2px rgba(76, 175, 80, 0.2); /* Green glow */
            outline: none;
        }
        
        .form-row {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        .form-row .form-group {
            flex: 1 1 200px;
        }
        
        .calculate-btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            margin-top: 10px;
            transition: background-color 0.3s, transform 0.2s, box-shadow 0.2s; /* Animation */
            position: relative;
            overflow: hidden;
        }
        
        .calculate-btn:hover {
            background-color: var(--secondary-color);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .calculate-btn:active {
            transform: translateY(0);
            box-shadow: none;
        }

        /* Ripple effect for button */
        .calculate-btn::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 5px;
            height: 5px;
            background: rgba(255, 255, 255, 0.5);
            border-radius: 50%;
            opacity: 0;
            transform: scale(1) translate(-50%, -50%);
            transition: transform 0.5s, opacity 0.5s;
        }

        .calculate-btn:active::after {
            transform: scale(20) translate(-50%, -50%);
            opacity: 1;
            transition: 0s;
        }
        
        .result-container,
        .recommendation-section {
            margin-top: 30px;
            padding: 20px;
            border-radius: 8px;
            background-color: var(--card-bg);
            box-shadow: var(--card-shadow);
            display: none; /* Hidden by default */
            opacity: 0; /* For fade-in animation */
            transform: translateY(20px); /* For slide-up animation */
            transition: opacity 0.5s ease-out, transform 0.5s ease-out;
        }

        .result-container.show,
        .recommendation-section.show {
            opacity: 1;
            transform: translateY(0);
            display: block; /* Show after animation */
        }
        
        .result-container h3,
        .recommendation-section h3 {
            color: var(--primary-color);
            margin-bottom: 15px;
        }
        /* Ensure H3 is visible in dark mode */
        body.dark-mode .result-container h3,
        body.dark-mode .recommendation-section h3 {
            color: white; /* Explicitly set to white for visibility */
        }

        .result-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        
        .result-table th, .result-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
        }
        
        .result-table th {
            background-color: var(--hover-color);
        }
        
        .standard-reference {
            margin-top: 20px;
            font-style: italic;
            font-size: 0.9rem;
            color: var(--text-color); /* Ensure visibility in dark mode */
        }
        
        .info-icon {
            color: var(--primary-color);
            margin-left: 5px;
            cursor: help;
        }
        
        .tooltip {
            position: relative;
            display: inline-block;
        }
        
        .tooltip .tooltiptext {
            visibility: hidden;
            width: 200px;
            background-color: #333;
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 5px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -100px;
            opacity: 0;
            transition: opacity 0.3s, transform 0.3s;
            transform: translateY(10px);
        }
        
        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
            transform: translateY(0);
        }

        /* Custom message box style */
        #custom-message-box {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            padding: 15px 25px;
            border-radius: 8px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
            z-index: 1000;
            font-weight: bold;
            color: white;
            opacity: 0;
            transition: opacity 0.5s ease-in-out;
        }

        /* Styles for detailed calculation steps */
        .detailed-calculations {
            margin-top: 20px;
            padding: 15px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            background-color: var(--hover-color); /* A lighter background for contrast */
            color: var(--text-color); /* Ensure text visibility */
        }

        body.dark-mode .detailed-calculations {
            background-color: #3a475a; /* Darker background for contrast in dark mode */
            border-color: #6a7a8f;
        }

        .detailed-calculations h4 {
            font-weight: bold;
            font-size: 1.1rem;
            margin-bottom: 10px;
            color: var(--primary-color); /* Highlight heading */
        }
        body.dark-mode .detailed-calculations h4 {
            color: var(--primary-color); /* Use lighter primary color in dark mode */
        }

        .detailed-calculations p {
            margin-bottom: 5px;
            font-size: 0.95rem;
            line-height: 1.4;
        }

        .detailed-calculations strong {
            color: var(--secondary-color); /* Highlight key terms in formulas */
        }
        body.dark-mode .detailed-calculations strong {
            color: var(--primary-color); /* Use lighter primary color for highlights in dark mode */
        }

        /* MathJax rendered formulas will have the desired styling */
        .formula {
            background-color: rgba(0,0,0,0.05); /* Light tint for formula background */
            padding: 2px 5px;
            border-radius: 3px;
            display: inline-block; /* Helps with MathJax inline rendering */
            margin-top: 5px;
            font-size: 0.9em;
        }
        body.dark-mode .formula {
            background-color: rgba(255,255,255,0.05);
        }

        .calculation-step {
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px dashed var(--border-color);
        }

        .detailed-calculations .calculation-step:last-child {
            border-bottom: none; /* No border after the last step */
        }

        .recommendation-section ul {
            list-style-type: disc;
            margin-left: 20px;
            color: var(--text-color);
        }
        .recommendation-section ul li {
            margin-bottom: 8px;
        }
        .recommendation-section strong {
            color: var(--primary-color);
        }
        body.dark-mode .recommendation-section strong {
            color: white;
        }

        /* Responsive adjustments */
        @media (max-width: 640px) {
            .form-row {
                flex-direction: column;
            }
            .form-row .form-group {
                flex: 1 1 auto;
            }
            .theme-toggle {
                position: static; /* Adjust for smaller screens */
                transform: none;
                justify-content: center;
                margin-top: 1rem;
            }
            header .container {
                padding-bottom: 1rem; /* Add space for theme toggle if moved */
            }
        }
        /* Animation for table rows */
        @keyframes fadeInSlideUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .result-table-body tr {
            opacity: 0; /* Start hidden for animation */
            transform: translateY(20px);
            animation: fadeInSlideUp 0.5s ease-out forwards;
        }

        /* Delay for sequential row animation */
        .result-table-body tr:nth-child(1) { animation-delay: 0s; }
        .result-table-body tr:nth-child(2) { animation-delay: 0.1s; }
        .result-table-body tr:nth-child(3) { animation-delay: 0.2s; }
        .result-table-body tr:nth-child(4) { animation-delay: 0.3s; }
        .result-table-body tr:nth-child(5) { animation-delay: 0.4s; }
        .result-table-body tr:nth-child(6) { animation-delay: 0.5s; }
        .result-table-body tr:nth-child(7) { animation-delay: 0.6s; }
        .result-table-body tr:nth-child(8) { animation-delay: 0.7s; }
        .result-table-body tr:nth-child(9) { animation-delay: 0.8s; }
        .result-table-body tr:nth-child(10) { animation-delay: 0.9s; }
        .result-table-body tr:nth-child(11) { animation-delay: 1.0s; }
        .result-table-body tr:nth-child(12) { animation-delay: 1.1s; }
        /* Add more as needed */

    </style>
    <!-- MathJax configuration and loading -->
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
            },
            svg: {
                fontCache: 'global'
            },
            options: {
                processHtmlClass: 'math-content', // Process elements with this class
                ignoreHtmlClass: 'no-mathjax'    // Ignore elements with this class
            }
        };
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>
<body>
    <header>
        <div class="container">
            <h1>Design Calculators - Electrical</h1>
            <p class="subtitle">Electrical Calculations Made Easy — Learn with Every Step</p>
            <div class="theme-toggle">
                <span class="light-icon"><i class="fas fa-sun"></i></span>
                <label class="switch">
                    <input type="checkbox" id="theme-switch">
                    <span class="slider round"></span>
                </label>
                <span class="dark-icon"><i class="fas fa-moon"></i></span>
            </div>
        </div>
    </header>

    <main class="container">
        <a href="indexEle.html" class="back-button"><i class="fas fa-arrow-left"></i> Back to Tools</a>
        
        <div class="tool-container">
            <h2>NEMA Motor Efficiency Calculator</h2>
            
            <div class="tool-description">
                <p>This calculator determines the operational efficiency of an electric motor based on its output power and measured electrical input parameters, in line with NEMA standards. It also provides an estimated breakdown of losses, economic analysis for efficiency improvements, and general recommendations. Ensure input values are accurate for precise results.</p>
            </div>
        
            <div class="calculator-form">
                <form id="motor-efficiency-form">
                    <h3 class="text-xl font-semibold mb-3 text-gray-700 dark:text-white">Input Parameters</h3>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="rated-output-power">Rated Output Power (kW) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">The nominal mechanical output power of the motor as specified by the manufacturer (e.g., from the nameplate).</span></span></label>
                            <input type="number" id="rated-output-power" min="0.01" step="0.01" value="10" required>
                        </div>
                        <div class="form-group">
                            <label for="input-voltage">Input Voltage (V) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">The line-to-line voltage supplied to the motor during operation.</span></span></label>
                            <input type="number" id="input-voltage" min="1" step="1" value="415" required>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="input-current">Input Current (A) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">The measured input current drawn by the motor during operation.</span></span></label>
                            <input type="number" id="input-current" min="0.01" step="0.01" value="18" required>
                        </div>
                        <div class="form-group">
                            <label for="power-factor">Power Factor <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">The cosine of the angle between voltage and current. For motors, typical values are between 0.7 and 0.95.</span></span></label>
                            <input type="number" id="power-factor" min="0.1" max="1" step="0.01" value="0.85" required>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="phase-type-motor">System Type <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Select whether the motor is single-phase or three-phase.</span></span></label>
                            <select id="phase-type-motor" required>
                                <option value="single">Single-Phase</option>
                                <option value="three" selected>Three-Phase</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="load-factor">Load Factor (%) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">The percentage of the motor's rated power at which it is currently operating (e.g., 75 for 75% load).</span></span></label>
                            <input type="number" id="load-factor" min="0" max="100" step="1" value="100" required>
                        </div>
                    </div>

                    <h3 class="text-xl font-semibold mb-3 mt-6 text-gray-700 dark:text-white">Economic Analysis Parameters (Optional)</h3>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="operatingHoursPerYear">Operating Hours per Year (hours) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Estimated annual operating hours of the motor.</span></span></label>
                            <input type="number" id="operatingHoursPerYear" min="0" step="1" value="2000">
                        </div>
                        <div class="form-group">
                            <label for="electricityCostPerKWh">Electricity Cost (per kWh) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Your average electricity cost per kilowatt-hour.</span></span></label>
                            <input type="number" id="electricityCostPerKWh" min="0" step="0.001" value="0.12">
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="currencySymbol">Currency <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Select the currency symbol for economic analysis.</span></span></label>
                            <select id="currencySymbol">
                                <option value="$">USD ($)</option>
                                <option value="€">Euro (€)</option>
                                <option value="£">British Pound (£)</option>
                                <option value="¥">Japanese Yen (¥)</option>
                                <option value="₹" selected>Indian Rupee (₹)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="newMotorEfficiency">Proposed New Motor Efficiency (%) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">The estimated efficiency of a new, higher-efficiency motor you might consider.</span></span></label>
                            <input type="number" id="newMotorEfficiency" min="0" max="100" step="0.01" value="90">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="newMotorPurchaseCost">New Motor Purchase Cost <span class="currency-label-prefix">($)</span> <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">The estimated purchase cost of the new, higher-efficiency motor. Leave blank if not considering replacement.</span></span></label>
                            <input type="number" id="newMotorPurchaseCost" min="0" step="any">
                        </div>
                        <div class="form-group">
                            <label for="analysisPeriodYears">Analysis Period (Years) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">The number of years over which to calculate cumulative savings.</span></span></label>
                            <input type="number" id="analysisPeriodYears" min="1" step="1" value="5">
                        </div>
                    </div>

                    <button type="button" id="calculate-efficiency-btn" class="calculate-btn">Calculate Efficiency & Savings</button>
                </form>
            </div>
            
            <div id="result-container" class="result-container">
                <h3 class="text-xl font-semibold mb-3 text-gray-700 dark:text-white">Calculation Summary</h3>
                <table class="result-table">
                    <thead>
                        <tr>
                            <th>Parameter</th>
                            <th>Value</th>
                        </tr>
                    </thead>
                    <tbody id="result-table-body" class="result-table-body">
                        <!-- Results will be dynamically inserted here -->
                    </tbody>
                </table>
                <!-- Detailed calculations section -->
                <div id="detailed-calculations" class="detailed-calculations mt-6 math-content">
                    <h3 class="text-xl font-semibold mb-3 text-gray-700 dark:text-white">Detailed Calculation Steps</h3>
                    <!-- Detailed calculation steps will be dynamically inserted here -->
                </div>
            </div>

            <div id="loss-breakdown-section" class="recommendation-section">
                <h3 class="text-xl font-semibold mb-3 text-gray-700 dark:text-white">Estimated Motor Loss Breakdown</h3>
                <p class="mb-4">Motor losses are categorized into several types. The following is an estimated breakdown of the calculated total losses for your motor, based on typical industry distributions. Exact values require detailed motor design data and specific test procedures (e.g., IEEE 112, IEC 60034-2-1).</p>
                <table class="result-table">
                    <thead>
                        <tr>
                            <th>Loss Type</th>
                            <th>Value (kW)</th>
                            <th>Percentage of Total Losses</th>
                        </tr>
                    </thead>
                    <tbody id="loss-breakdown-table-body" class="result-table-body">
                        <!-- Loss breakdown will be inserted here -->
                    </tbody>
                </table>
            </div>

            <div id="efficiency-class-section" class="recommendation-section">
                <h3 class="text-xl font-semibold mb-3 text-gray-700 dark:text-white">Estimated Efficiency Class</h3>
                <p class="mb-4" id="efficiency-class-text"></p>
                <p class="text-sm text-gray-600 dark:text-gray-400"><em>Note: This is an estimation based on common efficiency ranges for NEMA and IEC standards. Actual classification requires certified test data and adherence to specific test procedures (e.g., IEEE 112 for North America, IEC 60034-2-1 for international markets).</em></p>
            </div>

            <div id="economic-analysis-section" class="recommendation-section">
                <h3 class="text-xl font-semibold mb-3 text-gray-700 dark:text-white">Economic Analysis of Efficiency Improvement</h3>
                <div id="economic-analysis-results" class="math-content">
                    <!-- Economic analysis results will be inserted here -->
                </div>
            </div>

            <div id="factors-affecting-efficiency-section" class="recommendation-section">
                <h3 class="text-xl font-semibold mb-3 text-gray-700 dark:text-white">Key Factors Affecting Motor Efficiency</h3>
                <p class="mb-4">Beyond the design of the motor itself, several operational and environmental factors can significantly impact its real-world efficiency:</p>
                <ul class="list-disc pl-5">
                    <li>
                        <strong>Load Factor:</strong> Motors are most efficient when operating near their full rated load (typically 75-100%). Under-loaded motors (e.g., below 50% load) experience a significant drop in efficiency, as fixed losses (like core losses and friction/windage) become a larger percentage of the total power.
                    </li>
                    <li>
                        <strong>Voltage Imbalance:</strong> Unequal voltages across the phases of a three-phase motor can lead to increased losses, overheating, and reduced efficiency. Even a small imbalance (e.g., 1%) can cause a disproportionately larger increase in losses.
                    </li>
                    <li>
                        <strong>Harmonic Distortion:</strong> Non-sinusoidal waveforms (harmonics) in the power supply, often introduced by variable frequency drives (VFDs) or other non-linear loads, can cause additional losses in the motor windings and core, leading to reduced efficiency and premature aging.
                    </li>
                    <li>
                        <strong>Voltage Level:</strong> Operating a motor significantly above or below its rated voltage can reduce efficiency and increase losses.
                    </li>
                    <li>
                        <strong>Ambient Temperature & Ventilation:</strong> High ambient temperatures or inadequate ventilation can lead to increased motor winding temperatures, which in turn increase copper losses and reduce efficiency.
                    </li>
                    <li>
                        <strong>Bearing & Lubrication Condition:</strong> Poorly maintained or worn bearings and inadequate lubrication increase mechanical friction losses, directly impacting motor efficiency.
                    </li>
                    <li>
                        <strong>Alignment:</strong> Misalignment between the motor and the driven equipment can cause excessive vibration, increased bearing wear, and higher mechanical losses.
                    </li>
                    <li>
                        <strong>Maintenance Practices:</strong> Regular preventive maintenance, including cleaning, lubrication, and inspection of electrical connections, is crucial for maintaining optimal motor efficiency over its lifespan.
                    </li>
                </ul>
                <p class="mt-4 text-sm text-gray-600 dark:text-gray-400"><em>Understanding and addressing these factors is key to maximizing energy savings and extending motor life in industrial applications.</em></p>
            </div>

            <div id="general-recommendations-section" class="recommendation-section">
                <h3 class="text-xl font-semibold mb-3 text-gray-700 dark:text-white">General Recommendations for Motor System Optimization</h3>
                <p class="mb-4">To achieve the most economic and reliable solution for motor system optimization, consider the following:</p>
                <ul class="list-disc pl-5">
                    <li>
                        <strong>Upgrade to High-Efficiency Motors (IE3/IE4):</strong> For motors that operate frequently or at high loads, replacing older, less efficient motors with modern high-efficiency (IE3) or super premium efficiency (IE4) motors can lead to significant energy savings and reduced operating costs. This is often the **most economic and reliable long-term solution** for continuous duty applications.
                    </li>
                    <li>
                        <strong>Utilize Variable Frequency Drives (VFDs):</strong> For applications with variable loads (e.g., pumps, fans, compressors), installing a VFD can precisely match motor speed to load demand, drastically reducing energy consumption compared to fixed-speed operation with throttling or dampening. This offers excellent control and energy savings.
                    </li>
                    <li>
                        <strong>Proper Motor Sizing:</strong> Ensure motors are correctly sized for their application. Oversized motors operate at lower load factors, which reduces their efficiency. Undersized motors can overheat and fail prematurely.
                    </li>
                    <li>
                        <strong>Implement Power Factor Correction:</strong> While not directly improving motor efficiency, maintaining a good power factor (typically > 0.95 lagging) reduces reactive power demand, lowers utility bills (especially if penalized for low PF), and frees up electrical capacity.
                    </li>
                    <li>
                        <strong>Regular Maintenance:</strong> Implement a robust preventive maintenance program including lubrication, cleaning, and vibration analysis to ensure motors run smoothly and efficiently, extending their lifespan.
                    </li>
                    <li>
                        <strong>System Integration:</strong> Consider the entire system (motor, driven equipment, controls) for optimization. Improvements in one area can positively impact others.
                    </li>
                    <li>
                        <strong>Conduct Energy Audits:</strong> Periodically perform comprehensive energy audits to identify areas for improvement and quantify potential savings.
                    </li>
                </ul>
                <p class="mt-4 text-sm text-gray-600 dark:text-gray-400"><em>Always consult with a qualified electrical engineer or energy auditor for a detailed assessment and tailored recommendations for your specific application.</em></p>
            </div>

            <div class="standard-reference" id="standard-reference">
                <p>Motor efficiency calculations and testing standards are typically defined by organizations such as: <br>
                - <strong>NEMA (National Electrical Manufacturers Association):</strong> E.g., NEMA MG 1 for Motors and Generators, which includes definitions and test procedures for motor efficiency. <br>
                - <strong>IEC (International Electrotechnical Commission):</strong> E.g., IEC 60034 series for rotating electrical machines, including efficiency classes and test methods. <br>
                - <strong>IEEE (Institute of Electrical and Electronics Engineers):</strong> E.g., IEEE 112 for Test Procedures for Polyphase Induction Motors and Generators.</p>
            </div>
        </div>
    </main>

    <footer>
        <div class="container">
            <div class="disclaimer">
                
                <p class="text-sm">Disclaimer: Always verify calculation results against applicable engineering standards and guidelines.</p>
            </div>
            <div class="credit">
                <p class="text-sm">Created by A Sharma</p>
                <p>&copy; 2025 Design Calculators</p>
            </div>
            <div class="social-share">
                <h3 class="text-lg font-semibold">Share This Site</h3>
                <div class="social-buttons">
                    <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://designcalculators.co.in&title=Design Calculators - Electrical" target="_blank" class="social-btn linkedin">
                        <i class="fab fa-linkedin"></i>
                    </a>
                    <a href="https://www.facebook.com/sharer/sharer.php?u=https://designcalculators.co.in" target="_blank" class="social-btn facebook">
                        <i class="fab fa-facebook"></i>
                    </a>
                    <a href="https://twitter.com/intent/tweet?text=Check out this amazing Design Calculators - Electrical!&url=https://designcalculators.co.in" target="_blank" class="social-btn twitter">
                        <i class="fab fa-twitter"></i>
                    </a>
                    <a href="https://api.whatsapp.com/send?text=Check out this amazing Design Calculators - Electrical! https://designcalculators.co.in" target="_blank" class="social-btn whatsapp">
                        <i class="fab fa-whatsapp"></i>
                    </a>
                    <a href="https://www.reddit.com/submit?url=https://designcalculators.co.in&title=Design Calculators - Electrical" target="_blank" class="social-btn reddit">
                        <i class="fab fa-reddit"></i>
                    </a>
                </div>
            </div>
        </div>
    </footer>

    <!-- Custom Message Box -->
    <div id="custom-message-box"></div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const calculateBtn = document.getElementById('calculate-efficiency-btn');
            const resultContainer = document.getElementById('result-container');
            const resultTableBody = document.getElementById('result-table-body');
            const detailedCalculationsDiv = document.getElementById('detailed-calculations');
            const lossBreakdownSection = document.getElementById('loss-breakdown-section');
            const lossBreakdownTableBody = document.getElementById('loss-breakdown-table-body');
            const efficiencyClassSection = document.getElementById('efficiency-class-section');
            const efficiencyClassText = document.getElementById('efficiency-class-text');
            const economicAnalysisSection = document.getElementById('economic-analysis-section');
            const economicAnalysisResultsDiv = document.getElementById('economic-analysis-results');
            const generalRecommendationsSection = document.getElementById('general-recommendations-section');
            const factorsAffectingEfficiencySection = document.getElementById('factors-affecting-efficiency-section'); // New section

            // Theme switch logic
            const themeSwitch = document.getElementById('theme-switch');
            if (themeSwitch) {
                // Check for saved theme preference
                if (localStorage.getItem('theme') === 'dark') {
                    document.body.classList.add('dark-mode');
                    themeSwitch.checked = true;
                }

                themeSwitch.addEventListener('change', function() {
                    if (this.checked) {
                        document.body.classList.add('dark-mode');
                        localStorage.setItem('theme', 'dark');
                    } else {
                        document.body.classList.remove('dark-mode');
                        localStorage.setItem('theme', 'light');
                    }
                });
            }

            // Custom Message Box Functionality
            function displayMessage(message, type = "info") {
                let messageBox = document.getElementById('custom-message-box');
                if (!messageBox) {
                    messageBox = document.createElement('div');
                    messageBox.id = 'custom-message-box';
                    document.body.appendChild(messageBox);
                }

                messageBox.textContent = message;
                messageBox.style.backgroundColor = ''; // Reset background
                messageBox.style.color = 'white'; // Default text color

                if (type === "error") {
                    messageBox.style.backgroundColor = '#dc3545'; /* Red */
                } else if (type === "warning") {
                    messageBox.style.backgroundColor = '#ffc107'; /* Orange */
                    messageBox.style.color = '#333'; /* Dark text for orange background */
                } else {
                    messageBox.style.backgroundColor = '#28a745'; /* Green */
                }
                messageBox.style.opacity = 1;

                // Hide after 5 seconds
                setTimeout(() => {
                    messageBox.style.opacity = 0;
                }, 5000);
            }

            // Update currency label prefix dynamically
            const currencySymbolSelect = document.getElementById('currencySymbol');
            const newMotorPurchaseCostLabel = document.querySelector('label[for="newMotorPurchaseCost"] .currency-label-prefix');

            function updateCurrencyLabel() {
                if (newMotorPurchaseCostLabel) {
                    newMotorPurchaseCostLabel.textContent = `(${currencySymbolSelect.value})`;
                }
            }

            if (currencySymbolSelect) {
                currencySymbolSelect.addEventListener('change', updateCurrencyLabel);
                updateCurrencyLabel(); // Set initial label
            }

            // Set default values for inputs
            document.getElementById('rated-output-power').value = 10;
            document.getElementById('input-voltage').value = 415;
            document.getElementById('input-current').value = 18;
            document.getElementById('power-factor').value = 0.85;
            document.getElementById('phase-type-motor').value = 'three';
            document.getElementById('load-factor').value = 100;
            document.getElementById('operatingHoursPerYear').value = 2000;
            document.getElementById('electricityCostPerKWh').value = 0.12;
            document.getElementById('currencySymbol').value = '₹'; // Default to Indian Rupee
            document.getElementById('newMotorEfficiency').value = 90;
            document.getElementById('newMotorPurchaseCost').value = ''; // Keep optional empty
            document.getElementById('analysisPeriodYears').value = 5;

            calculateBtn.addEventListener('click', function() {
                // Get input values
                const ratedOutputPower = parseFloat(document.getElementById('rated-output-power').value);
                const inputVoltage = parseFloat(document.getElementById('input-voltage').value);
                const inputCurrent = parseFloat(document.getElementById('input-current').value);
                const powerFactor = parseFloat(document.getElementById('power-factor').value);
                const phaseType = document.getElementById('phase-type-motor').value;
                const loadFactor = parseFloat(document.getElementById('load-factor').value); // Load factor in percentage

                // Economic analysis inputs
                const operatingHoursPerYear = parseFloat(document.getElementById('operatingHoursPerYear').value);
                const electricityCostPerKWh = parseFloat(document.getElementById('electricityCostPerKWh').value);
                const currencySymbol = document.getElementById('currencySymbol').value; // Get selected currency symbol
                const newMotorEfficiency = parseFloat(document.getElementById('newMotorEfficiency').value);
                const newMotorPurchaseCost = parseFloat(document.getElementById('newMotorPurchaseCost').value); // Optional input
                const analysisPeriodYears = parseFloat(document.getElementById('analysisPeriodYears').value);

                // Input validation
                if (isNaN(ratedOutputPower) || isNaN(inputVoltage) || isNaN(inputCurrent) || isNaN(powerFactor) || isNaN(loadFactor)) {
                    displayMessage("Please fill in all required fields with valid numbers.", "error");
                    return;
                }

                if (ratedOutputPower <= 0 || inputVoltage <= 0 || inputCurrent <= 0 || powerFactor <= 0 || powerFactor > 1 || loadFactor < 0 || loadFactor > 100) {
                    displayMessage("Please enter positive values for power, voltage, and current. Power factor should be between 0.1 and 1, and Load Factor between 0 and 100.", "error");
                    return;
                }

                // Clear previous results and hide sections
                resultTableBody.innerHTML = '';
                detailedCalculationsDiv.innerHTML = '<h3 class="text-xl font-semibold mb-3 text-gray-700 dark:text-white">Detailed Calculation Steps</h3>';
                lossBreakdownTableBody.innerHTML = '';
                efficiencyClassText.innerHTML = '';
                economicAnalysisResultsDiv.innerHTML = '';

                // Hide all sections initially for animation
                resultContainer.classList.remove('show');
                lossBreakdownSection.classList.remove('show');
                efficiencyClassSection.classList.remove('show');
                economicAnalysisSection.classList.remove('show');
                generalRecommendationsSection.classList.remove('show');
                factorsAffectingEfficiencySection.classList.remove('show');

                // --- Motor Efficiency Calculation Logic ---
                let inputPowerVA = 0; // Apparent power in VA

                // Step 1: Calculate Input Apparent Power (S)
                // Explanation: Apparent power is the total power in an AC circuit, including both real and reactive power.
                if (phaseType === 'single') {
                    inputPowerVA = inputVoltage * inputCurrent;
                    addDetailedCalculationStep(
                        "Step 1: Calculate Input Apparent Power (Single-Phase)",
                        `Apparent power ($S$) is the product of voltage and current in a single-phase AC circuit. It represents the total power that the source must supply.`,
                        `Formula: $S = V \\cdot I$`,
                        `Calculation: $S = ${inputVoltage.toFixed(2)} \\text{ V} \\cdot ${inputCurrent.toFixed(2)} \\text{ A} = ${inputPowerVA.toFixed(2)} \\text{ VA}$`
                    );
                } else { // Three-phase
                    inputPowerVA = Math.sqrt(3) * inputVoltage * inputCurrent;
                    addDetailedCalculationStep(
                        "Step 1: Calculate Input Apparent Power (Three-Phase)",
                        `For a three-phase system, apparent power ($S$) is calculated using the line-to-line voltage and line current, multiplied by $\\sqrt{3}$. This is the total power drawn by the motor from the supply.`,
                        `Formula: $S = \\sqrt{3} \\cdot V_{\\text{line}} \\cdot I_{\\text{line}}$`,
                        `Calculation: $S = \\sqrt{3} \\cdot ${inputVoltage.toFixed(2)} \\text{ V} \\cdot ${inputCurrent.toFixed(2)} \\text{ A} = ${inputPowerVA.toFixed(2)} \\text{ VA}$`
                    );
                }

                // Step 2: Calculate Input Real Power (P_in) in kW
                // Explanation: Real power (or active power) is the actual power consumed by the motor to produce mechanical work and overcome losses.
                const inputPowerKW = (inputPowerVA * powerFactor) / 1000;
                addDetailedCalculationStep(
                    "Step 2: Calculate Input Real Power ($P_{\\text{in}}$)",
                    `Input real power ($P_{\\text{in}}$) is the portion of apparent power that performs useful work. It's calculated by multiplying apparent power by the power factor. This is the power your utility bills you for.`,
                    `Formula: $P_{\\text{in}} = \\frac{S \\cdot PF}{1000}$`,
                    `Calculation: $P_{\\text{in}} = \\frac{${inputPowerVA.toFixed(2)} \\text{ VA} \\cdot ${powerFactor.toFixed(2)}}{1000} = ${inputPowerKW.toFixed(2)} \\text{ kW}$`
                );

                // Step 3: Calculate Actual Mechanical Output Power (P_out,actual)
                // Explanation: This is the actual mechanical power delivered by the motor to the connected load, considering the load factor.
                const actualOutputPowerKW = ratedOutputPower * (loadFactor / 100);
                addDetailedCalculationStep(
                    "Step 3: Calculate Actual Mechanical Output Power ($P_{\\text{out,actual}}$)",
                    `The actual mechanical output power is the portion of the motor's rated power that is currently being delivered to the load, based on the operating load factor.`,
                    `Formula: $P_{\\text{out,actual}} = \\text{Rated Output Power} \\cdot \\frac{\\text{Load Factor}}{100}$`,
                    `Calculation: $P_{\\text{out,actual}} = ${ratedOutputPower.toFixed(2)} \\text{ kW} \\cdot \\frac{${loadFactor.toFixed(0)}}{100} = ${actualOutputPowerKW.toFixed(2)} \\text{ kW}$`
                );

                // Step 4: Calculate Efficiency (eta) and Total Losses (P_losses)
                // Explanation: Efficiency is the ratio of output power to input power, indicating how effectively the motor converts electrical energy into mechanical energy. Losses are the difference between input and output power.
                let efficiency = 0;
                let totalLossesKW = 0;
                if (inputPowerKW > 0) {
                    efficiency = (actualOutputPowerKW / inputPowerKW) * 100;
                    totalLossesKW = inputPowerKW - actualOutputPowerKW;
                    addDetailedCalculationStep(
                        "Step 4: Calculate Motor Efficiency ($\\eta$)",
                        `Motor efficiency ($\eta$) is a critical performance metric, representing the percentage of input electrical power converted into useful mechanical output power. Higher efficiency means less energy is wasted as heat.`,
                        `Formula: $\\eta = \\left( \\frac{P_{\\text{out,actual}}}{P_{\\text{in}}} \\right) \\cdot 100\\%$`,
                        `Calculation: $\\eta = \\left( \\frac{${actualOutputPowerKW.toFixed(2)} \\text{ kW}}{${inputPowerKW.toFixed(2)} \\text{ kW}} \\right) \\cdot 100\\% = ${efficiency.toFixed(2)}\\%$`
                    );
                    addDetailedCalculationStep(
                        "Step 5: Calculate Total Losses ($P_{\\text{losses}}$)",
                        `Total losses represent the energy dissipated within the motor, primarily as heat, due to electrical resistance in windings, magnetic effects in the core, and mechanical friction. Minimizing these losses is key to energy efficiency.`,
                        `Formula: $P_{\\text{losses}} = P_{\\text{in}} - P_{\\text{out,actual}}$`,
                        `Calculation: $P_{\\text{losses}} = ${inputPowerKW.toFixed(2)} \\text{ kW} - ${actualOutputPowerKW.toFixed(2)} \\text{ kW} = ${totalLossesKW.toFixed(2)} \\text{ kW}$`
                    );
                } else {
                    displayMessage("Input power is zero, cannot calculate efficiency. Check your current/voltage/power factor inputs.", "error");
                    return;
                }

                // Display Summary Results
                addResultRow("Rated Output Power", ratedOutputPower.toFixed(2) + " kW");
                addResultRow("Actual Output Power", actualOutputPowerKW.toFixed(2) + " kW (at " + loadFactor + "% load)");
                addResultRow("Input Voltage", inputVoltage.toFixed(2) + " V");
                addResultRow("Input Current", inputCurrent.toFixed(2) + " A");
                addResultRow("Power Factor", powerFactor.toFixed(2));
                addResultRow("Calculated Input Power", inputPowerKW.toFixed(2) + " kW");
                addResultRow("Motor Efficiency", efficiency.toFixed(2) + " %"); // Display as number with % sign
                addResultRow("Total Losses", totalLossesKW.toFixed(2) + " kW");
                addResultRow("System Type", phaseType === "single" ? "Single-Phase" : "Three-Phase");

                // --- Estimated Loss Breakdown (Simplified) ---
                // These percentages are typical for induction motors and sum to 100% of total losses.
                // Values are illustrative; actual distribution varies by motor design and operating point.
                const lossDistribution = {
                    statorI2R: 0.35, // Stator copper losses
                    rotorI2R: 0.25, // Rotor copper losses
                    coreLoss: 0.20, // Core losses (hysteresis and eddy current)
                    frictionWindage: 0.10, // Friction and windage losses
                    strayLoad: 0.10 // Stray load losses
                };

                const statorI2RLoss = totalLossesKW * lossDistribution.statorI2R;
                const rotorI2RLoss = totalLossesKW * lossDistribution.rotorI2R;
                const coreLoss = totalLossesKW * lossDistribution.coreLoss;
                const frictionWindageLoss = totalLossesKW * lossDistribution.frictionWindage;
                const strayLoadLoss = totalLossesKW * lossDistribution.strayLoad;

                lossBreakdownTableBody.innerHTML = ''; // Clear previous
                addLossRow("Stator I2R Losses", statorI2RLoss, lossDistribution.statorI2R * 100);
                addLossRow("Rotor I2R Losses", rotorI2RLoss, lossDistribution.rotorI2R * 100);
                addLossRow("Core Losses", coreLoss, lossDistribution.coreLoss * 100);
                addLossRow("Friction & Windage Losses", frictionWindageLoss, lossDistribution.frictionWindage * 100);
                addLossRow("Stray Load Losses", strayLoadLoss, lossDistribution.strayLoad * 100);

                // --- Efficiency Class Determination ---
                const efficiencyClass = getEfficiencyClass(ratedOutputPower, efficiency);
                efficiencyClassText.innerHTML = `Based on the calculated efficiency of <strong>${efficiency.toFixed(2)}%</strong> and rated output power of <strong>${ratedOutputPower.toFixed(2)} kW</strong>, your motor's estimated efficiency class is: <strong>${efficiencyClass}</strong>.`;

                // --- Economic Analysis ---
                if (operatingHoursPerYear > 0 && electricityCostPerKWh > 0 && newMotorEfficiency > 0) {
                    const currentAnnualEnergyConsumption = inputPowerKW * operatingHoursPerYear;
                    const currentAnnualEnergyCost = currentAnnualEnergyConsumption * electricityCostPerKWh;

                    // Calculate new motor input power assuming same actual output power
                    let newMotorInputPowerKW = 0;
                    if (newMotorEfficiency > 0) {
                        newMotorInputPowerKW = actualOutputPowerKW / (newMotorEfficiency / 100);
                    } else {
                        displayMessage("Proposed New Motor Efficiency cannot be zero for economic analysis.", "warning");
                        newMotorInputPowerKW = inputPowerKW; // Fallback to current input power
                    }
                    
                    const newAnnualEnergyConsumption = newMotorInputPowerKW * operatingHoursPerYear;
                    const newAnnualEnergyCost = newAnnualEnergyConsumption * electricityCostPerKWh;
                    const annualCostSavings = currentAnnualEnergyCost - newAnnualEnergyCost;
                    const cumulativeSavings = annualCostSavings * analysisPeriodYears;

                    // Carbon Emission Reduction (assuming typical emission factor, e.g., 0.5 kg CO2 per kWh)
                    const carbonEmissionFactor = 0.5; // kg CO2 per kWh, approximate
                    const currentAnnualCarbonEmissions = currentAnnualEnergyConsumption * carbonEmissionFactor;
                    const newAnnualCarbonEmissions = newAnnualEnergyConsumption * carbonEmissionFactor;
                    const annualCarbonReduction = currentAnnualCarbonEmissions - newAnnualCarbonEmissions;

                    economicAnalysisResultsDiv.innerHTML = `
                        <p class="mb-2">Current Annual Energy Consumption: <strong>${currentAnnualEnergyConsumption.toFixed(2)} kWh</strong></p>
                        <p class="mb-2">Current Annual Energy Cost: <strong>${currencySymbol}${currentAnnualEnergyCost.toFixed(2)}</strong></p>
                        <p class="mb-2">Proposed New Motor Input Power: <strong>${newMotorInputPowerKW.toFixed(2)} kW</strong></p>
                        <p class="mb-2">New Annual Energy Consumption (with ${newMotorEfficiency.toFixed(2)}% efficiency): <strong>${newAnnualEnergyConsumption.toFixed(2)} kWh</strong></p>
                        <p class="mb-2">New Annual Energy Cost: <strong>${currencySymbol}${newAnnualEnergyCost.toFixed(2)}</strong></p>
                        <p class="mb-2 text-green-700 dark:text-green-400"><strong>Estimated Annual Cost Savings: ${currencySymbol}${annualCostSavings.toFixed(2)}</strong></p>
                        <p class="mb-2 text-green-700 dark:text-green-400"><strong>Estimated Cumulative Savings over ${analysisPeriodYears} years: ${currencySymbol}${cumulativeSavings.toFixed(2)}</strong></p>
                        <p class="mb-2 text-blue-700 dark:text-blue-400"><strong>Estimated Annual Carbon Emission Reduction: ${annualCarbonReduction.toFixed(2)} kg CO2</strong></p>
                    `;

                    if (!isNaN(newMotorPurchaseCost) && newMotorPurchaseCost > 0 && annualCostSavings > 0) {
                        const paybackPeriodYears = newMotorPurchaseCost / annualCostSavings;
                        economicAnalysisResultsDiv.innerHTML += `<p class="mt-4 text-purple-700 dark:text-purple-400"><strong>Estimated Payback Period for New Motor: ${paybackPeriodYears.toFixed(1)} years</strong></p>`;
                    } else if (!isNaN(newMotorPurchaseCost) && newMotorPurchaseCost > 0 && annualCostSavings <= 0) {
                        economicAnalysisResultsDiv.innerHTML += `<p class="mt-4 text-red-700 dark:text-red-400"><em>No positive cost savings for payback calculation with the provided inputs.</em></p>`;
                    }
                } else {
                    economicAnalysisResultsDiv.innerHTML = `<p class="text-gray-600 dark:text-gray-400">Please provide Operating Hours, Electricity Cost, and Proposed New Motor Efficiency for economic analysis.</p>`;
                }

                // Show result sections with animation
                resultContainer.classList.add('show');
                lossBreakdownSection.classList.add('show');
                efficiencyClassSection.classList.add('show');
                economicAnalysisSection.classList.add('show');
                generalRecommendationsSection.classList.add('show');
                factorsAffectingEfficiencySection.classList.add('show');
                
                resultContainer.scrollIntoView({ behavior: 'smooth' });

                // IMPORTANT: Tell MathJax to re-render the newly added content after a small delay
                if (window.MathJax && typeof window.MathJax.typesetPromise === 'function') {
                    setTimeout(() => {
                        window.MathJax.typesetPromise([detailedCalculationsDiv, lossBreakdownSection, efficiencyClassSection, economicAnalysisSection, factorsAffectingEfficiencySection])
                            .catch((err) => console.error('MathJax typesetting failed:', err));
                    }, 50); 
                }
            });

            // Helper function to add a row to the summary result table
            function addResultRow(parameter, value) {
                const row = document.createElement('tr');
                
                const paramCell = document.createElement('td');
                paramCell.textContent = parameter; // Use textContent for plain text
                paramCell.classList.add('font-medium');
                
                const valueCell = document.createElement('td');
                valueCell.textContent = value; // Use textContent for plain text values
                
                row.appendChild(paramCell);
                row.appendChild(valueCell);
                
                resultTableBody.appendChild(row);
            }

            // Helper function to add a detailed calculation step
            function addDetailedCalculationStep(stepTitle, explanationText, formulaText, calculationText) {
                const stepDiv = document.createElement('div');
                stepDiv.classList.add('calculation-step');

                const titleElem = document.createElement('h4');
                titleElem.textContent = stepTitle;
                stepDiv.appendChild(titleElem);

                if (explanationText) {
                    const explanationElem = document.createElement('p');
                    explanationElem.innerHTML = explanationText; // Use innerHTML for MathJax rendering if explanation contains LaTeX
                    stepDiv.appendChild(explanationElem);
                }

                if (formulaText) {
                    const formulaElem = document.createElement('p');
                    formulaElem.classList.add('formula'); // Add class for styling
                    formulaElem.innerHTML = formulaText; // Use innerHTML for MathJax rendering
                    stepDiv.appendChild(formulaElem);
                }

                if (calculationText) {
                    const calcElem = document.createElement('p');
                    calcElem.innerHTML = calculationText; // Use innerHTML for MathJax rendering in calculation text
                    stepDiv.appendChild(calcElem);
                }
                detailedCalculationsDiv.appendChild(stepDiv);
            }

            // Helper function for loss breakdown table
            function addLossRow(lossType, valueKW, percentage) {
                const row = document.createElement('tr');
                const typeCell = document.createElement('td');
                typeCell.textContent = lossType;
                const valueCell = document.createElement('td');
                valueCell.textContent = valueKW.toFixed(2) + " kW";
                const percentCell = document.createElement('td');
                // Ensure no literal % sign for display, just the number
                percentCell.textContent = percentage.toFixed(1) + " "; 
                row.appendChild(typeCell);
                row.appendChild(valueCell);
                row.appendChild(percentCell);
                lossBreakdownTableBody.appendChild(row);
            }

            // Function to determine efficiency class (simplified based on typical ranges)
            // This is a simplified mapping. Actual NEMA/IEC classes depend on specific motor size, speed, and standard.
            function getEfficiencyClass(ratedPowerKW, efficiency) {
                if (ratedPowerKW < 0.75) { // Small motors
                    if (efficiency >= 85) return "IE3 / NEMA Premium";
                    if (efficiency >= 80) return "IE2 / NEMA Energy Efficient";
                    return "IE1 / NEMA Standard";
                } else if (ratedPowerKW < 7.5) { // Medium motors
                    if (efficiency >= 90) return "IE3 / NEMA Premium";
                    if (efficiency >= 87) return "IE2 / NEMA Energy Efficient";
                    return "IE1 / NEMA Standard";
                } else if (ratedPowerKW < 75) { // Larger motors
                    if (efficiency >= 93) return "IE3 / NEMA Premium";
                    if (efficiency >= 90) return "IE2 / NEMA Energy Efficient";
                    return "IE1 / NEMA Standard";
                } else { // Very large motors
                    if (efficiency >= 95) return "IE3 / NEMA Premium";
                    if (efficiency >= 92) return "IE2 / NEMA Energy Efficient";
                    return "IE1 / NEMA Standard";
                }
            }
        });
    </script>
</body>
</html>



