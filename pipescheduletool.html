<!DOCTYPE html>
<html lang="en">

<head>
    <!-- AdSense & Analytics -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5936527763614780"
        crossorigin="anonymous"></script>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-23Y1V450SR"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());
        gtag('config', 'G-23Y1V450SR');
    </script>

    <!-- SEO Meta Tags -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced Pipe Schedule & Stress Calculator (ASME B36.10/B31.3)</title>
    <meta name="description"
        content="World-class Pipe Schedule Calculator for Heavy Industry. ASME B36.10/19 Dimensions, Wall Thickness, and Weight. Features Advanced Pressure Containment (Barlow/ASME B31.3) with Mill Tolerance & Corrosion, plus Structural Properties (Moment of Inertia, Section Modulus) for Stress Analysis.">
    <meta name="keywords"
        content="pipe schedule calculator, asme b36.10 calculator, pipe stress analysis tool, barlows formula with corrosion allowance, moment of inertia pipe, section modulus calculator, asme b31.3 pressure rating, heavy industry piping, nps dimensions">
    <meta name="author" content="Design Calculators">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://designcalculators.co.in/pipecalc" />

    <!-- JSON-LD Schema: Software Application -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "SoftwareApplication",
      "name": "Industrial Pipe Schedule & Stress Analyzer",
      "applicationCategory": "UtilitiesApplication",
      "operatingSystem": "Web",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "USD"
      },
      "description": "A commercial-grade engineering platform for piping design. Calculates dimensional properties, structural stress factors (I, Z, r), and ASME B31.3 compliant pressure ratings including manufacturing tolerances.",
      "featureList": "ASME B36.10/19 Database, Mill Tolerance & Corrosion Logic, Structural Properties (I, Z, r), Fluid Capacity, Detailed Forensics",
      "author": {
        "@type": "Organization",
        "name": "Design Calculators"
      }
    }
    </script>

    <!-- JSON-LD Schema: FAQ Page -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "FAQPage",
      "mainEntity": [
        { "@type": "Question", "name": "Why include Mill Tolerance in pressure calculations?", "acceptedAnswer": { "@type": "Answer", "text": "ASME B31.3 and other design codes require calculations to be based on the minimum possible wall thickness. Manufacturing standards (like ASTM A53/A106) allow the wall thickness to be up to 12.5% thinner than the nominal value stated in the schedule. Ignoring this can lead to catastrophic failure." } },
        { "@type": "Question", "name": "What is Corrosion Allowance?", "acceptedAnswer": { "@type": "Answer", "text": "It is extra wall thickness added to the design to account for material loss over the lifespan of the pipe due to corrosion or erosion. Common values are 1.6mm (1/16\") or 3.2mm (1/8\") depending on the fluid service." } },
        { "@type": "Question", "name": "What are Moment of Inertia (I) and Section Modulus (Z)?", "acceptedAnswer": { "@type": "Answer", "text": "These are structural properties used in Pipe Stress Analysis. Moment of Inertia (I) measures resistance to bending. Section Modulus (Z) is used to calculate bending stress. These are critical for determining support spans and flexibility analysis in software like CAESAR II." } },
        { "@type": "Question", "name": "What is the difference between NPS and DN?", "acceptedAnswer": { "@type": "Answer", "text": "NPS (Nominal Pipe Size) is the North American standard set in inches (e.g., NPS 4). DN (Diameter Nominal) is the European metric equivalent measured in millimeters (e.g., DN 100). They refer to the same physical pipe size." } },
        { "@type": "Question", "name": "Does Schedule 40 always mean the same thickness?", "acceptedAnswer": { "@type": "Answer", "text": "No. The actual wall thickness of 'Schedule 40' changes depending on the pipe diameter. For example, NPS 2 Sch 40 is 0.154\" thick, while NPS 4 Sch 40 is 0.237\" thick." } },
        { "@type": "Question", "name": "Does this tool support Stainless Steel (B36.19)?", "acceptedAnswer": { "@type": "Answer", "text": "Yes. While dimensions often align with B36.10, Stainless Steel schedules often include an 'S' suffix (e.g., 10S, 40S, 80S). This calculator includes common stainless thicknesses where applicable." } },
        { "@type": "Question", "name": "How is pipe weight calculated?", "acceptedAnswer": { "@type": "Answer", "text": "Weight is calculated based on the volume of steel in the pipe wall. Formula: W = 10.69 * (OD - Wall) * Wall (lb/ft). Carbon steel density is assumed (~0.283 lb/in³)." } },
        { "@type": "Question", "name": "What is the 'Schedule' number derived from?", "acceptedAnswer": { "@type": "Answer", "text": "Originally, Schedule = 1000 * (P/S), where P is service pressure and S is allowable stress. Today, it is a standardized lookup value in ASME B36.10." } },
        { "@type": "Question", "name": "Why is the OD of a 2-inch pipe not 2 inches?", "acceptedAnswer": { "@type": "Answer", "text": "Historical reasons. For NPS 1/8 through 12, the OD is fixed and larger than the nominal size (e.g., NPS 2 OD is 2.375\"). For NPS 14 and larger, the OD equals the nominal size." } },
        { "@type": "Question", "name": "Is Schedule 80 stronger than Schedule 40?", "acceptedAnswer": { "@type": "Answer", "text": "Yes. Schedule 80 has a thicker wall, resulting in a smaller internal diameter (ID) but significantly higher pressure containment capability and mechanical strength." } }
      ]
    }
    </script>

    <!-- Fonts & Icons -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Montserrat:wght@700;800;900&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- PDF Generation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.8.3/jspdf.plugin.autotable.min.js"></script>

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>

    <!-- MathJax for Formulas -->
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['\\(', '\\)'], ['$', '$']],
                displayMath: [['\\[', '\\]'], ['$$', '$$']]
            },
            svg: { fontCache: 'global' }
        };
    </script>
    <script type="text/javascript" id="MathJax-script" async
        src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <!-- Favicon Links -->
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">

    <style>
        /* --- CORE THEME (Blue Industrial) --- */
        :root {
            --primary: #1E3A8A;
            /* Dark Blue */
            --secondary: #2563EB;
            /* Bright Blue */
            --accent: #F59E0B;
            /* Amber */
            --success: #10B981;
            --danger: #DC2626;
            --warning: #F59E0B;
            --bg: #F8FAFC;
            --card: #FFFFFF;
            --text: #334155;
            --heading: #0F172A;
            --footer-bg: #0F172A;
            --border: #E2E8F0;
            --grad: linear-gradient(135deg, var(--primary), var(--secondary));
            --grad-dark: linear-gradient(135deg, #0F172A, #1E293B);
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --input-bg: #FFFFFF;
        }

        body.dark-mode {
            --primary: #3B82F6;
            --secondary: #60A5FA;
            --bg: #0F172A;
            --card: #1E293B;
            --text: #E2E8F0;
            --heading: #F8FAFC;
            --footer-bg: #020617;
            --border: #334155;
            --accent: #FBBF24;
            --input-bg: #334155;
        }

        * {
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg);
            color: var(--text);
            line-height: 1.6;
            margin: 0;
            padding: 0;
        }

        .container {
            max-width: 1280px;
            margin: 0 auto;
            padding: 0 24px;
        }

        /* Header & Nav */
        header {
            background: var(--grad);
            color: white;
            padding: 24px 0;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
        }

        .navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo-container {
            display: flex;
            flex-direction: column;
            text-decoration: none;
            color: white;
        }

        .logo-text {
            font-size: 1.75rem;
            font-weight: 800;
            font-family: 'Montserrat', sans-serif;
            letter-spacing: -0.5px;
        }

        .logo-subtitle {
            font-size: 0.8rem;
            margin: 4px 0 0 0;
            color: #DBEAFE;
            font-weight: 500;
        }

        .nav-links {
            display: flex;
            gap: 24px;
            list-style: none;
            margin: 0;
            padding: 0;
        }

        .nav-links a {
            color: white;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.2s;
            opacity: 0.9;
        }

        .nav-links a:hover {
            opacity: 1;
            transform: translateY(-1px);
        }

        /* Theme Toggle */
        .theme-toggle {
            display: flex;
            align-items: center;
            gap: 12px;
            color: white;
        }

        .switch {
            position: relative;
            width: 52px;
            height: 28px;
        }

        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(255, 255, 255, 0.2);
            transition: .4s;
            border-radius: 34px;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 20px;
            width: 20px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked+.slider {
            background-color: var(--success);
            border-color: var(--success);
        }

        input:checked+.slider:before {
            transform: translateX(24px);
        }

        /* Main Content */
        main {
            padding: 40px 0;
        }

        .card {
            background: var(--card);
            border-radius: 16px;
            padding: 32px;
            box-shadow: var(--shadow);
            margin-bottom: 30px;
            border: 1px solid var(--border);
            animation: fadeIn 0.5s ease-out;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .card h2 {
            color: var(--primary);
            border-bottom: 2px solid var(--border);
            padding-bottom: 15px;
            margin-top: 0;
            font-family: 'Montserrat', sans-serif;
            font-size: 1.75rem;
            display: flex;
            align-items: center;
            gap: 12px;
            letter-spacing: -0.5px;
        }

        h3 {
            color: var(--heading);
            font-family: 'Montserrat', sans-serif;
            font-size: 1.4rem;
            margin-top: 25px;
            margin-bottom: 20px;
        }

        h4 {
            color: var(--heading);
            font-size: 1.1rem;
            margin-bottom: 15px;
            border-bottom: 1px solid var(--border);
            padding-bottom: 8px;
        }

        /* Forms */
        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 24px;
            margin-bottom: 24px;
        }

        .form-group {
            margin-bottom: 0;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--heading);
            font-size: 0.95rem;
        }

        .form-group input,
        .form-group select {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid var(--border);
            border-radius: 8px;
            background-color: var(--input-bg);
            color: var(--text);
            font-size: 1rem;
            transition: all 0.2s ease;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
        }

        .form-group input:focus,
        .form-group select:focus {
            border-color: var(--secondary);
            outline: none;
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.15);
        }

        /* Tool Switcher */
        .tool-switcher {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .tool-btn {
            background: var(--card);
            border: 2px solid var(--border);
            padding: 12px 24px;
            border-radius: 12px;
            font-weight: 700;
            color: var(--text);
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .tool-btn:hover {
            border-color: var(--secondary);
            transform: translateY(-2px);
        }

        .tool-btn.active {
            background: var(--primary);
            border-color: var(--primary);
            color: white;
            box-shadow: 0 4px 12px rgba(30, 58, 138, 0.3);
        }

        /* Module Containers */
        .tool-module {
            display: none;
            animation: fadeIn 0.4s ease-out;
        }

        .tool-module.active {
            display: block;
        }

        /* Results Big Display */
        .result-box {
            text-align: center;
            padding: 25px;
            background: var(--card);
            border: 2px solid var(--primary);
            border-radius: 12px;
            margin-top: 30px;
            position: relative;
            overflow: hidden;
            box-shadow: var(--shadow);
        }

        .result-box::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 6px;
            background: var(--grad);
        }

        .main-value {
            font-size: 2.5rem;
            font-weight: 800;
            color: var(--primary);
            font-family: 'Montserrat', sans-serif;
            margin: 10px 0;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }

        .sub-value {
            font-size: 1.1rem;
            color: var(--text);
            opacity: 0.9;
            font-weight: 500;
            max-width: 800px;
            margin: 0 auto;
        }

        /* Calculation Steps Styling */
        .calc-steps {
            text-align: left;
            margin-top: 25px;
            background: var(--bg);
            padding: 25px;
            border-radius: 8px;
            border-left: 4px solid var(--accent);
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
            color: var(--text);
            box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.03);
        }

        .calc-steps h4 {
            margin-top: 0;
            color: var(--primary);
            font-family: 'Inter', sans-serif;
            border-bottom: 1px dashed var(--border);
            padding-bottom: 8px;
            margin-bottom: 15px;
        }

        .calc-steps strong {
            color: var(--heading);
        }

        .step-block {
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border);
        }

        .step-block:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }

        .step-title {
            font-weight: 700;
            color: var(--secondary);
            display: block;
            margin-bottom: 5px;
            font-family: 'Inter', sans-serif;
        }

        /* Visualizer */
        .viz-container {
            height: 350px;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 20px;
            position: relative;
            background: var(--bg);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 10px;
        }

        canvas {
            max-height: 100%;
            max-width: 100%;
        }

        /* Buttons (Shared) */
        .btn {
            background: var(--grad);
            color: white;
            border: none;
            padding: 14px 28px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.25);
            transition: all 0.2s;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 16px rgba(37, 99, 235, 0.35);
        }

        .btn-outline {
            background: transparent;
            border: 2px solid var(--border);
            color: var(--text);
            box-shadow: none;
        }

        .btn-outline:hover {
            border-color: var(--primary);
            color: var(--primary);
            background: rgba(37, 99, 235, 0.05);
        }

        .btn-small {
            padding: 8px 16px;
            font-size: 0.9rem;
        }

        /* Message Box */
        .message-box {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            padding: 16px 24px;
            border-radius: 8px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
            z-index: 9999;
            font-weight: 600;
            color: white;
            opacity: 0;
            transition: all 0.3s;
            display: none;
        }

        .message-box.show {
            display: block;
            opacity: 1;
            top: 30px;
        }

        /* Educational Section */
        .education-section {
            padding: 40px;
        }

        .article-content {
            font-family: 'Inter', sans-serif;
            color: var(--text);
        }

        .article-block {
            margin-bottom: 40px;
        }

        .article-block h3 {
            color: var(--primary);
            border-left: 5px solid var(--accent);
            padding-left: 15px;
            margin-bottom: 20px;
            font-size: 1.4rem;
            margin-top: 0;
        }

        .article-block h4 {
            color: var(--heading);
            margin-top: 25px;
            margin-bottom: 15px;
            font-weight: 700;
            font-size: 1.1rem;
            border-bottom: none;
        }

        .article-block p {
            line-height: 1.8;
            margin-bottom: 15px;
            text-align: justify;
        }

        .article-block ul {
            padding-left: 20px;
            margin-bottom: 15px;
        }

        .article-block li {
            margin-bottom: 10px;
            line-height: 1.6;
        }

        .highlight-box {
            background: rgba(37, 99, 235, 0.05);
            border: 1px solid var(--border);
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }

        .formula {
            background: var(--bg);
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            text-align: center;
            font-size: 1.1rem;
            border: 1px solid var(--border);
            font-family: 'Courier New', monospace;
            overflow-x: auto;
        }

        /* FAQ Accordion */
        .faq-item {
            border-bottom: 1px solid var(--border);
            padding: 15px 0;
        }

        .faq-question {
            font-weight: 700;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: var(--heading);
            transition: color 0.2s;
        }

        .faq-question:hover {
            color: var(--primary);
        }

        .faq-answer {
            display: none;
            margin-top: 10px;
            color: var(--text);
            line-height: 1.7;
            text-align: justify;
        }

        .faq-item.active .faq-answer {
            display: block;
            animation: fadeIn 0.3s;
        }

        .faq-icon {
            transition: transform 0.3s;
        }

        .faq-item.active .faq-icon {
            transform: rotate(180deg);
        }

        /* Results Grid */
        .res-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 20px;
        }

        @media(max-width:768px) {
            .res-grid {
                grid-template-columns: 1fr;
            }
        }

        .res-item {
            background: var(--bg);
            padding: 15px;
            border-radius: 8px;
            border: 1px solid var(--border);
        }

        .res-label {
            font-size: 0.85rem;
            color: var(--text);
            opacity: 0.8;
            margin-bottom: 5px;
        }

        .res-val {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--heading);
        }

        /* Footer */
        footer {
            background: var(--grad-dark);
            color: #94A3B8;
            padding: 60px 0 30px 0;
            margin-top: 80px;
        }

        .footer-content {
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 40px;
            margin-bottom: 40px;
        }

        .footer-col {
            flex: 1;
            min-width: 200px;
        }

        .footer-col h4 {
            color: white;
            margin-bottom: 20px;
            font-weight: 700;
            font-size: 1.1rem;
        }

        .footer-col ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .footer-col li {
            margin-bottom: 12px;
        }

        .footer-col a {
            color: #CBD5E1;
            text-decoration: none;
            transition: color 0.2s;
        }

        .footer-col a:hover {
            color: var(--accent);
        }

        .social-buttons {
            display: flex;
            gap: 12px;
            margin-top: 20px;
        }

        /* Social Buttons Styling */
        .social-btn {
            width: 40px;
            height: 40px;
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            border-radius: 50%;
            font-size: 1.1rem;
            transition: transform 0.3s;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .social-btn:hover {
            transform: translateY(-4px);
        }

        .social-btn.linkedin {
            background-color: #0A66C2;
        }

        .social-btn.youtube {
            background-color: #FF0000;
        }

        .social-btn.twitter {
            background-color: #1DA1F2;
        }

        .social-btn.facebook {
            background-color: #1877F2;
        }

        .social-btn.whatsapp {
            background-color: #25D366;
        }

        .footer-disclaimer {
            text-align: center;
            padding-top: 30px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            max-width: 900px;
            margin: 0 auto;
            font-size: 0.85rem;
            line-height: 1.6;
        }

        .footer-bottom {
            text-align: center;
            padding-top: 20px;
            font-size: 0.85rem;
        }

        .hidden {
            display: none;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .navbar {
                flex-direction: column;
                gap: 20px;
            }

            .nav-links {
                flex-direction: column;
                width: 100%;
                text-align: center;
            }

            .tool-switcher {
                flex-direction: column;
            }
        }
    </style>
    <style>
        /* Core Header Styles */
        .header {
            background: var(--gradient-primary, linear-gradient(135deg, #1E3A8A, #2563EB));
            color: white;
            padding: 10px 0;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            position: relative;
            z-index: 1000;
            overflow: visible !important;
        }

        .header .container {
            max-width: 1280px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .header .navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
            position: relative;
        }

        .header .logo-container {
            display: flex !important;
            align-items: center !important;
            gap: 12px !important;
            text-decoration: none;
            color: white;
        }

        .header .logo {
            height: 48px !important;
            width: auto;
            object-fit: contain;
            border-radius: 6px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .header .logo-text {
            font-size: 1.25rem;
            font-weight: 700;
            letter-spacing: -0.02em;
            color: #ffffff;
            margin-bottom: 2px;
            white-space: nowrap;
            font-family: 'Montserrat', sans-serif;
        }

        .logo-text-group {
            display: flex;
            flex-direction: column;
            justify-content: center;
            line-height: 1.1;
        }

        .logo-subtitle {
            font-size: 0.7rem !important;
            color: rgba(255, 255, 255, 0.85) !important;
            font-weight: 500;
            margin: 0 !important;
            line-height: 1.2;
            max-width: 250px;
            white-space: normal;
        }

        .header .nav-menu {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .header .nav-links {
            display: flex;
            gap: 25px;
            list-style: none;
            margin: 0;
            padding: 0;
            align-items: center;
        }

        .header .nav-links li {
            margin: 0;
            position: relative;
            display: inline-block;
        }

        .header .nav-links a {
            color: white;
            text-decoration: none;
            font-weight: 600;
            font-size: 0.95rem;
            transition: all 0.2s ease;
            opacity: 0.9;
        }

        .header .nav-links a:hover {
            opacity: 1;
            transform: translateY(-1px);
        }

        .header .theme-toggle {
            margin-left: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .mobile-menu-toggle {
            display: none;
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            padding: 8px;
            z-index: 1000;
        }

        /* Mega Menu Styles */
        .nav-links .dropbtn {
            cursor: pointer;
            padding: 10px 0;
            display: inline-block;
        }

        .nav-links .dropbtn i {
            font-size: 0.8em;
            margin-left: 4px;
            opacity: 0.7;
            transition: transform 0.3s;
        }

        .nav-links .nav-item:hover .dropbtn i {
            transform: rotate(180deg);
        }

        .dropdown-content {
            display: none;
            position: absolute;
            background-color: var(--card-bg, #ffffff);
            width: 600px;
            left: 50%;
            transform: translateX(-50%);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
            z-index: 2000;
            border-radius: 12px;
            padding: 20px;
            top: 100%;
            margin-top: 5px;
            opacity: 0;
            visibility: hidden;
            transition: all 0.2s ease-in-out;
            border-top: 4px solid var(--secondary-color, #2563EB);
        }

        .nav-links .nav-item:hover .dropdown-content {
            display: block;
            opacity: 1;
            visibility: visible;
        }

        .dropdown-content .row {
            display: flex;
            gap: 20px;
        }

        .dropdown-content .column {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .dropdown-content a {
            color: var(--text-color, #4B5563) !important;
            padding: 6px 8px;
            text-decoration: none;
            display: block;
            font-size: 0.9rem !important;
            border-radius: 6px;
            transition: background 0.2s, color 0.2s;
            font-weight: 400 !important;
            line-height: 1.4;
        }

        .dropdown-content a:hover {
            background-color: var(--hover-color, #F1F5F9);
            color: var(--primary-color, #1E3A8A) !important;
            transform: translateX(4px);
        }

        .mega-menu-footer {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid var(--border-color, #E2E8F0);
            text-align: center;
        }

        .mega-menu-footer .view-all-btn {
            display: inline-block;
            color: var(--primary-color, #1E3A8A) !important;
            font-weight: 700 !important;
            font-size: 0.95rem !important;
        }

        /* Dark Mode Overrides */
        body.dark-mode .dropdown-content {
            background-color: var(--card-bg, #1E293B);
            border-color: var(--secondary-color, #34D399);
        }

        body.dark-mode .dropdown-content a {
            color: var(--text-color, #CBD5E1) !important;
        }

        body.dark-mode .dropdown-content a:hover {
            background-color: rgba(255, 255, 255, 0.05);
            color: var(--primary-color, #10B981) !important;
        }

        /* Responsive */
        @media (max-width: 992px) {
            .mobile-menu-toggle {
                display: block;
            }

            .header .nav-menu {
                display: flex;
            }

            .nav-links {
                position: fixed;
                top: 0;
                left: -100%;
                width: 280px;
                height: 100vh;
                background: var(--gradient-dark, #0F172A);
                flex-direction: column;
                padding: 100px 30px 30px;
                gap: 24px;
                transition: left 0.4s ease-in-out;
                box-shadow: 4px 0 12px rgba(0, 0, 0, 0.3);
                z-index: 999;
                align-items: flex-start;
            }

            .nav-links.active {
                left: 0;
            }

            .nav-links a {
                width: 100%;
                padding: 12px 16px;
                border-radius: 8px;
                background: rgba(255, 255, 255, 0.05);
                display: block;
            }

            .dropdown-content {
                position: static;
                width: 100%;
                box-shadow: none;
                transform: none;
                display: none !important;
                padding: 0 0 0 15px;
                background: transparent;
                border: none;
            }

            .nav-links .nav-item:hover .dropdown-content {
                display: block !important;
                opacity: 1;
                visibility: visible;
            }

            .dropdown-content .row {
                flex-direction: column;
                gap: 0;
            }

            .nav-links .nav-item {
                display: block;
                width: 100%;
            }

            .nav-links .dropbtn {
                width: 100%;
                display: flex;
                justify-content: space-between;
            }

            .header .logo-text {
                font-size: 1.1rem;
            }

            .header .logo {
                height: 40px;
            }
        }
    </style>
    <link rel="stylesheet" href="/styles.css">
</head>

<body>
    <div id="message-box" class="message-box"></div>

    <header class="header">
        <div class="header-bg-animation"></div>
        <div class="container">
            <nav class="navbar">
                <a href="/" class="logo-container">
                    <img src="logo.png" alt="Design Calculators Logo" class="logo">
                    <span class="logo-text">Design Calculators</span>
                </a>

                <div class="nav-menu">
                    <button class="mobile-menu-toggle" aria-label="Toggle menu">
                        <i class="fas fa-bars"></i>
                    </button>

                    <ul class="nav-links">
                        <li><a href="/index.html">Home</a></li>
                        
    <li class="dropdown">
        <a href="/indexele.html" class="dropdown-toggle">Electrical <i class="fas fa-chevron-down" style="font-size: 0.7em; margin-left: 4px;"></i></a>
        <div class="dropdown-menu">
            <div class="repo-grid"><div><a href="/arcflash.html">Arc Flash Calculator</a><a href="/breaker-sizing.html">Breaker Sizing</a><a href="/cable-thermal-rating.html">Cable Ampacity</a><a href="/comm-cable-loss.html">Comm Cable Loss</a><a href="/earth-conductor-size.html">Earth Conductor Size</a><a href="/generatorsizing.html">Generator Sizing</a><a href="/harmonicsanalyser.html">Harmonics Analyser</a><a href="/insulationresistance.html">Insulation Resistance</a><a href="/logicgate.html">Logic Gates Simulator</a><a href="/motor-starting.html">Motor Starting Current</a><a href="/pcbtrace.html">PCB Trace Width</a><a href="/protection-device.html">Protection Device</a><a href="/resistor.html">Resistor Color Code</a><a href="/solarcable.html">Solar Cable Sizing</a><a href="/systemxrcalculator.html">System X/R Ratio</a><a href="/transmissionline.html">Transmission Line</a><a href="/vfd-selection.html">VFD Selection Tool</a></div><div><a href="/batterylife.html">Battery Life Estimator</a><a href="/busbarampacity.html">Busbar Ampacity</a><a href="/cablepulling.html">Cable Pulling Tension</a><a href="/conduit-fill.html">Conduit Fill Calculator</a><a href="/earthingfaultsimulator.html">Earthing Fault Simulator</a><a href="/grounding.html">Grounding System Design</a><a href="/hvac-sizing.html">HVAC Sizing Calculator</a><a href="/lcresonancecalculator.html">LC Resonance Calculator</a><a href="/maintenance-guide.html">Maintenance Guide</a><a href="/nemaipconvertor.html">NEMA to IP Converter</a><a href="/power-factor.html">Power Factor Correction</a><a href="/relay-coordination.html">Relay Coordination</a><a href="/short-circuit.html">Short Circuit Current</a><a href="/solarpvarray.html">Solar PV Array</a><a href="/transformer-calculator.html">Transformer Calculator</a><a href="/unit-converter.html">Unit Converter</a><a href="/voltage-drop.html">Voltage Drop Calculator</a></div><div><a href="/battery-sizing.html">Battery Sizing (AH)</a><a href="/busbarshortcircuit.html">Busbar Short Circuit</a><a href="/cable-sizing.html">Cable Sizing Calculator</a><a href="/ctsaturation.html">CT Saturation</a><a href="/equipment-relay.html">Equipment Relay Setting</a><a href="/harmonic-distortion.html">Harmonic Distortion</a><a href="/industriallighting.html">Industrial Lighting</a><a href="/lighting-calulator.html">Lighting Calculator</a><a href="/motor-efficiency.html">Motor Efficiency</a><a href="/neutral-earth-fault-current.html">Neutral Earth Fault</a><a href="/powertriangletool.html">Power Triangle</a><a href="/electricalresidentialload.html">Residential Load Calc</a><a href="/skindepth.html">Skin Depth Calculator</a><a href="/symmetricalcomponents.html">Symmetrical Components</a><a href="/transformerinrush.html">Transformer Inrush</a><a href="/ups-sizing.html">UPS Sizing</a></div>
            </div>
            <div class="view-all-container">
                <a href="/indexele.html" class="view-all-link">View All Electrical Tools â†’</a>
            </div>
        </div>
    </li>
                        
    <li class="dropdown">
        <a href="/indexinst.html" class="dropdown-toggle">Instrumentation <i class="fas fa-chevron-down" style="font-size: 0.7em; margin-left: 4px;"></i></a>
        <div class="dropdown-menu">
            <div class="repo-grid"><div><a href="/adc-resolution.html">ADC Resolution</a><a href="/capillarylengthtemperatureerror.html">Capillary Error</a><a href="/cv-kv-valve.html">Cv/Kv Valve Sizing</a><a href="/dp-level.html">DP Level Measurement</a><a href="/hydrostatic-level.html">Hydrostatic Level</a><a href="/instrument-range.html">Instrument Range</a><a href="/loop-impedance.html">Loop Impedance</a><a href="/orifice-plate.html">Orifice Plate Beta</a><a href="/pid-tuning.html">PID Tuning</a><a href="/profibus.html">Profibus Calculator</a><a href="/tempsensorresponse.html">Response Time (Tau)</a><a href="/rtd-lead-comp.html">RTD Lead Wire Comp.</a><a href="/sealfluidzeroshift.html">Seal Fluid Shift</a><a href="/snr-calculator.html">SNR Calculator</a><a href="/thermocoupleextensioncable.html">TC Extension Cable</a><a href="/thermowellwakefreq.html">Thermowell Frequency</a><a href="/pressuretransmitteroverrange.html">Tx Overrange</a><a href="/valvecavitationcalculator.html">Valve Cavitation</a><a href="/vibrationtransmitter.html">Vibration Tx</a><a href="/zoneclassificationhelper.html">Zone Classification</a></div><div><a href="/baud-rate.html">Baud Rate Calculator</a><a href="/gascompressibility.html">Compressibility (Z)</a><a href="/dbcalculator.html">dB Gain/Loss Calc</a><a href="/flowprofiledistortioncalculator.html">Flow Distortion</a><a href="/impulselinefreezing.html">Impulse Freezing</a><a href="/intrinsic-safety.html">Intrinsic Safety Loop</a><a href="/measurement.html">Measurement Uncertainty</a><a href="/ph-temp-comp.html">pH Temp Compensation</a><a href="/plcscantime.html">PLC Scan Time</a><a href="/pressurereliefvalve.html">PRV Sizing (API 520)</a><a href="/reynoldsnumbercal.html">Reynolds Number</a><a href="/rtdselfheating.html">RTD Self-Heating</a><a href="/signal-scaling.html">Signal Scaling</a><a href="/staticheadcal.html">Static Head</a><a href="/temperaturesensorlag.html">Temp Sensor Lag</a><a href="/thermowell-wake.html">Thermowell Wake</a><a href="/ultrasoniclevel.html">Ultrasonic Level</a><a href="/valve-cv.html">Valve Cv Viewer</a><a href="/wetlegdensitycompensation.html">Wet Leg Compensation</a></div><div><a href="/capacitance-level.html">Capacitance Level</a><a href="/controlvalvenoise.html">Control Valve Noise</a><a href="/dp-flow-conversion.html">DP Flow Conversion</a><a href="/hartdevices.html">HART Devices</a><a href="/impulse-pressure-drop.html">Impulse Pressure Drop</a><a href="/junctionbox.html">Junction Box Sizing</a><a href="/orifice-flow.html">Orifice Flow Calculator</a><a href="/pid-symbol-library.html">PID Symbol Library</a><a href="/power-supply-load.html">Power Supply Load</a><a href="/prvsizing.html">Relief Orifice Area</a><a href="/rtdexcitationcurrentselection.html">RTD Excitation</a><a href="/rtd-tc-conversion.html">RTD/TC Conversion</a><a href="/sil.html">SIL Calculator</a><a href="/steamflow.html">Steam Flow</a><a href="/thermocouplecjccalculator.html">Thermocouple CJC</a><a href="/turndown.html">Turndown Ratio</a><a href="/controlvalveauthority.html">Valve Authority</a><a href="/controlvalveleakage.html">Valve Leakage Class</a><a href="/wirelesshart.html">WirelessHART Range</a></div>
            </div>
            <div class="view-all-container">
                <a href="/indexinst.html" class="view-all-link">View All Instrumentation Tools â†’</a>
            </div>
        </div>
    </li>
                        
    <li class="dropdown">
        <a href="/indexmech.html" class="dropdown-toggle">Mechanical <i class="fas fa-chevron-down" style="font-size: 0.7em; margin-left: 4px;"></i></a>
        <div class="dropdown-menu">
            <div class="repo-grid"><div><a href="/aircompressorfad.html">Air Compressor FAD</a><a href="/asme-vessel.html">ASME Vessel Design</a><a href="/belt-pulley.html">Belt & Pulley</a><a href="/bolt-torque.html">Bolt Torque</a><a href="/controlvalveactuator.html">Control Valve Actuator</a><a href="/frictionfactortool.html">Darcy Friction Factor</a><a href="/fatigue.html">Fatigue Analysis</a><a href="/fuel-combustion.html">Fuel Combustion</a><a href="/gas.html">Gas Properties</a><a href="/heat-exchanger.html">Heat Exchanger</a><a href="/hydroliccylinder.html">Hydraulic Cylinder</a><a href="/material-compatibility.html">Material Compatibility</a><a href="/nozzle-reinforcement.html">Nozzle Reinforcement</a><a href="/openchannelflow.html">Open Channel Flow</a><a href="/pipescheduletool.html">Pipe Schedule & Stress</a><a href="/pump-head.html">Pump Head</a><a href="/shaft-power-torque.html">Shaft Power & Torque</a><a href="/steam-table.html">Steam Table</a><a href="/vibrationanalysis.html">Vibration Analysis</a></div><div><a href="/air-flow-duct.html">Air Flow Duct Sizing</a><a href="/beam-deflection.html">Beam Deflection</a><a href="/bernoulli-equation.html">Bernoulli Equation</a><a href="/chiller-capacity.html">Chiller Capacity</a><a href="/cooling-tower-sizing.html">Cooling Tower Sizing</a><a href="/darcy-weisbach.html">Darcy-Weisbach</a><a href="/finned-tube-heat-transfer.html">Finned Tube Heat</a><a href="/furnace-heat-duty.html">Furnace Heat Duty</a><a href="/gear-design.html">Gear Design</a><a href="/heat-loss-pipes.html">Heat Loss Pipes</a><a href="/jacketed-vessel-heat-transfer.html">Jacketed Vessel</a><a href="/metalweight.html">Metal Weight Calculator</a><a href="/nptbspthreadcalculator.html">NPT/BSP Threads</a><a href="/overall-heat-transfer.html">Overall Heat Transfer</a><a href="/pipe-stress-flexibility.html">Pipe Stress</a><a href="/pump-power.html">Pump Power</a><a href="/specific-heat-enthalpy.html">Specific Heat</a><a href="/storage-tank-volume.html">Storage Tank Volume</a><a href="/weldingstress.html">Welding Stress</a></div><div><a href="/allowable-stress-safety-factor.html">Allowable Stress</a><a href="/bearinglife.html">Bearing Life Calculator</a><a href="/boiler-efficiency.html">Boiler Efficiency</a><a href="/compressor-power.html">Compressor Power</a><a href="/corrosion-rate.html">Corrosion Rate</a><a href="/fan-laws.html">Fan Laws</a><a href="/foundation.html">Foundation Design</a><a href="/gas-laws.html">Gas Laws</a><a href="/hardness.html">Hardness Converter</a><a href="/conduction-convection-radiation.html">Heat Transfer Modes</a><a href="/machining.html">Machining Calculator</a><a href="/momentofinertia.html">Moment of Inertia</a><a href="/oring.html">O-Ring Sizing</a><a href="/pipe-flow.html">Pipe Flow Calculator</a><a href="/psychrometric.html">Psychrometric Calc</a><a href="/reynolds-number.html">Reynolds Number</a><a href="/spring.html">Spring Design</a><a href="/thermal-expansion.html">Thermal Expansion</a></div>
            </div>
            <div class="view-all-container">
                <a href="/indexmech.html" class="view-all-link">View All Mechanical Tools â†’</a>
            </div>
        </div>
    </li>
                        <li><a href="/index.html#articles">Articles</a></li>
                        <li><a href="/sitemap2.html">Site Map</a></li>
                    </ul>

                    <div class="theme-toggle">
                        <i class="fas fa-sun icon"></i>
                        <label class="switch">
                            <input type="checkbox" id="theme-switch">
                            <span class="slider"></span>
                        </label>
                        <i class="fas fa-moon icon"></i>
                    </div>
                </div>
            </nav>
    </header>

    <main class="container">
        <div class="card">
            <h2><i class="fas fa-ruler-combined"></i> Pipe Schedule & Advanced Stress Calculator</h2>
            <div class="tool-description">
                <p>Commercial-grade <strong>ASME B36.10/B36.19</strong> Pipe Analysis Tool. Provides comprehensive data
                    on <strong>OD, ID, Wall Thickness, Weight</strong>, and <strong>Structural Properties (I, Z,
                        r)</strong>. Includes a B31.3-compliant <strong>Pressure Containment Calculator</strong> that
                    accounts for Mill Tolerance and Corrosion Allowance.</p>
            </div>

            <!-- Tool Switcher -->
            <div class="tool-switcher">
                <button class="tool-btn active" onclick="switchTool('schedule')"><i class="fas fa-table"></i> Schedule &
                    Structural</button>
                <button class="tool-btn" onclick="switchTool('pressure')"><i class="fas fa-tachometer-alt"></i> Advanced
                    Pressure</button>
            </div>

            <!-- Visualizer -->
            <div class="viz-container">
                <canvas id="pipeCanvas"></canvas>
            </div>

            <!-- MODULE 1: SCHEDULE & STRUCTURAL PROPERTIES -->
            <div id="mod-schedule" class="tool-module active">
                <div class="form-row">
                    <div class="form-group">
                        <label>Nominal Pipe Size (NPS)</label>
                        <select id="nps-select">
                            <!-- Filled by JS -->
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Schedule / Weight</label>
                        <select id="sch-select">
                            <!-- Filled by JS -->
                        </select>
                    </div>
                </div>

                <div class="button-wrapper">
                    <button type="button" class="btn" onclick="calcPipe()">Calculate Properties</button>
                </div>

                <div id="structural-results" style="display:none; margin-top:20px;">
                    <h4>Structural Properties (for Stress Analysis)</h4>
                    <div class="res-grid">
                        <div class="res-item">
                            <div class="res-label">Moment of Inertia (I)</div>
                            <div class="res-val" id="res-i">--</div>
                        </div>
                        <div class="res-item">
                            <div class="res-label">Section Modulus (Z)</div>
                            <div class="res-val" id="res-z">--</div>
                        </div>
                        <div class="res-item">
                            <div class="res-label">Radius of Gyration (r)</div>
                            <div class="res-val" id="res-r">--</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- MODULE 2: ADVANCED PRESSURE RATING -->
            <div id="mod-pressure" class="tool-module">
                <div class="form-row">
                    <div class="form-group">
                        <label>Pipe Material (Yield Strength)</label>
                        <select id="mat-select">
                            <option value="35000">ASTM A53 Grade B (35 ksi)</option>
                            <option value="35000">ASTM A106 Grade B (35 ksi)</option>
                            <option value="30000">ASTM A312 TP304 (30 ksi)</option>
                            <option value="30000">ASTM A312 TP316 (30 ksi)</option>
                            <option value="60000">API 5L X60 (60 ksi)</option>
                            <option value="custom">Custom Yield...</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Yield Strength (psi)</label>
                        <input type="number" id="mat-yield" value="35000">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Safety Factor (Design Factor)</label>
                        <input type="number" id="safety-factor" value="1.0" min="1" step="0.1">
                        <p style="font-size:0.75rem; color:var(--text); margin-top:2px;">1.0 = Burst P, 3.0-4.0 =
                            Working P</p>
                    </div>
                    <div class="form-group">
                        <label>Mill Tolerance (%)</label>
                        <input type="number" id="mill-tol" value="12.5" step="0.1">
                        <p style="font-size:0.75rem; color:var(--text); margin-top:2px;">Standard: 12.5% per ASTM A53
                        </p>
                    </div>
                    <div class="form-group">
                        <label>Corrosion Allowance (in)</label>
                        <input type="number" id="corr-allow" value="0.0625" step="0.001">
                        <p style="font-size:0.75rem; color:var(--text); margin-top:2px;">Typical: 0.0625" (1.6mm)</p>
                    </div>
                </div>

                <div class="button-wrapper">
                    <button type="button" class="btn" onclick="calcPressure()">Analyze Pressure Containment</button>
                </div>
            </div>

            <!-- RESULTS -->
            <div class="result-box" id="main-result" style="display:none;">
                <div class="sub-value" id="res-subtitle">Pipe Specifications</div>
                <div id="res-main" class="main-value">--</div>

                <div class="res-grid">
                    <div class="res-item">
                        <div class="res-label">Outside Diameter (OD)</div>
                        <div class="res-val" id="res-od">--</div>
                    </div>
                    <div class="res-item">
                        <div class="res-label">Inside Diameter (ID)</div>
                        <div class="res-val" id="res-id">--</div>
                    </div>
                    <div class="res-item">
                        <div class="res-label">Nominal Wall</div>
                        <div class="res-val" id="res-wall">--</div>
                    </div>
                    <div class="res-item">
                        <div class="res-label">Weight (Steel)</div>
                        <div class="res-val" id="res-weight">--</div>
                    </div>
                    <div class="res-item">
                        <div class="res-label">Internal Area</div>
                        <div class="res-val" id="res-area">--</div>
                    </div>
                    <div class="res-item">
                        <div class="res-label">Fluid Capacity</div>
                        <div class="res-val" id="res-vol">--</div>
                    </div>
                </div>

                <div class="calc-steps" id="calc-steps-box"></div>
            </div>

            <div class="button-wrapper" style="margin-top:40px;">
                <button type="button" id="pdf-btn" class="btn btn-outline"><i class="fas fa-file-pdf"></i> Download
                    Datasheet</button>
            </div>
        </div>

        <!-- EDUCATIONAL SECTION -->
        <div class="card education-section" style="margin-top: 40px;">
            <h2><i class="fas fa-book-open"></i> Engineering Guide: Pipe Design & Stress Analysis</h2>
            <div class="article-content">

                <div class="article-block">
                    <h3>1. Manufacturing Tolerances: The "Mill Tolerance" Rule</h3>
                    <p>In heavy industrial design, utilizing the <strong>nominal</strong> wall thickness for pressure
                        calculations is dangerous. Manufacturing standards like <strong>ASTM A53, A106, and API
                            5L</strong> allow the wall thickness at any point to be up to <strong>12.5% less</strong>
                        than the nominal schedule thickness. </p>
                    <p>When performing ASME B31.3 (Process Piping) or B31.1 (Power Piping) calculations, the engineer
                        must subtract this tolerance. For example, a 0.500" wall pipe is effectively treated as having
                        only 0.4375" of steel for pressure containment purposes.</p>
                </div>

                <div class="article-block">
                    <h3>2. Corrosion Allowance Logic</h3>
                    <p>Pipes degrade over time. To ensure a 20-30 year lifespan, engineers add a "Corrosion Allowance"
                        (CA) to the required thickness. This material is sacrificial. When calculating the Burst
                        Pressure of a <em>new</em> pipe, the CA contributes to strength. However, when calculating the
                        <strong>End-of-Life (EOL) Safe Working Pressure</strong>, the CA must be subtracted from the
                        wall thickness, as that steel is assumed to be gone.
                    </p>
                </div>

                <div class="article-block">
                    <h3>3. Structural Properties for Stress Analysis</h3>
                    <p>Beyond internal pressure, pipes must support their own weight, fluid weight, insulation, and
                        wind/seismic loads. This requires structural beam analysis.</p>
                    <ul>
                        <li><strong>Moment of Inertia ($I$):</strong> Determines the pipe's resistance to bending
                            deflection. Higher $I$ means less sag between supports. Formula: $I = \frac{\pi (OD^4 -
                            ID^4)}{64}$.</li>
                        <li><strong>Section Modulus ($Z$):</strong> Used to calculate the maximum bending stress
                            ($\sigma = M/Z$). Critical for determining if a pipe will yield under a heavy load. Formula:
                            $Z = \frac{2I}{OD}$.</li>
                        <li><strong>Radius of Gyration ($r$):</strong> Used in column buckling analysis. Important for
                            vertical pipe runs or risers. Formula: $r = \sqrt{I/A}$.</li>
                    </ul>
                </div>

                <div class="article-block">
                    <h3>4. ASME B36.10 vs B36.19</h3>
                    <p><strong>ASME B36.10</strong> covers Carbon and Alloy Steel pipes. <strong>ASME B36.19</strong>
                        covers Stainless Steel. While many schedules overlap (e.g., Sch 40 vs Sch 40S), they diverge in
                        larger sizes. Specifically, for NPS 14 and larger, Schedule 10S is often lighter than Schedule
                        10 to reduce the cost of expensive stainless alloys. This calculator utilizes the B36.10
                        standard as the baseline, which is conservative for most carbon steel applications.</p>
                </div>

                <div class="article-block">
                    <h3>5. Frequently Asked Questions (FAQ)</h3>

                    <div class="faq-item">
                        <div class="faq-question" onclick="toggleFaq(this)">1. Why include Mill Tolerance in pressure
                            calculations? <i class="fas fa-chevron-down faq-icon"></i></div>
                        <div class="faq-answer">ASME B31.3 and other design codes require calculations to be based on
                            the minimum possible wall thickness. Manufacturing standards (like ASTM A53/A106) allow the
                            wall thickness to be up to 12.5% thinner than the nominal value stated in the schedule.
                            Ignoring this can lead to catastrophic failure.</div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question" onclick="toggleFaq(this)">2. What is Corrosion Allowance? <i
                                class="fas fa-chevron-down faq-icon"></i></div>
                        <div class="faq-answer">It is extra wall thickness added to the design to account for material
                            loss over the lifespan of the pipe due to corrosion or erosion. Common values are 1.6mm
                            (1/16") or 3.2mm (1/8") depending on the fluid service.</div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question" onclick="toggleFaq(this)">3. What are Moment of Inertia (I) and
                            Section Modulus (Z)? <i class="fas fa-chevron-down faq-icon"></i></div>
                        <div class="faq-answer">These are structural properties used in Pipe Stress Analysis. Moment of
                            Inertia (I) measures resistance to bending. Section Modulus (Z) is used to calculate bending
                            stress. These are critical for determining support spans and flexibility analysis in
                            software like CAESAR II.</div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question" onclick="toggleFaq(this)">4. What is the difference between NPS and
                            DN? <i class="fas fa-chevron-down faq-icon"></i></div>
                        <div class="faq-answer">NPS (Nominal Pipe Size) is the North American standard set in inches
                            (e.g., NPS 4). DN (Diameter Nominal) is the European metric equivalent measured in
                            millimeters (e.g., DN 100). They refer to the same physical pipe size.</div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question" onclick="toggleFaq(this)">5. Does Schedule 40 always mean the same
                            thickness? <i class="fas fa-chevron-down faq-icon"></i></div>
                        <div class="faq-answer">No. The actual wall thickness of "Schedule 40" changes depending on the
                            pipe diameter. For example, NPS 2 Sch 40 is 0.154" thick, while NPS 4 Sch 40 is 0.237"
                            thick.</div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question" onclick="toggleFaq(this)">6. Does this tool support Stainless Steel
                            (B36.19)? <i class="fas fa-chevron-down faq-icon"></i></div>
                        <div class="faq-answer">Yes. While dimensions often align with B36.10, Stainless Steel schedules
                            often include an 'S' suffix (e.g., 10S, 40S, 80S). This calculator includes common stainless
                            thicknesses where applicable.</div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question" onclick="toggleFaq(this)">7. How is pipe weight calculated? <i
                                class="fas fa-chevron-down faq-icon"></i></div>
                        <div class="faq-answer">Weight is calculated based on the volume of steel in the pipe wall.
                            Formula: W = 10.69 * (OD - Wall) * Wall (lb/ft). Carbon steel density is assumed (~0.283
                            lb/in³).</div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question" onclick="toggleFaq(this)">8. What is the "Schedule" number derived
                            from? <i class="fas fa-chevron-down faq-icon"></i></div>
                        <div class="faq-answer">Originally, Schedule = 1000 * (P/S), where P is service pressure and S
                            is allowable stress. Today, it is a standardized lookup value in ASME B36.10.</div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question" onclick="toggleFaq(this)">9. Why is the OD of a 2-inch pipe not 2
                            inches? <i class="fas fa-chevron-down faq-icon"></i></div>
                        <div class="faq-answer">Historical reasons. For NPS 1/8 through 12, the OD is fixed and larger
                            than the nominal size (e.g., NPS 2 OD is 2.375"). For NPS 14 and larger, the OD equals the
                            nominal size.</div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question" onclick="toggleFaq(this)">10. Is Schedule 80 stronger than Schedule
                            40? <i class="fas fa-chevron-down faq-icon"></i></div>
                        <div class="faq-answer">Yes. Schedule 80 has a thicker wall, resulting in a smaller internal
                            diameter (ID) but significantly higher pressure containment capability and mechanical
                            strength.</div>
                    </div>

                </div>
            </div>
        </div>
    </main>

        <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-left">
                    <a href="/" class="footer-logo">
                        <img src="logo.png" alt="Design Calculators Logo" loading="lazy" decoding="async">
                        <span class="footer-logo-text">Design Calculators</span>
                    </a>
                    <p class="footer-description">A comprehensive engineering calculator hub based on IEC, IEEE, and
                        global standards.</p>
                    <div class="social-buttons">
                        <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://designcalculators.co.in"
                            target="_blank" rel="noopener noreferrer" class="social-btn linkedin"
                            aria-label="LinkedIn"><i class="fab fa-linkedin-in"></i></a>
                        <a href="https://www.youtube.com/@designcalculators" target="_blank" rel="noopener noreferrer"
                            class="social-btn youtube" aria-label="YouTube"><i class="fab fa-youtube"></i></a>
                        <a href="https://twitter.com/intent/tweet?url=https://designcalculators.co.in&text=Check%20out%20this%20amazing%20engineering%20calculator%20hub!"
                            target="_blank" rel="noopener noreferrer" class="social-btn twitter" aria-label="Twitter"><i
                                class="fab fa-twitter"></i></a>
                        <a href="https://www.facebook.com/sharer/sharer.php?u=https://designcalculators.co.in"
                            target="_blank" rel="noopener noreferrer" class="social-btn facebook"
                            aria-label="Facebook"><i class="fab fa-facebook-f"></i></a>
                        <a href="https://api.whatsapp.com/send?text=Check%20out%20this%20amazing%20engineering%20resource:%20https://designcalculators.co.in"
                            target="_blank" rel="noopener noreferrer" class="social-btn whatsapp"
                            aria-label="WhatsApp"><i class="fab fa-whatsapp"></i></a>
                    </div>
                </div>
                <div class="footer-right">
                    <div class="footer-col">
                        <h4>Quick Links</h4>
                        <ul>
                            <li><a href='/indexele.html'>Electrical Tools</a></li>
                            <li><a href='/indexmech.html'>Mechanical Tools</a></li>
                            <li><a href='/indexinst.html'>Instrumentation Tools</a></li>
                            <li><a href='/about.html'>About Us</a></li>
                            <li><a href='/faq.html'>FAQ</a></li>
                        </ul>
                    </div>
                    <div class="footer-col">
                        <h4>Learn More</h4>
                        <ul>
                            <li><a href="https://www.youtube.com/@designcalculators" target="_blank"
                                    rel="noopener noreferrer">YouTube Channel</a></li>
                            <li><a href='/contact.html'>Contact Us</a></li>
                            <li><a href='/privacy-policy.html'>Privacy Policy</a></li>
                            <li><a href='/terms-of-service.html'>Terms of Service</a></li>
                            <li><a href='/sitemap2.html'>Sitemap</a></li>
                        </ul>
                    </div>
                    <div class="footer-col">
                        <h4>Our Network</h4>
                        <ul>
                            <li style="margin-bottom: 12px;">
                                <a href="https://reliabilitytools.co.in/" target="_blank" rel="noopener"
                                   style="font-weight: 600; display: block; margin-bottom: 2px;">Reliability Tools</a>
                                <span style="font-size: 0.85rem; color: #94a3b8; line-height: 1.3; display: block;">Reliability
                                    & maintenance engineering calculators.</span>
                            </li>
                            <li style="margin-bottom: 12px;">
                                <a href="https://electrosafe.homes/" target="_blank" rel="noopener"
                                   style="font-weight: 600; display: block; margin-bottom: 2px;">ElectroSafe</a>
                                <span style="font-size: 0.85rem; color: #94a3b8; line-height: 1.3; display: block;">Dedicated
                                    to home electrical safety & protection.</span>
                            </li>
                            <li>
                                <a href="https://knowyourname.co.in/" target="_blank" rel="noopener"
                                   style="font-weight: 600; display: block; margin-bottom: 2px;">KnowYourName</a>
                                <span style="font-size: 0.85rem; color: #94a3b8; line-height: 1.3; display: block;">Scientific
                                    name analysis: Phonetics, Ergonomics & Acoustics.</span>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="footer-disclaimer">
                <p>All calculations are for preliminary engineering design guidance. Final designs must comply with all applicable local and international standards (including but not limited to ASHRAE 90.1, ARI 550/590). Always verify calculations and consult with a licensed professional engineer before implementation or construction.</p>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 Design Calculators. Created by <span style="color: var(--secondary); font-weight: bold;">Anil Sharma</span>. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script>
        // Global State
        let lastResult = {};
        let canvas = document.getElementById('pipeCanvas');
        let ctx = canvas.getContext('2d');

        // --- DATASET: ASME B36.10 Common Sizes (Extended) ---
        // OD in inches. Schedules are thicknesses in inches.
        const PIPE_DATA = {
            "0.5": { od: 0.840, sch: { "10": 0.065, "40": 0.109, "80": 0.147, "160": 0.188, "XXS": 0.294 } },
            "0.75": { od: 1.050, sch: { "10": 0.083, "40": 0.113, "80": 0.154, "160": 0.219, "XXS": 0.308 } },
            "1": { od: 1.315, sch: { "10": 0.109, "40": 0.133, "80": 0.179, "160": 0.250, "XXS": 0.358 } },
            "1.5": { od: 1.900, sch: { "10": 0.109, "40": 0.145, "80": 0.200, "160": 0.281, "XXS": 0.400 } },
            "2": { od: 2.375, sch: { "10": 0.109, "40": 0.154, "80": 0.218, "160": 0.344, "XXS": 0.436 } },
            "2.5": { od: 2.875, sch: { "10": 0.120, "40": 0.203, "80": 0.276, "160": 0.375, "XXS": 0.552 } },
            "3": { od: 3.500, sch: { "10": 0.120, "40": 0.216, "80": 0.300, "160": 0.438, "XXS": 0.600 } },
            "4": { od: 4.500, sch: { "10": 0.120, "40": 0.237, "80": 0.337, "120": 0.438, "160": 0.531, "XXS": 0.674 } },
            "6": { od: 6.625, sch: { "10": 0.134, "40": 0.280, "80": 0.432, "120": 0.562, "160": 0.719, "XXS": 0.864 } },
            "8": { od: 8.625, sch: { "10": 0.148, "20": 0.250, "30": 0.277, "40": 0.322, "60": 0.406, "80": 0.500, "100": 0.594, "120": 0.719, "140": 0.812, "160": 0.906, "XXS": 0.875 } },
            "10": { od: 10.750, sch: { "10": 0.165, "20": 0.250, "30": 0.307, "40": 0.365, "60": 0.500, "80": 0.594, "100": 0.719, "120": 0.844, "140": 1.000, "160": 1.125 } },
            "12": { od: 12.750, sch: { "10": 0.180, "20": 0.250, "30": 0.330, "40": 0.406, "STD": 0.375, "60": 0.562, "80": 0.688, "XS": 0.500, "100": 0.844, "120": 1.000, "140": 1.125, "160": 1.312 } },
            "14": { od: 14.000, sch: { "10": 0.250, "20": 0.312, "30": 0.375, "40": 0.438, "STD": 0.375, "60": 0.594, "80": 0.750, "XS": 0.500, "100": 0.938, "120": 1.094, "140": 1.250, "160": 1.406 } },
            "16": { od: 16.000, sch: { "10": 0.250, "20": 0.312, "30": 0.375, "40": 0.500, "STD": 0.375, "60": 0.656, "80": 0.844, "XS": 0.500, "100": 1.031, "120": 1.219, "140": 1.438, "160": 1.594 } },
            "18": { od: 18.000, sch: { "10": 0.250, "20": 0.312, "30": 0.438, "40": 0.562, "STD": 0.375, "60": 0.750, "80": 0.938, "XS": 0.500, "100": 1.156, "120": 1.375, "140": 1.562, "160": 1.781 } },
            "20": { od: 20.000, sch: { "10": 0.250, "20": 0.375, "30": 0.500, "40": 0.594, "STD": 0.375, "60": 0.812, "80": 1.031, "XS": 0.500, "100": 1.281, "120": 1.500, "140": 1.750, "160": 1.969 } },
            "24": { od: 24.000, sch: { "10": 0.250, "20": 0.375, "30": 0.562, "40": 0.688, "STD": 0.375, "60": 0.969, "80": 1.219, "XS": 0.500, "100": 1.531, "120": 1.812, "140": 2.062, "160": 2.344 } },
            "30": { od: 30.000, sch: { "10": 0.312, "20": 0.500, "30": 0.625, "STD": 0.375, "40": 0.688, "XS": 0.500, "60": 1.000, "80": 1.250 } },
            "36": { od: 36.000, sch: { "10": 0.312, "20": 0.500, "30": 0.625, "STD": 0.375, "40": 0.750, "XS": 0.500, "60": 1.125, "80": 1.406 } }
        };

        // UI Logic
        document.addEventListener('DOMContentLoaded', () => {
            const themeSwitch = document.getElementById('theme-switch');
            if (themeSwitch && localStorage.getItem('theme') === 'dark') {
                document.body.classList.add('dark-mode');
                themeSwitch.checked = true;
            }
            if (themeSwitch) {
                themeSwitch.addEventListener('change', function () {
                    document.body.classList.toggle('dark-mode');
                    localStorage.setItem('theme', this.checked ? 'dark' : 'light');
                });
            }
            document.getElementById('pdf-btn').addEventListener('click', generatePDF);
            document.getElementById('mat-select').addEventListener('change', function () {
                if (this.value !== 'custom') {
                    document.getElementById('mat-yield').value = this.value;
                }
            });

            initPipeSelect();
            resizeCanvas();
            window.addEventListener('resize', resizeCanvas);
        });

        function switchTool(toolId) {
            document.querySelectorAll('.tool-btn').forEach(b => b.classList.remove('active'));
            event.currentTarget.classList.add('active');
            document.querySelectorAll('.tool-module').forEach(m => m.classList.remove('active'));
            document.getElementById('mod-' + toolId).classList.add('active');
            document.getElementById('main-result').style.display = 'none';
            document.getElementById('structural-results').style.display = toolId === 'schedule' ? 'none' : 'none'; // Only show after calc
        }

        function toggleFaq(element) {
            const item = element.parentElement;
            item.classList.toggle('active');
        }

        function initPipeSelect() {
            const npsSel = document.getElementById('nps-select');
            for (let nps in PIPE_DATA) {
                const opt = document.createElement('option');
                opt.value = nps;
                opt.innerText = `NPS ${nps} (DN ${nps < 14 ? (nps * 25.4).toFixed(0) : (nps * 25.4).toFixed(0)})`;
                npsSel.appendChild(opt);
            }
            npsSel.addEventListener('change', updateSchSelect);

            // Set default to 2"
            npsSel.value = "2";
            updateSchSelect();
        }

        function updateSchSelect() {
            const nps = document.getElementById('nps-select').value;
            const schSel = document.getElementById('sch-select');
            schSel.innerHTML = "";

            const schedules = PIPE_DATA[nps].sch;
            for (let s in schedules) {
                const opt = document.createElement('option');
                opt.value = s;
                let label = `Schedule ${s}`;
                if (s === "STD") label = "Standard (STD)";
                if (s === "XS") label = "Extra Strong (XS)";
                if (s === "XXS") label = "Double Extra Strong (XXS)";
                opt.innerText = label;
                schSel.appendChild(opt);
            }
            // Default to 40 if available
            if (schedules["40"]) schSel.value = "40";
        }

        function resizeCanvas() {
            const container = document.querySelector('.viz-container');
            canvas.width = container.clientWidth;
            canvas.height = container.clientHeight;
            if (lastResult.od) drawPipe(lastResult.od, lastResult.id);
        }

        // --- MATH ENGINE ---

        function drawPipe(od, id) {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            const w = canvas.width;
            const h = canvas.height;
            const center = { x: w / 2, y: h / 2 };

            const maxRadius = Math.min(w, h) / 2.2;
            const scale = maxRadius / (od / 2);

            const r_out = (od / 2) * scale;
            const r_in = (id / 2) * scale;

            // Draw Wall (Gray)
            ctx.beginPath();
            ctx.arc(center.x, center.y, r_out, 0, 2 * Math.PI);
            ctx.arc(center.x, center.y, r_in, 0, 2 * Math.PI, true); // Counter-clockwise for hole
            ctx.fillStyle = '#64748B';
            ctx.fill();

            // Draw Outline
            ctx.strokeStyle = '#1E293B';
            ctx.lineWidth = 2;
            ctx.stroke();

            // Dimensions Lines
            ctx.strokeStyle = '#2563EB';
            ctx.beginPath();
            ctx.moveTo(center.x - r_out, center.y);
            ctx.lineTo(center.x + r_out, center.y);
            ctx.stroke();

            ctx.fillStyle = '#FFFFFF';
            ctx.font = 'bold 14px Inter';
            ctx.textAlign = 'center';
            ctx.fillText(`OD: ${od}"`, center.x, center.y - 5);

            ctx.fillStyle = '#F8FAFC';
            ctx.fillText(`ID: ${id.toFixed(3)}"`, center.x, center.y + 15);
        }

        function calcPipe() {
            const nps = document.getElementById('nps-select').value;
            const sch = document.getElementById('sch-select').value;

            const od = PIPE_DATA[nps].od;
            const wall = PIPE_DATA[nps].sch[sch];
            const id = od - (2 * wall);

            // Calc Weight (Steel): 10.69 * (OD - Wall) * Wall
            const weight = 10.69 * (od - wall) * wall;

            // Calc Area (Internal) for flow
            const areaSqIn = Math.PI * Math.pow((id / 2), 2);
            const areaSqFt = areaSqIn / 144;
            const volGalFt = areaSqFt * 7.48052;

            // Structural Properties
            // Moment of Inertia (I) = pi * (OD^4 - ID^4) / 64
            const I = (Math.PI * (Math.pow(od, 4) - Math.pow(id, 4))) / 64;
            // Section Modulus (Z) = 2*I / OD
            const Z = (2 * I) / od;
            // Metal Area (A) = pi * (OD^2 - ID^2) / 4
            const A_metal = (Math.PI * (Math.pow(od, 2) - Math.pow(id, 2))) / 4;
            // Radius of Gyration (r) = sqrt(I/A)
            const r = Math.sqrt(I / A_metal);

            // Results
            document.getElementById('main-result').style.display = 'block';
            document.getElementById('structural-results').style.display = 'block';
            document.getElementById('res-subtitle').innerText = `Specifications: NPS ${nps} Sch ${sch}`;
            document.getElementById('res-main').innerText = `${nps}" Nominal`;

            document.getElementById('res-od').innerText = `${od.toFixed(3)}" (${(od * 25.4).toFixed(1)} mm)`;
            document.getElementById('res-id').innerText = `${id.toFixed(3)}" (${(id * 25.4).toFixed(1)} mm)`;
            document.getElementById('res-wall').innerText = `${wall.toFixed(3)}" (${(wall * 25.4).toFixed(1)} mm)`;
            document.getElementById('res-weight').innerText = `${weight.toFixed(2)} lb/ft (${(weight * 1.488).toFixed(2)} kg/m)`;
            document.getElementById('res-area').innerText = `${areaSqIn.toFixed(2)} sq.in`;
            document.getElementById('res-vol').innerText = `${volGalFt.toFixed(3)} gal/ft`;

            // Update Structural Display
            document.getElementById('res-i').innerText = `${I.toFixed(2)} in⁴`;
            document.getElementById('res-z').innerText = `${Z.toFixed(2)} in³`;
            document.getElementById('res-r').innerText = `${r.toFixed(3)} in`;

            let steps = `<h4>Dimensional Analysis</h4>`;
            steps += `<div class="step-block">
                <span class="step-title">Step 1: Database Lookup (ASME B36.10)</span>
                NPS: ${nps}" $\\rightarrow$ <strong>OD: ${od.toFixed(3)}"</strong><br>
                Schedule: ${sch} $\\rightarrow$ <strong>Wall (t): ${wall.toFixed(3)}"</strong>
            </div>`;
            steps += `<div class="step-block">
                <span class="step-title">Step 2: Derived Dimensions</span>
                ID = OD - 2t = ${od} - 2(${wall}) = <strong>${id.toFixed(3)}"</strong><br>
                Metal Area (A) = $\\frac{\\pi}{4}(OD^2 - ID^2) = \\mathbf{${A_metal.toFixed(2)} \\text{ in}^2}$
            </div>`;
            steps += `<div class="step-block">
                <span class="step-title">Step 3: Structural Properties</span>
                Moment of Inertia ($I$): $\\frac{\\pi(OD^4 - ID^4)}{64} = \\mathbf{${I.toFixed(2)} \\text{ in}^4}$<br>
                Section Modulus ($Z$): $\\frac{2I}{OD} = \\mathbf{${Z.toFixed(2)} \\text{ in}^3}$<br>
                Radius of Gyration ($r$): $\\sqrt{I/A} = \\mathbf{${r.toFixed(3)} \\text{ in}}$
            </div>`;

            document.getElementById('calc-steps-box').innerHTML = steps;
            if (window.MathJax) window.MathJax.typesetPromise();

            drawPipe(od, id);
            lastResult = { nps, sch, od, id, wall, weight, I, Z, r, steps, mode: 'schedule' };
        }

        function calcPressure() {
            // Ensure pipe is selected first
            if (!lastResult.od) {
                calcPipe();
            }
            const od = lastResult.od;
            const t_nom = lastResult.wall;

            const S = parseFloat(document.getElementById('mat-yield').value);
            const SF = parseFloat(document.getElementById('safety-factor').value);
            const millTolPct = parseFloat(document.getElementById('mill-tol').value);
            const corr = parseFloat(document.getElementById('corr-allow').value);

            // 1. Calculate Minimum Wall Thickness (Mill Tolerance)
            // t_min_mfg = t_nominal * (1 - tolerance/100)
            const t_min_mfg = t_nom * (1 - (millTolPct / 100));

            // 2. Subtract Corrosion Allowance (End of Life condition)
            // t_effective = t_min_mfg - corrosion
            let t_eff = t_min_mfg - corr;
            if (t_eff < 0) t_eff = 0; // Safety check

            // 3. Barlow's Formula: P = 2St/D using effective thickness
            const burstPressure = (2 * S * t_eff) / od;
            const safePressure = burstPressure / SF;

            let steps = `<h4>Advanced Pressure Analysis (ASME B31.3 Logic)</h4>`;
            steps += `<div class="step-block">
                <span class="step-title">Step 1: Determine Minimum Mfg Thickness</span>
                Nominal Wall ($t_{nom}$): ${t_nom}"<br>
                Mill Tolerance: ${millTolPct}% (Standard)<br>
                $t_{min} = t_{nom} \\times (1 - 0.${millTolPct}) = ${t_nom} \\times ${(1 - millTolPct / 100).toFixed(3)} = \\mathbf{${t_min_mfg.toFixed(4)} "}$
            </div>`;
            steps += `<div class="step-block">
                <span class="step-title">Step 2: Effective Wall Thickness ($t_{eff}$)</span>
                Corrosion Allowance: ${corr}"<br>
                $t_{eff} = t_{min} - Corrosion = ${t_min_mfg.toFixed(4)} - ${corr} = \\mathbf{${t_eff.toFixed(4)} "}$<br>
                <em>This is the steel remaining at End-of-Life.</em>
            </div>`;
            steps += `<div class="step-block">
                <span class="step-title">Step 3: Burst Pressure Calculation</span>
                Material Yield ($S$): ${S} psi<br>
                $P_{burst} = \\frac{2 S t_{eff}}{OD} = \\frac{2 \\times ${S} \\times ${t_eff.toFixed(4)}}{${od}} = \\mathbf{${burstPressure.toFixed(0)} \\text{ psi}}$
            </div>`;
            steps += `<div class="step-block">
                <span class="step-title">Step 4: Safe Working Pressure</span>
                Safety Factor: ${SF}<br>
                $P_{safe} = \\frac{P_{burst}}{SF} = \\mathbf{${safePressure.toFixed(0)} \\text{ psi}}$
            </div>`;

            document.getElementById('calc-steps-box').innerHTML = steps;
            if (window.MathJax) window.MathJax.typesetPromise();

            // Override main display for pressure context
            document.getElementById('res-subtitle').innerText = `Safe Pressure (SF ${SF}, ${millTolPct}% Tol)`;
            document.getElementById('res-main').innerText = `${safePressure.toFixed(0)} psi`;

            lastResult.mode = 'pressure';
            lastResult.steps = steps;
            lastResult.safeP = safePressure;
        }

        function generatePDF() {
            if (!lastResult.od) { alert("Calculate first!"); return; }
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();

            doc.setFontSize(18); doc.setTextColor(30, 58, 138);
            doc.text("Industrial Pipe Engineering Report", 14, 20);

            doc.setFontSize(12); doc.setTextColor(0);
            doc.text(`Specification: NPS ${lastResult.nps} Schedule ${lastResult.sch}`, 14, 40);
            doc.text(`Date: ${new Date().toLocaleDateString()}`, 14, 50);

            doc.setDrawColor(30, 58, 138);
            doc.setLineWidth(0.5);
            doc.line(14, 55, 196, 55);

            doc.setFontSize(14);
            doc.text(`Physical Dimensions:`, 14, 65);
            doc.setFontSize(12);
            doc.text(`OD: ${lastResult.od}"`, 20, 75);
            doc.text(`ID: ${lastResult.id.toFixed(3)}"`, 20, 85);
            doc.text(`Wall: ${lastResult.wall}"`, 20, 95);
            doc.text(`Weight: ${lastResult.weight.toFixed(2)} lb/ft`, 20, 105);

            if (lastResult.I) {
                doc.setFontSize(14);
                doc.text(`Structural Properties:`, 14, 120);
                doc.setFontSize(12);
                doc.text(`Inertia (I): ${lastResult.I.toFixed(2)} in4`, 20, 130);
                doc.text(`Section Modulus (Z): ${lastResult.Z.toFixed(2)} in3`, 20, 140);
            }

            if (lastResult.safeP) {
                doc.setFontSize(14);
                doc.text(`Pressure Analysis:`, 14, 155);
                doc.setFontSize(12);
                doc.text(`Safe Pressure: ${lastResult.safeP.toFixed(0)} psi`, 20, 165);
            }

            // Add canvas image
            const imgData = canvas.toDataURL("image/png");
            doc.addImage(imgData, 'PNG', 120, 60, 60, 60);

            // Add Steps text (simplified)
            // const stepsText = document.getElementById('calc-steps-box').innerText;
            // const split = doc.splitTextToSize(stepsText, 180);
            // doc.text(split, 14, 180);

            doc.save('Pipe_Analysis_Report.pdf');
        }
    </script>
    <script src="/main.js"></script>
</body>

</html>
