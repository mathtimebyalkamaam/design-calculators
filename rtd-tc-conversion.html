<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RTD / Thermocouple Conversion Tool - Design Calculators - Instrumentation</title>
    <!-- SEO Meta Tags -->
    <meta name="description" content="Professional RTD & Thermocouple calculator. Convert Temperature to Ohms/mV and Ohms/mV to Temperature (Pt100, Pt1000, Type K, J, T, etc.) per IEC 60751 & NIST ITS-90.">
    <meta name="keywords" content="rtd calculator, thermocouple calculator, pt100, pt1000, type k, type j, iec 60751, nist, callendar-van dusen, cjc, instrumentation">
    <meta name="author" content="Design Calculators">
    <meta name="robots" content="index, follow">
    <!-- AdSense & Analytics -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5936527763614780" crossorigin="anonymous"></script>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-23Y1V450SR"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-23Y1V450SR');
    </script>
    <!-- Fonts & Icons -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Montserrat:wght@700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- MathJax for Formulas -->
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['\\(', '\\)'], ['$', '$']],
                displayMath: [['\\[', '\\]'], ['$$', '$$']]
            },
            svg: { fontCache: 'global' },
            options: {
                processHtmlClass: 'math-content', // Process elements with this class
                ignoreHtmlClass: 'no-mathjax'     // Ignore elements with this class
            }
        };
    </script>
    <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <!-- PDF Generation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.8.3/jspdf.plugin.autotable.min.js"></script>
    <!-- Favicon -->
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    
    <style>
        :root {
            --primary: #1E3A8A;
            --secondary: #2563EB;
            --accent: #F59E0B;
            --success: #10B981;
            --danger: #DC2626;
            --warning: #F59E0B;
            --bg: #F8FAFC;
            --card: #FFFFFF;
            --text: #4B5563;
            --heading: #111827;
            --footer-bg: #0F172A;
            --border: #E2E8F0;
            --grad: linear-gradient(135deg, var(--primary), var(--secondary));
            --grad-dark: linear-gradient(135deg, #0F172A, #1E293B);
            --shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
            --shadow-lg: 0 10px 20px rgba(0, 0, 0, 0.1);
        }

        body.dark-mode {
            --primary: #10B981;
            --secondary: #34D399;
            --bg: #0F172A;
            --card: #1E293B;
            --text: #CBD5E1;
            --heading: #F1F5F9;
            --footer-bg: #020617;
            --border: #334155;
        }

        * { box-sizing: border-box; }
        html { scroll-behavior: smooth; }
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg);
            color: var(--text);
            line-height: 1.7;
            margin: 0;
            padding: 0;
        }

        .container { max-width: 1280px; margin: 0 auto; padding: 0 24px; }

        /* Header & Nav */
        header {
            background: var(--grad);
            color: white;
            padding: 24px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .logo-container {
            display: flex;
            flex-direction: column;
            text-decoration: none;
            color: white;
        }
        .logo-text {
            font-size: 1.75rem;
            font-weight: 800;
            font-family: 'Montserrat', sans-serif;
        }
        .logo-subtitle {
            font-size: 0.8rem;
            margin: 4px 0 0 0;
            color: #E0E7FF;
            opacity: 0.9;
        }
        .nav-links {
            display: flex;
            gap: 24px;
            list-style: none;
            margin: 0;
            padding: 0;
        }
        .nav-links a {
            color: white;
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s;
        }
        .nav-links a:hover { color: var(--accent); }
        .theme-toggle {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .switch {
            position: relative;
            width: 56px;
            height: 30px;
        }
        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0,0,0,0.2);
            transition: .4s;
            border-radius: 30px;
        }
        .slider:before {
            position: absolute;
            content: "";
            height: 22px;
            width: 22px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        input:checked + .slider {
            background-color: var(--accent);
        }
        input:checked + .slider:before {
            transform: translateX(26px);
        }
        
        /* Main Content & Cards */
        main { padding: 40px 0; }
        .card {
            background: var(--card);
            border-radius: 12px;
            padding: 30px;
            box-shadow: var(--shadow);
            margin-bottom: 30px;
            border: 1px solid var(--border);
        }
        h2 {
            color: var(--primary);
            border-bottom: 3px solid var(--primary);
            padding-bottom: 15px;
            margin-top: 0;
            font-family: 'Montserrat', sans-serif;
            font-size: 1.8rem;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        h3 {
            color: var(--heading);
            font-family: 'Montserrat', sans-serif;
            font-size: 1.5rem;
            margin-top: 25px;
            margin-bottom: 20px;
        }
        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }
        .form-group {
            margin-bottom: 20px;
        }
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--heading);
        }
        .form-group input,
        .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--border);
            border-radius: 6px;
            background-color: var(--bg);
            color: var(--text);
            font-size: 1rem;
        }
        .form-group input:focus,
        .form-group select:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 3px rgba(30, 58, 138, 0.1);
        }
        body.dark-mode .form-group input:focus {
             box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1);
        }
        
        .btn {
            background: var(--grad);
            color: white;
            border: none;
            padding: 16px 30px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: 700;
            box-shadow: 0 4px 12px rgba(30, 58, 138, 0.3);
            transition: all 0.3s;
            width: 100%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(30, 58, 138, 0.4);
        }
        .btn-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        .btn-group .btn {
            flex: 1;
            min-width: 150px;
        }
        .btn.secondary {
            background: var(--secondary);
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3);
        }
        .btn.accent {
            background: var(--accent);
            box-shadow: 0 4px 12px rgba(245, 158, 11, 0.3);
        }
        
        /* Custom Form Layout for this tool */
        .conversion-direction-group {
            display: flex;
            align-items: center;
            justify-content: space-around;
            margin: 10px 0 20px 0;
            background-color: var(--bg);
            border-radius: 8px;
            padding: 10px;
            border: 1px solid var(--border);
        }
        .conversion-direction-group label {
            display: flex;
            align-items: center;
            cursor: pointer;
            font-weight: 600;
            color: var(--heading);
            padding: 10px;
            border-radius: 6px;
            transition: all 0.2s;
        }
        .conversion-direction-group input[type="radio"] {
            margin-right: 8px;
            transform: scale(1.2); /* Make radio buttons slightly larger */
            accent-color: var(--primary);
        }
        .conversion-direction-group label:has(input:checked) {
            background-color: var(--card);
            color: var(--primary);
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        
        #rtd-fields, #tc-fields {
            display: none; /* Hidden by default */
            border-top: 2px solid var(--border);
            padding-top: 20px;
            margin-top: 20px;
        }
        #rtd-fields.active, #tc-fields.active {
            display: block;
        }
        

        /* CALCULATION STEPS DISPLAY */
        .steps-container {
            display: none;
            margin-top: 30px;
        }
        .steps-container.active {
            display: block;
        }
        .step-card {
            background: var(--card);
            border-radius: 12px;
            padding: 25px 30px;
            box-shadow: var(--shadow);
            border: 1px solid var(--border);
            animation: slideIn 0.6s ease-out;
            transition: all 0.3s;
            margin-bottom: 25px; /* Spacing between cards */
        }
        @keyframes slideIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .step-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }
        .step-card h4 {
            color: var(--primary);
            margin: 0 0 20px 0;
            font-size: 1.4rem;
            font-family: 'Montserrat', sans-serif;
            display: flex;
            align-items: center;
        }
        .step-card .number {
            display: inline-block;
            width: 40px;
            height: 40px;
            background: var(--primary);
            color: white;
            border-radius: 50%;
            text-align: center;
            line-height: 40px;
            font-weight: 700;
            margin-right: 15px;
            font-size: 1.3rem;
            flex-shrink: 0;
        }
        .step-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
            align-items: start;
        }
        @media (max-width: 768px) {
            .step-content {
                grid-template-columns: 1fr;
            }
        }
        .step-content .formula-block {
            background: var(--bg);
            border-radius: 8px;
            padding: 20px;
            font-size: 1rem;
            border: 1px solid var(--border);
        }
        .step-content .formula-block p {
            margin-top: 0;
        }
        .step-content .formula {
            background: var(--bg);
            border-left: 3px solid var(--accent);
            padding: 15px;
            margin: 12px 0;
            font-size: 1rem;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            overflow-x: auto;
        }
        .step-value {
            font-size: 2.2rem;
            font-weight: 800;
            color: var(--success);
            margin: 10px 0;
            line-height: 1.2;
        }
        .step-unit {
            font-size: 1rem;
            color: var(--text);
            opacity: 0.8;
            font-weight: 500;
            margin-left: 5px;
        }
        .step-explanation {
            font-size: 1.05rem;
            line-height: 1.8;
        }

        /* Results */
        .results-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            border-radius: 8px;
            overflow: hidden;
        }
        .results-table th,
        .results-table td {
            padding: 16px;
            text-align: left;
            border-bottom: 1px solid var(--border);
        }
        .results-table th {
            background: var(--grad);
            color: white;
            font-weight: 700;
        }
        .results-table tr:nth-child(even) {
            background-color: var(--bg);
        }
        .results-table td:first-child {
            font-weight: 600;
            color: var(--heading);
        }
        .results-table .highlight {
            font-weight: 700;
            font-size: 1.1rem;
            color: var(--success);
        }

        /* Educational Section */
        .education-section {
            margin-top: 60px;
        }
        .insight-card {
            background: linear-gradient(135deg, var(--card), rgba(37,99,235,0.03));
            border-radius: 12px;
            padding: 25px;
            margin: 20px 0;
            border-left: 5px solid var(--secondary);
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            transition: all 0.3s;
        }
        .insight-card:hover {
            transform: translateX(5px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        .insight-card h4 {
            color: var(--secondary);
            font-size: 1.3rem;
            margin: 0 0 15px 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .insight-card h4 i {
            font-size: 1.5rem;
        }
        .insight-card p {
            margin: 10px 0;
            line-height: 1.8;
        }
        .insight-card ol,
        .insight-card ul {
            padding-left: 20px;
            margin: 10px 0;
        }
        .insight-card li {
            margin-bottom: 10px;
        }
        .stat-highlight {
            display: inline-block;
            background: var(--accent);
            color: #333;
            padding: 4px 12px;
            border-radius: 20px;
            font-weight: 700;
            margin: 0 4px;
        }
        .danger-box {
            background: linear-gradient(135deg, rgba(220,38,38,0.1), rgba(220,38,38,0.05));
            border-left: 5px solid var(--danger);
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
        }
        .danger-box h4 {
            color: var(--danger);
            margin-top: 0;
        }
        .success-box {
            background: linear-gradient(135deg, rgba(16,185,129,0.1), rgba(16,185,129,0.05));
            border-left: 5px solid var(--success);
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
        }
        .success-box h4 {
            color: var(--success);
            margin-top: 0;
        }


        /* Message Box */
        .message-box {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            padding: 16px 28px;
            border-radius: 8px;
            box-shadow: 0 6px 16px rgba(0,0,0,0.25);
            z-index: 10000;
            font-weight: 600;
            color: white;
            opacity: 0;
            transition: all 0.4s;
            display: none;
        }
        .message-box.show {
            display: block;
            opacity: 1;
            top: 30px;
        }

        /* Footer */
        footer {
            background: var(--grad-dark);
            color: #CBD5E1;
            padding: 50px 0 20px 0;
            margin-top: 60px;
        }
        .footer-content {
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 40px;
            margin-bottom: 30px;
        }
        .footer-col {
            flex: 1;
            min-width: 200px;
        }
        .footer-col h4 {
            color: white;
            margin-bottom: 15px;
            font-weight: 700;
        }
        .footer-col ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        .footer-col a {
            color: #CBD5E1;
            text-decoration: none;
            transition: color 0.3s;
        }
        .footer-col a:hover {
            color: var(--accent);
        }
        .social-buttons {
            display: flex;
            gap: 12px;
            margin-top: 15px;
        }
        .social-btn {
            width: 40px;
            height: 40px;
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            border-radius: 50%;
            font-size: 1.1rem;
            transition: transform 0.3s;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        .social-btn:hover {
            transform: translateY(-4px);
        }
        .social-btn.linkedin { background-color: #0A66C2; }
        .social-btn.youtube { background-color: #FF0000; }
        .social-btn.twitter { background-color: #1DA1F2; }
        .social-btn.facebook { background-color: #1877F2; }
        .social-btn.whatsapp { background-color: #25D366; }
        .footer-disclaimer {
            text-align: center;
            padding-top: 25px;
            border-top: 1px solid #334155;
            max-width: 800px;
            margin: 0 auto;
            font-size: 0.9rem;
        }
        .footer-bottom {
            text-align: center;
            padding-top: 20px;
            font-size: 0.9rem;
            color: #94A3B8;
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .container { padding: 0 15px; }
            .navbar { flex-direction: column; gap: 20px; }
            .nav-links { flex-direction: column; gap: 12px; text-align: center; }
            .form-row { grid-template-columns: 1fr; }
            .card { padding: 20px; }
            .footer-content { flex-direction: column; gap: 25px; }
            .btn-group { flex-direction: column; }
            .conversion-direction-group { flex-direction: column; align-items: stretch; }
        }
        .hidden { display: none; }
        
        /* Tooltip */
        .info-icon {
            color: var(--primary);
            margin-left: 5px;
            cursor: help;
        }
        .tooltip {
            position: relative;
            display: inline-block;
        }
        .tooltip .tooltiptext {
            visibility: hidden;
            width: 250px; /* Adjusted width */
            background-color: #333;
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 8px; /* Increased padding */
            position: absolute;
            z-index: 10;
            bottom: 125%;
            left: 50%;
            margin-left: -125px; /* Half of width */
            opacity: 0;
            transition: opacity 0.3s, transform 0.3s;
            transform: translateY(10px);
            font-family: 'Inter', sans-serif; /* Professional font */
            font-size: 0.85rem; /* Slightly smaller font size */
            line-height: 1.4; /* Better readability */
        }
        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
            transform: translateY(0);
        }

    </style>
</head>
<body>
    <div id="message-box" class="message-box"></div>

    <header>
        <div class="container">
            <nav class="navbar">
                <a href="index.html" class="logo-container">
                    <span class="logo-text">Design Calculators</span>
                    <p class="logo-subtitle">Inspired by standards such as IEC, IEEE, ISA, ASME, and API.</p>
                </a>
                <ul class="nav-links">
                    <li><a href="index.html">Home</a></li>
                    <li><a href="articles">Articles</a></li>
                    <li><a href="indexmech">Mechanical</a></li>
                    <li><a href="indexele">Electrical</a></li>
                    <li><a href="indexinst">Instrumentation</a></li>
                </ul>
                <div class="theme-toggle">
                    <i class="fas fa-sun"></i>
                    <label class="switch">
                        <input type="checkbox" id="theme-switch">
                        <span class="slider"></span>
                    </label>
                    <i class="fas fa-moon"></i>
                </div>
            </nav>
        </div>
    </header>

    <main class="container">
        <div class="card">
            <h2><i class="fas fa-thermometer-half"></i> RTD / Thermocouple Conversion Tool</h2>
            
             <p>This comprehensive tool converts resistance (for RTDs) or millivolt signals (for Thermocouples) to temperature, and vice versa. Designed for high precision and reliability, it supports various sensor types and is essential for calibration, troubleshooting, and process control in all industrial sectors worldwide.</p>
            
            <div class="calculator-form">
                <form id="rtd-tc-form">
                    
                    <h3>Sensor Configuration</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="sensor-type">Select Sensor Type:</label>
                            <select id="sensor-type" required>
                                <option value="rtd">RTD (Resistance Temperature Detector)</option>
                                <option value="thermocouple">Thermocouple</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="temp-unit">Select Temperature Unit:</label>
                            <select id="temp-unit" required>
                                <option value="celsius">Celsius (°C)</option>
                                <option value="fahrenheit">Fahrenheit (°F)</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="conversion-direction-group">
                        <label>
                            <input type="radio" name="conversion-direction" value="to-temp" checked> Convert Signal to Temperature
                        </label>
                        <label>
                            <input type="radio" name="conversion-direction" value="to-signal"> Convert Temperature to Signal
                        </label>
                    </div>

                    <!-- RTD Specific Inputs -->
                    <div id="rtd-fields" class="active"> <!-- Start with RTD active by default -->
                        <h3>RTD Parameters (IEC 60751)</h3>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="rtd-type">RTD Type:</label>
                                <select id="rtd-type" required>
                                    <option value="pt100">Pt100 (α = 0.00385)</option>
                                    <option value="pt1000">Pt1000 (α = 0.00385)</option>
                                </select>
                            </div>
                            <div class="form-group" id="rtd-resistance-input-group">
                                <label for="rtd-resistance">Resistance (Ohms): <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Enter the measured resistance from the RTD.</span></span></label>
                                <input type="number" id="rtd-resistance" step="0.001" value="100.000" required>
                            </div>
                            <div class="form-group" id="rtd-temperature-input-group" style="display: none;">
                                <label for="rtd-temperature">Temperature: <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Enter the temperature to convert to RTD resistance.</span></span></label>
                                <input type="number" id="rtd-temperature" step="0.01" value="0.00" required>
                            </div>
                        </div>
                    </div>

                    <!-- Thermocouple Specific Inputs -->
                    <div id="tc-fields">
                        <h3>Thermocouple Parameters (NIST ITS-90)</h3>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="tc-type">Thermocouple Type:</label>
                                <select id="tc-type" required>
                                    <option value="type-k">Type K (NiCr-NiAl)</option>
                                    <option value="type-j">Type J (Fe-CuNi)</option>
                                    <option value="type-t">Type T (Cu-CuNi)</option>
                                    <option value="type-e">Type E (NiCr-CuNi)</option>
                                    <option value="type-n">Type N (NiCrSi-NiSi)</option>
                                    <option value="type-r">Type R (Pt-13%Rh/Pt)</option>
                                    <option value="type-s">Type S (Pt-10%Rh/Pt)</option>
                                    <option value="type-b">Type B (Pt-30%Rh/Pt-6%Rh)</option>
                                </select>
                            </div>
                            <div class="form-group" id="tc-millivolt-input-group">
                                <label for="tc-millivolt">Millivolt (mV): <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Enter the measured millivolt signal from the thermocouple.</span></span></label>
                                <input type="number" id="tc-millivolt" step="0.001" value="0.000" required>
                            </div>
                            <div class="form-group" id="tc-temperature-input-group" style="display: none;">
                                <label for="tc-temperature">Temperature: <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Enter the temperature to convert to thermocouple millivolt.</span></span></label>
                                <input type="number" id="tc-temperature" step="0.01" value="0.00" required>
                            </div>
                        </div>
                        <div class="form-row" style="grid-template-columns: 1fr;">
                            <div class="form-group">
                                <label for="cold-junction-temp">Cold Junction Temperature (°C): <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">The reference junction temperature. 0°C if compensated, or enter the actual ambient temperature at the terminals.</span></span></label>
                                <input type="number" id="cold-junction-temp" step="0.1" value="0.0" required>
                            </div>
                        </div>
                    </div>

                    <div class="btn-group" style="margin-top: 25px;">
                        <button type="button" id="calculate-conversion-btn" class="btn"><i class="fas fa-calculator"></i> Calculate</button>
                        <button type="button" id="reset-form-btn" class="btn accent"><i class="fas fa-sync-alt"></i> Reset</button>
                        <button type="button" id="pdf-btn" class="btn secondary" style="display: none;"><i class="fas fa-file-pdf"></i> Download PDF</button>
                    </div>
                </form>
            </div>
        </div>
        
        <!-- NEW Step-by-Step Results Container -->
        <div id="steps-container" class="steps-container math-content">
            <!-- Step cards will be dynamically inserted here -->
        </div>

        <!-- NEW Results Table -->
        <div id="results-section" class="card hidden" style="margin-top: 40px;">
            <h3><i class="fas fa-clipboard-check"></i> Calculation Summary</h3>
            <table class="results-table">
                <thead>
                    <tr>
                        <th>Parameter</th>
                        <th>Value</th>
                    </tr>
                </thead>
                <tbody id="results-tbody">
                    <!-- Results will be dynamically inserted here -->
                </tbody>
            </table>
        </div>
        
        <!-- NEW/EXPANDED EDUCATIONAL INSIGHTS SECTION -->
        <div id="education-section" class="education-section card">
            <h2><i class="fas fa-lightbulb"></i> Professional Insights: RTD vs. Thermocouple</h2>

            <div class="insight-card">
                <h4><i class="fas fa-ruler-combined"></i> What is an RTD (Resistance Temperature Detector)?</h4>
                <p>An RTD is a high-precision temperature sensor. Its principle is simple: as the temperature of a metal (like platinum) increases, its electrical resistance increases in a very stable and predictable way. A "Pt100" is the most common type, meaning it has a resistance of <strong>100.0 Ohms at 0°C</strong>. A "Pt1000" has 1000.0 Ohms at 0°C.</p>
                <p>The relationship between resistance ($R$) and temperature ($T$) is defined by the <strong>Callendar-Van Dusen equation</strong> (part of the IEC 60751 standard):
                <div class="formula-block math-content">
                    $R_T = R_0 \cdot (1 + A \cdot T + B \cdot T^2)$ &nbsp;&nbsp;&nbsp; (for $T \ge 0^\circ C$)<br>
                    $R_T = R_0 \cdot [1 + A \cdot T + B \cdot T^2 + C \cdot (T-100) \cdot T^3]$ &nbsp;&nbsp;&nbsp; (for $T < 0^\circ C$)
                </div>
                </p>
                <p>Where $R_0$ is the resistance at 0°C, and $A$, $B$, and $C$ are standard coefficients for platinum.</p>
                <ul>
                    <li><strong>Pros:</strong> Very high accuracy, excellent stability and repeatability, good linearity over a wide range.</li>
                    <li><strong>Cons:</strong> More expensive, slower response time, susceptible to self-heating (from the measurement current), more fragile.</li>
                </ul>
            </div>

            <div class="insight-card">
                <h4><i class="fas fa-bolt"></i> What is a Thermocouple?</h4>
                <p>A thermocouple is a rugged, versatile temperature sensor. It works on the <strong>Seebeck effect</strong>: when two different types of metal wires (e.g., Nickel-Chromium and Nickel-Alumel for a Type K) are joined at one end, they create a tiny, temperature-dependent voltage (in millivolts). As the temperature at the "hot junction" (the measurement tip) changes, this voltage changes in a predictable, non-linear way defined by NIST tables.</p>
                
                <ul>
                    <li><strong>Pros:</strong> Extremely wide temperature range (e.g., -200°C to over 2000°C), very fast response, durable, self-powered (generates its own voltage), and inexpensive.</li>
                    <li><strong>Cons:</strong> Less accurate than an RTD, non-linear, and requires **Cold Junction Compensation**.</li>
                </ul>
            </div>
            
            <div class="danger-box">
                <h4><i class="fas fa-snowflake"></i> The "Gotcha!": Cold Junction Compensation (CJC)</h4>
                <p>This is the most critical and most misunderstood concept in thermocouple measurement. A thermocouple **does not measure absolute temperature**. It only measures the **temperature difference** between its hot junction (the tip) and its cold junction (the terminals on the transmitter or PLC card).</p>
                <p>If the hot junction is 100°C and the terminal block (cold junction) is 25°C, the thermocouple will only output the millivolts for <strong>75°C</strong> (100 - 25).</p>
                <p>To get the correct reading, the transmitter *must* have a second, built-in thermometer (a thermistor) to measure the temperature of the terminal block. This is the **Cold Junction Compensation (CJC)**.
                <div class="formula-block" style="text-align:center; font-weight:bold; font-size: 1.1rem;">
                    $T_{\text{Actual}} = T_{\text{Measured (from mV)}} + T_{\text{Cold Junction}}$
                </div>
                This calculator requires you to enter the cold junction temperature (often 0°C for tables, or a real-world 20-25°C) to perform this essential compensation. A 0.0mV reading does not mean 0°C; it means the hot end is the exact same temperature as the cold end.</p>
            </div>

            <div class="insight-card">
                <h4><i class="fas fa-project-diagram"></i> Why 3-Wire and 4-Wire RTDs are Better than 2-Wire</h4>
                <p>The problem with RTDs is that the connecting copper wires also have resistance. This "lead resistance" adds to the RTD's resistance, making the transmitter think the temperature is higher than it really is. A 100-foot run of wire could add several Ohms, translating to many degrees of error.</p>
                
                <ul>
                    <li><strong>2-Wire RTD:</strong> The cheapest method. The transmitter measures the total resistance of the RTD *plus* both lead wires. It's impossible to separate the true RTD resistance from the wire resistance. <strong>This method is inaccurate and should not be used in industry.</strong><br>
                    $R_{\text{Total}} = R_{\text{RTD}} + R_{\text{Wire1}} + R_{\text{Wire2}}$</li>
                    
                    <li><strong>3-Wire RTD:</strong> The most common industrial standard. It uses a clever bridge circuit. It measures the resistance of the RTD + 2 wires, then measures the resistance of *just* 2 wires on a "compensation loop." By subtracting the wire resistance, it calculates the *true* resistance of the RTD element. This works perfectly as long as all three wires are the same length, gauge, and material.</li>
                    
                    <li><strong>4-Wire RTD:</strong> The most accurate (laboratory grade). It uses two wires to send a tiny, precise measurement current (e.g., 1mA) *through* the RTD. It then uses two *completely separate* wires to measure the voltage drop *directly across* the RTD element. Since no current flows in the measurement wires, their resistance doesn't matter. Ohm's Law ($V=IR$) gives the true resistance of the RTD with zero error from the lead wires.</li>
                </ul>
            </div>
            
            <div class="success-box">
                <h4><i class="fas fa-check-circle"></i> When to Choose Which Sensor</h4>
                <p><strong>Use an RTD (e.g., Pt100) when you need:</strong></p>
                <ul>
                    <li><strong>High Accuracy:</strong> For critical process control, custody transfer, or scientific measurement where 0.1°C matters.</li>
                    <li><strong>High Stability:</strong> For applications that must not "drift" over time.</li>
                    <li><strong>Good Linearity:</strong> When you need a signal that is nearly linear with temperature.</li>
                    <li><strong>Typical Range:</strong> -200°C to 600°C.</li>
                </ul>
                <p><strong>Use a Thermocouple (e.g., Type K) when you need:</strong></p>
                <ul>
                    <li><strong>High Temperature:</strong> For furnaces, ovens, engines, or anything over 600°C.</li>
                    <li><strong>Fast Response:</strong> For processes that change temperature very quickly.</li>
                    <li><strong>Durability:</strong> For high-vibration or high-impact environments.</li>
                    <li><strong>Low Cost:</strong> When you need to measure many points cheaply.</li>
                    <li><strong>Point Sensing:</strong> When you need to measure the temperature of a tiny, specific point.</li>
                </ul>
            </div>

        </div>

    </main>

    <!-- FOOTER -->
    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-col">
                    <h4>Design Calculators</h4>
                    <p style="font-size: 0.9rem; line-height: 1.6; margin-bottom: 15px;">If you find this tool helpful, please consider sharing it with your colleagues!</p>
                    <div class="social-buttons">
                        <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://designcalculators.co.in" target="_blank" rel="noopener noreferrer" class="social-btn linkedin" title="LinkedIn"><i class="fab fa-linkedin-in"></i></a>
                        <a href="https://www.youtube.com/@designcalculators" target="_blank" rel="noopener noreferrer" class="social-btn youtube" title="YouTube"><i class="fab fa-youtube"></i></a>
                        <a href="https://twitter.com/intent/tweet?url=https://designcalculators.co.in" target="_blank" rel="noopener noreferrer" class="social-btn twitter" title="Twitter"><i class="fab fa-twitter"></i></a>
                        <a href="https://www.facebook.com/sharer/sharer.php?u=https://designcalculators.co.in" target="_blank" rel="noopener noreferrer" class="social-btn facebook" title="Facebook"><i class="fab fa-facebook-f"></i></a>
                        <a href="https://api.whatsapp.com/send?text=Check%20out%20this%20amazing%20engineering%20resource%20https://designcalculators.co.in" target="_blank" rel="noopener noreferrer" class="social-btn whatsapp" title="WhatsApp"><i class="fab fa-whatsapp"></i></a>
                    </div>
                </div>
                <div class="footer-col">
                    <h4>Quick Links</h4>
                    <ul>
                        <li><a href="index.html">Home</a></li>
                        <li><a href="indexele">Electrical</a></li>
                        <li><a href="indexmech">Mechanical</a></li>
                        <li><a href="indexinst">Instrumentation</a></li>
                        <li><a href="articles">Articles</a></li>
                    </ul>
                </div>
                <div class="footer-col">
                    <h4>Resources</h4>
                    <ul>
                        <li><a href="about">About Us</a></li>
                        <li><a href="contact">Contact</a></li>
                        <li><a href="faq">FAQ</a></li>
                        <li><a href="privacy-policy">Privacy Policy</a></li>
                        <li><a href="terms-of-service">Terms of Service</a></li>
                    </ul>
                </div>
                <div class="footer-col">
                    <h4>More</h4>
                    <ul>
                        <li><a href="articles.html">Articles & Whitepapers</a></li>
                        <li><a href="sitemap2.html">Sitemap</a></li>
                        <li><a href="https://www.youtube.com/@designcalculators" target="_blank" rel="noopener noreferrer">YouTube Channel</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-disclaimer">
                <p>RTD calculations are based on the Callendar-Van Dusen equation per IEC 60751. Thermocouple calculations are based on NIST ITS-90 polynomials. This tool is for guidance only. Always use calibrated equipment and refer to official standards for critical applications.</p>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 Design Calculators. Created by <span style="color: var(--secondary); font-weight: bold;">A Sharma</span>. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // --- Elements ---
            const sensorTypeSelect = document.getElementById('sensor-type');
            const rtdFields = document.getElementById('rtd-fields');
            const tcFields = document.getElementById('tc-fields');
            const conversionDirectionRadios = document.querySelectorAll('input[name="conversion-direction"]');
            const rtdResistanceInputGroup = document.getElementById('rtd-resistance-input-group');
            const rtdTemperatureInputGroup = document.getElementById('rtd-temperature-input-group');
            const tcMillivoltInputGroup = document.getElementById('tc-millivolt-input-group');
            const tcTemperatureInputGroup = document.getElementById('tc-temperature-input-group');
            const tempUnitSelect = document.getElementById('temp-unit');
            
            const calculateConversionBtn = document.getElementById('calculate-conversion-btn');
            const resetFormBtn = document.getElementById('reset-form-btn');
            const pdfBtn = document.getElementById('pdf-btn');
            
            const resultsSection = document.getElementById('results-section');
            const resultsTbody = document.getElementById('results-tbody');
            const stepsContainer = document.getElementById('steps-container');
            const messageBox = document.getElementById('message-box');
            const themeSwitch = document.getElementById('theme-switch');

            let lastInputs = null; // For PDF

            // --- Default Values ---
            const defaultValues = {
                'sensor-type': 'rtd',
                'temp-unit': 'celsius',
                'rtd-type': 'pt100',
                'rtd-resistance': "100.000",
                'rtd-temperature': "0.00",
                'tc-type': 'type-k',
                'tc-millivolt': "0.000",
                'tc-temperature': "0.00",
                'cold-junction-temp': "0.0"
            };

            // --- RTD Coefficients (IEC 60751) ---
            const rtdCoefficients = {
                'pt100': { R0: 100, A: 3.9083e-3, B: -5.775e-7, C: -4.183e-12 },
                'pt1000': { R0: 1000, A: 3.9083e-3, B: -5.775e-7, C: -4.183e-12 }
            };

            // --- Thermocouple Coefficients (NIST ITS-90 Polynomials) ---
            // Note: These are simplified/approximated for demonstration.
            // A full implementation requires extensive lookup tables or complex, multi-range polynomials.
            const tcCoefficients = {
                'type-k': {
                    // T(mV) -> C (Approx. 0-1372C)
                    mV_to_T: (mV) => {
                        if (mV === 0) return 0;
                        // Simplified 2nd order poly for demo. A real one is 9th+ order.
                        // Using a more accurate (but still approx) poly
                        return 25.08355 * mV + 0.078601 * Math.pow(mV, 2) - 0.250313 * Math.pow(mV, 3) + 0.0831527 * Math.pow(mV, 4) - 0.0122803 * Math.pow(mV, 5) + 0.000980404 * Math.pow(mV, 6) - 4.41303e-5 * Math.pow(mV, 7) + 1.05773e-6 * Math.pow(mV, 8) - 1.05276e-8 * Math.pow(mV, 9);
                    },
                    // T(C) -> mV (Approx. 0-1372C)
                    T_to_mV: (T) => {
                        if (T === 0) return 0;
                        // Simplified poly for demo.
                        // Using a more accurate (but still approx) poly
                        return (0.041065 * T) + (5.89539e-6 * Math.pow(T, 2)) - (1.10788e-7 * Math.pow(T, 3)) + (5.32119e-11 * Math.pow(T, 4));
                    },
                    range: { minT: -200, maxT: 1372 }
                },
                // Other types are placeholders
                'type-j': { T_to_mV: (T) => T / 19.3, mV_to_T: (mV) => mV * 19.3, range: { minT: -210, maxT: 1200 } },
                'type-t': { T_to_mV: (T) => T / 25.6, mV_to_T: (mV) => mV * 25.6, range: { minT: -270, maxT: 400 } },
                'type-e': { T_to_mV: (T) => T / 16.9, mV_to_T: (mV) => mV * 16.9, range: { minT: -270, maxT: 1000 } },
                'type-n': { T_to_mV: (T) => T / 27.8, mV_to_T: (mV) => mV * 27.8, range: { minT: -270, maxT: 1300 } },
                'type-r': { T_to_mV: (T) => T / 103.0, mV_to_T: (mV) => mV * 103.0, range: { minT: -50, maxT: 1768 } },
                'type-s': { T_to_mV: (T) => T / 114.9, mV_to_T: (mV) => mV * 114.9, range: { minT: -50, maxT: 1768 } },
                'type-b': { T_to_mV: (T) => T / 138.9, mV_to_T: (mV) => mV * 138.9, range: { minT: 0, maxT: 1820 } }
            };

            // --- Event Listeners ---
            sensorTypeSelect.addEventListener('change', updateSensorFieldsVisibility);
            conversionDirectionRadios.forEach(radio => radio.addEventListener('change', updateInputFieldsVisibility));
            calculateConversionBtn.addEventListener('click', performConversion);
            resetFormBtn.addEventListener('click', resetForm);
            pdfBtn.addEventListener('click', generatePDF);
            tempUnitSelect.addEventListener('change', updateTempInputLabels);
            
            // --- Theme & Message Box ---
            if (localStorage.getItem('theme') === 'dark') {
                document.body.classList.add('dark-mode');
                themeSwitch.checked = true;
            }
            themeSwitch.addEventListener('change', function() {
                if (this.checked) {
                    document.body.classList.add('dark-mode');
                    localStorage.setItem('theme', 'dark');
                } else {
                    document.body.classList.remove('dark-mode');
                    localStorage.setItem('theme', 'light');
                }
            });

            function showMessage(msg, type = 'success') {
                messageBox.textContent = msg;
                if (type === 'error') {
                    messageBox.style.backgroundColor = 'var(--danger)';
                } else if (type === 'warning') {
                     messageBox.style.backgroundColor = 'var(--warning)';
                     messageBox.style.color = '#333';
                } else {
                    messageBox.style.backgroundColor = 'var(--success)';
                    messageBox.style.color = 'white';
                }
                messageBox.classList.add('show');
                setTimeout(() => messageBox.classList.remove('show'), 4000);
            }

            // --- Form Management ---

            function updateSensorFieldsVisibility() {
                const selectedType = sensorTypeSelect.value;
                if (selectedType === 'rtd') {
                    rtdFields.classList.add('active');
                    tcFields.classList.remove('active');
                } else {
                    tcFields.classList.add('active');
                    rtdFields.classList.remove('active');
                }
                updateInputFieldsVisibility();
            }

            function updateInputFieldsVisibility() {
                const selectedSensorType = sensorTypeSelect.value;
                const selectedDirection = document.querySelector('input[name="conversion-direction"]:checked').value;

                if (selectedSensorType === 'rtd') {
                    if (selectedDirection === 'to-temp') {
                        rtdResistanceInputGroup.style.display = 'block';
                        rtdTemperatureInputGroup.style.display = 'none';
                        document.getElementById('rtd-resistance').setAttribute('required', 'required');
                        document.getElementById('rtd-temperature').removeAttribute('required');
                    } else { // to-signal
                        rtdResistanceInputGroup.style.display = 'none';
                        rtdTemperatureInputGroup.style.display = 'block';
                        document.getElementById('rtd-resistance').removeAttribute('required');
                        document.getElementById('rtd-temperature').setAttribute('required', 'required');
                    }
                } else { // thermocouple
                    if (selectedDirection === 'to-temp') {
                        tcMillivoltInputGroup.style.display = 'block';
                        tcTemperatureInputGroup.style.display = 'none';
                        document.getElementById('tc-millivolt').setAttribute('required', 'required');
                        document.getElementById('tc-temperature').removeAttribute('required');
                    } else { // to-signal
                        tcMillivoltInputGroup.style.display = 'none';
                        tcTemperatureInputGroup.style.display = 'block';
                        document.getElementById('tc-millivolt').removeAttribute('required');
                        document.getElementById('tc-temperature').setAttribute('required', 'required');
                    }
                }
                updateTempInputLabels();
            }
            
            function updateTempInputLabels() {
                const unit = tempUnitSelect.value === 'celsius' ? '°C' : '°F';
                document.querySelector('#rtd-temperature-input-group label').innerHTML = `Temperature (${unit}): <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Enter the temperature to convert to RTD resistance.</span></span>`;
                document.querySelector('#tc-temperature-input-group label').innerHTML = `Temperature (${unit}): <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Enter the temperature to convert to thermocouple millivolt.</span></span>`;
            }

            function resetForm() {
                for (const id in defaultValues) {
                    const input = document.getElementById(id);
                    if (input) input.value = defaultValues[id];
                }
                document.querySelector('input[name="conversion-direction"][value="to-temp"]').checked = true;
                
                updateSensorFieldsVisibility();
                
                stepsContainer.classList.remove('active');
                stepsContainer.innerHTML = '';
                resultsSection.classList.add('hidden');
                pdfBtn.style.display = 'none';
                
                lastInputs = null;
                
                showMessage("Form reset to default values.", "success");
            }
            
            // --- Calculation Functions ---

            // T -> R for RTD
            function rtdTempToResistance(tempC, rtdType) {
                const { R0, A, B, C } = rtdCoefficients[rtdType];
                if (tempC >= 0) {
                    return R0 * (1 + A * tempC + B * tempC * tempC);
                } else {
                    return R0 * (1 + A * tempC + B * tempC * tempC + C * (tempC - 100) * tempC * tempC);
                }
            }

            // R -> T for RTD
            function rtdResistanceToTemp(resistance, rtdType) {
                const { R0, A, B, C } = rtdCoefficients[rtdType];
                if (resistance < 0) throw new Error("Resistance cannot be negative.");
                
                // For T < 0°C, the equation is a 4th-order polynomial (complex).
                // For T >= 0°C, it's a simple quadratic.
                
                // Solve quadratic for T >= 0
                let discriminant = A * A - 4 * B * (1 - resistance / R0);
                if (discriminant >= 0) {
                    let tempC = (-A + Math.sqrt(discriminant)) / (2 * B);
                    if (tempC >= -0.1) return tempC; // Allow small tolerance near zero
                }
                
                // If T < 0 or quadratic fails, use iterative search (Newton-Raphson)
                let T = -100; // Initial guess
                for (let i = 0; i < 20; i++) { // Max 20 iterations
                    let R = rtdTempToResistance(T, rtdType);
                    let R_prime = R0 * (A + 2*B*T + C*(4*T*T*T - 300*T*T)); // Derivative
                    let T_new = T - (R - resistance) / R_prime;
                    if (Math.abs(T_new - T) < 1e-6) return T_new;
                    T = T_new;
                }
                throw new Error("RTD conversion failed to converge. Check resistance value.");
            }

            // T -> mV for Thermocouple
            function tcTempToMillivolt(tempC, tcType) {
                if (!tcCoefficients[tcType]) throw new Error(`Unknown thermocouple type: ${tcType}`);
                if (tcType !== 'type-k') {
                    // Using placeholder linear func for non-K types
                    return tcCoefficients[tcType].T_to_mV(tempC);
                }
                // Use more accurate poly for Type K
                const T = tempC;
                let mV = (0.041065 * T) + (5.89539e-6 * Math.pow(T, 2)) - (1.10788e-7 * Math.pow(T, 3)) + (5.32119e-11 * Math.pow(T, 4));
                return mV;
            }

            // mV -> T for Thermocouple
            function tcMillivoltToTemp(millivolt, tcType) {
                if (!tcCoefficients[tcType]) throw new Error(`Unknown thermocouple type: ${tcType}`);
                if (tcType !== 'type-k') {
                     // Using placeholder linear func for non-K types
                    return tcCoefficients[tcType].mV_to_T(millivolt);
                }
                
                // Use Newton-Raphson iterative solver for Type K
                let T_guess = millivolt * 25; // Initial guess (based on ~40uV/C)
                for (let i = 0; i < 20; i++) {
                    let mV_guess = tcTempToMillivolt(T_guess, tcType);
                    let derivative = (tcTempToMillivolt(T_guess + 0.01, tcType) - mV_guess) / 0.01; // Approx derivative
                    let T_new = T_guess - (mV_guess - millivolt) / derivative;
                    if (Math.abs(T_new - T_guess) < 1e-6) return T_new;
                    T_guess = T_new;
                }
                throw new Error("TC conversion failed to converge. Check millivolt value.");
            }

            // --- Main Conversion Function ---
            function performConversion() {
                stepsContainer.innerHTML = ''; // Clear
                resultsTbody.innerHTML = '';
                
                try {
                    const selectedSensorType = sensorTypeSelect.value;
                    const selectedDirection = document.querySelector('input[name="conversion-direction"]:checked').value;
                    const tempUnit = tempUnitSelect.value;
                    
                    let resultValue, outputUnit, inputVal, inputUnit, tempC;
                    let step1Html = '', step2Html = '', step3Html = '';
                    
                    const inputsForPdf = { sensorType: selectedSensorType, direction: selectedDirection, tempUnit };
                    const resultsForPdf = {};

                    if (selectedSensorType === 'rtd') {
                        const rtdType = document.getElementById('rtd-type').value;
                        const { R0 } = rtdCoefficients[rtdType];
                        inputsForPdf.rtdType = rtdType;

                        if (selectedDirection === 'to-temp') {
                            inputVal = parseFloat(document.getElementById('rtd-resistance').value);
                            if (isNaN(inputVal) || inputVal < 0) throw new Error("Please enter a valid positive RTD Resistance.");
                            inputUnit = "Ohms";
                            inputsForPdf.inputValue = `${inputVal} ${inputUnit}`;
                            
                            tempC = rtdResistanceToTemp(inputVal, rtdType);
                            resultValue = (tempUnit === 'fahrenheit') ? (tempC * 9/5) + 32 : tempC;
                            outputUnit = (tempUnit === 'fahrenheit') ? '°F' : '°C';
                            
                            // --- RTD: R -> T Steps ---
                            step1Html = `<div class="step-card">
                                <h4><span class="number">1</span>Input Parameters</h4>
                                <div class="step-content">
                                    <div class="step-explanation">Sensor: <strong>${rtdType.toUpperCase()}</strong><br>Standard: <strong>IEC 60751</strong><br>R @ 0°C (R₀): <strong>${R0} Ω</strong></div>
                                    <div class="step-explanation">Input Signal: <strong>${inputVal.toFixed(3)} Ω</strong><br>Direction: <strong>Signal to Temp</strong></div>
                                </div>
                            </div>`;
                            
                            step2Html = `<div class="step-card math-content">
                                <h4><span class="number">2</span>Calculation (Callendar-Van Dusen)</h4>
                                <div class="step-explanation">
                                    <p>The sensor's resistance is converted to Celsius using the inverse of the Callendar-Van Dusen equation, which is defined by IEC 60751. This formula is complex, especially for T < 0°C.</p>
                                    <p class="formula">$$T = f(R_T, R_0, A, B, C)$$</p>
                                    <p>Solving this for $T$ with an input of <strong>${inputVal.toFixed(3)} Ω</strong> gives:</p>
                                    <div class="step-value" style="color:var(--heading); font-size: 1.5rem;">${tempC.toFixed(3)}<span class="step-unit">°C</span></div>
                                </div>
                            </div>`;
                            
                            step3Html = `<div class="step-card">
                                <h4><span class="number">3</span>Final Conversion</h4>
                                <div class="step-content">
                                    <div class="step-explanation">
                                        <p>The Celsius temperature is converted to your selected unit (${outputUnit}).</p>
                                        ${tempUnit === 'fahrenheit' ? `<p class="formula">°F = (°C × 9/5) + 32</p>` : `<p>Unit is already Celsius.</p>`}
                                    </div>
                                    <div>
                                        <p><strong>Final Temperature:</strong></p>
                                        <div class="step-value">${resultValue.toFixed(3)}<span class="step-unit">${outputUnit}</span></div>
                                    </div>
                                </div>
                            </div>`;

                        } else { // RTD: T -> R
                            inputVal = parseFloat(document.getElementById('rtd-temperature').value);
                            if (isNaN(inputVal)) throw new Error("Please enter a valid Temperature.");
                            inputUnit = (tempUnit === 'fahrenheit') ? '°F' : '°C';
                            inputsForPdf.inputValue = `${inputVal} ${inputUnit}`;
                            
                            tempC = (tempUnit === 'fahrenheit') ? (inputVal - 32) * 5/9 : inputVal;
                            resultValue = rtdTempToResistance(tempC, rtdType);
                            outputUnit = 'Ohms';

                            // --- RTD: T -> R Steps ---
                            step1Html = `<div class="step-card">
                                <h4><span class="number">1</span>Input Parameters</h4>
                                <div class="step-content">
                                    <div class="step-explanation">Sensor: <strong>${rtdType.toUpperCase()}</strong><br>Standard: <strong>IEC 60751</strong><br>R @ 0°C (R₀): <strong>${R0} Ω</strong></div>
                                    <div class="step-explanation">Input Temp: <strong>${inputVal.toFixed(2)} ${inputUnit}</strong><br>Direction: <strong>Temp to Signal</strong></div>
                                </div>
                            </div>`;
                            
                            step2Html = `<div class="step-card math-content">
                                <h4><span class="number">2</span>Calculation (Callendar-Van Dusen)</h4>
                                <div class="step-explanation">
                                    <p>The input temperature is first converted to Celsius, then plugged into the Callendar-Van Dusen equation (IEC 60751) to find the corresponding resistance.</p>
                                    ${tempUnit === 'fahrenheit' ? `<p class="formula">°C = (°F - 32) × 5/9 = <strong>${tempC.toFixed(2)} °C</strong></p>` : ''}
                                    <p class="formula">$$R_T = R_0 \cdot (1 + A \cdot T + B \cdot T^2 \dots)$$</p>
                                    <p>Solving this for $R_T$ with an input of <strong>${tempC.toFixed(2)} °C</strong> gives:</p>
                                </div>
                            </div>`;
                            
                            step3Html = `<div class="step-card">
                                <h4><span class="number">3</span>Final Conversion</h4>
                                <div class="step-content">
                                    <div class="step-explanation">
                                        <p>The calculation yields the final resistance value.</p>
                                    </div>
                                    <div>
                                        <p><strong>Final Resistance:</strong></p>
                                        <div class="step-value">${resultValue.toFixed(3)}<span class="step-unit">${outputUnit}</span></div>
                                    </div>
                                </div>
                            </div>`;
                        }
                        
                        resultsForPdf.inputLabel = "Input Resistance";
                        resultsForPdf.outputLabel = "Calculated Temperature";
                        if(selectedDirection === 'to-signal') {
                            resultsForPdf.inputLabel = "Input Temperature";
                            resultsForPdf.outputLabel = "Calculated Resistance";
                        }
                        
                    } else { // Thermocouple
                        const tcType = document.getElementById('tc-type').value;
                        const coldJunctionTempC = parseFloat(document.getElementById('cold-junction-temp').value);
                        if (isNaN(coldJunctionTempC)) throw new Error("Please enter a valid Cold Junction Temperature.");
                        
                        inputsForPdf.tcType = tcType;
                        inputsForPdf.cjc = `${coldJunctionTempC} °C`;
                        
                        if (tcCoefficients[tcType] && (tcType !== 'type-k')) {
                             showMessage(`Warning: ${tcType} calculations are simplified linear approximations and not based on full NIST tables. Use for estimation only.`, "warning");
                        }

                        if (selectedDirection === 'to-temp') {
                            inputVal = parseFloat(document.getElementById('tc-millivolt').value);
                            if (isNaN(inputVal)) throw new Error("Please enter a valid Millivolt value.");
                            inputUnit = "mV";
                            inputsForPdf.inputValue = `${inputVal} ${inputUnit}`;
                            
                            const coldJunctionmV = tcTempToMillivolt(coldJunctionTempC, tcType);
                            const compensatedmV = inputVal + coldJunctionmV;
                            
                            tempC = tcMillivoltToTemp(compensatedmV, tcType);
                            resultValue = (tempUnit === 'fahrenheit') ? (tempC * 9/5) + 32 : tempC;
                            outputUnit = (tempUnit === 'fahrenheit') ? '°F' : '°C';
                            
                            // --- TC: mV -> T Steps ---
                            step1Html = `<div class="step-card">
                                <h4><span class="number">1</span>Input Parameters</h4>
                                <div class="step-content">
                                    <div class="step-explanation">Sensor: <strong>${tcType.toUpperCase()}</strong><br>Standard: <strong>NIST ITS-90</strong><br>Direction: <strong>Signal to Temp</strong></div>
                                    <div class="step-explanation">Input Signal: <strong>${inputVal.toFixed(3)} ${inputUnit}</strong><br>CJC Temp: <strong>${coldJunctionTempC.toFixed(1)} °C</strong></div>
                                </div>
                            </div>`;
                            
                            step2Html = `<div class="step-card math-content">
                                <h4><span class="number">2</span>Cold Junction Compensation (CJC)</h4>
                                <div class="step-explanation">
                                    <p>First, the transmitter's "Cold Junction" temperature (${coldJunctionTempC.toFixed(1)}°C) is converted to its millivolt equivalent.</p>
                                    <p class="formula">CJC (mV) = f(${coldJunctionTempC.toFixed(1)}°C) = <strong>${coldJunctionmV.toFixed(3)} mV</strong></p>
                                    <p>This is added to your measured signal to get the *true* millivolt value relative to 0°C.</p>
                                    <p class="formula">Total (mV) = ${inputVal.toFixed(3)} + ${coldJunctionmV.toFixed(3)} = <strong>${compensatedmV.toFixed(3)} mV</strong></p>
                                </div>
                            </div>`;

                            step3Html = `<div class="step-card">
                                <h4><span class="number">3</span>Final Conversion</h4>
                                <div class="step-content">
                                    <div class="step-explanation">
                                        <p>The total compensated millivolt value is converted to Celsius using high-order NIST polynomials. This value is then converted to your selected unit (${outputUnit}).</p>
                                        ${tempUnit === 'fahrenheit' ? `<p class="formula">°F = (${tempC.toFixed(3)}°C × 9/5) + 32</p>` : `<p>Unit is already Celsius.</p>`}
                                    </div>
                                    <div>
                                        <p><strong>Final Temperature:</strong></p>
                                        <div class="step-value">${resultValue.toFixed(3)}<span class="step-unit">${outputUnit}</span></div>
                                    </div>
                                </div>
                            </div>`;
                            
                            resultsForPdf.inputLabel = "Input Millivolt";
                            resultsForPdf.outputLabel = "Calculated Temperature";

                        } else { // TC: T -> mV
                            inputVal = parseFloat(document.getElementById('tc-temperature').value);
                            if (isNaN(inputVal)) throw new Error("Please enter a valid Temperature.");
                            inputUnit = (tempUnit === 'fahrenheit') ? '°F' : '°C';
                            inputsForPdf.inputValue = `${inputVal} ${inputUnit}`;
                            
                            tempC = (tempUnit === 'fahrenheit') ? (inputVal - 32) * 5/9 : inputVal;
                            
                            const millivoltAtTemp = tcTempToMillivolt(tempC, tcType);
                            const coldJunctionmV = tcTempToMillivolt(coldJunctionTempC, tcType);
                            
                            resultValue = millivoltAtTemp - coldJunctionmV;
                            outputUnit = 'mV';
                            
                            // --- TC: T -> mV Steps ---
                            step1Html = `<div class="step-card">
                                <h4><span class="number">1</span>Input Parameters</h4>
                                <div class="step-content">
                                    <div class="step-explanation">Sensor: <strong>${tcType.toUpperCase()}</strong><br>Standard: <strong>NIST ITS-90</strong><br>Direction: <strong>Temp to Signal</strong></div>
                                    <div class="step-explanation">Input Temp: <strong>${inputVal.toFixed(2)} ${inputUnit}</strong><br>CJC Temp: <strong>${coldJunctionTempC.toFixed(1)} °C</strong></div>
                                </div>
                            </div>`;
                            
                            step2Html = `<div class="step-card math-content">
                                <h4><span class="number">2</span>Cold Junction Compensation (CJC)</h4>
                                <div class="step-explanation">
                                    <p>The total millivolts for the *hot* junction and *cold* junction are calculated separately using NIST polynomials (relative to 0°C).</p>
                                    ${tempUnit === 'fahrenheit' ? `<p class="formula">Input °C = (${inputVal.toFixed(2)}°F - 32) × 5/9 = <strong>${tempC.toFixed(2)} °C</strong></p>` : ''}
                                    <p class="formula">Hot mV = f(${tempC.toFixed(2)}°C) = <strong>${millivoltAtTemp.toFixed(3)} mV</strong></p>
                                    <p class="formula">Cold mV = f(${coldJunctionTempC.toFixed(1)}°C) = <strong>${coldJunctionmV.toFixed(3)} mV</strong></p>
                                </div>
                            </div>`;

                            step3Html = `<div class="step-card">
                                <h4><span class="number">3</span>Final Conversion</h4>
                                <div class="step-content">
                                    <div class="step-explanation">
                                        <p>The final signal is the *difference* between the hot and cold junction millivolts. This is the value the transmitter will actually measure.</p>
                                        <p class="formula">Signal (mV) = Hot (mV) - Cold (mV)</p>
                                    </div>
                                    <div>
                                        <p><strong>Final Millivolt Signal:</strong></p>
                                        <div class="step-value">${resultValue.toFixed(3)}<span class="step-unit">${outputUnit}</span></div>
                                    </div>
                                </div>
                            </div>`;
                            
                            resultsForPdf.inputLabel = "Input Temperature";
                            resultsForPdf.outputLabel = "Calculated Millivolt";
                        }
                    }
                    
                    // Populate Summary Table
                    resultsTbody.innerHTML = `
                        <tr>
                            <td>Sensor Type</td>
                            <td>${inputsForPdf.sensorType.toUpperCase()} ${selectedSensorType === 'rtd' ? `(${inputsForPdf.rtdType.toUpperCase()})` : `(${inputsForPdf.tcType.toUpperCase()})`}</td>
                        </tr>
                        <tr>
                            <td>Conversion</td>
                            <td>${inputsForPdf.direction === 'to-temp' ? 'Signal to Temperature' : 'Temperature to Signal'}</td>
                        </tr>
                        <tr>
                            <td>${resultsForPdf.inputLabel}</td>
                            <td>${inputsForPdf.inputValue}</td>
                        </tr>
                        ${selectedSensorType === 'thermocouple' ? `<tr><td>Cold Junction</td><td>${inputsForPdf.cjc}</td></tr>` : ''}
                        <tr>
                            <td><strong>${resultsForPdf.outputLabel}</strong></td>
                            <td class="highlight"><strong>${resultValue.toFixed(3)} ${outputUnit}</strong></td>
                        </tr>
                    `;
                    
                    // Store final results for PDF
                    lastInputs = {
                        inputs: inputsForPdf,
                        results: Array.from(resultsTbody.querySelectorAll('tr')).map(tr => [
                            tr.cells[0].textContent,
                            tr.cells[1].textContent
                        ])
                    };
                    
                    // Show sections
                    stepsContainer.innerHTML = step1Html + step2Html + step3Html;
                    stepsContainer.classList.add('active');
                    resultsSection.classList.remove('hidden');
                    pdfBtn.style.display = 'inline-flex';

                    setTimeout(() => {
                        resultsSection.scrollIntoView({ behavior: 'smooth' });
                    }, 100); 

                    // Typeset MathJax
                    if (window.MathJax && typeof window.MathJax.typesetPromise === 'function') {
                        setTimeout(() => {
                            window.MathJax.typesetPromise([stepsContainer]);
                        }, 50); 
                    }
                    
                    showMessage("Calculation successful!", "success");

                } catch (e) {
                    showMessage(e.message, "error");
                    // Hide results on error
                    stepsContainer.classList.remove('active');
                    resultsSection.classList.add('hidden');
                    pdfBtn.style.display = 'none';
                    lastInputs = null;
                }
            }
            
            // --- PDF Generation ---
            function generatePDF() {
                if (!lastInputs) {
                    showMessage('Please run a calculation first.', 'error');
                    return;
                }
                
                try {
                    const { jsPDF } = window.jspdf;
                    const pdf = new jsPDF('p', 'mm', 'a4');
                    let y = 15;
                    const { inputs, results } = lastInputs;

                    pdf.setFont('helvetica', 'bold');
                    pdf.setFontSize(16);
                    pdf.text('RTD/Thermocouple Conversion Report', 105, y, { align: 'center' });
                    y += 8;
                    pdf.setFont('helvetica', 'normal');
                    pdf.setFontSize(9);
                    pdf.text(`Generated by Design Calculators | ${new Date().toLocaleString()}`, 105, y, { align: 'center' });
                    y += 10;
                    
                    pdf.setFont('helvetica', 'bold');
                    pdf.setFontSize(12);
                    pdf.text('Input Parameters', 14, y);
                    y += 2;
                    
                    const inputRows = [
                        ["Sensor Type", `${inputs.sensorType.toUpperCase()} ${inputs.rtdType ? `(${inputs.rtdType.toUpperCase()})` : `(${inputs.tcType.toUpperCase()})`}`],
                        ["Conversion", `${inputs.direction === 'to-temp' ? 'Signal to Temperature' : 'Temperature to Signal'}`],
                        [results[2][0], results[2][1]], // Input Value row
                    ];
                    if(inputs.sensorType === 'thermocouple') {
                        inputRows.push(["Cold Junction", inputs.cjc]);
                    }
                    
                    pdf.autoTable({
                        startY: y,
                        head: [['Parameter', 'Value']],
                        body: inputRows,
                        margin: { left: 14, right: 14 },
                        theme: 'grid',
                        headStyles: { fillColor: [30, 58, 138] },
                    });
                    y = pdf.autoTable.previous.finalY + 10;

                    // Add Results
                    pdf.setFont('helvetica', 'bold');
                    pdf.setFontSize(12);
                    pdf.text('Calculation Summary', 14, y);
                    y += 2;
                    
                    pdf.autoTable({
                        startY: y,
                        head: [['Parameter', 'Value']],
                        body: [results[results.length-1]], // Only the last row (Final Result)
                        margin: { left: 14, right: 14 },
                        theme: 'grid',
                        headStyles: { fillColor: [30, 58, 138] },
                        didParseCell: function (data) {
                            data.cell.styles.textColor = [16, 185, 129]; // Green
                            data.cell.styles.fontStyle = 'bold';
                        }
                    });
                    y = pdf.autoTable.previous.finalY + 15;

                    // Add footer
                    pdf.setFont('helvetica', 'normal');
                    pdf.setFontSize(10);
                    pdf.setTextColor(40, 40, 40);
                    pdf.text('For more calculators and information, visit http://designcalculators.co.in', 105, y, { align: 'center' });
                    y += 5;
                    pdf.setFontSize(8);
                    pdf.setTextColor(100, 100, 100);
                    pdf.text('This report is for guidance only. Always use calibrated equipment and refer to official standards.', 105, y, { align: 'center' });

                    pdf.save('RTD-TC-Conversion-Report.pdf');
                    showMessage('PDF downloaded successfully');

                } catch (e) {
                    showMessage(`Error generating PDF: ${e.message}`, 'error');
                }
            }
            
            // Initial setup call
            updateSensorFieldsVisibility();

        });
    </script>
</body>
</html>

