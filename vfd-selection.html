<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>World-Class VFD Selection Tool - Design Calculators - Electrical</title>
    <!-- Meta tags -->
    <meta name="description" content="Professional VFD selection tool. Calculate VFD size based on motor power, load type, environment, and derating factors per IEC/IEEE standards.">
    <meta name="keywords" content="vfd selection calculator, vfd sizing, variable frequency drive, motor control, iec, ieee, electrical calculator, vfd derating">
    <meta name="author" content="Design Calculators">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://designcalculators.co.in/vfd-selection.html" />

    <!-- AdSense & Google Analytics -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5936527763614780" crossorigin="anonymous"></script>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-23Y1V450SR"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-23Y1V450SR');
    </script>
    
    <!-- Fonts and Icons -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Montserrat:wght@700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- MathJax for formula rendering -->
    <script>
        window.MathJax = {
            tex: { inlineMath: [['$', '$'], ['\\(', '\\)']] },
            svg: { fontCache: 'global' },
            options: { processHtmlClass: 'math-content', ignoreHtmlClass: 'no-mathjax' }
        };
    </script>
    <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    
    <!-- PDF Generation Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

    <!-- Favicons -->
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    
    <!-- Standardized CSS -->
    <style>
        :root {
            --primary-color: #1E3A8A;
            --secondary-color: #2563EB;
            --accent-color: #F59E0B;
            --success-color: #10B981;
            --bg-color: #F8FAFC;
            --card-bg: #FFFFFF;
            --text-color: #4B5563;
            --heading-color: #111827;
            --footer-bg: #0F172A;
            --border-color: #E2E8F0;
            --gradient-primary: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            --gradient-dark: linear-gradient(135deg, #0F172A, #1E293B);
            --card-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            --hover-color: #e2e6ea;
            --input-focus-shadow: 0 0 0 3px rgba(30, 58, 138, 0.25);
        }

        body.dark-mode {
            --primary-color: #10B981;
            --secondary-color: #34D399;
            --bg-color: #0F172A;
            --card-bg: #1E293B;
            --text-color: #CBD5E1;
            --heading-color: #F1F5F9;
            --footer-bg: #020617;
            --border-color: #334155;
            --hover-color: #1E293B;
            --input-focus-shadow: 0 0 0 3px rgba(16, 185, 129, 0.5);
        }

        * { box-sizing: border-box; }
        html { scroll-behavior: smooth; }
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            line-height: 1.8;
            transition: background-color 0.3s, color 0.3s;
            overflow-x: hidden;
            margin: 0;
            padding: 0;
        }
        .container {
            max-width: 1280px;
            margin: 0 auto;
            padding: 0 24px;
        }

        /* HEADER */
        .header {
            background: var(--gradient-primary);
            color: white;
            padding: 24px 0;
            position: relative;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .logo-container {
            flex-direction: column;
            align-items: flex-start;
            text-decoration: none;
            color: white;
            gap: 0;
        }
        .logo-text {
            font-size: 1.75rem;
            font-weight: 800;
            font-family: 'Montserrat', sans-serif;
        }
        .logo-subtitle {
            font-size: 0.8rem;
            line-height: 1.2;
            margin: 4px 0 0 0;
            font-weight: 300;
            max-width: 400px;
            color: #E0E7FF;
        }
        
        .nav-links {
            display: flex;
            gap: 24px;
            align-items: center;
            list-style: none;
            margin: 0;
            padding: 0;
        }
        .nav-links a {
            color: white;
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s;
        }
        .nav-links a:hover { color: var(--accent-color); }

        /* Theme Toggle */
        .theme-toggle {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .theme-toggle .icon {
            color: white;
            font-size: 1.2rem;
        }
        .switch {
            position: relative;
            display: inline-block;
            width: 56px;
            height: 30px;
        }
        .switch input { opacity: 0; width: 0; height: 0; }
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0,0,0,0.2);
            transition: .4s;
            border-radius: 30px;
        }
        .slider:before {
            position: absolute;
            content: "";
            height: 22px;
            width: 22px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        input:checked + .slider { background-color: var(--accent-color); }
        input:checked + .slider:before { transform: translateX(26px); }

        /* Main Content */
        main { padding: 40px 0; }
        .tool-container {
            background-color: var(--card-bg);
            border-radius: 12px;
            padding: 30px;
            box-shadow: var(--card-shadow);
            margin-bottom: 30px;
        }
        .tool-container h2 {
            color: var(--primary-color);
            border-bottom: 3px solid var(--primary-color);
            padding-bottom: 15px;
            margin-top: 0;
            margin-bottom: 25px;
            font-family: 'Montserrat', sans-serif;
            font-size: 1.8rem;
        }
         .tool-container h3 {
            color: var(--heading-color);
            font-family: 'Montserrat', sans-serif;
            font-size: 1.5rem;
            margin-top: 25px;
            margin-bottom: 20px;
        }
        .tool-description {
            margin-bottom: 25px;
            color: var(--text-color);
            font-size: 1rem;
            line-height: 1.8;
        }
        .tool-description a {
            color: var(--primary-color);
            text-decoration: none;
            font-weight: 500;
        }
        .tool-description a:hover {
            text-decoration: underline;
        }

        /* Form Styles */
        .calculator-form {
            background-color: var(--card-bg);
            border-radius: 12px;
            padding: 25px;
            margin-top: 25px;
        }
        .form-group { margin-bottom: 20px; }
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--heading-color);
        }
        .form-group input, .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--border-color);
            border-radius: 6px;
            background-color: var(--bg-color);
            color: var(--text-color);
            box-sizing: border-box;
            transition: all 0.3s;
            font-size: 1rem;
        }
        .form-group input:focus, .form-group select:focus {
            border-color: var(--primary-color);
            box-shadow: var(--input-focus-shadow);
            outline: none;
        }
        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }
        
        /* Button Styles */
        .calculate-btn {
            background: var(--gradient-primary);
            color: white;
            border: none;
            padding: 16px 30px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: 700;
            transition: all 0.3s;
            width: 100%;
            box-shadow: 0 4px 12px rgba(30, 58, 138, 0.3);
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }
        .calculate-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(30, 58, 138, 0.4);
        }
        .calculate-btn:active {
            transform: translateY(0);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        .calculate-btn:disabled {
            background: #9ca3af;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        .calculate-btn .spinner {
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-left-color: #ffffff;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
            display: none;
            margin-left: 10px;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Result Styles */
        .result-container {
            margin-top: 40px;
            padding: 30px;
            border-radius: 12px;
            background-color: var(--card-bg);
            box-shadow: var(--card-shadow);
            display: none;
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.5s ease-out, transform 0.5s ease-out;
        }
        .result-container.show {
            display: block;
            opacity: 1;
            transform: translateY(0);
        }
        .result-container h3 {
            color: var(--primary-color);
            margin-bottom: 25px;
            font-family: 'Montserrat', sans-serif;
            font-size: 1.6rem;
        }
        .result-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            border-radius: 8px;
            overflow: hidden;
        }
        .result-table th, .result-table td {
            padding: 14px;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
        }
        .result-table th {
            background: var(--gradient-primary);
            color: white;
            font-weight: 700;
        }
        .result-table tr:nth-child(even) {
            background-color: rgba(0,0,0,0.02);
        }
        .result-table td strong {
            color: var(--heading-color);
        }
        body.dark-mode .result-table td strong {
             color: var(--primary-color);
        }
        /* Animation for table rows */
        @keyframes fadeInSlideUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .result-table-body tr {
            opacity: 0;
            transform: translateY(20px);
            animation: fadeInSlideUp 0.5s ease-out forwards;
        }
        /* Staggered delay for rows */
        .result-table-body tr:nth-child(1) { animation-delay: 0s; }
        .result-table-body tr:nth-child(2) { animation-delay: 0.05s; }
        .result-table-body tr:nth-child(3) { animation-delay: 0.1s; }
        .result-table-body tr:nth-child(4) { animation-delay: 0.15s; }
        .result-table-body tr:nth-child(5) { animation-delay: 0.2s; }
        .result-table-body tr:nth-child(6) { animation-delay: 0.25s; }
        .result-table-body tr:nth-child(7) { animation-delay: 0.3s; }
        .result-table-body tr:nth-child(8) { animation-delay: 0.35s; }
        .result-table-body tr:nth-child(9) { animation-delay: 0.4s; }
        
        /* Calculation Details & Standard Ref */
        #calculation-details { 
            background-color: var(--bg-color);
            border: 2px solid var(--border-color);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 25px;
            font-size: 0.95rem;
        }
        #calculation-details h3 {
            color: var(--primary-color);
            margin-bottom: 25px;
            font-family: 'Montserrat', sans-serif;
            font-size: 1.6rem;
            margin-top: 0;
        }
        #calculation-details h4 {
            color: var(--secondary-color);
            margin-top: 0;
            margin-bottom: 15px;
            font-size: 1.2rem;
        }
        #calculation-details p.formula {
            font-family: 'Times New Roman', serif;
            font-size: 1.1rem;
            text-align: center;
            padding: 15px;
            background-color: var(--hover-color);
            border-radius: 6px;
            margin: 15px 0;
            overflow-x: auto;
        }
        #calculation-details p.calculation-step {
            font-family: 'Courier New', monospace;
            background-color: var(--hover-color);
            padding: 8px 12px;
            border-radius: 4px;
            margin-bottom: 8px;
            line-height: 1.6;
        }
        #calculation-details ul {
            list-style-type: disc;
            margin-left: 25px;
            padding-left: 0;
        }
        #calculation-details ul li {
            margin-bottom: 8px;
            line-height: 1.7;
        }
        .standard-reference {
            margin-top: 25px;
            font-style: italic;
            font-size: 0.95rem;
            padding: 15px;
            background: linear-gradient(135deg, rgba(245,158,11,0.1), rgba(245,158,11,0.05));
            border-left: 4px solid var(--accent-color);
            border-radius: 6px;
            line-height: 1.7;
        }
         .standard-reference a {
            color: var(--primary-color);
            text-decoration: none;
            font-weight: 500;
        }
        .standard-reference a:hover {
            text-decoration: underline;
        }

        /* Tooltip */
        .info-icon {
            color: var(--primary-color);
            margin-left: 6px;
            cursor: help;
            font-size: 0.9rem;
        }
        .tooltip {
            position: relative;
            display: inline-block;
        }
        .tooltip .tooltiptext {
            visibility: hidden;
            width: 280px;
            background-color: #333;
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 10px;
            position: absolute;
            z-index: 1000;
            bottom: 130%;
            left: 50%;
            margin-left: -140px;
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 0.85rem;
            line-height: 1.5;
            white-space: normal;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
        }
        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }

        /* Custom Message Box */
        #custom-message-box {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            padding: 16px 28px;
            border-radius: 8px;
            box-shadow: 0 6px 16px rgba(0,0,0,0.25);
            z-index: 10000;
            font-weight: 600;
            color: white;
            opacity: 0;
            transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
        }
        #custom-message-box.show { opacity: 1; }

        /* New Content Block Styles */
        .content-block { 
            background-color: var(--card-bg);
            border-radius: 12px;
            padding: 30px;
            box-shadow: var(--card-shadow);
            margin-bottom: 30px;
            margin-top: 30px;
            opacity: 1;
            transform: translateY(0);
            transition: opacity 0.5s ease-out, transform 0.5s ease-out;
        }
        .content-block.show {
            opacity: 1;
            transform: translateY(0);
        }
        .content-block h2 {
            color: var(--primary-color);
            border-bottom: 3px solid var(--primary-color);
            padding-bottom: 15px;
            margin-top: 0;
            margin-bottom: 25px;
            font-family: 'Montserrat', sans-serif;
            font-size: 1.8rem;
        }
        .content-block h3 {
            color: var(--heading-color);
            font-family: 'Montserrat', sans-serif;
            font-size: 1.4rem;
            margin-top: 25px;
            margin-bottom: 15px;
        }
         .content-block h4 {
            color: var(--secondary-color);
            font-family: 'Montserrat', sans-serif;
            font-size: 1.2rem;
            margin-top: 20px;
            margin-bottom: 10px;
        }
        .content-block p, .content-block li {
            font-size: 1rem;
            line-height: 1.8;
            color: var(--text-color);
        }
        .content-block ul, .content-block ol {
            list-style-type: disc;
            margin-left: 20px;
            padding-left: 5px;
            margin-bottom: 15px;
        }
        .content-block ol {
            list-style-type: decimal;
        }
        .content-block li {
            margin-bottom: 10px;
        }
        .content-block strong {
            color: var(--heading-color);
        }
        body.dark-mode .content-block strong {
            color: var(--primary-color);
        }
        .content-block code {
            background-color: var(--hover-color);
            padding: 2px 5px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            color: var(--primary-color);
        }
        body.dark-mode .content-block code {
            color: var(--secondary-color);
        }
        .content-block .formula-block {
            font-family: 'Times New Roman', serif;
            font-size: 1.1rem;
            text-align: center;
            padding: 15px;
            background-color: var(--hover-color);
            border-radius: 6px;
            margin: 20px 0;
            overflow-x: auto;
            border: 1px dashed var(--primary-color);
        }
        .content-block table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            border-radius: 8px;
            overflow: hidden;
        }
        .content-block th, .content-block td {
            padding: 14px;
            text-align: left;
            border: 1px solid var(--border-color);
        }
        .content-block th {
            background-color: var(--hover-color);
            font-weight: 600;
        }
        
        /* FOOTER */
        footer {
            background: var(--gradient-dark);
            color: #CBD5E1;
            padding: 50px 0 20px 0;
        }
        .footer-content {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            flex-wrap: wrap;
            gap: 40px;
            margin-bottom: 30px;
        }
        .footer-col {
            flex: 1;
            min-width: 200px;
        }
        .footer-col h4 {
            font-size: 1.1rem;
            color: white;
            margin-bottom: 15px;
            font-weight: 700;
        }
        .footer-col ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        .footer-col ul li { margin-bottom: 10px; }
        .footer-col a {
            color: #CBD5E1;
            text-decoration: none;
            transition: color 0.3s;
            font-size: 0.95rem;
        }
        .footer-col a:hover { color: var(--accent-color); }
        .footer-disclaimer {
            text-align: center;
            margin: 30px auto;
            padding-top: 25px;
            border-top: 1px solid #334155;
            max-width: 800px;
            font-size: 0.9rem;
            line-height: 1.6;
        }
        .footer-bottom {
            text-align: center;
            padding-top: 20px;
            font-size: 0.9rem;
            color: #94A3B8;
        }
        .creator-name {
            color: var(--secondary-color);
            font-weight: bold;
        }
        .social-buttons {
            display: flex;
            gap: 12px;
            margin-top: 15px;
        }
        .social-btn {
            width: 40px;
            height: 40px;
            display: inline-flex;
            justify-content: center;
            align-items: center;
            color: white;
            border-radius: 50%;
            text-decoration: none;
            font-size: 1.1rem;
            transition: transform 0.3s, box-shadow 0.3s;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        .social-btn:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 16px rgba(0,0,0,0.3);
        }
        .social-btn.linkedin { background-color: #0A66C2; }
        .social-btn.youtube { background-color: #FF0000; }
        .social-btn.twitter { background-color: #1DA1F2; }
        .social-btn.facebook { background-color: #1877F2; }
        .social-btn.whatsapp { background-color: #25D366; }

        /* Responsive */
        @media (max-width: 768px) {
            .container { padding: 0 15px; }
            .navbar { flex-direction: column; gap: 20px; }
            .nav-links { flex-direction: column; gap: 12px; text-align: center; }
            .form-row { grid-template-columns: 1fr; }
            .tool-container, .content-block { padding: 20px; }
            .footer-content { flex-direction: column; gap: 25px; }
            .theme-toggle {
                position: relative;
                top: 0;
                right: 0;
                margin-top: 15px;
            }
            .content-block table {
                display: block;
                overflow-x: auto;
                white-space: nowrap;
            }
            .logo-container {
                 align-items: center; 
            }
            .logo-subtitle {
                text-align: center; 
            }
        }
        .hidden { display: none; }
    </style>
</head>
<body>
    
    <!-- Custom Message Box -->
    <div id="custom-message-box"></div>
    
    <!-- HEADER -->
    <header class="header">
        <div class="container">
            <nav class="navbar">
                <a href="/" class="logo-container">
                    <span class="logo-text">Design Calculators</span>
                    <p class="logo-subtitle">
                        Inspired by standards such as IEC, IEEE, ISA, ASME, and API.
                    </p>
                </a>
                <ul class="nav-links">
                    <li><a href="/">Home</a></li>
                    <li><a href='/articles'>Articles</a></li>
                    <li><a href='/indexmech'>Mechanical</a></li>
                    <li><a href='/indexele'>Electrical</a></li>
                    <li><a href='/indexinst'>Instrumentation</a></li>
                </ul>
                <div class="theme-toggle">
                    <i class="fas fa-sun icon"></i>
                    <label class="switch">
                        <input type="checkbox" id="theme-switch">
                        <span class="slider"></span>
                    </label>
                    <i class="fas fa-moon icon"></i>
                </div>
            </nav>
        </div>
    </header>

    <!-- MAIN CONTENT -->
    <main class="container">
        <div class="tool-container">
            <h2>World-Class VFD Selection Tool</h2>
            
            <div class="tool-description">
                <p>This calculator helps select a Variable Frequency Drive (VFD) based on motor parameters, application type, system requirements, and advanced considerations like efficiency, power factor, cable length, braking, harmonics, and environmental factors. It follows general industry guidelines compatible with IEC and IEEE standards, designed for robust industrial use.</p>
            </div>
            
            <div class="calculator-form">
                <form id="vfd-selection-form">
                    <h3>1. Motor & Application</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="motor-power-hp">Motor Rated Power (HP)
                                <span class="tooltip"><i class="fas fa-info-circle info-icon"></i>
                                <span class="tooltiptext">The nominal output power of the motor in Horsepower (HP). This is a key parameter for initial VFD sizing.</span>
                                </span>
                            </label>
                            <input type="number" id="motor-power-hp" min="0.1" step="0.1" value="5" required>
                        </div>
                        <div class="form-group">
                            <label for="motor-voltage">Motor Rated Voltage (V)
                                <span class="tooltip"><i class="fas fa-info-circle info-icon"></i>
                                <span class="tooltiptext">The nominal voltage rating of the motor. This is the voltage at the motor terminals and should ideally match the VFD output voltage.</span>
                                </span>
                            </label>
                            <input type="number" id="motor-voltage" min="1" step="1" value="400" required>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="motor-current">Motor Rated Current (A)
                                <span class="tooltip"><i class="fas fa-info-circle info-icon"></i>
                                <span class="tooltiptext">The full load current (FLC) of the motor as per its nameplate. This is critical for accurate VFD current capacity matching.</span>
                                </span>
                            </label>
                            <input type="number" id="motor-current" min="0.1" step="0.1" value="8.5" required>
                        </div>
                        <div class="form-group">
                            <label for="motor-phase-type">Motor Phase Type
                                <span class="tooltip"><i class="fas fa-info-circle info-icon"></i>
                                <span class="tooltiptext">Select whether the motor is single-phase or three-phase. Industrial VFDs primarily control three-phase AC induction motors.</span>
                                </span>
                            </label>
                            <select id="motor-phase-type" required>
                                <option value="three">Three-Phase</option>
                                <option value="single">Single-Phase (Note: VFDs for 1-ph motors are rare).</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="motor-efficiency">Motor Efficiency (%)
                                <span class="tooltip"><i class="fas fa-info-circle info-icon"></i>
                                <span class="tooltiptext">The efficiency of the motor at full load, typically found on the motor nameplate (e.g., 90 for 90%).</span>
                                </span>
                            </label>
                            <input type="number" id="motor-efficiency" min="50" max="100" step="0.1" value="87" required>
                        </div>
                        <div class="form-group">
                            <label for="motor-power-factor">Motor Power Factor
                                <span class="tooltip"><i class="fas fa-info-circle info-icon"></i>
                                <span class="tooltiptext">The power factor of the motor at full load, usually between 0.75 and 0.95 (e.g., 0.8 for 0.8 PF).</span>
                                </span>
                            </label>
                            <input type="number" id="motor-power-factor" min="0.5" max="1.0" step="0.01" value="0.82" required>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="application-type">Application Type
                                <span class="tooltip"><i class="fas fa-info-circle info-icon"></i>
                                <span class="tooltiptext">The type of load the VFD will control (e.g., fans/pumps are variable torque; conveyors/extruders are constant torque; cranes/hoists are heavy duty). This significantly affects the required VFD overload capacity.</span>
                                </span>
                            </label>
                            <select id="application-type" required>
                                <option value="variable-torque">Variable Torque (Fans, Pumps, Centrifugal)</option>
                                <option value="constant-torque">Constant Torque (Conveyors, Extruders, Mixers)</option>
                                <option value="heavy-duty">Heavy Duty (Cranes, Hoists, Machine Tools)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="motor-service-factor">Motor Service Factor (SF)
                                <span class="tooltip"><i class="fas fa-info-circle info-icon"></i>
                                <span class="tooltiptext">A multiplier indicating the permissible continuous overload a motor can handle (e.g., 1.15). Enter 1.0 if not specified.</span>
                                </span>
                            </label>
                            <input type="number" id="motor-service-factor" min="1.0" max="1.5" step="0.01" value="1.15" required>
                        </div>
                    </div>
                    
                    <h3>2. Supply & Environment</h3>
                    <div class="form-row">
                         <div class="form-group">
                            <label for="supply-voltage">Supply Voltage (V)
                                <span class="tooltip"><i class="fas fa-info-circle info-icon"></i>
                                <span class="tooltiptext">The input supply voltage to the VFD. This must match the available facility voltage.</span>
                                </span>
                            </label>
                            <input type="number" id="supply-voltage" min="1" step="1" value="400" required>
                        </div>
                        <div class="form-group">
                            <label for="ambient-temperature">Ambient Temperature (&#8451;)
                                <span class="tooltip"><i class="fas fa-info-circle info-icon"></i>
                                <span class="tooltiptext">The maximum ambient air temperature where the VFD will be installed. High temperatures (e.g., >40°C) may require derating.</span>
                                </span>
                            </label>
                            <input type="number" id="ambient-temperature" min="0" max="50" step="1" value="30" required>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="altitude">Altitude (meters)
                                <span class="tooltip"><i class="fas fa-info-circle info-icon"></i>
                                <span class="tooltiptext">The elevation above sea level where the VFD will be installed. Higher altitudes (e.g., >1000m) require derating due to thinner air.</span>
                                </span>
                            </label>
                            <input type="number" id="altitude" min="0" step="10" value="500" required>
                        </div>
                        <div class="form-group">
                            <label for="enclosure-type">Enclosure Type
                                <span class="tooltip"><i class="fas fa-info-circle info-icon"></i>
                                <span class="tooltiptext">The NEMA or IP rating required for the VFD's installation environment to protect its internal components.</span>
                                </span>
                            </label>
                            <select id="enclosure-type" required>
                                <option value="nema1">NEMA 1 (IP20/IP21) - General Purpose, Indoor</option>
                                <option value="nema12">NEMA 12 (IP54) - Dust/Drip Tight, Indoor</option>
                                <option value="nema4">NEMA 4 (IP66) - Washdown, Indoor/Outdoor</option>
                                <option value="nema4x">NEMA 4X (IP66) - Corrosion Resistant, Indoor/Outdoor</option>
                            </select>
                        </div>
                    </div>

                    <h3>3. Advanced Options</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="safety-factor">VFD Sizing Safety Factor (%)
                                <span class="tooltip"><i class="fas fa-info-circle info-icon"></i>
                                <span class="tooltiptext">Additional capacity margin for VFD sizing, e.g., 10% (enter 10). Recommended for critical applications or unknown load characteristics.</span>
                                </span>
                            </label>
                            <input type="number" id="safety-factor" min="0" max="50" step="1" value="10" required>
                        </div>
                        <div class="form-group">
                            <label for="cable-length">Cable Length (meters)
                                <span class="tooltip"><i class="fas fa-info-circle info-icon"></i>
                                <span class="tooltiptext">The length of the cable between the VFD and the motor. Long cables (e.g., >50m) may require output filters or VFD derating.</span>
                                </span>
                            </label>
                            <input type="number" id="cable-length" min="0" step="1" value="20" required>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="motor-insulation-class">Motor Insulation Class
                                <span class="tooltip"><i class="fas fa-info-circle info-icon"></i>
                                <span class="tooltiptext">Indicates the maximum operating temperature of the motor winding insulation. VFDs require "inverter-duty" rated insulation (Class F or H).</span>
                                </span>
                            </label>
                            <select id="motor-insulation-class" required>
                                <option value="F">Class F (155°C)</option>
                                <option value="H">Class H (180°C)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="braking-required">Braking Required?
                                <span class="tooltip"><i class="fas fa-info-circle info-icon"></i>
                                <span class="tooltiptext">Select 'Yes' if the application requires rapid deceleration or stopping of high-inertia loads, which may necessitate a dynamic braking resistor.</span>
                                </span>
                            </label>
                            <select id="braking-required">
                                <option value="no">No</option>
                                <option value="yes">Yes (Dynamic Braking)</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="line-reactor-required">Line/Load Reactor Needed?
                                <span class="tooltip"><i class="fas fa-info-circle info-icon"></i>
                                <span class="tooltiptext">Line reactors (input) mitigate harmonics. Load reactors (output) protect motors on long cable runs. Select 'Auto' for a recommendation.</span>
                                </span>
                            </label>
                            <select id="line-reactor-required" required>
                                <option value="auto">Auto-Recommend</option>
                                <option value="yes">Yes</option>
                                <option value="no">No</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="vfd-control-type">VFD Control Type
                                <span class="tooltip"><i class="fas fa-info-circle info-icon"></i>
                                <span class="tooltiptext">Choose the VFD control method. V/f (Scalar) is simple. Vector control offers higher performance and better torque at low speeds.</span>
                                </span>
                            </label>
                            <select id="vfd-control-type" required>
                                <option value="v-f">V/f Control (Scalar)</option>
                                <option value="vector-sensorless">Vector Control (Sensorless)</option>
                                <option value="vector-closed-loop">Vector Control (Closed-Loop, with encoder)</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="grid-stiffness">Power Grid Stiffness
                                <span class="tooltip"><i class="fas fa-info-circle info-icon"></i>
                                <span class="tooltiptext">A 'weak' grid (low short-circuit capacity) is more susceptible to harmonic distortion from VFDs.</span>
                                </span>
                            </label>
                            <select id="grid-stiffness" required>
                                <option value="stiff">Stiff Grid (High Short Circuit Capacity)</option>
                                <option value="weak">Weak Grid (Low Short Circuit Capacity)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="harmonic-mitigation">Harmonic Mitigation Level
                                <span class="tooltip"><i class="fas fa-info-circle info-icon"></i>
                                <span class="tooltiptext">Select desired level of harmonic mitigation. 'Standard' often implies line reactors. 'Advanced' could mean active filters or 12/18-pulse VFDs.</span>
                                </span>
                            </label>
                            <select id="harmonic-mitigation" required>
                                <option value="basic">Basic (Internal VFD Filters)</option>
                                <option value="standard">Standard (with Line Reactor)</option>
                                <option value="advanced">Advanced (Active Filter / 12-Pulse)</option>
                            </select>
                        </div>
                    </div>

                    <h3>4. Economic Analysis Parameters (Optional)</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="motor-load-factor">Motor Operating Load Factor (%)
                                <span class="tooltip"><i class="fas fa-info-circle info-icon"></i>
                                <span class="tooltiptext">The average percentage of the motor's rated power at which it operates. Used for estimating energy consumption.</span>
                                </span>
                            </label>
                            <input type="number" id="motor-load-factor" min="0" max="100" step="1" value="75">
                        </div>
                        <div class="form-group">
                            <label for="operating-hours-per-year">Operating Hours per Year (hours)
                                <span class="tooltip"><i class="fas fa-info-circle info-icon"></i>
                                <span class="tooltiptext">The estimated annual operating hours of the motor.</span>
                                </span>
                            </label>
                            <input type="number" id="operating-hours-per-year" min="0" step="1" value="4000">
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="electricity-cost-per-kwh">Electricity Cost (per kWh)
                                <span class="tooltip"><i class="fas fa-info-circle info-icon"></i>
                                <span class="tooltiptext">Your average electricity cost per kilowatt-hour.</span>
                                </span>
                            </label>
                            <input type="number" id="electricity-cost-per-kwh" min="0" step="0.001" value="0.12">
                        </div>
                        <div class="form-group">
                            <label for="analysis-period-years">Analysis Period (Years)
                                <span class="tooltip"><i class="fas fa-info-circle info-icon"></i>
                                <span class="tooltiptext">The number of years over which to calculate cumulative energy savings.</span>
                                </span>
                            </label>
                            <input type="number" id="analysis-period-years" min="1" step="1" value="5">
                        </div>
                    </div>

                    <div class="form-row" style="gap: 10px; margin-top: 25px;">
                        <button type="button" id="calculate-vfd-btn" class="calculate-btn" style="flex: 2;">
                            <i class="fas fa-calculator" style="margin-right: 8px;"></i>Select VFD
                            <span class="spinner" id="calculate-spinner" style="display:none;"></span>
                        </button>
                        <button type="button" id="reset-calculations-btn" class="calculate-btn" style="flex: 1; background: var(--accent-color); box-shadow: 0 4px 12px rgba(245, 158, 11, 0.3);">
                            <i class="fas fa-sync-alt" style="margin-right: 8px;"></i>Reset
                        </button>
                        <button type="button" id="download-pdf-btn" class="calculate-btn" style="flex: 1; background: var(--secondary-color); box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3);">
                            <i class="fas fa-file-pdf" style="margin-right: 8px;"></i>Download PDF
                        </button>
                    </div>
                </form>
            </div>
            
            <!-- Result Container -->
            <div id="result-container" class="result-container">
                <h3>VFD Selection Results</h3>
                <div id="calculation-details" class="math-content">
                    <!-- Calculation steps will be inserted here -->
                </div>
                <table class="result-table">
                    <thead>
                        <tr>
                            <th>Parameter</th>
                            <th>Value</th>
                        </tr>
                    </thead>
                    <tbody id="result-table-body" class="result-table-body">
                        <!-- Results will be dynamically inserted here -->
                    </tbody>
                </table>
                <div id="economic-analysis-section" class="content-block">
                    <h3>Economic Analysis of VFD Benefits</h3>
                    <div id="economic-analysis-results" class="math-content">
                        <!-- Economic analysis results will be inserted here -->
                    </div>
                </div>
                <div id="advanced-recommendations-section" class="content-block">
                    <h3>Advanced Recommendations for Optimal VFD System</h3>
                    <p>For a truly robust, efficient, and reliable VFD system, consider these advanced aspects:</p>
                    <ul>
                        <li><strong>Integrated Drive Systems:</strong> For complex applications, consider VFDs with integrated PLCs, advanced communication protocols (Ethernet/IP, Profinet), and built-in safety functions (STO, SS1).</li>
                        <li><strong>Active Front End (AFE) VFDs:</strong> If harmonic distortion is a major concern (e.g., for compliance with IEEE 519), AFE VFDs offer near-unity power factor and very low harmonic distortion. They can also regenerate energy back to the grid.</li>
                        <li><strong>Liquid Cooled VFDs:</strong> For high power applications or harsh environments (high ambient temperature, dusty areas), liquid-cooled VFDs offer superior thermal management.</li>
                        <li><strong>Energy Monitoring & Analytics:</strong> Implement energy monitoring to track VFD performance, identify savings, and predict maintenance needs.</li>
                    </ul>
                </div>
                <div class="standard-reference" id="standard-reference">
                    <!-- Standard reference text will be inserted here -->
                </div>
            </div>
        </div>
    </main>

    <!-- NEW CONTENT BLOCK for AdSense -->
    <div class="container">
        <div class="content-block">
            <h2 class="math-content">Guide to selecting a right VFD for your industrial requirements</h2>
            <p>Selecting a Variable Frequency Drive (VFD) is a critical engineering task that goes far beyond simply matching the motor's horsepower or kW rating. A correctly sized VFD ensures reliability, protects the motor, and provides the intended energy savings and process control. An incorrectly sized VFD can lead to nuisance tripping, premature failure of the drive or motor, and safety hazards. This guide covers the essential factors this calculator uses to provide a professional recommendation.</p>

            <h3>1. Load Type: The Most Critical Factor</h3>
            <p>The type of load determines the torque required from the motor, which in turn dictates the overload capacity needed from the VFD. Loads are generally categorized into three types:</p>
            
            <h4>Variable Torque (VT) Loads</h4>
            <ul>
                <li><strong>Examples:</strong> Centrifugal fans, pumps, and blowers.</li>
                <li><strong>Characteristics:</strong> Torque required is proportional to the square of the speed ($T \\propto N^2$), and power required is proportional to the cube of the speed ($P \\propto N^3$).</li>
                <li><strong>VFD Sizing:</strong> These are the most energy-efficient applications for VFDs. They require low torque at low speeds. VFDs for VT loads are typically rated for <strong>110% overload for 60 seconds (Normal Duty)</strong>. This is the most economical VFD sizing.</li>
            </ul>

            <h4>Constant Torque (CT) Loads</h4>
            <ul>
                <li><strong>Examples:</strong> Conveyors, positive displacement pumps, mixers, extruders.</li>
                <li><strong>Characteristics:</strong> The load requires the same amount of torque regardless of the speed. Power is directly proportional to speed ($P \\propto N$).</li>
                <li><strong>VFD Sizing:</strong> These applications are more demanding. The VFD must be able to provide full torque at low speeds, which generates more heat. VFDs for CT loads are rated for <strong>150% overload for 60 seconds (Heavy Duty)</strong>. This often means selecting a VFD one size larger than for a VT load of the same power.</li>
            </ul>

            <h4>Heavy Duty / Constant Horsepower Loads</h4>
            <ul>
                <li><strong>Examples:</strong> Cranes, hoists, machine tool spindles, traction drives.</li>
                <li><strong>Characteristics:</strong> These require extremely high breakaway torque and can have shock loads. Hoists, for example, require high torque during acceleration and must also handle regenerative energy during braking (lowering).</li>
                <li><strong>VFD Sizing:</strong> These require the most robust VFDs, often rated for <strong>180-200% overload</strong> and requiring dynamic braking systems.</li>
            </ul>

            <h3>2. VFD Sizing: Current vs. Power</h3>
            <p>While VFDs are often sold by HP or kW, the <strong>only parameter that truly matters for selection is current</strong>. Always size the VFD based on the motor's <strong>Full Load Current (FLC)</strong> from its nameplate, not its power rating. An older, less-efficient 5 HP motor may draw significantly more current than a new, NEMA Premium 5 HP motor. This calculator uses the motor's FLC as the primary basis for all calculations.</p>
            <p>The calculator finds the motor's input current from its output power, efficiency, and power factor, and compares this to the nameplate current you provide. It uses the <strong>larger of the two</strong> for all subsequent sizing steps to be conservative and safe.</p>

            <h3>3. Environmental Derating: Heat & Altitude</h3>
            <p>VFDs are sophisticated electronic devices that generate significant heat. Their ability to cool themselves is directly affected by the surrounding environment. All VFDs are rated for a specific ambient temperature (e.g., 40°C or 104°F) and altitude (e.g., 1000m or 3300ft).</p>
            <ul>
                <li><strong>Temperature:</strong> For every degree Celsius above the rated temperature (typically 40°C), the VFD's continuous current capacity must be derated (typically 1-2% per °C). A VFD in a 50°C environment may only be able to provide 80-90% of its rated current.</li>
                <li><strong>Altitude:</strong> At higher altitudes (typically above 1000m), the air is thinner and less effective at cooling. VFDs must be derated (typically 1% for every 100m above 1000m) to prevent overheating.</li>
            </ul>
            <p>This calculator applies these derating factors to the required current, ensuring the selected VFD can perform under your specified site conditions without failing.</p>

            <h3>4. Advanced Considerations for System Reliability</h3>

            <h4>Braking & Regeneration</h4>
            <p>When a VFD decelerates a high-inertia load (like a large fan, flywheel, or crane), the motor acts as a generator, sending energy <strong>back</strong> to the VFD. This "regenerative" energy charges the VFD's internal DC bus capacitors. If the energy is too much, the bus voltage will rise rapidly, and the VFD will trip on an "Overvoltage Fault" to protect itself.</p>
            <ul>
                <li><strong>Solution:</strong> A <strong>dynamic braking resistor</strong> is connected to the VFD. The drive monitors its bus voltage and, when it gets too high, dumps the excess energy into the resistor, which dissipates it as heat. This is essential for applications requiring fast stopping or for controlling "overhauling" loads like a downhill conveyor.</li>
            </ul>
            
            <h4>Harmonics (IEEE 519)</h4>
            <p>VFDs are non-linear loads. They draw current from the line in non-sinusoidal pulses, which creates "noise" or <strong>harmonic distortion (THD)</strong> on the power grid. This distortion can overheat transformers, damage sensitive electronics, and cause nuisance tripping of breakers. <strong>IEEE 519</strong> is the international standard that sets limits on this distortion at the Point of Common Coupling (PCC).</p>
            <ul>
                <li><strong>Mitigation:</strong>
                    <ul>
                        <li><strong>DC Bus Choke / Line Reactor:</strong> The most common solution. This is an inductor (coil) placed on the input of the VFD. It smooths the current pulses and typically reduces harmonic distortion (THDi) from ~80% down to ~35-40%.</li>
                        <li><strong>12-Pulse or 18-Pulse VFDs:</strong> Use multiple converters to cancel out specific harmonics. More effective but much more expensive.</li>
                        <li><strong>Active Front End (AFE) VFDs:</strong> The "gold standard." These use a second, "active" converter on the input to force the VFD to draw a perfect sine wave of current. They produce <5% THDi and can correct for poor power factor.</li>
                    </ul>
                </li>
            </ul>

            <h4>Long Motor Cables (dv/dt & Reflected Waves)</h4>
            <p>The VFD's output is not a clean sine wave; it's a very fast-switching pulse-width-modulated (PWM) signal. This high-speed switching ($dv/dt$, or change-in-voltage over change-in-time) can cause problems, especially with long motor cables:</p>
            <ul>
                <li><strong>Reflected Waves:</strong> The fast voltage pulses can travel down the cable and reflect off the motor terminals, doubling the voltage at the motor (e.g., a 400V system can see 800V+ spikes). This destroys motor insulation and causes premature failure.</li>
                <li><strong>Solution:</strong> For long cable runs (typically > 50-100 meters), an <strong>output filter (or "load reactor")</strong> is installed at the VFD's output. This filter smooths the PWM edges, reducing the $dv/dt$ and protecting the motor. Using "inverter-duty" rated motors (with Class F or H insulation) is also essential.</li>
            </ul>
            
            <h4>Control Method: V/f (Scalar) vs. Vector Control</h4>
            <ul>
                <li><strong>V/f (Scalar) Control:</strong> The simplest and most common method. The VFD maintains a constant Voltage-to-Frequency (V/Hz) ratio. This is perfectly adequate for simple applications like fans and pumps where high torque at low speed is not needed.</li>
                <li><strong>Sensorless Vector Control (SVC):</strong> A more advanced method that uses a high-speed processor and a mathematical model of the motor to precisely control torque, even at low speeds. This is ideal for constant torque loads like conveyors and mixers that need good torque control without the expense of an encoder.</li>
                <li><strong>Closed-Loop Vector:</strong> The highest performance. This uses an encoder on the motor shaft to provide exact speed and position feedback to the VFD. It is required for applications needing precise positioning or full torque at zero speed, such as hoists, elevators, and machine tools.</li>
            </ul>
        </div>
    </div>

    <!-- FOOTER -->
    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-col">
                    <h4>Design Calculators</h4>
                    <p style="font-size: 0.9rem; line-height: 1.6; margin-bottom: 15px;">
                        If you find this tool helpful, please consider sharing it with your colleagues!
                    </p>
                    <div class="social-buttons">
                        <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://designcalculators.co.in" target="_blank" rel="noopener noreferrer" class="social-btn linkedin" aria-label="LinkedIn"><i class="fab fa-linkedin-in"></i></a>
                        <a href="https://www.youtube.com/@designcalculators" target="_blank" rel="noopener noreferrer" class="social-btn youtube" aria-label="YouTube"><i class="fab fa-youtube"></i></a>
                        <a href="https://twitter.com/intent/tweet?url=https://designcalculators.co.in" target="_blank" rel="noopener noreferrer" class="social-btn twitter" aria-label="Twitter"><i class="fab fa-twitter"></i></a>
                        <a href="https://www.facebook.com/sharer/sharer.php?u=https://designcalculators.co.in" target="_blank" rel="noopener noreferrer" class="social-btn facebook" aria-label="Facebook"><i class="fab fa-facebook-f"></i></a>
                        <a href="https://api.whatsapp.com/send?text=Check%20out%20this%20amazing%20engineering%20resource:%20https://designcalculators.co.in" target="_blank" rel="noopener noreferrer" class="social-btn whatsapp" aria-label="WhatsApp"><i class="fab fa-whatsapp"></i></a>
                    </div>
                </div>
                <div class="footer-col">
                    <h4>Quick Links</h4>
                    <ul>
                        <li><a href="/">Home</a></li>
                        <li><a href='/indexele'>Electrical</a></li>
                        <li><a href='/indexmech'>Mechanical</a></li>
                        <li><a href='/indexinst'>Instrumentation</a></li>
                        <li><a href='/articles'>Articles</a></li>
                    </ul>
                </div>
                <div class="footer-col">
                    <h4>Resources</h4>
                    <ul>
                        <li><a href='/about'>About Us</a></li>
                        <li><a href='/contact'>Contact</a></li>
                        <li><a href='/faq'>FAQ</a></li>
                        <li><a href='/privacy-policy'>Privacy Policy</a></li>
                        <li><a href='/terms-of-service'>Terms of Service</a></li>
                    </ul>
                </div>
                <div class="footer-col">
                    <h4>More</h4>
                    <ul>
                        <li><a href="/articles.html">Articles</a></li>
                        <li><a href='/sitemap2'>Sitemap</a></li>
                        <li><a href="https://www.youtube.com/@designcalculators" target="_blank" rel="noopener noreferrer">YouTube Channel</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-disclaimer">
                <p>All calculations are for preliminary design guidance. Always verify results against relevant engineering standards (ISO, ASME, IEC, NEC) and manufacturer specifications. Final designs require professional engineering verification considering site-specific conditions.</p>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 Design Calculators. Created by <span class="creator-name">A Sharma</span>. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <!-- SCRIPT -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Get buttons
            const calculateBtn = document.getElementById('calculate-vfd-btn');
            const resetFormBtn = document.getElementById('reset-calculations-btn');
            const downloadPdfBtn = document.getElementById('download-pdf-btn');
            const calculationSpinner = document.getElementById('calculate-spinner');
            
            // Get containers
            const resultContainer = document.getElementById('result-container');
            const resultTableBody = document.getElementById('result-table-body');
            const standardReference = document.getElementById('standard-reference');
            const calculationDetailsDiv = document.getElementById('calculation-details');
            const economicAnalysisSection = document.getElementById('economic-analysis-section');
            const economicAnalysisResultsDiv = document.getElementById('economic-analysis-results');
            const advancedRecommendationsSection = document.getElementById('advanced-recommendations-section');
            
            // Default values for resetting
            const defaultValues = {
                'motor-power-hp': 5,
                'motor-voltage': 400,
                'motor-current': 8.5,
                'motor-phase-type': 'three',
                'motor-efficiency': 87,
                'motor-power-factor': 0.82,
                'application-type': 'variable-torque',
                'supply-voltage': 400,
                'safety-factor': 10,
                'motor-service-factor': 1.15,
                'cable-length': 20,
                'motor-insulation-class': 'F',
                'ambient-temperature': 30,
                'altitude': 500,
                'enclosure-type': 'nema1',
                'braking-required': 'no',
                'line-reactor-required': 'auto',
                'vfd-control-type': 'v-f',
                'grid-stiffness': 'stiff',
                'harmonic-mitigation': 'basic',
                'motor-load-factor': 75,
                'operating-hours-per-year': 4000,
                'electricity-cost-per-kwh': 0.12,
                'analysis-period-years': 5
            };

            // --- Custom Message Box Functionality ---
            function displayMessage(message, type = "info") {
                let messageBox = document.getElementById('custom-message-box');
                
                messageBox.textContent = message;
                messageBox.style.color = 'white';
                if (type === "error") {
                    messageBox.style.backgroundColor = '#dc3545';
                } else if (type === "warning") {
                    messageBox.style.backgroundColor = '#ffc107';
                    messageBox.style.color = '#333';
                } else {
                    messageBox.style.backgroundColor = '#28a745';
                }
                messageBox.classList.add('show');

                setTimeout(() => {
                    messageBox.classList.remove('show');
                }, 5000);
            }

            // --- Reset & Clear Functions ---
            function clearResults() {
                resultContainer.classList.remove('show');
                economicAnalysisSection.classList.remove('show');
                advancedRecommendationsSection.classList.remove('show');

                resultTableBody.innerHTML = '';
                calculationDetailsDiv.innerHTML = '<h3>Detailed Calculation Steps</h3>';
                economicAnalysisResultsDiv.innerHTML = '';
                standardReference.innerHTML = '';
            }

            function resetForm() {
                for (const id in defaultValues) {
                    const input = document.getElementById(id);
                    if (input) input.value = defaultValues[id];
                }
                clearResults();
                displayMessage("Form reset to default values.", "info");
            }
            
            // --- PDF Download Function ---
            function downloadPDF() {
                if (!resultContainer.classList.contains('show')) {
                    displayMessage("Please run a calculation first to generate a report.", "warning");
                    return;
                }
                displayMessage("Generating PDF... Please wait.", "info");

                const { jsPDF } = window.jspdf;
                const pdf = new jsPDF('p', 'mm', 'a4');
                const pdfWidth = pdf.internal.pageSize.getWidth();
                const pdfHeight = pdf.internal.pageSize.getHeight();
                let currentY = 15;

                pdf.setFont("helvetica", "bold");
                pdf.setFontSize(18);
                pdf.setTextColor(30, 58, 138);
                pdf.text("VFD Selection Report", pdfWidth / 2, currentY, { align: 'center' });
                currentY += 7;
                pdf.setFont("helvetica", "normal");
                pdf.setFontSize(10);
                pdf.setTextColor(100, 100, 100);
                pdf.text(`Generated on: ${new Date().toLocaleString()}`, pdfWidth / 2, currentY, { align: 'center' });
                currentY += 15;

                const pdfTarget = document.getElementById('result-container');

                html2canvas(pdfTarget, {
                    scale: 2, 
                    useCORS: true,
                    onclone: (doc) => {
                        doc.body.classList.remove('dark-mode');
                        doc.querySelectorAll('*').forEach(el => {
                            el.style.color = '#4B5563'; 
                        });
                        doc.querySelectorAll('.result-container, .content-block').forEach(el => {
                            el.style.background = '#FFFFFF';
                            el.style.color = '#4B5563';
                        });
                        doc.querySelectorAll('h3').forEach(el => el.style.color = '#1E3A8A');
                        doc.querySelectorAll('h4').forEach(el => el.style.color = '#2563EB');
                        doc.querySelectorAll('strong').forEach(el => el.style.color = '#111827');
                        doc.querySelectorAll('.result-table th').forEach(el => {
                            el.style.background = '#1E3A8A'; 
                            el.style.color = '#FFFFFF';
                        });
                        doc.querySelectorAll('.result-table tr:nth-child(even)').forEach(el => {
                            el.style.backgroundColor = '#F8FAFC';
                        });
                        if(doc.querySelector('#calculation-details')) {
                            doc.querySelector('#calculation-details').style.background = '#F8FAFC';
                            doc.querySelectorAll('#calculation-details .formula, #calculation-details .calculation-step').forEach(el => {
                                el.style.backgroundColor = '#e2e6ea';
                            });
                        }
                    }
                }).then(canvas => {
                    const imgData = canvas.toDataURL('image/png');
                    const imgWidth = pdfWidth - 20;
                    const imgHeight = canvas.height * imgWidth / canvas.width;
                    let heightLeft = imgHeight;
                    let page = 1;

                    pdf.addImage(imgData, 'PNG', 10, currentY, imgWidth, imgHeight);
                    heightLeft -= (pdfHeight - currentY - 20);

                    while (heightLeft > 0) {
                        pdf.addPage();
                        page++;
                        pdf.addImage(imgData, 'PNG', 10, -(imgHeight * (page-1)) + currentY, imgWidth, imgHeight);
                        heightLeft -= pdfHeight - 20;
                    }
                    
                    const pageCount = pdf.internal.getNumberOfPages();
                    for(let i = 1; i <= pageCount; i++) {
                        pdf.setPage(i);
                        pdf.setFontSize(8);
                        pdf.setTextColor(150, 150, 150);
                        pdf.text(`Page ${i} of ${pageCount} | www.designcalculators.co.in`, pdfWidth / 2, pdfHeight - 10, { align: 'center' });
                    }

                    pdf.save('VFD-Selection-Report.pdf');
                    displayMessage("PDF downloaded successfully!", "info");
                }).catch(err => {
                    displayMessage("Error generating PDF. See console for details.", "error");
                    console.error(err);
                });
            }
            
            // --- Helper function to add table rows ---
            function addResultRow(parameter, value) {
                const row = resultTableBody.insertRow();
                const paramCell = row.insertCell();
                const valueCell = row.insertCell();
                paramCell.innerHTML = parameter;
                valueCell.innerHTML = value;
            }
            
            // --- Helper function to add calculation steps ---
            function addDetailedCalculationStep(stepTitle, explanationText, formulaText, calculationText) {
                const stepDiv = document.createElement('div');
                stepDiv.style.marginBottom = '15px';
                stepDiv.style.paddingBottom = '15px';
                stepDiv.style.borderBottom = `1px dashed var(--border-color)`;
                
                const titleElem = document.createElement('h4');
                titleElem.innerHTML = stepTitle;
                stepDiv.appendChild(titleElem);
                
                if (explanationText) {
                    const explanationElem = document.createElement('p');
                    explanationElem.innerHTML = explanationText;
                    stepDiv.appendChild(explanationElem);
                }
                if (formulaText) {
                    const formulaElem = document.createElement('p');
                    formulaElem.classList.add('formula');
                    formulaElem.innerHTML = formulaText;
                    stepDiv.appendChild(formulaElem);
                }
                if (calculationText) {
                    const calcElem = document.createElement('p');
                    calcElem.classList.add('calculation-step');
                    calcElem.innerHTML = calculationText;
                    stepDiv.appendChild(calcElem);
                }
                calculationDetailsDiv.appendChild(stepDiv);
            }

            // --- Calculation Logic ---
            calculateBtn.addEventListener('click', function() {
                calculationSpinner.style.display = 'inline-block';
                calculateBtn.disabled = true;

                setTimeout(() => {
                    try {
                        // Get input values
                        const motorPowerHP = parseFloat(document.getElementById('motor-power-hp').value);
                        const motorVoltage = parseFloat(document.getElementById('motor-voltage').value);
                        const motorCurrent = parseFloat(document.getElementById('motor-current').value);
                        const motorPhaseType = document.getElementById('motor-phase-type').value;
                        const motorEfficiency = parseFloat(document.getElementById('motor-efficiency').value) / 100;
                        const motorPowerFactor = parseFloat(document.getElementById('motor-power-factor').value);
                        const applicationType = document.getElementById('application-type').value;
                        const supplyVoltage = parseFloat(document.getElementById('supply-voltage').value);
                        const safetyFactor = parseFloat(document.getElementById('safety-factor').value) / 100;
                        const motorServiceFactor = parseFloat(document.getElementById('motor-service-factor').value);
                        const cableLength = parseFloat(document.getElementById('cable-length').value);
                        const motorInsulationClass = document.getElementById('motor-insulation-class').value;
                        const ambientTemperature = parseFloat(document.getElementById('ambient-temperature').value);
                        const altitude = parseFloat(document.getElementById('altitude').value);
                        const enclosureType = document.getElementById('enclosure-type').value;
                        const brakingRequired = document.getElementById('braking-required').value;
                        const lineReactorRequired = document.getElementById('line-reactor-required').value;
                        const vfdControlType = document.getElementById('vfd-control-type').value;
                        const gridStiffness = document.getElementById('grid-stiffness').value;
                        const harmonicMitigation = document.getElementById('harmonic-mitigation').value;
                        const motorLoadFactor = parseFloat(document.getElementById('motor-load-factor').value) / 100;
                        const electricityCostPerKWh = parseFloat(document.getElementById('electricity-cost-per-kwh').value);
                        const operatingHoursPerYear = parseFloat(document.getElementById('operating-hours-per-year').value);
                        const analysisPeriodYears = parseFloat(document.getElementById('analysis-period-years').value);
                        const currencySymbol = "$";

                        // Input validation
                        if (isNaN(motorPowerHP) || isNaN(motorVoltage) || isNaN(motorCurrent) || isNaN(motorEfficiency) || isNaN(motorPowerFactor) || isNaN(supplyVoltage) || isNaN(safetyFactor) || isNaN(motorServiceFactor) || isNaN(cableLength) || isNaN(ambientTemperature) || isNaN(altitude) || isNaN(motorLoadFactor) || isNaN(electricityCostPerKWh) || isNaN(operatingHoursPerYear) || isNaN(analysisPeriodYears)) {
                            throw new Error("Please fill in all required fields with valid numbers.");
                        }
                        if (motorPowerHP <= 0 || motorVoltage <= 0 || motorCurrent <= 0) throw new Error("Motor Power, Voltage, and Current must be positive values.");
                        if (motorEfficiency <= 0.5 || motorEfficiency > 1) throw new Error("Motor Efficiency must be between 50% and 100%.");
                        if (motorPowerFactor <= 0.1 || motorPowerFactor > 1) throw new Error("Motor Power Factor must be between 0.1 and 1.0.");
                        if (motorServiceFactor < 1 || motorServiceFactor > 1.5) throw new Error("Motor Service Factor is typically between 1.0 and 1.5.");
                        if (ambientTemperature > 50) throw new Error("Ambient Temperature is high. Please consult manufacturer for derating above 50°C.");
                        
                        clearResults();
                        
                        // --- VFD Selection Logic ---
                        const motorRatedPowerKW = motorPowerHP * 0.7457;
                        addDetailedCalculationStep(
                            "Step 1: Convert Motor Rated Power (HP to kW)",
                            `Motor power is converted from HP to kW ($1 HP = 0.7457 kW$).`,
                            `$$P_{kW} = P_{HP} \\times 0.7457$$`,
                            `Calculation: $${motorPowerHP.toFixed(2)} \\text{ HP} \\times 0.7457 = ${motorRatedPowerKW.toFixed(2)} \\text{ kW}$`
                        );

                        let motorRatedInputCurrent = 0;
                        if (motorPhaseType === 'three') {
                            motorRatedInputCurrent = (motorRatedPowerKW * 1000) / (Math.sqrt(3) * motorVoltage * motorPowerFactor * motorEfficiency);
                            addDetailedCalculationStep(
                                "Step 2: Calculate Motor Rated Input Current (from Power)",
                                `Calculates the theoretical input current based on power, voltage, PF, and efficiency.`,
                                `$$I_{calc} = \\frac{P_{kW} \\times 1000}{\\sqrt{3} \\times V \\times PF \\times Eff}$$`,
                                `Calculation: $${(motorRatedPowerKW * 1000).toFixed(0)} / (1.732 \\times ${motorVoltage}V \\times ${motorPowerFactor} \\times ${motorEfficiency}) = ${motorRatedInputCurrent.toFixed(2)} \\text{ A}$`
                            );
                        } else {
                            motorRatedInputCurrent = (motorRatedPowerKW * 1000) / (motorVoltage * motorPowerFactor * motorEfficiency);
                            addDetailedCalculationStep(
                                "Step 2: Calculate Motor Rated Input Current (Single Phase)",
                                `Calculates the theoretical input current based on power, voltage, PF, and efficiency.`,
                                `$$I_{calc} = \\frac{P_{kW} \\times 1000}{V \\times PF \\times Eff}$$`,
                                `Calculation: $${(motorRatedPowerKW * 1000).toFixed(0)} / (${motorVoltage}V \\times ${motorPowerFactor} \\times ${motorEfficiency}) = ${motorRatedInputCurrent.toFixed(2)} \\text{ A}$`
                            );
                        }

                        const effectiveMotorRatedCurrent = Math.max(motorCurrent, motorRatedInputCurrent);
                        addDetailedCalculationStep(
                            "Step 3: Determine Effective Motor Current for Sizing",
                            `Using the greater of Nameplate Current (${motorCurrent} A) and Calculated Input Current (${motorRatedInputCurrent.toFixed(2)} A).`,
                            null,
                            `Effective Current (I_eff) = ${effectiveMotorRatedCurrent.toFixed(2)} A`
                        );
                        
                        const currentWithSF = effectiveMotorRatedCurrent * motorServiceFactor;
                        addDetailedCalculationStep(
                            "Step 4: Apply Motor Service Factor (SF)",
                            `Calculate continuous current required if motor runs into its service factor.`,
                            `$$I_{SF} = I_{eff} \\times SF$$`,
                            `Calculation: $${effectiveMotorRatedCurrent.toFixed(2)} \\text{ A} \\times ${motorServiceFactor} = ${currentWithSF.toFixed(2)} \\text{ A}$`
                        );

                        let applicationOverloadFactor = 1.0;
                        let overloadExplanation = '';
                        if (applicationType === 'variable-torque') {
                            applicationOverloadFactor = 1.10;
                            overloadExplanation = "Variable Torque (Normal Duty): 110% overload capacity.";
                        } else if (applicationType === 'constant-torque') {
                            applicationOverloadFactor = 1.50;
                            overloadExplanation = "Constant Torque (Heavy Duty): 150% overload capacity.";
                        } else if (applicationType === 'heavy-duty') {
                            applicationOverloadFactor = 1.80;
                            overloadExplanation = "Heavy Duty (Severe Duty): 180% overload capacity.";
                        }
                        addDetailedCalculationStep(
                            "Step 5: Determine VFD Overload Requirement",
                            overloadExplanation,
                            null,
                            `Overload Factor = ${applicationOverloadFactor.toFixed(2)}`
                        );
                        
                        const vfdCurrentRequirement = Math.max(currentWithSF, effectiveMotorRatedCurrent * applicationOverloadFactor) * (1 + safetyFactor);
                        addDetailedCalculationStep(
                            "Step 6: Calculate Base VFD Current Requirement",
                            `This is the VFD's required current, considering continuous SF load OR peak overload, plus a safety factor.`,
                            `$$I_{base} = \\text{max}(I_{SF}, I_{eff} \\times \\text{Overload}) \\times (1 + \\text{Safety Factor})$$`,
                            `Calculation: $\\text{max}(${currentWithSF.toFixed(2)} \\text{ A}, ${effectiveMotorRatedCurrent.toFixed(2)} \\text{ A} \\times ${applicationOverloadFactor}) \\times (1 + ${safetyFactor}) = ${vfdCurrentRequirement.toFixed(2)} \\text{ A}$`
                        );

                        let tempDeratingFactor = 1.0;
                        if (ambientTemperature > 40) {
                            tempDeratingFactor = 1.0 + ((ambientTemperature - 40) * 0.02);
                        }
                        const vfdCurrentAfterTemp = vfdCurrentRequirement * tempDeratingFactor;
                        addDetailedCalculationStep(
                            "Step 7: Apply Temperature Derating",
                            `Applying derating for ambient temp of ${ambientTemperature}°C (Base: 40°C).`,
                            null,
                            `Derating Factor = ${tempDeratingFactor.toFixed(2)}\\n${vfdCurrentRequirement.toFixed(2)} \\text{ A} \\times ${tempDeratingFactor.toFixed(2)} = ${vfdCurrentAfterTemp.toFixed(2)} \\text{ A}$`
                        );

                        let altitudeDeratingFactor = 1.0;
                        if (altitude > 1000) {
                            altitudeDeratingFactor = 1.0 + (Math.floor((altitude - 1000) / 100) * 0.01);
                        }
                        const vfdCurrentAfterAltitude = vfdCurrentAfterTemp * altitudeDeratingFactor;
                        addDetailedCalculationStep(
                            "Step 8: Apply Altitude Derating",
                            `Applying derating for altitude of ${altitude}m (Base: 1000m).`,
                            null,
                            `Derating Factor = ${altitudeDeratingFactor.toFixed(2)}\\n${vfdCurrentAfterTemp.toFixed(2)} \\text{ A} \\times ${altitudeDeratingFactor.toFixed(2)} = ${vfdCurrentAfterAltitude.toFixed(2)} \\text{ A}$`
                        );
                        
                        const finalRequiredVFDCurrent = vfdCurrentAfterAltitude;

                        const vfdKVAFromCurrent = (motorPhaseType === 'three' ? Math.sqrt(3) : 1) * supplyVoltage * finalRequiredVFDCurrent / 1000;
                        const suggestedVFD_KW = vfdKVAFromCurrent * 0.95;
                        const suggestedVFD_HP = suggestedVFD_KW / 0.7457;
                        
                        addDetailedCalculationStep(
                            "Step 9: Estimate Suggested VFD Power Rating (for reference)",
                            null,
                            `$$S_{VFD} = \\frac{\\sqrt{3} \\times V_{supply} \\times I_{VFD, final}}{1000}$$`,
                            `Est. kVA = ${vfdKVAFromCurrent.toFixed(2)} kVA\\nEst. kW = ${suggestedVFD_KW.toFixed(2)} kW\\nEst. HP = ${suggestedVFD_HP.toFixed(2)} HP`
                        );

                        const commonVFD_HP_sizes = [0.5, 1, 2, 3, 5, 7.5, 10, 15, 20, 25, 30, 40, 50, 60, 75, 100, 125, 150, 200, 250, 300, 350, 400, 450, 500];
                        let finalSuggestedVFD_HP = commonVFD_HP_sizes.find(size => size >= suggestedVFD_HP);
                        if (!finalSuggestedVFD_HP) finalSuggestedVFD_HP = suggestedVFD_HP.toFixed(2);
                        const finalSuggestedVFD_KW = finalSuggestedVFD_HP * 0.7457;

                        let brakingResistorRecommendation = (brakingRequired === 'yes') ? "<strong>Required.</strong> Size based on inertia, decel time, and duty cycle." : "Not required based on selection.";
                        let lineLoadReactorRecommendation = "None requested.";
                        if (lineReactorRequired === 'yes') {
                            lineLoadReactorRecommendation = "<strong>Line and/or Load Reactors specified.</strong>";
                        } else if (lineReactorRequired === 'auto') {
                            lineLoadReactorRecommendation = "";
                            if (cableLength > 50) lineLoadReactorRecommendation += "<strong>Load Reactor Recommended</strong> (long cable). ";
                            if (gridStiffness === 'weak') lineLoadReactorRecommendation += "<strong>Line Reactor Recommended</strong> (weak grid). ";
                            if (harmonicMitigation === 'standard') lineLoadReactorRecommendation += "<strong>Line Reactor Recommended</strong> (harmonics).";
                            if (lineLoadReactorRecommendation === "") lineLoadReactorRecommendation = "Not automatically recommended.";
                        }
                        
                        const currentMotorInputPowerKW = (motorRatedPowerKW * motorLoadFactor) / motorEfficiency;
                        let energySavingsPercent = 0;
                        if (applicationType === 'variable-torque' && motorLoadFactor < 1) {
                            const avgSpeedFactor = (motorLoadFactor + 1) / 2;
                            const powerAtReducedSpeedFactor = Math.pow(avgSpeedFactor, 3);
                            energySavingsPercent = (1 - powerAtReducedSpeedFactor) * 100;
                        }
                        const annualEnergyConsumptionWithoutVFD = currentMotorInputPowerKW * operatingHoursPerYear;
                        const annualEnergyCostWithoutVFD = annualEnergyConsumptionWithoutVFD * electricityCostPerKWh;
                        const annualEnergyConsumptionWithVFD = annualEnergyConsumptionWithoutVFD * (1 - (energySavingsPercent / 100));
                        const annualEnergyCostWithVFD = annualEnergyConsumptionWithVFD * electricityCostPerKWh;
                        const annualCostSavings = annualEnergyCostWithoutVFD - annualEnergyCostWithVFD;
                        const cumulativeSavings = annualCostSavings * analysisPeriodYears;
                        const carbonEmissionFactor = 0.5;
                        const annualCarbonReduction = (annualEnergyConsumptionWithoutVFD - annualEnergyConsumptionWithVFD) * carbonEmissionFactor;

                        economicAnalysisResultsDiv.innerHTML = `
                            <p>Current Annual Energy Consumption: <strong>${annualEnergyConsumptionWithoutVFD.toFixed(2)} kWh</strong></p>
                            <p>Current Annual Energy Cost: <strong>${currencySymbol}${annualEnergyCostWithoutVFD.toFixed(2)}</strong></p>
                            <hr style="border-color: var(--border-color); margin: 10px 0;">
                            <p>Est. Annual Energy Consumption (with VFD): <strong>${annualEnergyConsumptionWithVFD.toFixed(2)} kWh</strong></p>
                            <p>Est. Annual Energy Cost (with VFD): <strong>${currencySymbol}${annualEnergyCostWithVFD.toFixed(2)}</strong></p>
                            <hr style="border-color: var(--border-color); margin: 10px 0;">
                            <p style="color: var(--success-color);"><strong>Est. Annual Cost Savings: ${currencySymbol}${annualCostSavings.toFixed(2)}</strong></p>
                            <p style="color: var(--success-color);"><strong>Cumulative Savings (${analysisPeriodYears} yrs): ${currencySymbol}${cumulativeSavings.toFixed(2)}</strong></p>
                            <p style="color: var(--secondary-color);"><strong>Est. Annual Carbon Reduction: ${annualCarbonReduction.toFixed(2)} kg CO₂</strong></p>
                        `;

                        addResultRow("<strong>Recommended VFD Current Rating</strong>", `<strong>${finalRequiredVFDCurrent.toFixed(2)} A</strong>`);
                        addResultRow("<strong>Recommended VFD Power Rating</strong>", `<strong>${finalSuggestedVFD_HP} HP / ${finalSuggestedVFD_KW.toFixed(2)} kW</strong>`);
                        addResultRow("VFD Control Type", `${vfdControlType.split('-').map(w => w.charAt(0).toUpperCase() + w.slice(1)).join(' ')}`);
                        addResultRow("Application Overload Profile", `${overloadExplanation}`);
                        addResultRow("---", "---");
                        addResultRow("Derating: Ambient Temp (>40°C)", `${((tempDeratingFactor - 1) * 100).toFixed(1)}%`);
                        addResultRow("Derating: Altitude (>1000m)", `${((altitudeDeratingFactor - 1) * 100).toFixed(1)}%`);
                        addResultRow("---", "---");
                        addResultRow("Braking Resistor", `${brakingResistorRecommendation}`);
                        addResultRow("Reactor Recommendation", `${lineLoadReactorRecommendation}`);
                        addResultRow("Harmonic Mitigation", `${harmonicMitigation.charAt(0).toUpperCase() + harmonicMitigation.slice(1)}`);
                        addResultRow("Enclosure Type", `${enclosureType.toUpperCase()}`);
                        
                        standardReference.innerHTML = `VFD selection adheres to principles from <strong>IEC 61800</strong> series, <strong>IEEE 519</strong> (Harmonics), and <strong>NEMA MG 1 Part 31</strong> (Motor/Drive Compatibility). Sizing is based on motor FLC, service factor, load profile (overload), and environmental derating (temp, altitude). <strong>Final selection must be verified against VFD manufacturer's specific datasheets.</strong>`;

                        resultContainer.style.display = 'block';
                        setTimeout(() => {
                            resultContainer.classList.add('show');
                            economicAnalysisSection.classList.add('show');
                            advancedRecommendationsSection.classList.add('show');
                            resultContainer.scrollIntoView({ behavior: 'smooth' });
                        }, 10);
                        
                        if (window.MathJax && typeof window.MathJax.typesetPromise === 'function') {
                             setTimeout(() => {
                                window.MathJax.typesetPromise(document.querySelectorAll('.math-content'))
                                    .catch(err => console.error("MathJax Error: " + err.message));
                            }, 50);
                        }

                    } catch (error) {
                        displayMessage(error.message, "error");
                    } finally {
                        calculationSpinner.style.display = 'none';
                        calculateBtn.disabled = false;
                    }
                }, 500);
            });
            
            resetFormBtn.addEventListener('click', resetForm);
            downloadPdfBtn.addEventListener('click', downloadPDF);

            const themeSwitch = document.getElementById('theme-switch');
            if (themeSwitch) {
                if (localStorage.getItem('theme') === 'dark') {
                    document.body.classList.add('dark-mode');
                    themeSwitch.checked = true;
                }
                themeSwitch.addEventListener('change', function() {
                    if (this.checked) {
                        document.body.classList.add('dark-mode');
                        localStorage.setItem('theme', 'dark');
                    } else {
                        document.body.classList.remove('dark-mode');
                        localStorage.setItem('theme', 'light');
                    }
                });
            }
        });
    </script>
</body>
</html>

