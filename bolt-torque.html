<!DOCTYPE html>
<html lang="en">
<head>
    <!-- AdSense & Analytics -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5936527763614780" crossorigin="anonymous"></script>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-23Y1V450SR"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-23Y1V450SR');
    </script>
    
    <!-- SEO Meta Tags -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bolt Torque & Preload Calculator - Industrial Grade</title>
    <meta name="description" content="Professional Bolt Torque Calculator. Calculate required torque for ASTM A193 B7, B8, SAE, and Metric bolts. Includes K-Factor lubrication selection, Stress Area calculation, and Torque-Tension analysis.">
    <meta name="keywords" content="bolt torque calculator, fastener preload, k-factor, nut factor, ASTM A193 B7, SAE Grade 8, metric bolt torque, thread stress area, lubrication factor, flange bolting">
    <meta name="author" content="Design Calculators">
    <meta name="robots" content="index, follow">

    <!-- Fonts & Icons -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Montserrat:wght@700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- PDF Generation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.8.3/jspdf.plugin.autotable.min.js"></script>

    <!-- Chart.js for Visuals -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation@2.2.1/dist/chartjs-plugin-annotation.min.js"></script>

    <!-- MathJax for Formulas -->
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['\\(', '\\)'], ['$', '$']],
                displayMath: [['\\[', '\\]'], ['$$', '$$']]
            },
            svg: { fontCache: 'global' }
        };
    </script>
    <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <!-- Favicon Links -->
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">

    <style>
        /* --- CORE THEME (Blue Industrial - Matches Reference) --- */
        :root {
            --primary: #1E3A8A; /* Dark Blue */
            --secondary: #2563EB; /* Bright Blue */
            --accent: #F59E0B; /* Amber */
            --success: #10B981;
            --danger: #DC2626;
            --warning: #F59E0B;
            --bg: #F8FAFC;
            --card: #FFFFFF;
            --text: #4B5563;
            --heading: #111827;
            --footer-bg: #0F172A;
            --border: #E2E8F0;
            --grad: linear-gradient(135deg, var(--primary), var(--secondary));
            --grad-dark: linear-gradient(135deg, #0F172A, #1E293B);
            --shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
            --shadow-lg: 0 10px 20px rgba(0, 0, 0, 0.1);
        }

        body.dark-mode {
            --primary: #10B981;
            --secondary: #34D399;
            --bg: #0F172A;
            --card: #1E293B;
            --text: #CBD5E1;
            --heading: #F1F5F9;
            --footer-bg: #020617;
            --border: #334155;
            --accent: #F59E0B;
        }

        * { box-sizing: border-box; }
        html { scroll-behavior: smooth; }
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg);
            color: var(--text);
            line-height: 1.7;
            margin: 0;
            padding: 0;
        }

        .container { max-width: 1280px; margin: 0 auto; padding: 0 24px; }

        /* Header & Nav */
        header {
            background: var(--grad);
            color: white;
            padding: 24px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .logo-container {
            display: flex;
            flex-direction: column;
            text-decoration: none;
            color: white;
        }
        .logo-text {
            font-size: 1.75rem;
            font-weight: 800;
            font-family: 'Montserrat', sans-serif;
        }
        .logo-subtitle {
            font-size: 0.8rem;
            margin: 4px 0 0 0;
            color: #E0E7FF;
            opacity: 0.9;
        }
        .nav-links {
            display: flex;
            gap: 24px;
            list-style: none;
            margin: 0;
            padding: 0;
        }
        .nav-links a {
            color: white;
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s;
        }
        .nav-links a:hover { color: var(--accent); }
        
        /* Theme Toggle */
        .theme-toggle {
            display: flex;
            align-items: center;
            gap: 12px;
            color: white;
        }
        .switch {
            position: relative;
            width: 56px;
            height: 30px;
        }
        .switch input { opacity: 0; width: 0; height: 0; }
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0; left: 0; right: 0; bottom: 0;
            background-color: rgba(0,0,0,0.2);
            transition: .4s;
            border-radius: 30px;
        }
        .slider:before {
            position: absolute;
            content: "";
            height: 22px; width: 22px;
            left: 4px; bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        input:checked + .slider { background-color: var(--accent); }
        input:checked + .slider:before { transform: translateX(26px); }

        /* Main Content & Cards */
        main { padding: 40px 0; }
        .card {
            background: var(--card);
            border-radius: 12px;
            padding: 30px;
            box-shadow: var(--shadow);
            margin-bottom: 30px;
            border: 1px solid var(--border);
            animation: fadeIn 0.6s ease-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .card h2 {
            color: var(--primary);
            border-bottom: 3px solid var(--primary);
            padding-bottom: 15px;
            margin-top: 0;
            font-family: 'Montserrat', sans-serif;
            font-size: 1.8rem;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        h3 {
            color: var(--heading);
            font-family: 'Montserrat', sans-serif;
            font-size: 1.5rem;
            margin-top: 25px;
            margin-bottom: 20px;
        }

        /* Forms */
        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        .form-group { margin-bottom: 0; }
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--heading);
        }
        .form-group input, .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--border);
            border-radius: 6px;
            background-color: var(--bg);
            color: var(--text);
            font-size: 1rem;
            transition: all 0.3s ease;
        }
        .form-group input:focus, .form-group select:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 3px rgba(30, 58, 138, 0.1);
        }
        body.dark-mode .form-group input:focus { 
            box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1);
        }

        /* Buttons */
        .btn {
            background: var(--grad);
            color: white;
            border: none;
            padding: 16px 30px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: 700;
            box-shadow: 0 4px 12px rgba(30, 58, 138, 0.3);
            transition: all 0.3s;
            width: 100%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(30, 58, 138, 0.4);
        }
        .btn-outline {
            background: transparent;
            border: 2px solid var(--secondary);
            color: var(--secondary);
            font-size: 0.9rem;
            padding: 8px 16px;
        }
        .btn-outline:hover {
            background: var(--secondary);
            color: white;
        }
        .button-wrapper {
            display: flex;
            justify-content: center;
            width: 100%;
            padding-top: 15px;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        /* Quick Load Buttons */
        .preset-container {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }
        .preset-btn {
            padding: 8px 12px;
            font-size: 0.85rem;
            border: 1px solid var(--border);
            background: var(--card);
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.2s;
            color: var(--text);
            display: flex;
            align-items: center;
            gap: 5px;
        }
        .preset-btn:hover {
            background: var(--bg);
            border-color: var(--secondary);
            color: var(--secondary);
        }

        /* Results Layout */
        .results-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            align-items: start;
        }
        @media (max-width: 1024px) {
            .results-grid { grid-template-columns: 1fr; }
        }

        .results-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            border-radius: 8px;
            overflow: hidden;
        }
        .results-table th, .results-table td {
            padding: 14px;
            text-align: left;
            border-bottom: 1px solid var(--border);
        }
        .results-table th {
            background: var(--grad);
            color: white;
            font-weight: 700;
        }
        .results-table tr:nth-child(even) { background-color: var(--bg); }
        .results-table td:first-child {
            font-weight: 600;
            color: var(--heading);
        }
        .highlight { color: var(--success); font-weight: 700; }
        .danger-text { color: var(--danger); font-weight: 700; }

        /* Canvas Container */
        .chart-container {
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 15px;
            position: relative;
            height: 400px;
            width: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
        }
        canvas {
            max-width: 100%;
            max-height: 100%;
        }

        /* Educational Section Styling */
        .insight-card {
            background: linear-gradient(135deg, var(--card), rgba(37,99,235,0.03));
            border-radius: 12px;
            padding: 25px;
            margin: 20px 0;
            border-left: 5px solid var(--secondary);
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            transition: all 0.3s;
        }
        .insight-card:hover {
            transform: translateX(5px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        .insight-card h4 {
            color: var(--secondary);
            font-size: 1.3rem;
            margin: 0 0 15px 0;
            display: flex;
            align-items: center;
            gap: 10px;
            font-family: 'Montserrat', sans-serif;
        }
        .insight-card p, .insight-card ul {
            margin: 10px 0;
            line-height: 1.8;
            color: var(--text);
        }
        .insight-card ul { padding-left: 20px; }
        .insight-card li { margin-bottom: 8px; }

        /* Formulas & Steps */
        .formula {
            background: var(--bg);
            border-left: 3px solid var(--accent);
            padding: 15px;
            margin: 12px 0;
            font-size: 1.1rem;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            overflow-x: auto;
            color: var(--heading);
        }
        .calculation-step {
            font-family: 'Courier New', monospace;
            background-color: rgba(0,0,0,0.03);
            padding: 15px;
            border-radius: 4px;
            margin-bottom: 15px;
            border-left: 4px solid var(--success);
            font-size: 0.95rem;
            line-height: 1.6;
        }
        body.dark-mode .calculation-step { background-color: rgba(255,255,255,0.05); }

        /* Vector Input Group Styling (Reused) */
        .vector-input-group {
            background: var(--bg);
            padding: 15px;
            border-radius: 8px;
            border: 1px solid var(--border);
            position: relative;
        }
        .vector-input-header {
            font-weight: 700;
            margin-bottom: 10px;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        /* Print Styling */
        @media print {
            header, footer, .education-section, .theme-toggle, .button-wrapper, .preset-container { display: none !important; }
            .card { border: none; shadow: none; padding: 0; }
            .container { width: 100%; max-width: 100%; padding: 0; }
            .results-grid { grid-template-columns: 1fr 1fr; }
            .chart-container { height: 300px; page-break-inside: avoid; }
        }

        /* Message Box */
        .message-box {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            padding: 16px 28px;
            border-radius: 8px;
            box-shadow: 0 6px 16px rgba(0,0,0,0.25);
            z-index: 10000;
            font-weight: 600;
            color: white;
            opacity: 0;
            transition: all 0.4s;
            display: none;
        }
        .message-box.show { display: block; opacity: 1; top: 30px; }
        .hidden { display: none; }

        /* Tooltip */
        .info-icon { color: var(--secondary); margin-left: 5px; cursor: help; }
        .tooltip { position: relative; display: inline-block; }
        .tooltip .tooltiptext {
            visibility: hidden;
            width: 220px;
            background-color: #333;
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 8px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -110px;
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 0.85rem;
            font-weight: 400;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .tooltip:hover .tooltiptext { visibility: visible; opacity: 1; }

        /* Footer */
        footer {
            background: var(--grad-dark);
            color: #CBD5E1;
            padding: 50px 0 20px 0;
            margin-top: 60px;
        }
        .footer-content {
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 40px;
            margin-bottom: 30px;
        }
        .footer-col { flex: 1; min-width: 200px; }
        .footer-col h4 { color: white; margin-bottom: 15px; font-weight: 700; }
        .footer-col ul { list-style: none; padding: 0; margin: 0; }
        .footer-col a { color: #CBD5E1; text-decoration: none; transition: color 0.3s; }
        .footer-col a:hover { color: var(--accent); }
        .social-buttons { display: flex; gap: 12px; margin-top: 15px; }
        .social-btn {
            width: 40px; height: 40px;
            display: flex; justify-content: center; align-items: center;
            color: white; border-radius: 50%;
            font-size: 1.1rem; transition: transform 0.3s;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        .social-btn:hover { transform: translateY(-4px); }
        .social-btn.linkedin { background-color: #0A66C2; }
        .social-btn.youtube { background-color: #FF0000; }
        .social-btn.twitter { background-color: #1DA1F2; }
        .social-btn.facebook { background-color: #1877F2; }
        .social-btn.whatsapp { background-color: #25D366; }
        .footer-disclaimer {
            text-align: center; padding-top: 25px;
            border-top: 1px solid #334155;
            max-width: 800px; margin: 0 auto;
            font-size: 0.9rem;
        }
        .footer-bottom {
            text-align: center; padding-top: 20px;
            font-size: 0.9rem; color: #94A3B8;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .container { padding: 0 15px; }
            .navbar { flex-direction: column; gap: 20px; }
            .nav-links { flex-direction: column; gap: 12px; text-align: center; }
            .form-row { grid-template-columns: 1fr; }
            .card { padding: 20px; }
            .footer-content { flex-direction: column; gap: 25px; }
        }
    </style>
</head>
<body>
    <div id="message-box" class="message-box"></div>
    <header>
        <div class="container">
            <nav class="navbar">
                <a href="#" class="logo-container">
                    <span class="logo-text">Design Calculators</span>
                    <p class="logo-subtitle">Inspired by standards such as IEC, IEEE, ISA, ASME, and API.</p>
                </a>
                <ul class="nav-links">
                    <li><a href='/'>Home</a></li>
                    <li><a href="articles.html">Articles</a></li>
                    <li><a href="indexmech.html">Mechanical</a></li>
                    <li><a href="indexele.html">Electrical</a></li>
                    <li><a href="indexinst.html">Instrumentation</a></li>
                </ul>
                <div class="theme-toggle">
                    <i class="fas fa-sun"></i>
                    <label class="switch">
                        <input type="checkbox" id="theme-switch">
                        <span class="slider"></span>
                    </label>
                    <i class="fas fa-moon"></i>
                </div>
            </nav>
        </div>
    </header>

    <main class="container">
        <div class="card">
            <h2><i class="fas fa-wrench"></i> Bolt Torque & Preload Calculator</h2>
            
            <div class="tool-description">
                <p>This commercial-grade calculator determines the optimal tightening torque for flanged joints and structural bolts. It uses the <strong>Standard Torque Equation ($T=KFD$)</strong> with a comprehensive library of friction coefficients (K-Factors) and Bolt Material Yield Strengths (ASTM/SAE/ISO). It ensures the bolt is preloaded to the correct percentage of yield (typically 60-75%) to prevent joint separation or bolt fatigue.</p>
            </div>

            <div class="calculator-form">
                <form id="torque-form">
                    <!-- Controls Row -->
                    <div class="form-row" style="align-items: end;">
                        <div class="form-group">
                            <label>Quick Load Scenarios:</label>
                            <div class="preset-container" style="margin-bottom: 0;">
                                <button type="button" class="preset-btn" onclick="loadPreset('b7_oil')"><i class="fas fa-oil-can"></i> A193 B7 w/ Oil</button>
                                <button type="button" class="preset-btn" onclick="loadPreset('b7_moly')"><i class="fas fa-hammer"></i> A193 B7 w/ Moly</button>
                                <button type="button" class="preset-btn" onclick="loadPreset('88_dry')"><i class="fas fa-times-circle"></i> Metric 8.8 Dry</button>
                            </div>
                        </div>
                    </div>

                    <!-- Bolt Specs -->
                    <h4 style="color: var(--primary); margin-bottom: 15px; border-bottom: 1px solid var(--border); padding-bottom: 5px;">1. Fastener Specifications</h4>
                    <div class="form-row">
                        <div class="vector-input-group">
                            <div class="vector-input-header"><i class="fas fa-bolt"></i> Geometry</div>
                            <div class="form-group">
                                <label for="unit-sys">Unit System</label>
                                <select id="unit-sys" onchange="updateBoltLists()">
                                    <option value="imperial">Imperial (Inches)</option>
                                    <option value="metric">Metric (mm)</option>
                                </select>
                            </div>
                            <div class="form-group" style="margin-top:10px;">
                                <label for="bolt-size">Nominal Size</label>
                                <select id="bolt-size">
                                    <!-- Populated by JS -->
                                </select>
                            </div>
                        </div>
                        <div class="vector-input-group">
                            <div class="vector-input-header"><i class="fas fa-layer-group"></i> Material Grade</div>
                            <div class="form-group">
                                <label for="bolt-grade">Grade / Class</label>
                                <select id="bolt-grade">
                                    <!-- Populated by JS -->
                                </select>
                            </div>
                            <div class="form-group" style="margin-top:10px;">
                                <label for="yield-strength">Yield Strength ($S_y$) <span id="yield-unit">[psi]</span></label>
                                <input type="number" id="yield-strength" readonly>
                            </div>
                        </div>
                    </div>

                    <!-- Lubrication & Target -->
                    <h4 style="color: var(--primary); margin-bottom: 15px; border-bottom: 1px solid var(--border); padding-bottom: 5px; margin-top: 20px;">2. Lubrication & Target Preload</h4>
                    <div class="form-row">
                        <div class="vector-input-group">
                            <div class="vector-input-header"><i class="fas fa-tint"></i> Tribology</div>
                            <div class="form-group">
                                <label for="lubricant">Lubrication Condition</label>
                                <select id="lubricant" onchange="updateK()">
                                    <option value="dry">Dry / Rusty (K=0.30)</option>
                                    <option value="zinc">Zinc Plated / Dry (K=0.20)</option>
                                    <option value="oil" selected>Machine Oil (K=0.17)</option>
                                    <option value="antiseize">Anti-Seize / Copper (K=0.13)</option>
                                    <option value="moly">Moly Paste (MoS2) (K=0.11)</option>
                                    <option value="custom">Custom K</option>
                                </select>
                            </div>
                            <div class="form-group" style="margin-top:10px;">
                                <label for="k-factor">Nut Factor ($K$)</label>
                                <input type="number" id="k-factor" value="0.17" step="0.01">
                            </div>
                        </div>
                        <div class="vector-input-group">
                            <div class="vector-input-header"><i class="fas fa-bullseye"></i> Target</div>
                            <div class="form-group">
                                <label for="target-pct">Target Preload [% Yield] <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Standard: 60-75% for static, 75-90% for dynamic/fatigue.</span></span></label>
                                <input type="number" id="target-pct" value="70" step="5">
                            </div>
                        </div>
                    </div>

                    <div class="button-wrapper">
                        <button type="button" id="calculate-btn" class="btn"><i class="fas fa-calculator"></i> Calculate Torque</button>
                        <button type="button" id="pdf-btn" class="btn btn-outline"><i class="fas fa-file-pdf"></i> Download Torque Sheet</button>
                    </div>
                </form>
            </div>

            <!-- Results Section -->
            <div id="result-container" class="card hidden" style="margin-top: 40px;">
                <h3><i class="fas fa-poll"></i> Torque Analysis</h3>
                
                <div class="results-grid">
                    <!-- Left Col: Table -->
                    <div>
                        <h4 style="margin-top: 0; color: var(--primary); margin-bottom: 15px;">Installation Specs</h4>
                        <table class="results-table">
                            <thead>
                                <tr>
                                    <th>Parameter</th>
                                    <th>Value</th>
                                </tr>
                            </thead>
                            <tbody id="result-table-body">
                                <!-- Dynamic rows -->
                            </tbody>
                        </table>
                        
                        <div style="margin-top: 20px; background: var(--bg); padding: 15px; border-radius: 6px; border: 1px solid var(--border);">
                            <strong><i class="fas fa-info-circle"></i> Insight:</strong>
                            <div id="interpretation-text" style="margin-top: 5px; font-size: 0.95rem;"></div>
                        </div>
                    </div>

                    <!-- Right Col: Visual Chart -->
                    <div>
                        <h4 style="margin-top: 0; color: var(--primary); margin-bottom: 15px;">Torque-Tension Curve</h4>
                        <div class="chart-container">
                            <canvas id="torqueChart"></canvas>
                        </div>
                        <div style="text-align: center; margin-top: 10px; font-size: 0.85rem; color: var(--text);">
                            <span style="color: #10B981;">‚óè Target Preload</span> &nbsp;
                            <span style="color: #EF4444; border-bottom: 2px dashed #EF4444;">-- Yield Limit (100%)</span>
                        </div>
                    </div>
                    
                     <!-- Canvas Joint Visual -->
                     <div style="grid-column: 1 / -1; margin-top: 20px;">
                        <h4 style="margin-top: 0; color: var(--primary); margin-bottom: 15px;">Bolted Joint Diagram</h4>
                        <div class="chart-container" style="height: 300px; display:flex; justify-content:center;">
                            <canvas id="boltCanvas" width="400" height="250"></canvas>
                        </div>
                    </div>
                </div>

                <h4 style="margin-top: 30px; border-top: 1px solid var(--border); padding-top: 20px;">Step-by-Step Engineering Calculation</h4>
                <div id="calculation-details">
                    <!-- Dynamic math steps -->
                </div>

                <div class="standard-reference" style="margin-top: 20px; font-style: italic; color: var(--text);">
                     Calculations based on $T = K F D$. Stress Area derived from ASME B1.1 (Imperial) and ISO 898-1 (Metric).
                </div>
            </div>
        </div>

        <!-- EDUCATIONAL CONTENT SECTION (MASSIVE) -->
        <div class="education-section card">
            <h2><i class="fas fa-lightbulb"></i> Engineering Insights: The Science of Bolting</h2>
            
            <!-- Insight 1: Why Torque? -->
            <div class="insight-card">
                <h4><i class="fas fa-wrench"></i> 1. Torque is a Proxy, Not the Goal</h4>
                <p>The goal of bolting is <strong>Clamping Force (Preload)</strong>, not Torque. We use Torque because it is easy to measure, but it is an indirect method. We apply rotational force to creating axial tension.</p>
                <p>The relationship is $T = K \cdot F \cdot D$. Only about <strong>10% to 15%</strong> of the applied torque actually stretches the bolt (creating preload). The remaining 85-90% is wasted overcoming friction under the nut head and in the threads. This makes friction control ($K$) the single most critical variable.</p>
            </div>

            <!-- Insight 2: K-Factor Uncertainty -->
            <div class="insight-card">
                <h4><i class="fas fa-oil-can"></i> 2. The K-Factor: Friction is Everything</h4>
                <p>The "Nut Factor" ($K$) summarizes all friction variables. A small change in lubrication changes the preload drastically for the same torque.</p>
                <ul>
                    <li><strong>Dry / Rusty ($K=0.30$):</strong> High friction. Most of your torque fights rust. Result: Low Preload (Loose Joint).</li>
                    <li><strong>Machine Oil ($K=0.20$):</strong> Standard condition for "lightly oiled" black bolts.</li>
                    <li><strong>Moly Paste ($K=0.11$):</strong> Extremely slippery. Low friction. If you torque a Moly-coated bolt to "Dry" specs, you will <strong>over-tension and snap the bolt</strong> because all that torque goes into stretch.</li>
                </ul>
                <p><strong>Rule:</strong> Always re-calculate torque if you change the lubricant!</p>
            </div>

            <!-- Insight 3: Target Preload -->
            <div class="insight-card">
                <h4><i class="fas fa-bullseye"></i> 3. Why 70% of Yield?</h4>
                <p>We typically aim for 60-75% of the bolt's yield strength. Why not 100%? Or 10%?</p>
                <ul>
                    <li><strong>Too Low (< 40%):</strong> The bolt acts like a loose spring. Vibration will cause the nut to back off. The joint may separate under process pressure, causing leaks.</li>
                    <li><strong>Too High (> 90%):</strong> You risk yielding the bolt during installation (stripping threads or necking). Also, external loads (pressure, thermal expansion) add to the bolt tension, pushing it over the yield point into permanent deformation or failure.</li>
                </ul>
            </div>

            <!-- Insight 4: Material Grades -->
            <div class="insight-card">
                <h4><i class="fas fa-layer-group"></i> 4. Know Your Grades</h4>
                <p><strong>ASTM A193 B7:</strong> The workhorse of the petrochemical industry. High strength Cr-Mo steel, good for high temps. Typical Yield: 105 ksi.
                <br><strong>SAE Grade 8 / Metric 10.9:</strong> High strength structural bolts.
                <br><strong>Stainless (B8 / 304):</strong> Lower strength (Yield ~30 ksi). Prone to galling. Requires anti-seize and lower torque.</p>
            </div>
            
            <!-- Insight 5: Tightening Methods -->
            <div class="insight-card">
                <h4><i class="fas fa-tools"></i> 5. Accuracy of Methods</h4>
                <ul>
                    <li><strong>Hand Wrench:</strong> $\pm 30\%$ Accuracy. (Guesswork).</li>
                    <li><strong>Torque Wrench:</strong> $\pm 25\%$ Accuracy. (Depends on K-factor stability).</li>
                    <li><strong>Hydraulic Tensioning:</strong> $\pm 10\%$ Accuracy. (Directly pulls bolt, bypasses friction).</li>
                    <li><strong>Ultrasonic / Load Cell:</strong> $\pm 2\%$ Accuracy. (Measures actual stretch).</li>
                </ul>
            </div>
        </div>
    </main>

    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-col">
                    <h4>Design Calculators</h4>
                    <p style="font-size: 0.9rem; line-height: 1.6; margin-bottom: 15px;">Empowering engineers with precision tools for complex analysis. If you find this tool helpful, please consider sharing it with your colleagues!</p>
                    <div class="social-buttons">
                        <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://designcalculators.co.in" target="_blank" rel="noopener noreferrer" class="social-btn linkedin" aria-label="LinkedIn"><i class="fab fa-linkedin-in"></i></a>
                        <a href="https://www.youtube.com/@designcalculators" target="_blank" rel="noopener noreferrer" class="social-btn youtube" aria-label="YouTube"><i class="fab fa-youtube"></i></a>
                        <a href="https://twitter.com/intent/tweet?url=https://designcalculators.co.in" target="_blank" rel="noopener noreferrer" class="social-btn twitter" aria-label="Twitter"><i class="fab fa-twitter"></i></a>
                        <a href="https://www.facebook.com/sharer/sharer.php?u=https://designcalculators.co.in" target="_blank" rel="noopener noreferrer" class="social-btn facebook" aria-label="Facebook"><i class="fab fa-facebook-f"></i></a>
                        <a href="https://api.whatsapp.com/send?text=Check%20out%20this%20amazing%20engineering%20resource:%20https://designcalculators.co.in" target="_blank" rel="noopener noreferrer" class="social-btn whatsapp" aria-label="WhatsApp"><i class="fab fa-whatsapp"></i></a>
                    </div>
                </div>
                <div class="footer-col">
                    <h4>Quick Links</h4>
                    <ul>
                        <li><a href='/'>Home</a></li>
                        <li><a href="indexele.html">Electrical</a></li>
                        <li><a href="indexmech.html">Mechanical</a></li>
                        <li><a href="indexinst.html">Instrumentation</a></li>
                        <li><a href="articles.html">Articles</a></li>
                    </ul>
                </div>
                <div class="footer-col">
                    <h4>Resources</h4>
                    <ul>
                        <li><a href="about.html">About Us</a></li>
                        <li><a href="contact.html">Contact</a></li>
                        <li><a href="faq.html">FAQ</a></li>
                        <li><a href="privacy-policy.html">Privacy Policy</a></li>
                        <li><a href="terms-of-service.html">Terms of Service</a></li>
                    </ul>
                </div>
                <div class="footer-col">
                    <h4>More</h4>
                    <ul>
                        <li><a href='/articles.html'>Articles & Whitepapers</a></li>
                        <li><a href="sitemap2.html">Sitemap</a></li>                        
                </div>
            </div>
            <div class="footer-disclaimer">
                <p>All calculations are for preliminary engineering design guidance. Final designs must comply with all applicable local and international standards (including but not limited to ASME PCC-1, ASTM). Always verify calculations and consult with a licensed professional engineer before implementation or construction.</p>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 Design Calculators. Created by <span style="color: var(--secondary); font-weight: bold;">A Sharma</span>. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script>
        // Global State
        let torqueChart = null;
        let lastResult = null;

        // Data: Bolt Stress Areas and Yield Strengths
        // Imperial (UNC)
        const impSizes = {
            '0.25': { name: '1/4"-20', As: 0.0318 },
            '0.375': { name: '3/8"-16', As: 0.0775 },
            '0.5': { name: '1/2"-13', As: 0.1419 },
            '0.625': { name: '5/8"-11', As: 0.226 },
            '0.75': { name: '3/4"-10', As: 0.334 },
            '0.875': { name: '7/8"-9', As: 0.462 },
            '1.0': { name: '1"-8', As: 0.606 },
            '1.25': { name: '1-1/4"-7', As: 0.969 },
            '1.5': { name: '1-1/2"-6', As: 1.405 }
        };
        const impGrades = {
            'b7': { name: 'ASTM A193 B7', Sy: 105000 },
            'b8_cl1': { name: 'ASTM A193 B8 Cl.1', Sy: 30000 },
            'b8_cl2': { name: 'ASTM A193 B8 Cl.2', Sy: 95000 }, // Strain hardened
            'gr5': { name: 'SAE J429 Grade 5', Sy: 92000 },
            'gr8': { name: 'SAE J429 Grade 8', Sy: 130000 }
        };

        // Metric (Coarse)
        const metSizes = {
            '6': { name: 'M6 x 1.0', As: 20.1 },
            '8': { name: 'M8 x 1.25', As: 36.6 },
            '10': { name: 'M10 x 1.5', As: 58.0 },
            '12': { name: 'M12 x 1.75', As: 84.3 },
            '16': { name: 'M16 x 2.0', As: 157 },
            '20': { name: 'M20 x 2.5', As: 245 },
            '24': { name: 'M24 x 3.0', As: 353 },
            '30': { name: 'M30 x 3.5', As: 561 }
        };
        const metGrades = {
            '8.8': { name: 'Class 8.8', Sy: 660 }, // MPa
            '10.9': { name: 'Class 10.9', Sy: 940 },
            '12.9': { name: 'Class 12.9', Sy: 1100 }
        };

        // K-Factors
        const kFactors = {
            'dry': 0.30,
            'zinc': 0.20,
            'oil': 0.17,
            'antiseize': 0.13,
            'moly': 0.11
        };

        function updateBoltLists() {
            const unit = document.getElementById('unit-sys').value;
            const sizeSel = document.getElementById('bolt-size');
            const gradeSel = document.getElementById('bolt-grade');
            const yieldUnit = document.getElementById('yield-unit');

            sizeSel.innerHTML = '';
            gradeSel.innerHTML = '';

            if (unit === 'imperial') {
                yieldUnit.innerText = '[psi]';
                for (const [k, v] of Object.entries(impSizes)) {
                    sizeSel.add(new Option(v.name, k));
                }
                for (const [k, v] of Object.entries(impGrades)) {
                    gradeSel.add(new Option(v.name, k));
                }
                // Set default
                sizeSel.value = '0.75';
                gradeSel.value = 'b7';
            } else {
                yieldUnit.innerText = '[MPa]';
                for (const [k, v] of Object.entries(metSizes)) {
                    sizeSel.add(new Option(v.name, k));
                }
                for (const [k, v] of Object.entries(metGrades)) {
                    gradeSel.add(new Option(v.name, k));
                }
                sizeSel.value = '20';
                gradeSel.value = '8.8';
            }
            updateYield();
        }

        function updateYield() {
            const unit = document.getElementById('unit-sys').value;
            const grade = document.getElementById('bolt-grade').value;
            let sy = 0;
            if (unit === 'imperial' && impGrades[grade]) sy = impGrades[grade].Sy;
            if (unit === 'metric' && metGrades[grade]) sy = metGrades[grade].Sy;
            document.getElementById('yield-strength').value = sy;
        }

        function updateK() {
            const k = document.getElementById('lubricant').value;
            if (k !== 'custom') {
                document.getElementById('k-factor').value = kFactors[k];
            }
        }

        function loadPreset(type) {
            if (type === 'b7_oil') {
                document.getElementById('unit-sys').value = 'imperial';
                updateBoltLists();
                document.getElementById('bolt-size').value = '0.75';
                document.getElementById('bolt-grade').value = 'b7';
                document.getElementById('lubricant').value = 'oil';
            } else if (type === 'b7_moly') {
                document.getElementById('unit-sys').value = 'imperial';
                updateBoltLists();
                document.getElementById('bolt-size').value = '0.75';
                document.getElementById('bolt-grade').value = 'b7';
                document.getElementById('lubricant').value = 'moly';
            } else if (type === '88_dry') {
                document.getElementById('unit-sys').value = 'metric';
                updateBoltLists();
                document.getElementById('bolt-size').value = '16';
                document.getElementById('bolt-grade').value = '8.8';
                document.getElementById('lubricant').value = 'dry';
            }
            updateYield();
            updateK();
            displayMessage(`${type.toUpperCase()} scenario loaded.`, "success");
        }

        function displayMessage(message, type = "info") {
            let messageBox = document.getElementById('message-box');
            messageBox.textContent = message;
            if (type === "error") messageBox.style.backgroundColor = 'var(--danger)';
            else if (type === "success") messageBox.style.backgroundColor = 'var(--success)';
            else messageBox.style.backgroundColor = 'var(--primary)';
            messageBox.classList.add('show');
            setTimeout(() => messageBox.classList.remove('show'), 4000);
        }

        document.addEventListener('DOMContentLoaded', function() {
            // Theme handling
            const themeSwitch = document.getElementById('theme-switch');
            if (themeSwitch && localStorage.getItem('theme') === 'dark') {
                document.body.classList.add('dark-mode');
                themeSwitch.checked = true;
            }
            if(themeSwitch) {
                themeSwitch.addEventListener('change', function() {
                    document.body.classList.toggle('dark-mode');
                    localStorage.setItem('theme', this.checked ? 'dark' : 'light');
                });
            }

            // Init listeners
            document.getElementById('bolt-grade').addEventListener('change', updateYield);
            document.getElementById('unit-sys').addEventListener('change', updateBoltLists);

            updateBoltLists();
            
            document.getElementById('calculate-btn').addEventListener('click', performCalculation);
            document.getElementById('pdf-btn').addEventListener('click', generatePDF);
        });

        function performCalculation() {
            // 1. Get Inputs
            const unit = document.getElementById('unit-sys').value;
            const sizeKey = document.getElementById('bolt-size').value;
            const Sy = parseFloat(document.getElementById('yield-strength').value);
            const K = parseFloat(document.getElementById('k-factor').value);
            const pct = parseFloat(document.getElementById('target-pct').value);

            if (isNaN(Sy) || isNaN(K) || isNaN(pct)) {
                displayMessage("Please enter valid numbers.", "error");
                return;
            }

            // 2. Physics Engine
            let D = 0; // Nominal Dia (in or mm)
            let As = 0; // Stress Area (in2 or mm2)
            let unitT = "";
            let unitF = "";

            if (unit === 'imperial') {
                D = parseFloat(sizeKey);
                As = impSizes[sizeKey].As;
                unitT = "ft-lb";
                unitF = "lbf";
            } else {
                D = parseFloat(sizeKey); // mm
                As = metSizes[sizeKey].As;
                unitT = "N-m";
                unitF = "kN";
            }

            // Target Preload Force F = Sy * As * %
            // Metric: Sy (MPa) * As (mm2) = F (Newtons)
            // Imperial: Sy (psi) * As (in2) = F (lbf)
            
            const stress_target = Sy * (pct / 100);
            let F_preload = stress_target * As; // N or lbf
            
            // Torque T = K * F * D
            // Imperial: F(lbf) * D(in) * K = T(in-lb). Divide by 12 for ft-lb.
            // Metric: F(N) * D(mm) * K / 1000 = T(N-m).
            
            let Torque = 0;
            if (unit === 'imperial') {
                Torque = (K * F_preload * D) / 12; 
            } else {
                Torque = (K * F_preload * D) / 1000;
                F_preload /= 1000; // Convert N to kN for display
            }

            lastResult = { unit, D, As, Sy, K, pct, F_preload, Torque, unitT, unitF };

            // 3. Render Step-by-Step
            let html = `<h4>Step 1: Determine Stress Area ($A_s$)</h4>`;
            html += `<div class="calculation-step">`;
            html += `Standard Stress Area for <strong>${(unit==='imperial'? impSizes[sizeKey].name : metSizes[sizeKey].name)}</strong>:<br>`;
            html += `$$ A_s = \\mathbf{${As} \\text{ ${unit==='imperial'?'in':'mm'}^2}} $$`;
            html += `</div>`;

            html += `<h4>Step 2: Target Preload Force ($F_p$)</h4>`;
            html += `<div class="calculation-step">`;
            html += `Targeting <strong>${pct}%</strong> of Yield Strength ($S_y = ${Sy} \\text{ ${unit==='imperial'?'psi':'MPa'}}$).<br>`;
            html += `$$ F_p = S_y \\times A_s \\times \\% = ${Sy} \\times ${As} \\times ${pct/100} $$<br>`;
            html += `$$ F_p = \\mathbf{${F_preload.toFixed(0)} \\text{ ${unitF}}} $$`;
            html += `</div>`;

            html += `<h4>Step 3: Torque Calculation ($T=KFD$)</h4>`;
            html += `<div class="calculation-step">`;
            html += `Using Nut Factor $K = ${K}$ (Lubrication Friction).<br>`;
            if(unit==='imperial') {
                html += `$$ T = \\frac{K \\cdot F_p \\cdot D}{12} = \\frac{${K} \\cdot ${F_preload.toFixed(0)} \\cdot ${D}}{12} = \\mathbf{${Torque.toFixed(1)} \\text{ ft-lb}} $$`;
            } else {
                html += `$$ T = \\frac{K \\cdot F_p \\cdot D}{1000} = \\frac{${K} \\cdot ${(F_preload*1000).toFixed(0)} \\cdot ${D}}{1000} = \\mathbf{${Torque.toFixed(1)} \\text{ N-m}} $$`;
            }
            html += `</div>`;

            document.getElementById('calculation-details').innerHTML = html;

            // 4. Update Table
            const tbody = document.getElementById('result-table-body');
            tbody.innerHTML = '';
            const addRow = (n, v, u) => {
                tbody.innerHTML += `<tr><td><strong>${n}</strong></td><td>${v}</td><td>${u}</td></tr>`;
            };
            addRow("Required Torque", Torque.toFixed(1), unitT);
            addRow("Clamping Force", F_preload.toFixed(1), unitF);
            addRow("Target Stress", stress_target.toFixed(0), unit === 'imperial'?'psi':'MPa');

            const interpEl = document.getElementById('interpretation-text');
            if (K < 0.15) {
                interpEl.innerHTML = `<span style="color:var(--warning); font-weight:bold;">Low Friction Warning.</span> Moly/Copper lube reduces torque requirements significantly. Do not over-torque!`;
            } else if (K > 0.25) {
                interpEl.innerHTML = `<span style="color:var(--danger); font-weight:bold;">High Friction.</span> Dry/Rusty bolts require high torque but result in scattered preload accuracy. Lubrication recommended.`;
            } else {
                interpEl.innerHTML = `<span style="color:var(--success); font-weight:bold;">Optimal Range.</span> Standard lubrication provides consistent preload.`;
            }

            // 5. Draw Visuals
            drawChart(pct, Sy, unit);
            drawBolt(D, F_preload, Torque, unitF, unitT);

            // 6. Show
            document.getElementById('result-container').classList.remove('hidden');
            if(window.MathJax) window.MathJax.typesetPromise([document.getElementById('calculation-details')]);
            document.getElementById('result-container').scrollIntoView({ behavior: 'smooth' });
        }

        function drawBolt(D, F, T, unitF, unitT) {
            const canvas = document.getElementById('boltCanvas');
            const ctx = canvas.getContext('2d');
            const cw = canvas.width;
            const ch = canvas.height;

            ctx.clearRect(0, 0, cw, ch);
            
            // Draw Flanges
            ctx.fillStyle = '#CBD5E1';
            ctx.fillRect(100, 80, 200, 40); // Top Flange
            ctx.fillRect(100, 122, 200, 40); // Bot Flange
            ctx.strokeStyle = '#334155';
            ctx.strokeRect(100, 80, 200, 40);
            ctx.strokeRect(100, 122, 200, 40);
            
            // Gasket
            ctx.fillStyle = '#333';
            ctx.fillRect(100, 120, 200, 2);

            // Bolt Shaft
            ctx.fillStyle = '#64748B';
            ctx.fillRect(180, 40, 40, 180); // Bolt body
            
            // Bolt Head (Top)
            ctx.fillStyle = '#475569';
            ctx.fillRect(170, 40, 60, 20); // Head
            
            // Nut (Bottom)
            ctx.fillRect(170, 180, 60, 20); // Nut

            // Force Arrows (Clamping)
            ctx.strokeStyle = '#EF4444';
            ctx.lineWidth = 3;
            // Down on top flange
            drawArrow(ctx, 150, 40, 150, 80);
            drawArrow(ctx, 250, 40, 250, 80);
            // Up on bot flange
            drawArrow(ctx, 150, 200, 150, 160);
            drawArrow(ctx, 250, 200, 250, 160);

            // Torque Arrow (Rotation)
            ctx.strokeStyle = '#F59E0B';
            ctx.beginPath();
            ctx.arc(200, 190, 50, 0, Math.PI, false); // semicircle
            ctx.stroke();
            // Arrowhead on arc
            drawArrowHead(ctx, 250, 190, -Math.PI/2); // approximate

            // Labels
            ctx.fillStyle = '#EF4444';
            ctx.font = 'bold 14px Inter';
            ctx.fillText(`F = ${F.toFixed(0)} ${unitF}`, 30, 120);
            
            ctx.fillStyle = '#F59E0B';
            ctx.fillText(`T = ${T.toFixed(0)} ${unitT}`, 260, 200);
        }

        function drawArrow(ctx, x1, y1, x2, y2) {
            ctx.beginPath();
            ctx.moveTo(x1, y1);
            ctx.lineTo(x2, y2);
            ctx.stroke();
            // Head
            const ang = Math.atan2(y2-y1, x2-x1);
            drawArrowHead(ctx, x2, y2, ang);
        }

        function drawArrowHead(ctx, x, y, ang) {
            ctx.beginPath();
            ctx.moveTo(x, y);
            ctx.lineTo(x - 10*Math.cos(ang-Math.PI/6), y - 10*Math.sin(ang-Math.PI/6));
            ctx.lineTo(x - 10*Math.cos(ang+Math.PI/6), y - 10*Math.sin(ang+Math.PI/6));
            ctx.lineTo(x, y);
            ctx.fill();
        }

        function drawChart(targetPct, YieldStr, unit) {
            const ctx = document.getElementById('torqueChart').getContext('2d');
            if (torqueChart) torqueChart.destroy();

            // Stress Strain Curve Simulation (Linear elastic region)
            // Just plotting % Yield vs Load
            const labels = [0, 20, 40, 60, 80, 100, 110]; // % Yield
            const dataStress = labels.map(p => (p/100) * YieldStr);
            
            // Color zones
            const bgColors = labels.map(p => {
                if (p > 95) return '#EF4444'; // Danger
                if (p >= 60 && p <= 80) return '#10B981'; // Target
                return '#3B82F6'; // Under
            });

            torqueChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels.map(l => l + '%'),
                    datasets: [{
                        label: `Bolt Stress (${unit==='imperial'?'psi':'MPa'})`,
                        data: dataStress,
                        backgroundColor: bgColors,
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: { title: { display: true, text: 'Stress' } }
                    },
                    plugins: {
                        annotation: {
                            annotations: {
                                line1: {
                                    type: 'line',
                                    yMin: YieldStr,
                                    yMax: YieldStr,
                                    borderColor: '#EF4444',
                                    borderWidth: 2,
                                    borderDash: [5, 5],
                                    label: { content: 'Yield Point', enabled: true }
                                },
                                line2: {
                                    type: 'line',
                                    yMin: YieldStr * (targetPct/100),
                                    yMax: YieldStr * (targetPct/100),
                                    borderColor: '#10B981',
                                    borderWidth: 2,
                                    label: { content: 'Target', enabled: true }
                                }
                            }
                        }
                    }
                }
            });
        }

        function generatePDF() {
            if (!lastResult) {
                displayMessage("Calculate first.", "error");
                return;
            }
            const { jsPDF } = window.jspdf;
            const pdf = new jsPDF('p', 'mm', 'a4');
            let y = 15;

            // Header
            pdf.setFont('helvetica', 'bold');
            pdf.setFontSize(16);
            pdf.setTextColor(30, 58, 138); 
            pdf.text('Bolt Torque Specification Sheet', 105, y, { align: 'center' });
            y += 10;

            pdf.setFontSize(10);
            pdf.setTextColor(100);
            pdf.text(`Date: ${new Date().toLocaleString()}`, 105, y, { align: 'center' });
            y += 15;

            // Inputs
            pdf.setFontSize(12);
            pdf.setTextColor(0);
            pdf.text('1. Joint Details', 14, y);
            y += 5;
            
            // Get selected text
            const bSize = document.getElementById('bolt-size');
            const bGrade = document.getElementById('bolt-grade');
            const bLube = document.getElementById('lubricant');

            const inputData = [
                ['Bolt Size', bSize.options[bSize.selectedIndex].text],
                ['Material Grade', bGrade.options[bGrade.selectedIndex].text],
                ['Lubrication', bLube.options[bLube.selectedIndex].text],
                ['Nut Factor (K)', lastResult.K],
                ['Target Preload', `${lastResult.pct}% Yield`]
            ];

            pdf.autoTable({
                startY: y,
                head: [['Parameter', 'Description']],
                body: inputData,
                margin: { left: 14, right: 14 },
                theme: 'grid',
                headStyles: { fillColor: [30, 58, 138] }
            });
            y = pdf.lastAutoTable.finalY + 15;

            // Results
            pdf.text('2. Torque Requirement', 14, y);
            y += 5;

            const resData = [
                ['REQUIRED TORQUE', `${lastResult.Torque.toFixed(1)} ${lastResult.unitT}`],
                ['Clamping Force', `${lastResult.F_preload.toFixed(0)} ${lastResult.unitF}`],
                ['Yield Strength', `${lastResult.Sy} ${lastResult.unit==='imperial'?'psi':'MPa'}`]
            ];

            pdf.autoTable({
                startY: y,
                head: [['Metric', 'Value']],
                body: resData,
                margin: { left: 14, right: 14 },
                theme: 'grid',
                headStyles: { fillColor: [30, 58, 138] },
                didParseCell: function(data) {
                    if(data.row.index === 0) {
                        data.cell.styles.fontStyle = 'bold';
                        data.cell.styles.fontSize = 12;
                    }
                }
            });

            // Footer
            y = pdf.lastAutoTable.finalY + 20;
            pdf.setFontSize(8);
            pdf.setTextColor(150);
            pdf.text('Torque calculated using T = KFD. Critical joints require field verification.', 105, y, { align: 'center' });

            pdf.save('Bolt_Torque_Spec.pdf');
            displayMessage("PDF Downloaded", "success");
        }
    </script>
</body>
</html>

