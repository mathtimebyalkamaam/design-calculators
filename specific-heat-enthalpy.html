<!DOCTYPE html>
<html lang="en">
<head>
    <!-- AdSense and Analytics -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5936527763614780" crossorigin="anonymous"></script>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-23Y1V450SR"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-23Y1V450SR');
    </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Specific Heat & Enthalpy Change - Design Calculators - Mechanical</title>
    <!-- Fonts and Icons -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Montserrat:wght@700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- MathJax for LaTeX rendering -->
    <script type="text/javascript" id="MathJax-script" async
            src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
    </script>
    <!-- Favicons -->
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <script>
        // MathJax configuration to support inline and display LaTeX
        MathJax = {
            tex: {
                inlineMath: [['\\(', '\\)'], ['$', '$']],
                displayMath: [['\\[', '\\]']],
                processEscapes: true
            },
            svg: {fontCache: 'global'}
        };
    </script>
    <style>
        /* === START: NEW THEME VARIABLES === */
        :root {
            --primary-color: #1E3A8A; /* Professional Dark Blue */
            --secondary-color: #2563EB; /* Bright Blue */
            --accent-color: #F59E0B; /* Warm Amber */
            --bg-color: #F8FAFC;
            --card-bg: #FFFFFF;
            --text-color: #4B5563;
            --heading-color: #111827;
            --footer-bg: #0F172A;
            --border-color: #E2E8F0;
            --gradient-primary: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            --gradient-dark: linear-gradient(135deg, #0F172A, #1E293B);
            --card-shadow: 0 10px 25px rgba(0, 0, 0, 0.1), 0 5px 10px rgba(0, 0, 0, 0.04);
            --hover-color: #eef2ff;
            --button-hover-shadow: 0 7px 20px rgba(37, 99, 235, 0.4);
            --highlight-bg: rgba(245, 158, 11, 0.15);
            --success-color: #10B981;
            --fail-color: #EF4444;
            --warning-color: #F59E0B;
            --primary-color-rgb: 30, 58, 138; /* Added for form focus */
        }

        /* Dark mode overrides */
        body.dark-mode {
            --primary-color: #10B981;
            --secondary-color: #34D399;
            --bg-color: #0F172A;
            --card-bg: #1E293B;
            --text-color: #CBD5E1;
            --heading-color: #F1F5F9;
            --footer-bg: #020617;
            --border-color: #334155;
            --highlight-bg: rgba(16, 185, 129, 0.2);
            --hover-color: #334155;
            --button-hover-shadow: 0 7px 20px rgba(16, 185, 129, 0.3);
            --primary-color-rgb: 16, 185, 129; /* Added for form focus */
            --success-color: #10B981;
            --fail-color: #EF4444;
        }
        /* === END: NEW THEME VARIABLES === */

        /* Base body styling */
        body {
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding: 0;
            background-color: var(--bg-color);
            color: var(--text-color);
            line-height: 1.8; /* Updated line height */
            transition: background-color 0.3s, color 0.3s;
            overflow-x: hidden; /* Added */
        }

        /* Container for content width limitation and centering */
        .container {
            max-width: 1280px; /* Updated from 960px */
            margin: 0 auto;
            padding: 0 24px; /* Updated from 20px */
        }
        .content-container {
            max-width: 1100px; /* Specific container for tool content */
            margin: 0 auto;
            padding: 20px;
        }

        /* === START: NEW HEADER STYLES === */
        .header {
            background: var(--gradient-primary);
            color: white;
            padding: 24px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo-container {
            display: flex;
            align-items: center;
            gap: 16px;
            text-decoration: none;
            color: white;
        }

        .logo-text {
            font-size: 1.75rem;
            font-weight: 800;
            font-family: 'Montserrat', sans-serif;
        }

        .nav-links {
            display: flex;
            gap: 24px;
            list-style: none;
            margin: 0;
            padding: 0;
        }

        .nav-links a {
            color: white;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.3s;
        }

        .nav-links a:hover {
            color: var(--accent-color);
            transform: translateY(-2px);
        }

        .theme-toggle {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .theme-toggle .icon {
            color: white;
            font-size: 1.2rem;
        }

        .switch {
            position: relative;
            display: inline-block;
            width: 56px;
            height: 30px;
        }

        .switch input { opacity: 0; width: 0; height: 0; }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0,0,0,0.2);
            transition: .4s;
            border-radius: 30px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 22px;
            width: 22px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .slider { background-color: var(--accent-color); }
        input:checked + .slider:before { transform: translateX(26px); }
        /* === END: NEW HEADER STYLES === */


        /* Main content area styling */
        main {
            padding: 40px 0; /* Updated padding */
        }

        /* Tool container styling */
        .tool-container {
            background-color: var(--card-bg);
            border-radius: 12px;
            padding: 30px;
            box-shadow: var(--card-shadow);
            margin-bottom: 30px; /* Updated margin */
            transition: transform 0.3s ease-in-out;
        }
        .tool-container:hover {
            transform: translateY(-5px);
        }
        .tool-container h2 {
            color: var(--primary-color);
            border-bottom: 3px solid var(--primary-color); /* Updated border */
            padding-bottom: 15px; /* Updated padding */
            margin-top: 0;
            margin-bottom: 25px;
            font-size: 1.8rem; /* Updated font size */
            font-family: 'Montserrat', sans-serif; /* Added font */
        }
        
        /* Added styles for new educational content */
        .tool-container h3 {
            color: var(--primary-color);
            margin-top: 25px;
            font-family: 'Montserrat', sans-serif;
        }
        .tool-container p {
            margin-bottom: 15px;
            line-height: 1.8; /* Added */
        }
        .tool-container ul {
            padding-left: 20px;
            margin-bottom: 15px;
        }
        .tool-container li {
            margin-bottom: 10px;
        }
        .tool-container h4 {
            color: var(--secondary-color);
            margin-top: 20px;
            font-family: 'Montserrat', sans-serif;
        }
        /* End of added styles */

        .tool-description {
            margin-bottom: 25px;
            color: var(--text-color);
            font-size: 1.05em;
        }
        .tool-description ul {
            list-style-type: disc;
            margin-left: 25px;
            padding-left: 0;
            margin-top: 15px;
        }
        .tool-description ul li {
            margin-bottom: 8px;
        }
        .tool-description strong {
            color: var(--primary-color);
            font-weight: 600; /* Ensure strong tags are bold */
        }

        /* Back button styling (REMOVED) */
        /*
        .back-button {
            display: inline-block;
            background-color: var(--primary-color);
            color: white;
            padding: 12px 20px;
            border-radius: 5px; 
            text-decoration: none;
            margin-bottom: 25px;
            transition: background-color 0.3s, transform 0.2s; 
            font-weight: 600; 
        }
        .back-button:hover {
            background-color: var(--secondary-color);
            transform: translateY(-2px); 
        }
        */

        /* === START: NEW FOOTER STYLES === */
        footer {
            background: var(--gradient-dark);
            color: #CBD5E1;
            padding: 50px 0 20px 0;
        }

        .footer-content {
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 40px;
            margin-bottom: 30px;
        }

        .footer-col {
            flex: 1;
            min-width: 200px;
        }

        .footer-col h4 {
            color: white;
            margin-bottom: 15px;
            font-weight: 700;
        }

        .footer-col ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .footer-col ul li {
            margin-bottom: 10px;
        }

        .footer-col a {
            color: #CBD5E1;
            text-decoration: none;
            transition: all 0.3s;
        }

        .footer-col a:hover {
            color: var(--accent-color);
            transform: translateX(3px);
        }

        .footer-disclaimer {
            text-align: center;
            margin: 30px auto;
            padding-top: 25px;
            border-top: 1px solid #334155;
            max-width: 800px;
            font-size: 0.9rem;
            line-height: 1.6;
        }
        /* Added for disclaimer content */
        .footer-disclaimer h3, .footer-disclaimer p, .footer-disclaimer ul, .footer-disclaimer li {
            color: #CBD5E1;
            font-size: 0.9rem;
            text-align: left;
        }
        .footer-disclaimer h3 {
            text-align: center;
            color: white;
            font-size: 1.1rem;
            margin-bottom: 10px;
        }
        .footer-disclaimer ul {
            padding-left: 20px;
            margin-top: 10px;
        }
        .footer-disclaimer p {
            text-align: center;
            margin-bottom: 10px;
        }
        .footer-disclaimer strong { /* Style for strong tags in footer */
            font-weight: 600;
            color: var(--accent-color);
        }


        .footer-bottom {
            text-align: center;
            padding-top: 20px;
            font-size: 0.9rem;
            color: #94A3B8;
        }

        .creator-name {
            color: var(--secondary-color);
            font-weight: bold;
        }

        .social-buttons {
            display: flex;
            justify-content: center; /* Center buttons in footer */
            gap: 12px;
            margin-top: 15px;
        }

        .social-btn {
            width: 40px;
            height: 40px;
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            border-radius: 50%;
            text-decoration: none;
            transition: all 0.3s;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .social-btn:hover {
            transform: translateY(-4px) scale(1.1);
            box-shadow: 0 8px 16px rgba(0,0,0,0.3);
        }

        .social-btn.linkedin { background-color: #0A66C2; }
        .social-btn.youtube { background-color: #FF0000; }
        .social-btn.twitter { background-color: #1DA1F2; }
        .social-btn.facebook { background-color: #1877F2; }
        .social-btn.whatsapp { background-color: #25D366; }
        /* === END: NEW FOOTER STYLES === */
        
        /* Calculator form styling */
        .calculator-form {
            background-color: var(--card-bg);
            border-radius: 12px;
            padding: 30px;
            margin-top: 25px;
            box-shadow: var(--card-shadow);
        }
        .form-group {
            margin-bottom: 20px;
        }
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            font-size: 1.05em;
            color: var(--heading-color); /* Use heading color */
        }
        .form-group input, .form-group select {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid var(--border-color);
            border-radius: 8px; /* Rounded corners */
            background-color: var(--bg-color);
            color: var(--text-color);
            box-sizing: border-box;
            font-size: 1em;
            transition: border-color 0.3s, box-shadow 0.3s;
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.08);
        }
        .form-group input:focus, .form-group select:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(var(--primary-color-rgb), 0.3);
            outline: none;
        }
        /* Radio button group styling */
        .radio-group {
            display: flex;
            gap: 20px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }
        .radio-group label {
            display: flex;
            align-items: center;
            cursor: pointer;
            font-weight: normal;
            margin-bottom: 0;
            color: var(--text-color); /* Use text color */
        }
        .radio-group input[type="radio"] {
            width: auto;
            margin-right: 8px;
            accent-color: var(--primary-color);
        }
        /* Checkbox styling */
        .checkbox-group {
            margin-bottom: 15px;
            display: flex;
            align-items: center;
        }
        .checkbox-group input[type="checkbox"] {
            width: auto;
            margin-right: 8px;
            transform: scale(1.2);
            accent-color: var(--primary-color);
        }
        .checkbox-group label {
            margin-bottom: 0;
            color: var(--text-color); /* Use text color */
        }
        /* Responsive form row layout */
        .form-row {
            display: flex;
            gap: 20px;
            flex-wrap: wrap; /* Allows items to wrap on smaller screens */
        }
        .form-row .form-group {
            flex: 1 1 calc(50% - 10px); /* Two columns, with gap */
            min-width: 280px; /* Minimum width before wrapping */
        }
        /* Media query for single column on small screens */
        @media (max-width: 600px) {
            .form-row .form-group {
                flex: 1 1 100%; /* Single column */
            }
        }
        /* Calculate button styling */
        .calculate-btn {
            background: var(--gradient-primary); /* Use new gradient */
            color: white;
            border: none;
            padding: 15px 25px; /* Updated padding */
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.2rem; /* Updated font size */
            font-weight: 700;
            font-family: 'Montserrat', sans-serif; /* Added font */
            margin-top: 25px; /* Updated margin */
            transition: transform 0.2s, box-shadow 0.3s; /* Updated transition */
            box-shadow: var(--card-shadow);
            width: 100%; /* Full width button */
            position: relative; /* Added for ripple */
            overflow: hidden; /* Added for ripple */
        }
        .calculate-btn:hover {
            transform: translateY(-3px);
            box-shadow: var(--button-hover-shadow);
        }

        /* Result container styling */
        .result-container {
            margin-top: 40px;
            padding: 30px;
            border-radius: 12px;
            background-color: var(--card-bg);
            box-shadow: var(--card-shadow);
            display: block; /* Always block, but opacity controls visibility */
            opacity: 0;
            transition: opacity 0.6s ease-out;
            pointer-events: none; /* Prevents interaction when hidden */
        }
        .result-container.show {
            opacity: 1;
            pointer-events: auto; /* Allows interaction when shown */
        }
        .result-container h3 { /* Added for consistency */
            color: var(--primary-color);
            margin-bottom: 25px;
            font-family: 'Montserrat', sans-serif;
            font-size: 1.8rem;
            text-align: center;
        }

        /* Result table styling */
        .result-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        .result-table th, .result-table td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
        }
        .result-table th {
            background-color: var(--hover-color);
            font-weight: 600; /* Updated weight */
            font-size: 1.1em;
            color: var(--heading-color); /* Added */
        }
        .result-table tr:last-child td {
            border-bottom: none;
        }

        /* Standard reference text styling */
        .standard-reference {
            margin-top: 25px;
            font-style: italic;
            font-size: 0.95rem;
            line-height: 1.5;
            padding: 15px; /* Updated padding */
            background-color: var(--bg-color);
            border-radius: 8px;
            border: 1px solid var(--border-color);
            color: var(--text-color); /* Added */
        }
        .standard-reference strong { /* Style for strong tags in results */
             font-weight: 600;
             color: var(--heading-color);
        }

        /* Tooltip styling */
        .info-icon {
            color: var(--secondary-color); /* Updated color */
            margin-left: 8px;
            cursor: help;
            font-size: 0.9em; /* Updated size */
        }
        .tooltip {
            position: relative;
            display: inline-block;
        }
        .tooltip .tooltiptext {
            visibility: hidden;
            width: 280px; /* Updated width */
            background-color: #333;
            color: #fff;
            text-align: center;
            border-radius: 6px; /* Updated radius */
            padding: 10px; /* Updated padding */
            position: absolute;
            z-index: 10; /* Increased z-index */
            bottom: 135%; /* Updated position */
            left: 50%;
            margin-left: -140px; /* Center the tooltip */
            opacity: 0;
            transition: opacity 0.3s;
            font-weight: normal; /* Added */
            font-size: 0.9rem; /* Added */
        }
        .tooltip .tooltiptext::after {
            content: "";
            position: absolute;
            top: 100%; /* Arrow at the bottom */
            left: 50%;
            margin-left: -5px;
            border-width: 5px;
            border-style: solid;
            border-color: #333 transparent transparent transparent;
        }
        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }

        /* Custom message box for alerts */
        #custom-message-box {
            position: fixed;
            top: 20px; /* Updated position */
            left: 50%;
            transform: translateX(-50%);
            padding: 15px 25px; /* Updated padding */
            border-radius: 8px; /* Updated radius */
            box-shadow: 0 4px 10px rgba(0,0,0,0.2); /* Updated shadow */
            z-index: 1000;
            font-weight: bold;
            color: white;
            opacity: 0;
            visibility: hidden; /* Added */
            transition: opacity 0.5s ease-in-out, visibility 0.5s, background-color 0.3s; /* Added visibility */
            font-size: 1.1em;
        }
        #custom-message-box.show { /* Added show class */
            opacity: 1;
            visibility: visible;
        }
        #custom-message-box.info {
            background-color: var(--success-color);
        }
        #custom-message-box.error {
            background-color: var(--fail-color);
        }
        #custom-message-box.warning {
            background-color: var(--accent-color);
            color: #333;
        }

        /* Calculation details section styling */
        #calculation-details {
            background-color: var(--bg-color);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 25px;
            font-size: 0.98em;
            overflow-x: auto; /* Allow horizontal scrolling for formulas if needed */
        }
        #calculation-details h4 {
            color: var(--secondary-color);
            margin-top: 0;
            margin-bottom: 15px;
            font-size: 1.3em;
        }
        #calculation-details p.formula {
            font-family: 'Times New Roman', serif;
            font-style: italic;
            font-size: 1.2em;
            text-align: center;
            padding: 12px; /* Updated padding */
            background-color: var(--hover-color);
            border-radius: 6px;
            margin: 15px 0;
            border: 1px dashed var(--border-color);
            white-space: nowrap; /* Prevent formula from wrapping */
            overflow-x: auto; /* Added for smaller screens */
        }
        #calculation-details p.calculation-step {
            font-family: 'Courier New', monospace;
            background-color: var(--hover-color);
            padding: 8px 12px;
            border-radius: 5px;
            margin-bottom: 8px;
            font-size: 0.95em;
            white-space: nowrap; /* Prevent calculation steps from wrapping */
            overflow-x: auto; /* Added for smaller screens */
            color: var(--text-color); /* Added */
        }
        #calculation-details ul {
            list-style-type: disc;
            margin-left: 25px;
            padding-left: 0;
        }
        #calculation-details ul li {
            margin-bottom: 5px;
        }

        /* Specific styling for required inputs to highlight visually */
        input:required:invalid {
            border-color: var(--fail-color); /* Use theme color */
        }
        input:required:valid {
            border-color: var(--success-color); /* Use theme color */
        }

        /* Responsive Media Queries */
        @media (max-width: 768px) {
            .navbar { flex-direction: column; gap: 24px; }
            .nav-links { flex-direction: column; gap: 12px; text-align: center; }
            .container, .content-container { padding: 0 15px; }
            .tool-container { padding: 20px; }
            .footer-content { flex-direction: column; }
            .theme-toggle { position: static; margin-top: 20px; } /* Adjust theme toggle on mobile */
        }
        @media (max-width: 600px) {
            .form-row .form-group {
                flex: 1 1 100%; /* Single column */
            }
        }
    </style>
</head>
<body>
    <!-- === START: NEW HEADER === -->
    <header class="header">
    <div class="container">
    <nav class="navbar">
    <a href="/" class="logo-container">
    <span class="logo-text">Design Calculators</span>
    </a>
    <ul class="nav-links">
    <li><a href="/">Home</a></li>
    <li><a href='/articles'>Articles</a></li>
    <li><a href='/indexmech'>Mechanical</a></li>
    <li><a href='/indexele'>Electrical</a></li>
    <li><a href='/indexinst'>Instrumentation</a></li>
    </ul>
    <div class="theme-toggle">
    <i class="fas fa-sun icon"></i>
    <label class="switch">
    <input type="checkbox" id="theme-switch">
    <span class="slider"></span>
    </label>
    <i class="fas fa-moon icon"></i>
    </div>
    </nav>
    </div>
    </header>
    <!-- === END: NEW HEADER === -->

    <main class="content-container">
        <!-- Back to Tools button removed as requested -->

        <div class="tool-container">
            <h2>Specific Heat & Enthalpy Change Calculator (Industrial Grade)</h2>
            <div class="tool-description">
                <p>This calculator is an industrial-grade tool to determine the <strong>net heat transfer (Q)</strong> for a substance undergoing changes in its thermodynamic state. It combines fundamental principles of thermodynamics, allowing for calculations involving <strong>enthalpy differences</strong>, <strong>sensible heat</strong>, <strong>latent heat (phase change)</strong>, and <strong>shaft work</strong>, crucial for accurate energy balances in complex industrial processes, equipment sizing, and performance analysis.</p>
                <p><strong>Key Inputs:</strong></p>
                <ul>
                    <li><strong>Unit System:</strong> Select Metric (kg, kJ, °C) or Imperial (lb, BTU, °F) for consistent units.</li>
                    <li><strong>Mass Flow Rate (M):</strong> The mass flow rate of the substance (e.g., fluid in a heat exchanger, steam in a turbine). Obtain from calibrated flow meters under steady-state conditions.</li>
                    <li><strong>Thermodynamic Calculation Method:</strong> Choose the primary method based on available, validated data:
                        <ul>
                            <li><strong>Using Inlet/Outlet Enthalpies (h<sub>in</sub>, h<sub>out</sub>):</strong> <strong>Highly Recommended for critical applications</strong>, especially for fluids undergoing complex phase changes or when specific heat is highly variable. Enthalpy values <strong>must</strong> be obtained from reliable, industry-recognized thermodynamic property tables (e.g., ASME Steam Tables, NIST databases, specialized process simulation software) corresponding to the measured pressure and temperature.</li>
                            <li><strong>Using Temperatures & Specific Heat (T<sub>in</sub>, T<sub>out</sub>, C<sub>p</sub>):</strong> Suitable for sensible heating/cooling of substances (no phase change expected) where the specific heat capacity (\(C_p\)) can be assumed constant over the temperature range. Refer to validated engineering handbooks or material property databases for accurate \(C_p\) values.</li>
                        </ul>
                    </li>
                    <li><strong>Phase Change (Optional, with Temperatures & Specific Heat):</strong> If a phase change occurs (e.g., vaporization or condensation) while using the temperature-based method, enable this option to include:
                        <ul>
                            <li><strong>Latent Heat of Vaporization/Condensation (\(h_{fg}\)):</strong> The energy required for a complete phase change at constant temperature/pressure.</li>
                            <li><strong>Fraction of Fluid Undergoing Phase Change (\(\alpha\)):</strong> The portion of the mass flow that actually undergoes the phase change (0 to 1, or 0% to 100%).</li>
                        </ul>
                    </li>
                    <li><strong>Shaft Work (Optional):</strong> Include external work done on or by the fluid (e.g., pumps, compressors, turbines).
                        <ul>
                            <li><strong>Shaft Work Rate (W<sub>shaft</sub>):</strong> The magnitude of power exchanged with the fluid.</li>
                            <li><strong>Work Direction:</strong> Specify if work is "Done ON Fluid" (e.g., pump, compressor) or "Done BY Fluid" (e.g., turbine, expander).</li>
                        </ul>
                    </li>
                </ul>
                <p><strong>Calculated Outputs:</strong></p>
                <ul>
                    <li><strong>Specific Enthalpy Change (\(\Delta h\)):</strong> The change in enthalpy per unit mass of the substance (e.g., kJ/kg or BTU/lb). A positive value indicates energy absorbed, negative indicates energy released.</li>
                    <li><strong>Heat Transferred (Q):</strong> The net heat transferred to the substance per unit time (e.g., kJ/hr, BTU/hr, or <strong>MW</strong>). A positive value indicates heat absorbed by the substance (endothermic process); a negative value indicates heat rejected by the substance (exothermic process).</li>
                </ul>
                <p><strong>Industrial Application Note:</strong> For accurate and reliable results in complex industrial applications (e.g., heat exchanger sizing, pump/turbine power requirements, chemical reactor energy balances), it is paramount to use highly accurate, measured, and consistent thermodynamic property data. This calculator serves as a powerful validation or preliminary design tool for experienced professionals; it is <strong>not a substitute for detailed engineering analysis</strong> or process simulation software.</p>
            </div>

            <div class="calculator-form">
                <form id="enthalpy-calculator-form">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="unit-system">Unit System: <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Select Metric (kg, kJ, °C) or Imperial (lb, BTU, °F) for consistent units.</span></span></label>
                            <select id="unit-system" required>
                                <option value="metric">Metric (kg/hr, kJ/kg, °C)</option>
                                <option value="imperial">Imperial (lb/hr, BTU/lb, °F)</option>
                            </select>
                        </div>
                    </div>

                    <h3>Input Parameters</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="mass-flow-rate">Mass Flow Rate (M) <span class="mass-rate-unit">(kg/hr)</span>: <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Mass flow rate of the substance. Use data from calibrated industrial flow meters.</span></span></label>
                            <input type="number" id="mass-flow-rate" step="any" value="1000" required min="0.01">
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Thermodynamic Calculation Method:</label>
                        <div class="radio-group">
                            <label>
                                <input type="radio" name="enthalpy-method" value="direct-enthalpy" checked>
                                Using Inlet/Outlet Enthalpies
                            </label>
                            <label>
                                <input type="radio" name="enthalpy-method" value="temp-cp">
                                Using Temperatures & Specific Heat (\(C_p\))
                            </label>
                        </div>
                    </div>

                    <div id="direct-enthalpy-inputs" class="form-row">
                        <div class="form-group">
                            <label for="enthalpy-in">Inlet Enthalpy (h<sub>in</sub>) <span class="enthalpy-unit">(kJ/kg)</span>: <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Specific enthalpy at inlet. <strong>Critical Input</strong>: Obtain from validated thermodynamic property tables (e.g., ASME Steam Tables, NIST) or process simulation software at P, T.</span></span></label>
                            <input type="number" id="enthalpy-in" step="any" value="200" required>
                        </div>
                        <div class="form-group">
                            <label for="enthalpy-out">Outlet Enthalpy (h<sub>out</sub>) <span class="enthalpy-unit">(kJ/kg)</span>: <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Specific enthalpy at outlet. <strong>Critical Input</strong>: Obtain from validated thermodynamic property tables (e.g., ASME Steam Tables, NIST) or process simulation software at P, T.</span></span></label>
                            <input type="number" id="enthalpy-out" step="any" value="1500" required>
                        </div>
                    </div>

                    <div id="temp-cp-inputs" class="form-row" style="display: none;">
                        <div class="form-group">
                            <label for="temperature-in">Inlet Temperature (T<sub>in</sub>) <span class="temp-unit">(°C)</span>: <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Inlet temperature of the substance. Ensure accurate sensor readings.</span></span></label>
                            <input type="number" id="temperature-in" step="any" value="30" required>
                        </div>
                        <div class="form-group">
                            <label for="temperature-out">Outlet Temperature (T<sub>out</sub>) <span class="temp-unit">(°C)</span>: <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Outlet temperature of the substance. Ensure accurate sensor readings.</span></span></label>
                            <input type="number" id="temperature-out" step="any" value="300" required>
                        </div>
                        <div class="form-group">
                            <label for="specific-heat">Specific Heat Capacity (C<sub>p</sub>) <span class="cp-unit">(kJ/kg·°C)</span>: <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Average specific heat capacity over the temperature range. Use accurate, validated data from engineering handbooks or databases. For wide ranges, an integrated average or temperature-dependent correlation is needed.</span></span></label>
                            <input type="number" id="specific-heat" step="any" value="2.0" required min="0.001">
                        </div>
                        <div class="form-group checkbox-group">
                            <input type="checkbox" id="include-phase-change">
                            <label for="include-phase-change">Include Phase Change (e.g., vaporization, condensation)</label>
                        </div>
                        <div id="phase-change-inputs" class="form-row" style="display: none;">
                            <div class="form-group">
                                <label for="latent-heat">Latent Heat (\(h_{fg}\)) <span class="enthalpy-unit">(kJ/kg)</span>: <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Latent heat of vaporization or condensation at the phase change temperature/pressure. Obtain from thermodynamic tables.</span></span></label>
                                <input type="number" id="latent-heat" step="any" value="2257.06" min="0">
                            </div>
                            <div class="form-group">
                                <label for="phase-fraction">Fraction Undergoing Phase Change (\(\alpha\)): <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Fraction of the mass flow that changes phase (0.0 to 1.0, or 0% to 100%). E.g., 0.5 for 50% vaporized.</span></span></label>
                                <input type="number" id="phase-fraction" step="0.01" value="1.0" min="0" max="1">
                            </div>
                        </div>
                    </div>

                    <h3>Work Parameters (Optional)</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="shaft-work-rate">Shaft Work Rate (W<sub>shaft</sub>) <span class="total-energy-unit">(kJ/hr)</span>: <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Magnitude of external work exchanged with the fluid. Positive value.</span></span></label>
                            <input type="number" id="shaft-work-rate" step="any" value="0" min="0">
                        </div>
                        <div class="form-group">
                            <label for="work-direction">Work Direction:</label>
                            <select id="work-direction" disabled>
                                <option value="on-fluid">Work Done ON Fluid (e.g., Pump, Compressor)</option>
                                <option value="by-fluid">Work Done BY Fluid (e.g., Turbine, Expander)</option>
                            </select>
                            <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Select if work is done ON the fluid (energy added, like a pump) or BY the fluid (energy removed, like a turbine).</span></span>
                        </div>
                    </div>
                    <button type="button" id="calculate-enthalpy-btn" class="calculate-btn">Calculate Net Heat Transfer</button>
                </form>
            </div>

            <div id="result-container" class="result-container">
                <h3>Calculation Results</h3>
                <div id="calculation-details"></div>
                <table class="result-table">
                    <thead>
                        <tr>
                            <th>Parameter</th>
                            <th>Value</th>
                        </tr>
                    </thead>
                    <tbody id="result-table-body"></tbody>
                </table>
                <div class="standard-reference" id="standard-reference"></div>
            </div>
        </div>

        <!-- === START: NEW 800+ WORD EDUCATIONAL CONTENT === -->
        <div class="tool-container" style="margin-top: 40px; animation: fadeInSlideUp 0.8s ease;">
            <h2>The Currency of Energy: An Industrial Guide to Enthalpy</h2>
        
            <h3>What is Enthalpy, and Why Does it Matter?</h3>
            <p>In the world of industrial engineering, <strong>Enthalpy (H)</strong> is the single most important property for tracking energy. While temperature tells you <em>how hot</em> something is, enthalpy tells you <em>how much energy</em> it contains. It's the "total heat content" of a fluid, combining its internal energy (due to molecular motion) with its "flow work" (the energy required to push it through a pipe or vessel).</p>
            <p>This is why engineers in power plants, chemical refineries, and HVAC design rely on enthalpy, not just temperature. The change in enthalpy ($\Delta h$) is the <em>true</em> measure of energy added to or removed from a fluid. Whether you are boiling water into steam, expanding gas through a turbine, or chilling a refrigerant, the calculation is always about the change in enthalpy. This tool is designed to solve the fundamental equation of industrial thermodynamics: the First Law for an open system.</p>
        
            <h3>The Gold Standard: Applicable Standards & Data</h3>
            <p>The calculations performed by this tool are only as accurate as the data you provide. In professional industrial settings, that data comes from rigorously validated, internationally recognized standards and databases.
            <ul>
                <li><strong>ASME Steam Tables:</strong> This is the "bible" for any process involving water or steam. For over a century, the American Society of Mechanical Engineers has published these tables, providing precise enthalpy, entropy, and density data for water at nearly any pressure and temperature. When you select "Direct Enthalpy" for a steam turbine, this is where you get your $h_{in}$ and $h_{out}$.</li>
                <li><strong>NIST REFPROP:</strong> The National Institute of Standards and Technology (NIST) provides the "Reference Fluid Thermodynamic and Transport Properties" (REFPROP) database. This is a software standard used globally, containing hyper-accurate data for hundreds of pure fluids and mixtures, from common refrigerants (like R-134a) to industrial chemicals (like ammonia) and hydrocarbons (like methane).</li>
                <li><strong>Process Simulation Software (Aspen HYSYS, PRO/II):</strong> In a complex oil refinery or chemical plant, engineers use simulation software that has these standards <em>built-in</em>. This software calculates the enthalpy of complex mixtures at every point in the plant, forming the basis for all equipment design.</li>
            </ul>
            This tool empowers you by allowing you to input data <em>from</em> these gold-standard sources, ensuring your calculation is as accurate as the data itself.</p>
        
            <h3>Where is Enthalpy Calculation Used? (How, Why, Where)</h3>
            <p>Enthalpy calculations are the foundation of almost every major piece of industrial equipment:</p>
            <ul>
                <li><strong>Power Generation (Steam Turbines):</strong> The entire purpose of a power plant is to create high-enthalpy steam (high pressure, high temperature) and send it through a turbine. The drop in enthalpy ($\Delta h$) as the steam expands and spins the blades is <em>directly</em> converted into shaft work, which spins the generator. An engineer sizes a turbine based on the equation: <strong>$W_{shaft} = M \times (h_{in} - h_{out})$</strong>.</li>
                <li><strong>Refrigeration & HVAC (Compressors & Evaporators):</strong> In your air conditioner, a refrigerant is compressed (enthalpy increases via shaft work), cooled (enthalpy drops in the condenser), expanded (enthalpy drops dramatically), and then evaporated (enthalpy rises as it absorbs heat from your room). Sizing the compressor and coils is purely an enthalpy calculation.</li>
                <li><strong>Chemical Reactors:</strong> When a chemical reaction happens, it either releases heat (exothermic, $\Delta h$ is negative) or absorbs heat (endothermic, $\Delta h$ is positive). The engineer <em>must</em> calculate this $\Delta h$ to design the cooling jacket or heating system for the reactor to prevent a runaway reaction or to ensure the reaction proceeds at all.</li>
                <li><strong>Heat Exchangers:</strong> This is the most common use. To size any heat exchanger, you perform two enthalpy calculations that must balance:
                    <ul>
                        <li><strong>Hot Fluid:</strong> $Q_{out} = M_{hot} \times (h_{hot,in} - h_{hot,out})$</li>
                        <li><strong>Cold Fluid:</strong> $Q_{in} = M_{cold} \times (h_{cold,out} - h_{cold,in})$</li>
                    </ul>
                    In a perfect exchanger, $Q_{out} = Q_{in}$. This calculation determines how much surface area is needed to transfer that heat.</li>
            </ul>
        
            <h3>Important Quality Checks: Garbage In, Garbage Out</h3>
            <p>An industrial calculation is not a theoretical exercise; it relies on real-world measurements. The accuracy of this tool is 100% dependent on the quality of your inputs.
            <ul>
                <li><strong>Instrument Calibration:</strong> The single most important check. The pressure, temperature, and flow rate values you input <strong>must</strong> come from calibrated, reliable instruments. A temperature sensor (RTD or thermocouple) that is off by just 2 degrees, or a pressure transmitter that has "drifted," can throw off an enthalpy calculation by a significant margin, leading to incorrect assumptions about equipment performance.</li>
                <li><strong>State Point Accuracy:</strong> The pressure and temperature must be measured at the <em>exact same point</em> to define the fluid's state and find the correct enthalpy. Measuring pressure before a valve and temperature *after* it is a classic mistake that invalidates the data.</li>
                <li><strong>Defining System Boundaries:</strong> This is what the "Shaft Work" input is for. Are you calculating the heat added to a fluid *inside* a pump, or the heat added *to the system* that includes the pump? The First Law of Thermodynamics ($Q - W_{shaft} = M \times \Delta h$) requires you to be precise. This tool allows you to account for that shaft work explicitly.</li>
            </ul>
            </p>
        
            <h3>Latest Trends & Innovations</h3>
            <p>The principles of thermodynamics are old, but our tools for applying them are evolving rapidly:
            <ul>
                <li><strong>Real-Time Energy Monitoring (IIoT):</strong> The "Industrial Internet of Things" (IIoT) is changing the game. Instead of doing a calculation once, modern plants have sensors that feed live pressure, temperature, and flow data into a control system *every second*. This system calculates $Q = M \times \Delta h$ in real-time. This is incredibly powerful. For example, if the system sees that $Q$ in a heat exchanger is dropping over time (while flows are constant), it means the exchanger is "fouling" (getting dirty) and can schedule a cleaning *before* it impacts production.</li>
                <li><strong>Advanced Equations of State (EoS):</strong> For complex mixtures (like crude oil), simple tables don't exist. Process simulation software uses advanced thermodynamic models like Peng-Robinson or Soave-Redlich-Kwong (SRK) to *predict* the enthalpy of a mixture based on its chemical composition. This is essential for oil and gas refining.</li>
                <li><strong>Digital Twins:</strong> This is the pinnacle. A "Digital Twin" is a complete, real-time software replica of a physical asset (like a turbine or an entire plant). It takes in the *real* sensor data, runs it through the *real* thermodynamic models (like the ones in this calculator), and predicts performance, efficiency, and potential failures. This allows engineers to test "what-if" scenarios (like changing a pressure) on the digital model *before* risking it on the real equipment.</li>
            </ul>
            <p>By understanding and applying these principles, you move from simple temperature-based math to the robust, powerful, and essential world of industrial energy calculation.</p>
        </div>
        <!-- === END: NEW EDUCATIONAL CONTENT === -->

    </main>

    <!-- === START: NEW FOOTER === -->
    <footer>
    <div class="container">
    <div class="footer-content">
    <div class="footer-col">
    <h4>Design Calculators</h4>
    <p style="font-size: 0.9rem; line-height: 1.6; margin-bottom: 15px;">Inspired by standards such as IEC, IEEE, ISA, ASME, and API.</p>
    <div class="social-buttons">
    <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://designcalculators.co.in" target="_blank" rel="noopener noreferrer" class="social-btn linkedin"><i class="fab fa-linkedin-in"></i></a>
    <a href="https://www.youtube.com/@designcalculators" target="_blank" rel="noopener noreferrer" class="social-btn youtube"><i class="fab fa-youtube"></i></a>
    <a href="https://twitter.com/intent/tweet?url=https://designcalculators.co.in" target="_blank" rel="noopener noreferrer" class="social-btn twitter"><i class="fab fa-twitter"></i></a>
    <a href="https://www.facebook.com/sharer/sharer.php?u=https://designcalculators.co.in" target="_blank" rel="noopener noreferrer" class="social-btn facebook"><i class="fab fa-facebook-f"></i></a>
    <a href="https://api.whatsapp.com/send?text=Check%20out%20this%20amazing%20engineering%20resource:%20https://designcalculators.co.in" target="_blank" rel="noopener noreferrer" class="social-btn whatsapp"><i class="fab fa-whatsapp"></i></a>
    </div>
    </div>
    <div class="footer-col">
    <h4>Quick Links</h4>
    <ul>
    <li><a href="/">Home</a></li>
    <li><a href='/indexele'>Electrical</a></li>
    <li><a href='/indexmech'>Mechanical</a></li>
    <li><a href='/indexinst'>Instrumentation</a></li>
    </ul>
    </div>
    <div class="footer-col">
    <h4>Resources</h4>
    <ul>
    <li><a href='/about'>About Us</a></li>
    <li><a href='/contact'>Contact</a></li>
    <li><a href='/faq'>FAQ</a></li>
    <li><a href='/privacy-policy'>Privacy Policy</a></li>
    <li><a href='/terms-of-service'>Terms of Service</a></li>
    </ul>
    </div>
    <div class="footer-col">
    <h4>More</h4>
    <ul>
    <li><a href='/articles'>Articles & Blog</a></li>
    <li><a href='/sitemap2'>Sitemap</a></li>
    <li><a href="https://www.youtube.com/@designcalculators" target="_blank" rel="noopener noreferrer">YouTube Channel</a></li>
    </ul>
    </div>
    </div>
    
    <div class="footer-disclaimer">
        <!-- Kept the original disclaimer from the enthalpy calculator -->
        <h3>Disclaimer</h3>
        <p>This Specific Heat & Enthalpy Change Calculator provides a fundamental thermodynamic calculation of energy change. It is designed as a practical, industrial-grade tool for preliminary assessments, process design, and energy balance calculations.</p>
        <p><strong>Key Considerations and Limitations for Industrial Use:</strong></p>
        <ul>
            <li><strong>Data Accuracy is Critical:</strong> The precision of calculated enthalpy changes is entirely dependent on the accuracy of input data. For exact values, especially involving phase changes (e.g., vaporization, condensation) or at high pressures/temperatures, specific enthalpy values <strong>must</strong> be sourced from validated thermodynamic property tables (e.g., ASME Steam Tables, NIST databases) or specialized process simulation software. <strong>Do NOT use this tool with unverified or estimated property data for critical applications.</strong></li>
            <li><strong>Specific Heat Variability:</strong> When using the "Temperatures & Specific Heat" method, it's crucial to understand that specific heat capacity (\(C_p\)) can vary significantly with temperature, pressure, and phase (liquid, gas, solid). This calculator assumes a constant average \(C_p\) over the specified temperature range. For wide temperature ranges, high pressures, or when phase changes occur, variable \(C_p\) correlations or direct enthalpy data are <strong>required for accuracy</strong>.</li>
            <li><strong>Phase Changes:</strong> This calculator, particularly the "Temperature & Specific Heat" method when "Include Phase Change" is enabled, simplifies the phase change calculation by assuming it occurs isothermally and isobarically at a known latent heat. For complex mixtures or multi-component phase changes, advanced thermodynamic models are <strong>necessary</strong>. Ensure the latent heat and fraction apply correctly to your specific process conditions.</li>
            <li><strong>Mixtures & Chemical Reactions:</strong> This tool is designed primarily for a single pure substance or a mixture with well-defined average properties. For complex mixtures, especially with varying compositions or those undergoing chemical reactions, dedicated chemical engineering thermodynamics software (e.g., Aspen HYSYS, PRO/II) is <strong>necessary</strong>.</li>
            <li><strong>Ideal Gas vs. Real Gas Behavior:</strong> For gases at high pressures, low temperatures, or near saturation, ideal gas assumptions (where enthalpy is primarily a function of temperature) may not hold. In such cases, accurate direct enthalpy data from real gas property tables is <strong>essential</strong>.</li>
            <li><strong>Instrumentation & Measurement:</strong> Accurate field measurements of mass flow rates, temperatures, and pressures from <strong>calibrated industrial instruments</strong> are foundational for applying this calculator effectively in real-world industrial scenarios. Inaccurate measurements will lead to incorrect results.</li>
            <li><strong>Beyond This Tool:</strong> This calculator provides the energy balance for the fluid stream itself based on the First Law of Thermodynamics ($Q - W_{shaft} = \Delta H$). It does not account for equipment inefficiencies (e.g., heat exchanger effectiveness, pump/turbine isentropic efficiencies), which require separate, more comprehensive system energy balance calculations for overall thermal design and optimization.</li>
        </ul>
        <p>For critical industrial processes, detailed system design, troubleshooting complex thermal systems, process optimization, or regulatory compliance, it is <strong>imperative</strong> to utilize comprehensive engineering principles, advanced thermodynamic modeling software, and consult with experienced chemical, process, or mechanical engineers specializing in thermal systems.</p>
    </div>
    
    <div class="footer-bottom">
    <p>&copy; 2025 Design Calculators. Created by <span class="creator-name">A Sharma</span>. All rights reserved.</p>
    </div>
    </div>
    </footer>
    <!-- === END: NEW FOOTER === -->

    <!-- Custom Message Box -->
    <div id="custom-message-box"></div>

    <!-- Original Calculator Script (Unchanged) -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Get references to DOM elements
            const calculateBtn = document.getElementById('calculate-enthalpy-btn');
            const resultContainer = document.getElementById('result-container');
            const resultTableBody = document.getElementById('result-table-body');
            const standardReference = document.getElementById('standard-reference');
            const calculationDetailsDiv = document.getElementById('calculation-details');

            // Input fields
            const unitSystemSelect = document.getElementById('unit-system');
            const massFlowRateInput = document.getElementById('mass-flow-rate');

            // Calculation method selectors
            const enthalpyMethodRadios = document.querySelectorAll('input[name="enthalpy-method"]');
            const directEnthalpyInputsDiv = document.getElementById('direct-enthalpy-inputs');
            const tempCpInputsDiv = document.getElementById('temp-cp-inputs');

            // Direct Enthalpy inputs
            const enthalpyInInput = document.getElementById('enthalpy-in');
            const enthalpyOutInput = document.getElementById('enthalpy-out');

            // Temperature/Cp inputs
            const temperatureInInput = document.getElementById('temperature-in');
            const temperatureOutInput = document.getElementById('temperature-out');
            const specificHeatInput = document.getElementById('specific-heat');
            const includePhaseChangeCheckbox = document.getElementById('include-phase-change');
            const phaseChangeInputsDiv = document.getElementById('phase-change-inputs');
            const latentHeatInput = document.getElementById('latent-heat');
            const phaseFractionInput = document.getElementById('phase-fraction');

            // Work parameters
            const shaftWorkRateInput = document.getElementById('shaft-work-rate');
            const workDirectionSelect = document.getElementById('work-direction');
        
            // Labels that change text
            const massRateUnitLabel = document.querySelector('.mass-rate-unit');
            const enthalpyUnitLabels = document.querySelectorAll('.enthalpy-unit');
            const tempUnitLabels = document.querySelectorAll('.temp-unit');
            const cpUnitLabel = document.querySelector('.cp-unit');
            const totalEnergyUnitLabels = document.querySelectorAll('.total-energy-unit');

            /**
             * Displays a custom message box at the top of the screen.
             * @param {string} message - The message to display.
             * @param {string} type - The type of message ('info', 'error', 'warning').
             */
            function displayMessage(message, type = "info") {
                let messageBox = document.getElementById('custom-message-box');
                if (!messageBox) {
                    messageBox = document.createElement('div');
                    messageBox.id = 'custom-message-box';
                    document.body.appendChild(messageBox);
                }
                messageBox.textContent = message;
                messageBox.className = ''; // Clear previous classes
                messageBox.classList.add(type); // Add type class for styling
                messageBox.classList.add('show'); // Add show class to make it visible
                
                // Hide message after 5 seconds
                setTimeout(() => {
                    messageBox.classList.remove('show');
                }, 5000);
            }

            /**
             * Converts an energy value from kJ/hr or BTU/hr to MW.
             * 1 MW = 3,600,000 kJ/hr
             * 1 MW = 3,412,142 BTU/hr (approx)
             * @param {number} value - The energy value in kJ/hr or BTU/hr.
             * @param {string} unitSystem - 'metric' or 'imperial'.
             * @returns {number} The energy value in MW.
             */
            function convertToMW(value, unitSystem) {
                if (unitSystem === 'metric') {
                    // 1 MW = 1000 kW = 1000 kJ/s = 1000 * 3600 kJ/hr = 3,600,000 kJ/hr
                    return value / 3600000;
                } else {
                    return value / 3412142; // BTU/hr to MW
                }
            }


            /**
             * Updates unit labels and input defaults based on selected unit system.
             */
            function updateUnitLabelsAndDefaults() {
                const unitSystem = unitSystemSelect.value;
                const isMetric = unitSystem === 'metric';

                // Update common units
                massRateUnitLabel.textContent = isMetric ? '(kg/hr)' : '(lb/hr)';
                enthalpyUnitLabels.forEach(label => label.textContent = isMetric ? '(kJ/kg)' : '(BTU/lb)');
                tempUnitLabels.forEach(label => label.textContent = isMetric ? '(°C)' : '(°F)');
                cpUnitLabel.textContent = isMetric ? '(kJ/kg·°C)' : '(BTU/lb·°F)';
                totalEnergyUnitLabels.forEach(label => label.textContent = isMetric ? '(kJ/hr)' : '(BTU/hr)');

                // Set default values based on unit system
                if (isMetric) {
                    massFlowRateInput.value = "1000";
                    enthalpyInInput.value = "200";
                    enthalpyOutInput.value = "1500";
                    temperatureInInput.value = "30";
                    temperatureOutInput.value = "300";
                    specificHeatInput.value = "2.0";
                    latentHeatInput.value = "2257.06"; // Latent heat of water at 100°C
                    shaftWorkRateInput.value = "0";
                } else { // Imperial
                    massFlowRateInput.value = "2200"; // approx 1000 kg/hr
                    enthalpyInInput.value = "86"; // approx 200 kJ/kg
                    enthalpyOutInput.value = "645"; // approx 1500 kJ/kg
                    temperatureInInput.value = "86"; // approx 30°C
                    temperatureOutInput.value = "572"; // approx 300°C
                    specificHeatInput.value = "0.48"; // approx 2.0 kJ/kgC
                    latentHeatInput.value = "970.3"; // Latent heat of water at 212°F
                    shaftWorkRateInput.value = "0";
                }
                phaseFractionInput.value = "1.0"; // Default to full phase change

                toggleEnthalpyMethod(); // Adjust input fields based on default type
                togglePhaseChangeInputs(); // Adjust phase change inputs visibility
                toggleWorkDirectionEnabled(); // Adjust work direction dropdown
            }

            /**
             * Toggles visibility and required status of enthalpy calculation method input fields.
             */
            function toggleEnthalpyMethod() {
                const selectedMethod = document.querySelector('input[name="enthalpy-method"]:checked').value;

                if (selectedMethod === 'direct-enthalpy') {
                    directEnthalpyInputsDiv.style.display = 'flex';
                    tempCpInputsDiv.style.display = 'none';

                    enthalpyInInput.setAttribute('required', 'true');
                    enthalpyOutInput.setAttribute('required', 'true');
                    temperatureInInput.removeAttribute('required');
                    temperatureOutInput.removeAttribute('required');
                    specificHeatInput.removeAttribute('required');
                    // Phase change inputs should be hidden and not required if switching from temp-cp
                    includePhaseChangeCheckbox.checked = false;
                    togglePhaseChangeInputs(); // Ensure this runs to hide the inputs
                    latentHeatInput.removeAttribute('required');
                    phaseFractionInput.removeAttribute('required');
                } else {
                    directEnthalpyInputsDiv.style.display = 'none';
                    tempCpInputsDiv.style.display = 'flex';
                
                    enthalpyInInput.removeAttribute('required');
                    enthalpyOutInput.removeAttribute('required');
                    temperatureInInput.setAttribute('required', 'true');
                    temperatureOutInput.setAttribute('required', 'true');
                    specificHeatInput.setAttribute('required', 'true');
                    // Reset phase change inputs state
                    togglePhaseChangeInputs();
                }
            }

            /**
             * Toggles visibility and required status of phase change input fields.
             */
            function togglePhaseChangeInputs() {
                if (includePhaseChangeCheckbox.checked) {
                    phaseChangeInputsDiv.style.display = 'flex';
                    latentHeatInput.setAttribute('required', 'true');
                    phaseFractionInput.setAttribute('required', 'true');
                } else {
                    phaseChangeInputsDiv.style.display = 'none';
                    latentHeatInput.removeAttribute('required');
                    phaseFractionInput.removeAttribute('required');
                }
            }

            /**
             * Enables/disables work direction dropdown based on shaft work rate input.
             */
            function toggleWorkDirectionEnabled() {
                if (parseFloat(shaftWorkRateInput.value) > 0) {
                    workDirectionSelect.removeAttribute('disabled');
                } else {
                    workDirectionSelect.setAttribute('disabled', 'true');
                }
            }

            // Event listeners
            unitSystemSelect.addEventListener('change', updateUnitLabelsAndDefaults);
            enthalpyMethodRadios.forEach(radio => {
                radio.addEventListener('change', toggleEnthalpyMethod);
            });
            includePhaseChangeCheckbox.addEventListener('change', togglePhaseChangeInputs);
            shaftWorkRateInput.addEventListener('input', toggleWorkDirectionEnabled);

            // Initial UI setup on load
            updateUnitLabelsAndDefaults();

            /**
             * Adds a row to the result table.
             * @param {string} parameterHtml - The HTML content for the parameter column.
             * @param {string} valueHtml - The HTML content for the value column.
             */
            function addResultRow(parameterHtml, valueHtml) {
                const row = resultTableBody.insertRow();
                const paramCell = row.insertCell();
                const valueCell = row.insertCell();
                paramCell.innerHTML = parameterHtml;
                valueCell.innerHTML = valueHtml;
            }

            // Main Calculation Logic
            calculateBtn.addEventListener('click', function() {
                const form = document.getElementById('enthalpy-calculator-form');
                if (!form.checkValidity()) {
                    displayMessage("Please fill in all required fields correctly.", "error");
                    form.reportValidity(); // Show native browser validation messages
                    return;
                }

                const unitSystem = unitSystemSelect.value;
                const massFlowRate = parseFloat(massFlowRateInput.value);
                const selectedMethod = document.querySelector('input[name="enthalpy-method"]:checked').value;
                const shaftWorkRate = parseFloat(shaftWorkRateInput.value || 0); // Default to 0 if empty
                const workDirection = workDirectionSelect.value;

                let specificEnthalpyChangeFluid = 0; // Δh of the fluid only
                let totalEnthalpyChangeFluid = 0; // M * Δh of the fluid only
                let netHeatTransferred = 0; // Q = M * Δh + W_shaft (First Law)

                let calculationHtml = '<h4>Detailed Calculation Steps:</h4>';
            
                // Units for display
                const massRateUnit = unitSystem === 'metric' ? 'kg/hr' : 'lb/hr';
                const energyPerMassUnit = unitSystem === 'metric' ? 'kJ/kg' : 'BTU/lb';
                const tempUnit = unitSystem === 'metric' ? '°C' : '°F';
                const cpUnit = unitSystem === 'metric' ? 'kJ/kg·°C' : 'BTU/lb·°F';
                const totalEnergyUnit = unitSystem === 'metric' ? 'kJ/hr' : 'BTU/hr';

                // --- 1. Calculate Total Enthalpy Change of the Fluid (ΔH_fluid) ---
                if (selectedMethod === 'direct-enthalpy') {
                    const enthalpyIn = parseFloat(enthalpyInInput.value);
                    const enthalpyOut = parseFloat(enthalpyOutInput.value);

                    specificEnthalpyChangeFluid = enthalpyOut - enthalpyIn;
                    totalEnthalpyChangeFluid = massFlowRate * specificEnthalpyChangeFluid;

                    calculationHtml += `<p><strong>1. Calculate Specific Enthalpy Change of Fluid (\\(\\Delta h\\)):</strong></p>
                                        <p class="formula">\\[ \\Delta h = h_{out} - h_{in} \\]</p>
                                        <p class="calculation-step">
                                            \\( \\Delta h \\) = ${enthalpyOut.toFixed(2)} ${energyPerMassUnit} - ${enthalpyIn.toFixed(2)} ${energyPerMassUnit} = ${specificEnthalpyChangeFluid.toFixed(2)} ${energyPerMassUnit}
                                        </p>`;
                    calculationHtml += `<p><strong>2. Calculate Total Enthalpy Change of Fluid (\\(\\Delta H_{fluid}\\)):</strong></p>
                                        <p class="formula">\\[ \\Delta H_{fluid} = M \\times \\Delta h \\]</p>
                                        <p class="calculation-step">
                                            \\( \\Delta H_{fluid} \\) = ${massFlowRate.toFixed(2)} ${massRateUnit} \\( \\times \\) ${specificEnthalpyChangeFluid.toFixed(2)} ${energyPerMassUnit} = ${totalEnthalpyChangeFluid.toFixed(2)} ${totalEnergyUnit}
                                        </p>`;

                } else { // temp-cp method
                    const temperatureIn = parseFloat(temperatureInInput.value);
                    const temperatureOut = parseFloat(temperatureOutInput.value);
                    const specificHeat = parseFloat(specificHeatInput.value);

                    let sensibleHeatChange = specificHeat * (temperatureOut - temperatureIn);
                    let latentHeatChange = 0;

                    if (includePhaseChangeCheckbox.checked) {
                        const latentHeat = parseFloat(latentHeatInput.value);
                        const phaseFraction = parseFloat(phaseFractionInput.value);

                        if (latentHeat < 0) { displayMessage("Latent Heat must be non-negative.", "error"); return; }
                        if (phaseFraction < 0 || phaseFraction > 1) { displayMessage("Phase Fraction must be between 0 and 1.", "error"); return; }

                        latentHeatChange = latentHeat * phaseFraction;
                        calculationHtml += `<p><strong>1.1. Calculate Specific Latent Heat Change:</strong></p>
                                            <p class="formula">\\[ \\Delta h_{latent} = h_{fg} \\times \\alpha \\]</p>
                                            <p class="calculation-step">
                                                \\( \\Delta h_{latent} \\) = ${latentHeat.toFixed(2)} ${energyPerMassUnit} \\( \\times \\) ${phaseFraction.toFixed(2)} = ${latentHeatChange.toFixed(2)} ${energyPerMassUnit}
                                            </p>`;
                    }

                    specificEnthalpyChangeFluid = sensibleHeatChange + latentHeatChange;
                    totalEnthalpyChangeFluid = massFlowRate * specificEnthalpyChangeFluid;

                    calculationHtml += `<p><strong>1. Calculate Specific Sensible Heat Change (\\(\\Delta h_{sensible}\\)):</strong></p>
                                        <p class="formula">\\[ \\Delta h_{sensible} = C_p \\times (T_{out} - T_{in}) \\]</p>
                                        <p class="calculation-step">
                                            \\( \\Delta h_{sensible} \\) = ${specificHeat.toFixed(3)} ${cpUnit} \\( \\times \\) (${temperatureOut.toFixed(2)} - ${temperatureIn.toFixed(2)}) ${tempUnit} = ${sensibleHeatChange.toFixed(2)} ${energyPerMassUnit}
                                        </p>`;
                    if (includePhaseChangeCheckbox.checked) {
                        calculationHtml += `<p><strong>1.2. Calculate Total Specific Enthalpy Change (\\(\\Delta h\\)):</strong></p>
                                            <p class="formula">\\[ \\Delta h = \\Delta h_{sensible} + \\Delta h_{latent} \\]</p>
                                            <p class="calculation-step">
                                                \\( \\Delta h \\) = ${sensibleHeatChange.toFixed(2)} ${energyPerMassUnit} + ${latentHeatChange.toFixed(2)} ${energyPerMassUnit} = ${specificEnthalpyChangeFluid.toFixed(2)} ${energyPerMassUnit}
                                            </p>`;
                    }
                    calculationHtml += `<p><strong>2. Calculate Total Enthalpy Change of Fluid (\\(\\Delta H_{fluid}\\)):</strong></p>
                                        <p class="formula">\\[ \\Delta H_{fluid} = M \\times \\Delta h \\]</p>
                                        <p class="calculation-step">
                                            \\( \\Delta H_{fluid} \\) = ${massFlowRate.toFixed(2)} ${massRateUnit} \\( \\times \\) ${specificEnthalpyChangeFluid.toFixed(2)} ${energyPerMassUnit} = ${totalEnthalpyChangeFluid.toFixed(2)} ${totalEnergyUnit}
                                        </p>`;
                }

                // --- 3. Incorporate Shaft Work into Net Heat Transfer ---
                let shaftWorkSign = 0; // Positive for work done BY fluid, negative for work done ON fluid
                if (shaftWorkRate > 0) {
                    if (workDirection === 'on-fluid') {
                        shaftWorkSign = -1; // Work done ON fluid (e.g., pump), so W_shaft is negative in Q - W = Delta H
                        calculationHtml += `<p><strong>3. Shaft Work Term (W<sub>shaft</sub>):</strong> Work Done ON Fluid (Pump/Compressor) </p>
                                            <p class="calculation-step">
                                                \\( W_{shaft} \\) = -${shaftWorkRate.toFixed(2)} ${totalEnergyUnit}
                                            </p>`;
                    } else { // 'by-fluid'
                        shaftWorkSign = 1; // Work done BY fluid (e.g., turbine), so W_shaft is positive in Q - W = Delta H 
                        calculationHtml += `<p><strong>3. Shaft Work Term (W<sub>shaft</sub>):</strong> Work Done BY Fluid (Turbine/Expander) </p>
                                            <p class="calculation-step">
                                                \\( W_{shaft} \\) = +${shaftWorkRate.toFixed(2)} ${totalEnergyUnit}
                                            </p>`;
                    }
                } else {
                    calculationHtml += `<p><strong>3. Shaft Work Term (W<sub>shaft</sub>):</strong> No shaft work considered (0 ${totalEnergyUnit}).</p>`;
                }

                // First Law of Thermodynamics: Q - W = ΔH => Q = ΔH + W
                // Note: W here is W_shaft (work done BY system). If work is done ON system, W is negative.
                netHeatTransferred = totalEnthalpyChangeFluid + (shaftWorkSign * shaftWorkRate);

                calculationHtml += `<p><strong>4. Calculate Net Heat Transferred (Q) using First Law of Thermodynamics:</strong></p>
                                    <p class="formula">\\[ Q - W_{shaft} = \\Delta H_{fluid} \\implies Q = \\Delta H_{fluid} + W_{shaft} \\]</p>
                                    <p class="calculation-step">
                                        \\( Q \\) = ${totalEnthalpyChangeFluid.toFixed(2)} ${totalEnergyUnit} ${shaftWorkSign === 1 ? '+' : (shaftWorkSign === -1 ? '-' : '+')} ${shaftWorkRate.toFixed(2)} ${totalEnergyUnit} = ${netHeatTransferred.toFixed(2)} ${totalEnergyUnit}
                                    </p>`;

                // Convert total heat transferred to MW
                const netHeatTransferredMW = convertToMW(netHeatTransferred, unitSystem);
                calculationHtml += `<p class="calculation-step">
                                    Net Heat Transferred in MW = ${netHeatTransferred.toFixed(2)} ${totalEnergyUnit} / ${unitSystem === 'metric' ? '3,600,000 kJ/hr/MW' : '3,412,142 BTU/hr/MW'} = ${netHeatTransferredMW.toFixed(4)} MW
                                </p>`;

                // Clear previous results
                resultTableBody.innerHTML = '';
                calculationDetailsDiv.innerHTML = calculationHtml;

                // Populate results table
                addResultRow("Unit System", unitSystem === 'imperial' ? 'Imperial' : 'Metric');
                addResultRow("Mass Flow Rate (M)", `${massFlowRate.toFixed(2)} ${massRateUnit}`);
                addResultRow("Calculation Method", selectedMethod === 'direct-enthalpy' ? 'Using Inlet/Outlet Enthalpies' : 'Using Temperatures & C<sub>p</sub>');
            
                if (selectedMethod === 'direct-enthalpy') {
                    addResultRow("Inlet Enthalpy (h<sub>in</sub>)", `${parseFloat(enthalpyInInput.value).toFixed(2)} ${energyPerMassUnit}`);
                    addResultRow("Outlet Enthalpy (h<sub>out</sub>)", `${parseFloat(enthalpyOutInput.value).toFixed(2)} ${energyPerMassUnit}`);
                } else {
                    addResultRow("Inlet Temperature (T<sub>in</sub>)", `${parseFloat(temperatureInInput.value).toFixed(2)} ${tempUnit}`);
                    addResultRow("Outlet Temperature (T<sub>out</sub>)", `${parseFloat(temperatureOutInput.value).toFixed(2)} ${tempUnit}`);
                    addResultRow("Specific Heat Capacity (C<sub>p</sub>)", `${parseFloat(specificHeatInput.value).toFixed(3)} ${cpUnit}`);
                    if (includePhaseChangeCheckbox.checked) {
                        addResultRow("Latent Heat (h<sub>fg</sub>)", `${parseFloat(latentHeatInput.value).toFixed(2)} ${energyPerMassUnit}`);
                        addResultRow("Fraction Phase Changed (\\(\\alpha\\))", `${parseFloat(phaseFractionInput.value).toFixed(2)}`);
                    } else {
                        addResultRow("Phase Change", "Not Included");
                    }
                }
            
                addResultRow("Shaft Work Rate (W<sub>shaft</sub>)", `${shaftWorkRate.toFixed(2)} ${totalEnergyUnit}`);
                if (shaftWorkRate > 0) {
                    addResultRow("Work Direction", workDirection === 'on-fluid' ? 'Work Done ON Fluid' : 'Work Done BY Fluid');
                } else {
                    addResultRow("Work Direction", "N/A (No Work)");
                }

                // Final results
                addResultRow("Specific Enthalpy Change (\\(\\Delta h\\))", `<strong>${specificEnthalpyChangeFluid.toFixed(2)} ${energyPerMassUnit}</strong>`);
                addResultRow("Total Enthalpy Change of Fluid (\\(\\Delta H_{fluid}\\))", `<strong>${totalEnthalpyChangeFluid.toFixed(2)} ${totalEnergyUnit}</strong>`);
                addResultRow("Net Heat Transferred (Q)", `<strong>${netHeatTransferred.toFixed(2)} ${totalEnergyUnit} (${netHeatTransferredMW.toFixed(4)} MW)</strong>`);
                addResultRow("Interpretation of Q", `A ${netHeatTransferred >= 0 ? 'positive' : 'negative'} value indicates heat ${netHeatTransferred >= 0 ? 'absorbed by' : 'rejected by'} the substance.`);

                // Re-render MathJax equations - ensure MathJax is fully loaded
                if (window.MathJax && typeof window.MathJax.typesetPromise === 'function') {
                    window.MathJax.typesetPromise([calculationDetailsDiv, resultTableBody]);
                }

                // Display standard reference (simplified, as footer has full text)
                standardReference.innerHTML = "<strong>Calculation based on the First Law of Thermodynamics for an open system:</strong> $Q - W_{shaft} = M \\times (h_{out} - h_{in})$.<br>Refer to the footer disclaimer for critical limitations and industrial use considerations.";
                
                // Ensure result container is visible and transitions smoothly
                resultContainer.style.display = 'block'; // Make element visible
                resultContainer.offsetHeight; // Force reflow to ensure display change is registered before transition
                resultContainer.classList.add('show'); // Apply class that sets opacity to 1 and allows interaction

                resultContainer.scrollIntoView({ behavior: 'smooth' });
                displayMessage("Net heat transfer calculation completed successfully!", "info");
            });

            // === START: NEW THEME TOGGLE SCRIPT ===
            // Theme switch functionality
            const themeSwitch = document.getElementById('theme-switch');
            const body = document.body;
            const currentTheme = localStorage.getItem('theme');
            
            if (currentTheme) {
                body.classList.add(currentTheme);
                if (currentTheme === 'dark-mode') {
                    themeSwitch.checked = true;
                }
            }
            
            themeSwitch.addEventListener('change', () => {
                if (themeSwitch.checked) {
                    body.classList.add('dark-mode');
                    localStorage.setItem('theme', 'dark-mode');
                } else {
                    body.classList.remove('dark-mode');
                    localStorage.setItem('theme', 'light-mode');
                }
            });
            // === END: NEW THEME TOGGLE SCRIPT ===
        });
    </script>
</body>
</html>
