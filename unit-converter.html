<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Electrical Unit Converter Pro - World Class Edition</title>
<meta name="description" content="A professional, industrial-grade tool for converting all critical electrical units, including complex power triangle calculations (kW, kVA, kVAR) and more.">
<!-- AdSense and Analytics -->
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5936527763614780" crossorigin="anonymous"></script>
<script async src="https://www.googlesyndication.com/pagead/js/adsbygoogle.js?id=G-23Y1V450SR"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-23Y1V450SR');
</script>
<!-- Fonts and Icons -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Montserrat:wght@700;800;900&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<!-- MathJax for Formulas -->
<script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script>
MathJax = {
tex: {inlineMath: [['$', '$'], ['\\(', '\\)']]},
svg: {fontCache: 'global'},
options: {
    processHtmlClass: 'math-content', // Process elements with this class
    ignoreHtmlClass: 'no-mathjax'      // Ignore elements with this class
}
};
</script>
<!-- Favicons -->
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="icon" href="/favicon.ico" type="image/x-icon">
<style>
/* Base Styles from perfect.txt */
:root {
--primary-color: #1E3A8A; /* Professional Dark Blue */
--secondary-color: #2563EB; /* Bright Blue */
--accent-color: #F59E0B; /* Warm Amber */
--bg-color: #F8FAFC;
--card-bg: #FFFFFF;
--text-color: #4B5563;
--heading-color: #111827;
--footer-bg: #0F172A;
--border-color: #E2E8F0;
--gradient-primary: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
--gradient-dark: linear-gradient(135deg, #0F172A, #1E293B);
--card-shadow: 0 10px 25px rgba(0, 0, 0, 0.1), 0 5px 10px rgba(0, 0, 0, 0.04);
--hover-color: #eef2ff;
--button-hover-shadow: 0 7px 20px rgba(37, 99, 235, 0.4);
--highlight-bg: rgba(245, 158, 11, 0.15);
--success-color: #10B981;
--fail-color: #EF4444;
--warning-color: #F59E0B; /* Added for consistency */
}

body.dark-mode {
--primary-color: #10B981;
--secondary-color: #34D399;
--bg-color: #0F172A;
--card-bg: #1E293B;
--text-color: #CBD5E1;
--heading-color: #F1F5F9;
--footer-bg: #020617;
--border-color: #334155;
--highlight-bg: rgba(16, 185, 129, 0.2);
--hover-color: #334155;
--button-hover-shadow: 0 7px 20px rgba(16, 185, 129, 0.3);
}

html { scroll-behavior: smooth;}

body {
font-family: 'Inter', sans-serif;
background-color: var(--bg-color);
color: var(--text-color);
line-height: 1.8;
transition: background-color 0.3s, color 0.3s;
overflow-x: hidden;
margin: 0;
padding: 0;
}

.container { max-width: 1280px; margin: 0 auto; padding: 0 24px; }
.content-container {max-width: 1100px;margin: 0 auto;padding: 20px;}

/* === START: NEW HEADER STYLES === */
.header {
background: var(--gradient-primary);
color: white;
padding: 24px 0;
box-shadow: 0 2px 10px rgba(0,0,0,0.1);
}

.navbar {
display: flex;
justify-content: space-between;
align-items: center;
}

.logo-container {
display: flex;
align-items: center;
gap: 16px;
text-decoration: none;
color: white;
}

.logo-text {
font-size: 1.75rem;
font-weight: 800;
font-family: 'Montserrat', sans-serif;
}

.nav-links {
display: flex;
gap: 24px;
list-style: none;
margin: 0;
padding: 0;
}

.nav-links a {
color: white;
text-decoration: none;
font-weight: 500;
transition: all 0.3s;
}

.nav-links a:hover {
color: var(--accent-color);
transform: translateY(-2px);
}

.theme-toggle {
display: flex;
align-items: center;
gap: 12px;
}

.theme-toggle .icon {
color: white;
font-size: 1.2rem;
}

.switch {
position: relative;
display: inline-block;
width: 56px;
height: 30px;
}

.switch input { opacity: 0; width: 0; height: 0; }

.slider {
position: absolute;
cursor: pointer;
top: 0;
left: 0;
right: 0;
bottom: 0;
background-color: rgba(0,0,0,0.2);
transition: .4s;
border-radius: 30px;
}

.slider:before {
position: absolute;
content: "";
height: 22px;
width: 22px;
left: 4px;
bottom: 4px;
background-color: white;
transition: .4s;
border-radius: 50%;
}

input:checked + .slider { background-color: var(--accent-color); }
input:checked + .slider:before { transform: translateX(26px); }
/* === END: NEW HEADER STYLES === */

/* Styles from user's original file, adapted for new theme */
main { padding: 40px 0; }
.content-container {max-width: 1100px;margin: 0 auto;padding: 0 15px;}

.back-button {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    color: var(--primary-color);
    font-weight: bold;
    text-decoration: none;
    transition: color 0.3s;
    margin-bottom: 25px; /* Added margin */
}
.back-button:hover {
    color: var(--secondary-color);
}
.tool-container {
    background-color: var(--card-bg);
    border-radius: 12px; /* Increased border radius */
    padding: 30px; /* Increased padding */
    margin-top: 20px;
    box-shadow: var(--card-shadow);
}
.tool-container h2 {
    color: var(--primary-color);
    border-bottom: 3px solid var(--primary-color);
    padding-bottom: 15px;
    margin-top: 0;
    margin-bottom: 25px;
    font-family: 'Montserrat', sans-serif;
    font-size: 1.8rem;
}
.tool-container h3 {
    color: var(--primary-color);
    margin-top: 25px;
    font-family: 'Montserrat', sans-serif;
}
.tool-container p {
    margin-bottom: 15px;
}
.tool-container ul {
    padding-left: 20px;
    margin-bottom: 15px;
}
.tool-container li {
    margin-bottom: 10px;
}
.tool-container h4 {
    color: var(--secondary-color);
    margin-top: 20px;
    font-family: 'Montserrat', sans-serif;
}
.tool-description {
    background-color: var(--hover-color);
    border-radius: 8px;
    padding: 25px;
    margin-bottom: 30px;
    border-left: 5px solid var(--primary-color);
}
.form-group {
    margin-bottom: 15px;
}
.form-group label {
    display: block;
    margin-bottom: 8px; /* Increased margin */
    font-weight: 600; /* Bolder */
    color: var(--heading-color);
}
.form-group input, .form-group select {
    width: 100%;
    padding: 12px; /* Increased padding */
    border: 1px solid var(--border-color);
    border-radius: 5px; /* Rounded corners */
    background-color: var(--bg-color);
    color: var(--text-color);
    box-sizing: border-box; /* Added for consistency */
    transition: border-color 0.3s, box-shadow 0.3s;
}
.form-group input:focus, .form-group select:focus {
    border-color: var(--primary-color);
    box-shadow: 0 0 8px rgba(30, 58, 138, 0.3);
    outline: none;
}
.form-row {
    display: grid; /* Use Grid */
    grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); /* Responsive columns */
    gap: 20px; /* Increased gap */
}

.calculate-btn {
    background: var(--gradient-primary);
    color: white;
    border: none;
    padding: 12px 20px;
    border-radius: 8px; /* Rounded corners */
    cursor: pointer;
    font-size: 1rem; /* Adjusted size */
    font-weight: 700;
    margin-top: 10px;
    transition: transform 0.2s, box-shadow 0.3s;
}
.calculate-btn:hover {
    transform: translateY(-2px); /* Hover effect */
    box-shadow: var(--button-hover-shadow);
}
.reset-btn {
    background-color: #6b7280; /* Gray for reset */
    color: white;
    border: none;
    padding: 12px 20px;
    border-radius: 8px;
    cursor: pointer;
    font-size: 1rem;
    font-weight: 700;
    margin-top: 10px;
    transition: background-color 0.3s, transform 0.2s;
    margin-left: 10px;
}
.reset-btn:hover {
    background-color: #4b5563; /* Darker gray */
    transform: translateY(-2px);
}
.result-container {
    margin-top: 30px;
    padding: 25px; /* Increased padding */
    border-radius: 12px; /* Increased radius */
    background-color: var(--card-bg);
    box-shadow: var(--card-shadow);
    display: none; /* Hidden by default */
}
.result-container h3 {
    color: var(--primary-color);
    margin-bottom: 20px; /* Increased margin */
}
.result-table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 15px;
}
.result-table th, .result-table td {
    padding: 12px;
    text-align: left;
    border-bottom: 1px solid var(--border-color);
}
.result-table th {
    background-color: var(--hover-color);
    color: var(--heading-color); /* Added for dark mode */
}
.standard-reference {
    margin-top: 20px;
    padding: 15px; /* Added padding */
    font-style: italic;
    font-size: 0.9rem;
    color: var(--text-color);
    background-color: var(--hover-color); /* Added background */
    border-radius: 8px; /* Rounded corners */
    border-left: 4px solid var(--accent-color); /* Accent border */
}
/* Tooltip styles */
.tooltip {
    position: relative;
    display: inline-block;
}
.info-icon {
    color: var(--secondary-color); /* Use theme color */
    margin-left: 5px;
    cursor: help;
}
.tooltip .tooltiptext {
    visibility: hidden;
    width: 220px; /* Adjusted width */
    background-color: #333;
    color: #fff;
    text-align: center;
    border-radius: 6px;
    padding: 8px; /* Adjusted padding */
    position: absolute;
    z-index: 1;
    bottom: 125%;
    left: 50%;
    margin-left: -110px;
    opacity: 0;
    transition: opacity 0.3s;
    font-weight: 400; /* Normal weight */
    font-size: 0.9rem; /* Adjusted font size */
}
.tooltip:hover .tooltiptext {
    visibility: visible;
    opacity: 1;
}

/* Modal styling */
.modal {
    position: fixed;
    z-index: 1000;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0,0,0,0.5);
    display: flex;
    justify-content: center;
    align-items: center;
    visibility: hidden;
    opacity: 0;
    transition: visibility 0s, opacity 0.3s;
}
.modal.show {
    visibility: visible;
    opacity: 1;
}
.modal-content {
    background-color: var(--card-bg);
    padding: 25px; /* Increased padding */
    border-radius: 12px; /* Increased radius */
    box-shadow: var(--card-shadow);
    max-width: 450px; /* Increased max-width */
    width: 90%; /* Added width */
    text-align: center;
    position: relative;
    color: var(--text-color); /* Ensure text color */
}
.close-button {
    position: absolute;
    top: 10px;
    right: 15px; /* Adjusted position */
    font-size: 1.8rem; /* Increased size */
    cursor: pointer;
    color: var(--text-color);
}
.close-button:hover {
    color: var(--fail-color); /* Added hover */
}
#ok-alert-button {
    /* Re-use .calculate-btn styles */
    background: var(--gradient-primary);
    color: white;
    border: none;
    padding: 12px 20px;
    border-radius: 8px;
    cursor: pointer;
    font-size: 1rem;
    font-weight: 700;
    margin-top: 15px;
    transition: transform 0.2s, box-shadow 0.3s;
}
#ok-alert-button:hover {
    transform: translateY(-2px);
    box-shadow: var(--button-hover-shadow);
}

/* Styles for detailed calculation steps */
.detailed-calculations {
    margin-top: 20px;
    padding: 20px; /* Increased padding */
    border: 1px solid var(--border-color);
    border-radius: 8px; /* Increased radius */
    background-color: var(--hover-color);
    color: var(--text-color);
}
.detailed-calculations h3 { /* Target the h3 inside this div */
    font-size: 1.5rem; /* Larger font */
    font-family: 'Montserrat', sans-serif; /* Match other headers */
    margin-bottom: 20px; /* More spacing */
    padding-bottom: 10px; /* Add padding */
    border-bottom: 2px solid var(--border-color); /* Add underline */
}
.detailed-calculations h4 {
    font-weight: bold;
    font-size: 1.2rem; /* Increased size */
    margin-bottom: 10px;
    color: var(--primary-color);
}
.detailed-calculations p {
    margin-bottom: 8px; /* Increased margin */
    font-size: 1rem; /* Increased size */
    line-height: 1.6; /* Improved line height */
}
.detailed-calculations strong {
    color: var(--secondary-color);
}
.formula-display {
    font-family: 'Times New Roman', Times, serif; /* Better font for math */
    font-size: 1.1em; /* Slightly larger */
    text-align: center; /* Center formulas */
    background-color: var(--bg-color); /* Match theme */
    padding: 10px; /* More padding */
    border-radius: 4px; /* Rounded corners */
    display: block;
    margin: 10px 0;
    overflow-x: auto;
    border: 1px solid var(--border-color); /* Add border */
}
.calculation-step {
    margin-bottom: 20px; /* More spacing */
    padding-bottom: 20px;
    border-bottom: 1px dashed var(--border-color);
}
.detailed-calculations .calculation-step:last-child {
    border-bottom: none;
}
</style>
</head>
<body class="antialiased">

<!-- === START: NEW HEADER === -->
<header class="header">
<div class="container">
<nav class="navbar">
<a href="/" class="logo-container">
<span class="logo-text">Design Calculators</span>
</a>
<ul class="nav-links">
<li><a href="/">Home</a></li>
<li><a href='/articles'>Articles</a></li>
<li><a href='/indexmech'>Mechanical</a></li>
<li><a href='/indexele'>Electrical</a></li>
<li><a href='/indexinst'>Instrumentation</a></li>
</ul>
<div class="theme-toggle">
<i class="fas fa-sun icon"></i>
<label class="switch">
<input type="checkbox" id="theme-switch">
<span class="slider"></span>
</label>
<i class="fas fa-moon icon"></i>
</div>
</nav>
</div>
</header>
<!-- === END: NEW HEADER === -->

<main class="content-container">
       
    <div class="tool-container mt-8 p-6">
        <h2 class="text-2xl font-semibold mb-4">Electrical Unit Converter Pro</h2>
        
        <div class="tool-description mb-6">
            <p>Convert between various electrical units used in design and engineering calculations. Select a category, enter your value and units, and get instant conversions. This professional tool now includes complex conversions for the <strong>Power Triangle (kW, kVA, kVAR)</strong>, essential for industrial applications. Detailed calculation steps are provided for enhanced understanding.</p>
        </div>
        
        <div class="converter-form">
            <form id="unit-converter-form">
                <h3 class="text-xl font-semibold mb-3">Input Parameters</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label for="conversion-category">Conversion Category <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Select the type of electrical quantity to convert (e.g., Power, Voltage).</span></span></label>
                        <select id="conversion-category" required>
                            <option value="">Select a category</option>
                            <option value="power">Power (kW, kVA, kVAR, W, hp...)</option>
                            <option value="voltage">Voltage (V, mV, kV)</option>
                            <option value="current">Current (A, mA, kA)</option>
                            <option value="resistance">Resistance (Ω, kΩ, MΩ, mΩ)</option>
                            <option value="capacitance">Capacitance (F, µF, nF, pF)</option>
                            <option value="inductance">Inductance (H, mH, µH, nH)</option>
                            <option value="energy">Energy (J, kWh, Wh, BTU)</option>
                            <option value="frequency">Frequency (Hz, kHz, MHz, GHz)</option>
                            <option value="conductance">Conductance (S, mS, µS, mho)</option>
                            <option value="charge">Charge (C, mC, µC, nC, pC)</option>
                            <option value="magnetic_flux">Magnetic Flux (Wb, Mx)</option>
                            <option value="magnetic_field_strength">Magnetic Field Strength (A/m, Oe)</option>
                            <option value="magnetic_flux_density">Magnetic Flux Density (T, G)</option>
                            <option value="temperature">Temperature (°C, °F, K)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="value-to-convert">Value <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Enter the numerical value you wish to convert.</span></span></label>
                        <input type="number" id="value-to-convert" min="0" step="any" required>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="from-unit">From Unit <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">The original unit of the value you entered.</span></span></label>
                        <select id="from-unit" required disabled>
                            <option value="">Select a unit</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="to-unit">To Unit <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">The desired unit for conversion.</span></span></label>
                        <select id="to-unit" required disabled>
                            <option value="">Select a unit</option>
                        </select>
                    </div>
                </div>

                <div class="form-group" id="power-factor-group" style="display: none;">
                    <label for="power-factor">Power Factor (PF) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Required for conversions between Real (kW), Apparent (kVA), and Reactive (kVAR) power (0.01 to 1.0).</span></span></label>
                    <input type="number" id="power-factor" min="0.01" max="1" step="0.01" value="0.8">
                </div>
                
                <button type="button" id="convert-btn" class="calculate-btn">Convert Unit</button>
                <button type="button" id="reset-btn" class="reset-btn">Reset</button>
            </form>
        </div>
        
        <div id="result-container" class="result-container">
            <h3 class="text-xl font-semibold mb-3">Conversion Result</h3>
            <table class="result-table">
                <thead>
                    <tr>
                        <th>Parameter</th>
                        <th>Value</th>
                    </tr>
                </thead>
                <tbody id="result-table-body">
                    <!-- Results will be inserted here -->
                </tbody>
            </table>
            <!-- Detailed calculations section -->
            <div id="detailed-calculations" class="detailed-calculations mt-6 math-content">
                <h3 class="text-xl font-semibold mb-3">Detailed Calculation Steps</h3>
                <!-- Detailed calculation steps will be dynamically inserted here -->
            </div>
            <div class="standard-reference" id="standard-reference">
                <p>Conversions are based on standard electrical formulas and SI unit definitions. For more information, refer to international standards such as: <br>
                - <strong>IEEE Std 260.1:</strong> Standard for Use of the International System of Units (SI) in Electrical and Electronic Practice. <br>
                - <strong>IEC 60050:</strong> International Electrotechnical Vocabulary (IEV) - Provides definitions for electrical and electronic terms and units.</p>
            </div>
        </div>
    </div>

    <!-- === START: NEW 800+ WORD EDUCATIONAL CONTENT === -->
    <div class="tool-container" style="margin-top: 40px;">
        <h2>The Language of Power: An Industrial Guide to Electrical Units</h2>

        <h3>More Than Just Numbers: The Unseen Force of Units</h3>
        <p>In the electrical and industrial world, units are not just academic labels; they are the fundamental language of design, safety, and operation. The difference between a milliamp (mA) and a kiloamp (kA) is the difference between a harmless LED circuit and a catastrophic arc flash. Understanding these units, and more importantly, how to convert between them with absolute precision, is the bedrock of professional engineering. A simple miscalculation—a misplaced decimal point or a forgotten conversion factor—can lead to oversized cables, undersized motors, cascading failures, and millions in damages. This tool is designed to be your shield against such errors, providing traceable, step-by-step conversions for critical applications.</p>

        <h3>The Heart of Industrial Power: Decoding the Power Triangle</h3>
        <p>The most crucial, and often misunderstood, set of conversions in AC systems is the "Power Triangle." This is why this tool's "Power" category is its most advanced feature. In a simple DC circuit (like a flashlight), power is simple: $Watts = Volts \times Amps$. In an industrial AC circuit (like a motor or a factory), it's far more complex.</p>
        
        <p>AC power is split into three components, which form a right-angled triangle:</p>
        
        <ul>
            <li><strong>Real Power (P) - Unit: Watts (W), Kilowatts (kW)</strong>
            <br>This is the "working" power. It's the energy that actually gets converted into useful work, like turning the shaft of a motor, lighting a lamp, or heating an element. This is the component you are billed for by the utility company (as kW-hours).</li>
            
            <li><strong>Apparent Power (S) - Unit: Volt-Amperes (VA), Kilovolt-Amperes (kVA)</strong>
            <br>This is the "total" power that the grid must supply to your facility. It's the vector sum of Real Power and Reactive Power. Transformers, cables, and switchgear must be rated to handle this total kVA load, even though not all of it does "work."</li>
            
            <li><strong>Reactive Power (Q) - Unit: Volt-Amperes Reactive (VAR), Kilovolt-Amperes Reactive (kVAR)</strong>
            <br>This is the "non-working" or "ghost" power. It's the energy required just to build up and sustain the magnetic fields in motors, transformers, and inductors (and the electric fields in capacitors). It sloshes back and forth in the system, doing no useful work but still loading the cables and transformers.</li>
        </ul>

        <h4>The Key: Power Factor (PF)</h4>
        <p>The link between these three is the <strong>Power Factor (PF)</strong>. It is the ratio of Real Power (kW) to Apparent Power (kVA) and represents your system's efficiency. A PF of 1.0 (or 100%) is perfect—all supplied power does useful work (kW = kVA). A PF of 0.8 (a common industrial value) means only 80% of the supplied kVA is doing work; the other 20% is lost as reactive power, heating up wires without contributing to the task. This is why this tool *requires* the PF for any conversion between kW, kVA, and kVAR, as it's mathematically impossible to do so without it. Utility companies often penalize large industrial customers for low power factors because it forces them to generate and transmit more "total" power (kVA) than is actually being used (kW).</p>

        <h3>Beyond the Triangle: Other Critical Industrial Units</h3>

        <h4>Magnetism: The Force Behind Motion</h4>
        <p>Motors and transformers are the workhorses of industry, and they operate entirely on magnetism. This tool handles the key conversions:</p>
        <ul>
            <li><strong>Magnetic Flux (Weber - Wb):</strong> Think of this as the *total amount* of magnetism in a circuit.</li>
            <li><strong>Magnetic Flux Density (Tesla - T, or Gauss - G):</strong> This is the *concentration* or *intensity* of the magnetic field in a specific area. 1 Tesla is a very strong field, while 10,000 Gauss equals 1 Tesla. This unit is critical for sizing the iron core of a transformer or designing the air gap in a motor.</li>
            <li><strong>Magnetic Field Strength (Amperes/meter - A/m, or Oersted - Oe):</strong> This measures the *effort* (driven by electric current) being put into creating the magnetic field.</li>
        </ul>

        <h4>Energy vs. Power: The Ultimate Cost Equation</h4>
        <p>This is a fundamental concept that trips up many. This converter handles both, allowing you to see the direct relationship.</p>
        <ul>
            <li><strong>Power (Kilowatt - kW):</strong> This is an *instantaneous* measurement. It's the *rate* at which energy is used. Think of it as your car's speedometer (km/h). A 100 kW motor demands 100 kW of power *right now*.</li>
            <li><strong>Energy (Kilowatt-hour - kWh):</strong> This is a *cumulative* measurement. It's the total *amount* of power used over a period of *time*. Think of it as your car's odometer (total km driven). That 100 kW motor, running for 5 hours, consumes $100 \; \text{kW} \times 5 \; \text{h} = 500 \; \text{kWh}$ of energy. This kWh value is what appears on your electricity bill.</li>
        </ul>
        <p>This calculator allows you to convert between kWh, Watt-hours (Wh), Joules (J), and even BTU, giving you the power to perform energy audits, calculate operating costs, and validate efficiency improvements.</p>

        <h4>The Micro and the Macro: From Electronics to the Grid</h4>
        <p>An engineer's work spans vast scales. A circuit board designer works in microfarads (µF) and milliamps (mA). A utility grid engineer works in megawatts (MW) and kiloamperes (kA). This tool effortlessly bridges that gap, handling units from pico- (pF, pC) to mega- (MW, MVA, MΩ) and giga- (GHz). This fluency is essential for interfacing low-power control electronics with high-power industrial machinery. By providing flawless, traceable conversions at all scales, this tool empowers you to design, build, and maintain systems with confidence, from the smallest chip to the largest grid.</p>

    </div>
    <!-- === END: NEW EDUCATIONAL CONTENT === -->

</main>

<!-- === START: NEW FOOTER === -->
<footer>
<div class="container">
<div class="footer-content">
<div class="footer-col">
<h4>Design Calculators</h4>
<p style="font-size: 0.9rem; line-height: 1.6; margin-bottom: 15px;">Inspired by standards such as IEC, IEEE, ISA, ASME, and API.</p>
<div class="social-buttons">
<a href="https://www.linkedin.com/shareArticle?mini=true&url=https://designcalculators.co.in" target="_blank" rel="noopener noreferrer" class="social-btn linkedin"><i class="fab fa-linkedin-in"></i></a>
<a href="https://www.youtube.com/@designcalculators" target="_blank" rel="noopener noreferrer" class="social-btn youtube"><i class="fab fa-youtube"></i></a>
<a href="https://twitter.com/intent/tweet?url=https://designcalculators.co.in" target="_blank" rel="noopener noreferrer" class="social-btn twitter"><i class="fab fa-twitter"></i></a>
<a href="https://www.facebook.com/sharer/sharer.php?u=https://designcalculators.co.in" target="_blank" rel="noopener noreferrer" class="social-btn facebook"><i class="fab fa-facebook-f"></i></a>
<a href="https://api.whatsapp.com/send?text=Check%20out%20this%20amazing%20engineering%20resource:%20https://designcalculators.co.in" target="_blank" rel="noopener noreferrer" class="social-btn whatsapp"><i class="fab fa-whatsapp"></i></a>
</div>
</div>
<div class="footer-col">
<h4>Quick Links</h4>
<ul>
<li><a href="/">Home</a></li>
<li><a href='/indexele'>Electrical</a></li>
<li><a href='/indexmech'>Mechanical</a></li>
<li><a href='/indexinst'>Instrumentation</a></li>
</ul>
</div>
<div class="footer-col">
<h4>Resources</h4>
<ul>
<li><a href='/about'>About Us</a></li>
<li><a href='/contact'>Contact</a></li>
<li><a href='/faq'>FAQ</a></li>
<li><a href='/privacy-policy'>Privacy Policy</a></li>
<li><a href='/terms-of-service'>Terms of Service</a></li>
</ul>
</div>
<div class="footer-col">
<h4>More</h4>
<ul>
<li><a href='/articles'>Articles & Blog</a></li>
<li><a href='/sitemap2'>Sitemap</a></li>
<li><a href="https://www.youtube.com/@designcalculators" target="_blank" rel="noopener noreferrer">YouTube Channel</a></li>
</ul>
</div>
</div>

<div class="footer-disclaimer">
<!-- Original Disclaimer Text -->
<p> All tools are for guidance only and should not replace professional engineering judgment. Results must be verified by a qualified professional against project requirements and local codes. </p>
</div>

<div class="footer-bottom">
<p>&copy; 2025 Design Calculators. Created by <span class="creator-name">A Sharma</span>. All rights reserved.</p>
</div>
</div>
</footer>
<!-- === END: NEW FOOTER === -->


    <!-- Custom Modal for Alerts -->
    <div id="custom-alert-modal" class="modal">
        <div class="modal-content">
            <span class="close-button" id="close-alert-modal">&times;</span>
            <p id="alert-message"></p>
            <button class="calculate-btn mt-4" id="ok-alert-button">OK</button>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // NOTE: Theme toggle logic is REMOVED from this script
            // It is now handled by the separate script from 'perfect.txt' at the bottom of the body.
            
            const conversionCategorySelect = document.getElementById('conversion-category');
            const valueToConvertInput = document.getElementById('value-to-convert');
            const fromUnitSelect = document.getElementById('from-unit');
            const toUnitSelect = document.getElementById('to-unit');
            const powerFactorGroup = document.getElementById('power-factor-group');
            const powerFactorInput = document.getElementById('power-factor');
            const convertBtn = document.getElementById('convert-btn');
            const resetBtn = document.getElementById('reset-btn');
            const resultContainer = document.getElementById('result-container');
            const resultTableBody = document.getElementById('result-table-body');
            const detailedCalculationsDiv = document.getElementById('detailed-calculations');

            // Custom Alert Modal elements
            const customAlertModal = document.getElementById('custom-alert-modal');
            const alertMessage = document.getElementById('alert-message');
            const closeAlertModalBtn = document.getElementById('close-alert-modal');
            const okAlertButton = document.getElementById('ok-alert-button');

            // Function to show custom alert
            function showCustomAlert(message) {
                alertMessage.textContent = message;
                customAlertModal.classList.add('show');
            }

            // Function to hide custom alert
            function hideCustomAlert() {
                customAlertModal.classList.remove('show');
            }
            closeAlertModalBtn.addEventListener('click', hideCustomAlert);
            okAlertButton.addEventListener('click', hideCustomAlert);
            customAlertModal.addEventListener('click', (e) => {
                if (e.target === customAlertModal) {
                    hideCustomAlert();
                }
            });

            // Define conversion units and their functions
            const units = {
                power: {
                    displayName: "Power (kW, kVA, kVAR, W, hp, BTU/hr, VA, MW, MVA, VAR, mVAR)",
                    options: [
                        { value: 'w', text: 'Watts (W) [Real]' },
                        { value: 'kw', text: 'Kilowatts (kW) [Real]' },
                        { value: 'mw', text: 'Megawatts (MW) [Real]' },
                        { value: 'va', text: 'Volt-Amperes (VA) [Apparent]' },
                        { value: 'kva', text: 'Kilovolt-Amperes (kVA) [Apparent]' },
                        { value: 'mva', text: 'Megavolt-Amperes (MVA) [Apparent]' },
                        { value: 'var', text: 'Volt-Amperes Reactive (VAR) [Reactive]' },
                        { value: 'kvar', text: 'Kilovolt-Amperes Reactive (kVAR) [Reactive]' },
                        { value: 'mvar', text: 'Megavolt-Amperes Reactive (MVAR) [Reactive]' },
                        { value: 'hp', text: 'Horsepower (hp) [Real]' },
                        { value: 'btu_hr', text: 'BTU/hr [Real]' }
                    ],
                    convert: function(value, from, to, pf = 1) {
                        let baseValueWatts; // Base unit is Watts (Real Power)
                        const steps = [];

                        // Step 1: Convert 'from' unit to base Watts (Real Power)
                        let initialUnitText = getUnitText(from, 'power');
                        
                        if (from === 'w') {
                            baseValueWatts = value;
                            steps.push({
                                title: `Step 1: Initial Value`,
                                formula: '',
                                calculation: `Initial value is ${value.toFixed(6)} W. Base unit is Watts.`
                            });
                        } else if (from === 'kw') {
                            baseValueWatts = value * 1000;
                            steps.push({
                                title: `Step 1: Convert ${initialUnitText} to Watts`,
                                formula: `$\\text{W} = \\text{kW} \\cdot 1000$`,
                                calculation: `${value.toFixed(6)} kW \\cdot 1000 = ${baseValueWatts.toFixed(6)} W`
                            });
                        } else if (from === 'mw') {
                            baseValueWatts = value * 1000000;
                            steps.push({
                                title: `Step 1: Convert ${initialUnitText} to Watts`,
                                formula: `$\\text{W} = \\text{MW} \\cdot 10^6$`,
                                calculation: `${value.toFixed(6)} MW \\cdot 1000000 = ${baseValueWatts.toFixed(6)} W`
                            });
                        } else if (from === 'va' || from === 'kva' || from === 'mva') {
                            let baseVAPower;
                            if (from === 'va') baseVAPower = value;
                            else if (from === 'kva') baseVAPower = value * 1000;
                            else if (from === 'mva') baseVAPower = value * 1000000;

                            baseValueWatts = baseVAPower * pf; // Convert Apparent Power to Real Power
                                                        
                            steps.push({
                                title: `Step 1: Convert ${initialUnitText} (Apparent) to Watts (Real)`,
                                formula: `$\\text{W} = \\text{VA} \\cdot \\text{PF}$`,
                                calculation: `${baseVAPower.toFixed(6)} VA \\cdot ${pf.toFixed(2)} = ${baseValueWatts.toFixed(6)} W`
                            });
                        } else if (from === 'var' || from === 'kvar' || from === 'mvar') {
                            let baseVARPower;
                            if (from === 'var') baseVARPower = value;
                            else if (from === 'kvar') baseVARPower = value * 1000;
                            else if (from === 'mvar') baseVARPower = value * 1000000;

                            // W = VAR / tan(acos(PF))
                            const tanAcosPf = Math.tan(Math.acos(pf));
                            baseValueWatts = baseVARPower / tanAcosPf;
                            steps.push({
                                title: `Step 1: Convert ${initialUnitText} (Reactive) to Watts (Real)`,
                                formula: `$\\text{W} = \\frac{\\text{VAR}}{\\tan(\\acos(\\text{PF}))}$`,
                                calculation: `${baseVARPower.toFixed(6)} VAR / ${tanAcosPf.toFixed(4)} = ${baseValueWatts.toFixed(6)} W`
                            });
                        } else if (from === 'hp') {
                            baseValueWatts = value * 745.7;
                            steps.push({
                                title: `Step 1: Convert ${initialUnitText} to Watts`,
                                formula: `$\\text{W} = \\text{hp} \\cdot 745.7$`,
                                calculation: `${value.toFixed(6)} hp \\cdot 745.7 = ${baseValueWatts.toFixed(6)} W`
                            });
                        } else if (from === 'btu_hr') {
                            baseValueWatts = value * 0.293071;
                            steps.push({
                                title: `Step 1: Convert ${initialUnitText} to Watts`,
                                formula: `$\\text{W} = \\text{BTU/hr} \\cdot 0.293071$`,
                                calculation: `${value.toFixed(6)} BTU/hr \\cdot 0.293071 = ${baseValueWatts.toFixed(6)} W`
                            });
                        } else { return { convertedValue: null, steps: [] }; }

                        // Step 2: Convert from base Watts (Real Power) to 'to' unit
                        let finalValue;
                        let targetUnitText = getUnitText(to, 'power');
                                                
                        if (to === 'w') {
                            finalValue = baseValueWatts;
                            steps.push({
                                title: `Step 2: Final Result in Watts`,
                                formula: '',
                                calculation: `Converted value is ${finalValue.toFixed(6)} W.`
                            });
                        } else if (to === 'kw') {
                            finalValue = baseValueWatts / 1000;
                            steps.push({
                                title: `Step 2: Convert Watts to ${targetUnitText}`,
                                formula: `$\\text{kW} = \\frac{\\text{W}}{1000}$`,
                                calculation: `${baseValueWatts.toFixed(6)} W / 1000 = ${finalValue.toFixed(6)} kW`
                            });
                        } else if (to === 'mw') {
                            finalValue = baseValueWatts / 1000000;
                            steps.push({
                                title: `Step 2: Convert Watts to ${targetUnitText}`,
                                formula: `$\\text{MW} = \\frac{\\text{W}}{10^6}$`,
                                calculation: `${baseValueWatts.toFixed(6)} W / 1000000 = ${finalValue.toFixed(6)} MW`
                            });
                        } else if (to === 'va' || to === 'kva' || to === 'mva') {
                            let baseVAPower = baseValueWatts / pf; // Convert Real Power to Apparent Power
                            if (to === 'va') finalValue = baseVAPower;
                            else if (to === 'kva') finalValue = baseVAPower / 1000;
                            else if (to === 'mva') finalValue = baseVAPower / 1000000;
                                                        
                            steps.push({
                                title: `Step 2: Convert Watts (Real) to ${targetUnitText} (Apparent)`,
                                formula: `$\\text{VA} = \\frac{\\text{W}}{\\text{PF}}$`,
                                calculation: `${baseValueWatts.toFixed(6)} W / ${pf.toFixed(2)} = ${baseVAPower.toFixed(6)} VA \\rightarrow ${finalValue.toFixed(6)} ${targetUnitText}`
                            });
                        } else if (to === 'var' || to === 'kvar' || to === 'mvar') {
                            // VAR = W * tan(acos(PF))
                            const tanAcosPf = Math.tan(Math.acos(pf));
                            let baseVARPower = baseValueWatts * tanAcosPf;
                            if (to === 'var') finalValue = baseVARPower;
                            else if (to === 'kvar') finalValue = baseVARPower / 1000;
                            else if (to === 'mvar') finalValue = baseVARPower / 1000000;
                            
                            steps.push({
                                title: `Step 2: Convert Watts (Real) to ${targetUnitText} (Reactive)`,
                                formula: `$\\text{VAR} = \\text{W} \\cdot \\tan(\\acos(\\text{PF})) $`,
                                calculation: `${baseValueWatts.toFixed(6)} W \\cdot ${tanAcosPf.toFixed(4)} = ${baseVARPower.toFixed(6)} VAR \\rightarrow ${finalValue.toFixed(6)} ${targetUnitText}`
                            });
                        } else if (to === 'hp') {
                            finalValue = baseValueWatts / 745.7;
                            steps.push({
                                title: `Step 2: Convert Watts to ${targetUnitText}`,
                                formula: `$\\text{hp} = \\frac{\\text{W}}{745.7}$`,
                                calculation: `${baseValueWatts.toFixed(6)} W / 745.7 = ${finalValue.toFixed(6)} hp`
                            });
                        } else if (to === 'btu_hr') {
                            finalValue = baseValueWatts / 0.293071;
                            steps.push({
                                title: `Step 2: Convert Watts to ${targetUnitText}`,
                                formula: `$\\text{BTU/hr} = \\frac{\\text{W}}{0.293071}$`,
                                calculation: `${baseValueWatts.toFixed(6)} W / 0.293071 = ${finalValue.toFixed(6)} BTU/hr`
                            });
                        } else { return { convertedValue: null, steps: [] }; }

                        return { convertedValue: finalValue, steps: steps };
                    }
                },
                voltage: {
                    displayName: "Voltage (V, mV, kV)",
                    options: [
                        { value: 'v', text: 'Volts (V)' },
                        { value: 'mv', text: 'Millivolts (mV)' },
                        { value: 'kv', text: 'Kilovolts (kV)' }
                    ],
                    convert: function(value, from, to) {
                        let baseValueVolts;
                        const steps = [];
                        let initialUnitText = getUnitText(from, 'voltage');
                        let targetUnitText = getUnitText(to, 'voltage');

                        if (from === 'v') {
                            baseValueVolts = value;
                            steps.push({
                                title: `Step 1: Initial Value`,
                                formula: '',
                                calculation: `Initial value is ${value.toFixed(6)} V. No conversion needed to base unit (Volts).`
                            });
                        } else if (from === 'mv') {
                            baseValueVolts = value / 1000;
                            steps.push({
                                title: `Step 1: Convert ${initialUnitText} to Volts`,
                                formula: `$\\text{V} = \\frac{\\text{mV}}{1000}$`,
                                calculation: `${value.toFixed(6)} mV / 1000 = ${baseValueVolts.toFixed(6)} V`
                            });
                        } else if (from === 'kv') {
                            baseValueVolts = value * 1000;
                            steps.push({
                                title: `Step 1: Convert ${initialUnitText} to Volts`,
                                formula: `$\\text{V} = \\text{kV} \\cdot 1000$`,
                                calculation: `${value.toFixed(6)} kV \\cdot 1000 = ${baseValueVolts.toFixed(6)} V`
                            });
                        } else { return { convertedValue: null, steps: [] }; }

                        let finalValue;
                        if (to === 'v') {
                            finalValue = baseValueVolts;
                            steps.push({
                                title: `Step 2: Final Result in Volts`,
                                formula: '',
                                calculation: `Converted value is ${finalValue.toFixed(6)} V.`
                            });
                        } else if (to === 'mv') {
                            finalValue = baseValueVolts * 1000;
                            steps.push({
                                title: `Step 2: Convert Volts to ${targetUnitText}`,
                                formula: `$\\text{mV} = \\text{V} \\cdot 1000$`,
                                calculation: `${baseValueVolts.toFixed(6)} V \\cdot 1000 = ${finalValue.toFixed(6)} mV`
                            });
                        } else if (to === 'kv') {
                            finalValue = baseValueVolts / 1000;
                            steps.push({
                                title: `Step 2: Convert Volts to ${targetUnitText}`,
                                formula: `$\\text{kV} = \\frac{\\text{V}}{1000}$`,
                                calculation: `${baseValueVolts.toFixed(6)} V / 1000 = ${finalValue.toFixed(6)} kV`
                            });
                        } else { return { convertedValue: null, steps: [] }; }
                        return { convertedValue: finalValue, steps: steps };
                    }
                },
                current: {
                    displayName: "Current (A, mA, kA)",
                    options: [
                        { value: 'a', text: 'Amperes (A)' },
                        { value: 'ma', text: 'Milliamperes (mA)' },
                        { value: 'ka', text: 'Kiloamperes (kA)' }
                    ],
                    convert: function(value, from, to) {
                        let baseValueAmps;
                        const steps = [];
                        let initialUnitText = getUnitText(from, 'current');
                        let targetUnitText = getUnitText(to, 'current');

                        if (from === 'a') {
                            baseValueAmps = value;
                            steps.push({
                                title: `Step 1: Initial Value`,
                                formula: '',
                                calculation: `Initial value is ${value.toFixed(6)} A. No conversion needed to base unit (Amperes).`
                            });
                        } else if (from === 'ma') {
                            baseValueAmps = value / 1000;
                            steps.push({
                                title: `Step 1: Convert ${initialUnitText} to Amperes`,
                                formula: `$\\text{A} = \\frac{\\text{mA}}{1000}$`,
                                calculation: `${value.toFixed(6)} mA / 1000 = ${baseValueAmps.toFixed(6)} A`
                            });
                        } else if (from === 'ka') {
                            baseValueAmps = value * 1000;
                            steps.push({
                                title: `Step 1: Convert ${initialUnitText} to Amperes`,
                                formula: `$\\text{A} = \\text{kA} \\cdot 1000$`,
                                calculation: `${value.toFixed(6)} kA \\cdot 1000 = ${baseValueAmps.toFixed(6)} A`
                            });
                        } else { return { convertedValue: null, steps: [] }; }

                        let finalValue;
                        if (to === 'a') {
                            finalValue = baseValueAmps;
                             steps.push({
                                title: `Step 2: Final Result in Amperes`,
                                formula: '',
                                calculation: `Converted value is ${finalValue.toFixed(6)} A.`
                            });
                        } else if (to === 'ma') {
                            finalValue = baseValueAmps * 1000;
                            steps.push({
                                title: `Step 2: Convert Amperes to ${targetUnitText}`,
                                formula: `$\\text{mA} = \\text{A} \\cdot 1000$`,
                                calculation: `${baseValueAmps.toFixed(6)} A \\cdot 1000 = ${finalValue.toFixed(6)} mA`
                            });
                        } else if (to === 'ka') {
                            finalValue = baseValueAmps / 1000;
                            steps.push({
                                title: `Step 2: Convert Amperes to ${targetUnitText}`,
                                formula: `$\\text{kA} = \\frac{\\text{A}}{1000}$`,
                                calculation: `${baseValueAmps.toFixed(6)} A / 1000 = ${finalValue.toFixed(6)} kA`
                            });
                        } else { return { convertedValue: null, steps: [] }; }
                        return { convertedValue: finalValue, steps: steps };
                    }
                },
                resistance: {
                    displayName: "Resistance (Ω, kΩ, MΩ, mΩ)",
                    options: [
                        { value: 'ohm', text: 'Ohms (Ω)' },
                        { value: 'milliohm', text: 'Milliohms (mΩ)' },
                        { value: 'kohm', text: 'Kilo-ohms (kΩ)' },
                        { value: 'mohm', text: 'Mega-ohms (MΩ)' }
                    ],
                    convert: function(value, from, to) {
                        let baseValueOhms;
                        const steps = [];
                        let initialUnitText = getUnitText(from, 'resistance');
                        let targetUnitText = getUnitText(to, 'resistance');

                        if (from === 'ohm') {
                            baseValueOhms = value;
                             steps.push({
                                title: `Step 1: Initial Value`,
                                formula: '',
                                calculation: `Initial value is ${value.toFixed(6)} Ω. No conversion needed to base unit (Ohms).`
                            });
                        } else if (from === 'milliohm') {
                            baseValueOhms = value / 1000;
                            steps.push({
                                title: `Step 1: Convert ${initialUnitText} to Ohms`,
                                formula: `$\\Omega = \\frac{\\text{m}\\Omega}{1000}$`,
                                calculation: `${value.toFixed(6)} mΩ / 1000 = ${baseValueOhms.toFixed(6)} Ω`
                            });
                        } else if (from === 'kohm') {
                            baseValueOhms = value * 1000;
                            steps.push({
                                title: `Step 1: Convert ${initialUnitText} to Ohms`,
                                formula: `$\\Omega = \\text{k}\\Omega \\cdot 1000$`,
                                calculation: `${value.toFixed(6)} kΩ \\cdot 1000 = ${baseValueOhms.toFixed(6)} Ω`
                            });
                        } else if (from === 'mohm') {
                            baseValueOhms = value * 1000000;
                            steps.push({
                                title: `Step 1: Convert ${initialUnitText} to Ohms`,
                                formula: `$\\Omega = \\text{M}\\Omega \\cdot 10^6$`,
                                calculation: `${value.toFixed(6)} MΩ \\cdot 1000000 = ${baseValueOhms.toFixed(6)} Ω`
                            });
                        } else { return { convertedValue: null, steps: [] }; }

                        let finalValue;
                        if (to === 'ohm') {
                            finalValue = baseValueOhms;
                            steps.push({
                                title: `Step 2: Final Result in Ohms`,
                                formula: '',
                                calculation: `Converted value is ${finalValue.toFixed(6)} Ω.`
                            });
                        } else if (to === 'milliohm') {
                            finalValue = baseValueOhms * 1000;
                            steps.push({
                                title: `Step 2: Convert Ohms to ${targetUnitText}`,
                                formula: `$\\text{m}\\Omega = \\Omega \\cdot 1000$`,
                                calculation: `${baseValueOhms.toFixed(6)} Ω \\cdot 1000 = ${finalValue.toFixed(6)} mΩ`
                            });
                        } else if (to === 'kohm') {
                            finalValue = baseValueOhms / 1000;
                            steps.push({
                                title: `Step 2: Convert Ohms to ${targetUnitText}`,
                                formula: `$\\text{k}\\Omega = \\frac{\\Omega}{1000}$`,
                                calculation: `${baseValueOhms.toFixed(6)} Ω / 1000 = ${finalValue.toFixed(6)} kΩ`
                            });
                        } else if (to === 'mohm') {
                            finalValue = baseValueOhms / 1000000;
                            steps.push({
                                title: `Step 2: Convert Ohms to ${targetUnitText}`,
                                formula: `$\\text{M}\\Omega = \\frac{\\Omega}{10^6}$`,
                                calculation: `${baseValueOhms.toFixed(6)} Ω / 1000000 = ${finalValue.toFixed(6)} MΩ`
                            });
                        } else { return { convertedValue: null, steps: [] }; }
                        return { convertedValue: finalValue, steps: steps };
                    }
                },
                capacitance: {
                    displayName: "Capacitance (F, µF, nF, pF)",
                    options: [
                        { value: 'f', text: 'Farad (F)' },
                        { value: 'uf', text: 'Microfarad (µF)' },
                        { value: 'nf', text: 'Nanofarad (nF)' },
                        { value: 'pf', text: 'Picofarad (pF)' }
                    ],
                    convert: function(value, from, to) {
                        let baseValueFarads;
                        const steps = [];
                        let initialUnitText = getUnitText(from, 'capacitance');
                        let targetUnitText = getUnitText(to, 'capacitance');

                        if (from === 'f') {
                            baseValueFarads = value;
                             steps.push({
                                title: `Step 1: Initial Value`,
                                formula: '',
                                calculation: `Initial value is ${value.toExponential(6)} F. No conversion needed to base unit (Farads).`
                            });
                        } else if (from === 'uf') {
                            baseValueFarads = value * 1e-6;
                            steps.push({
                                title: `Step 1: Convert ${initialUnitText} to Farads`,
                                formula: `$\\text{F} = \\mu\\text{F} \\cdot 10^{-6}$`,
                                calculation: `${value.toFixed(6)} µF \\cdot 0.000001 = ${baseValueFarads.toExponential(6)} F`
                            });
                        } else if (from === 'nf') {
                            baseValueFarads = value * 1e-9;
                            steps.push({
                                title: `Step 1: Convert ${initialUnitText} to Farads`,
                                formula: `$\\text{F} = \\text{nF} \\cdot 10^{-9}$`,
                                calculation: `${value.toFixed(6)} nF \\cdot 1e-9 = ${baseValueFarads.toExponential(6)} F`
                            });
                        } else if (from === 'pf') {
                            baseValueFarads = value * 1e-12;
                            steps.push({
                                title: `Step 1: Convert ${initialUnitText} to Farads`,
                                formula: `$\\text{F} = \\text{pF} \\cdot 10^{-12}$`,
                                calculation: `${value.toFixed(6)} pF \\cdot 1e-12 = ${baseValueFarads.toExponential(6)} F`
                            });
                        } else { return { convertedValue: null, steps: [] }; }

                        let finalValue;
                        if (to === 'f') {
                            finalValue = baseValueFarads;
                            steps.push({
                                title: `Step 2: Final Result in Farads`,
                                formula: '',
                                calculation: `Converted value is ${finalValue.toExponential(6)} F.`
                            });
                        } else if (to === 'uf') {
                            finalValue = baseValueFarads / 1e-6;
                            steps.push({
                                title: `Step 2: Convert Farads to ${targetUnitText}`,
                                formula: `$\\mu\\text{F} = \\frac{\\text{F}}{10^{-6}}$`,
                                calculation: `${baseValueFarads.toExponential(6)} F / 0.000001 = ${finalValue.toFixed(6)} µF`
                            });
                        } else if (to === 'nf') {
                            finalValue = baseValueFarads / 1e-9;
                            steps.push({
                                title: `Step 2: Convert Farads to ${targetUnitText}`,
                                formula: `$\\text{nF} = \\frac{\\text{F}}{10^{-9}}$`,
                                calculation: `${baseValueFarads.toExponential(6)} F / 1e-9 = ${finalValue.toFixed(6)} nF`
                            });
                        } else if (to === 'pf') {
                            finalValue = baseValueFarads / 1e-12;
                            steps.push({
                                title: `Step 2: Convert Farads to ${targetUnitText}`,
                                formula: `$\\text{pF} = \\frac{\\text{F}}{10^{-12}}$`,
                                calculation: `${baseValueFarads.toExponential(6)} F / 1e-12 = ${finalValue.toFixed(6)} pF`
                            });
                        } else { return { convertedValue: null, steps: [] }; }
                        return { convertedValue: finalValue, steps: steps };
                    }
                },
                inductance: {
                    displayName: "Inductance (H, mH, µH, nH)",
                    options: [
                        { value: 'h', text: 'Henry (H)' },
                        { value: 'mh', text: 'Millihenry (mH)' },
                        { value: 'uh', text: 'Microhenry (µH)' },
                        { value: 'nh', text: 'Nanohenry (nH)' }
                    ],
                    convert: function(value, from, to) {
                        let baseValueHenrys;
                        const steps = [];
                        let initialUnitText = getUnitText(from, 'inductance');
                        let targetUnitText = getUnitText(to, 'inductance');

                        if (from === 'h') {
                            baseValueHenrys = value;
                            steps.push({
                                title: `Step 1: Initial Value`,
                                formula: '',
                                calculation: `Initial value is ${value.toExponential(6)} H. No conversion needed to base unit (Henrys).`
                            });
                        } else if (from === 'mh') {
                            baseValueHenrys = value * 1e-3;
                            steps.push({
                                title: `Step 1: Convert ${initialUnitText} to Henrys`,
                                formula: `$\\text{H} = \\text{mH} \\cdot 10^{-3}$`,
                                calculation: `${value.toFixed(6)} mH \\cdot 0.001 = ${baseValueHenrys.toExponential(6)} H`
                            });
                        } else if (from === 'uh') {
                            baseValueHenrys = value * 1e-6;
                            steps.push({
                                title: `Step 1: Convert ${initialUnitText} to Henrys`,
                                formula: `$\\text{H} = \\mu\\text{H} \\cdot 10^{-6}$`,
                                calculation: `${value.toFixed(6)} µH \\cdot 0.000001 = ${baseValueHenrys.toExponential(6)} H`
                            });
                        } else if (from === 'nh') {
                            baseValueHenrys = value * 1e-9;
                            steps.push({
                                title: `Step 1: Convert ${initialUnitText} to Henrys`,
                                formula: `$\\text{H} = \\text{nH} \\cdot 10^{-9}$`,
                                calculation: `${value.toFixed(6)} nH \\cdot 1e-9 = ${baseValueHenrys.toExponential(6)} H`
                            });
                        } else { return { convertedValue: null, steps: [] }; }

                        let finalValue;
                        if (to === 'h') {
                            finalValue = baseValueHenrys;
                             steps.push({
                                title: `Step 2: Final Result in Henrys`,
                                formula: '',
                                calculation: `Converted value is ${finalValue.toExponential(6)} H.`
                            });
                        } else if (to === 'mh') {
                            finalValue = baseValueHenrys / 1e-3;
                            steps.push({
                                title: `Step 2: Convert Henrys to ${targetUnitText}`,
                                formula: `$\\text{mH} = \\frac{\\text{H}}{10^{-3}}$`,
                                calculation: `${baseValueHenrys.toExponential(6)} H / 0.001 = ${finalValue.toFixed(6)} mH`
                            });
                        } else if (to === 'uh') {
                            finalValue = baseValueHenrys / 1e-6;
                            steps.push({
                                title: `Step 2: Convert Henrys to ${targetUnitText}`,
                                formula: `$\\mu\\text{H} = \\frac{\\text{H}}{10^{-6}}$`,
                                calculation: `${baseValueHenrys.toExponential(6)} H / 0.000001 = ${finalValue.toFixed(6)} µH`
                            });
                        } else if (to === 'nh') {
                            finalValue = baseValueHenrys / 1e-9;
                            steps.push({
                                title: `Step 2: Convert Henrys to ${targetUnitText}`,
                                formula: `$\\text{nH} = \\frac{\\text{H}}{10^{-9}}$`,
                                calculation: `${baseValueHenrys.toExponential(6)} H / 1e-9 = ${finalValue.toFixed(6)} nH`
                            });
                        } else { return { convertedValue: null, steps: [] }; }
                        return { convertedValue: finalValue, steps: steps };
                    }
                },
                energy: {
                    displayName: "Energy (J, kWh, Wh, BTU)",
                    options: [
                        { value: 'j', text: 'Joule (J)' },
                        { value: 'wh', text: 'Watt-hour (Wh)' },
                        { value: 'kwh', text: 'Kilowatt-hour (kWh)' },
                        { value: 'btu', text: 'British Thermal Unit (BTU)'}
                    ],
                    convert: function(value, from, to) {
                        let baseValueJoules;
                        const steps = [];
                        let initialUnitText = getUnitText(from, 'energy');
                        let targetUnitText = getUnitText(to, 'energy');

                        if (from === 'j') {
                            baseValueJoules = value;
                            steps.push({
                                title: `Step 1: Initial Value`,
                                formula: '',
                                calculation: `Initial value is ${value.toFixed(6)} J. No conversion needed to base unit (Joules).`
                            });
                        } else if (from === 'wh') {
                            baseValueJoules = value * 3600;
                            steps.push({
                                title: `Step 1: Convert ${initialUnitText} to Joules`,
                                formula: `$\\text{J} = \\text{Wh} \\cdot 3600$`,
                                calculation: `${value.toFixed(6)} Wh \\cdot 3600 = ${baseValueJoules.toFixed(6)} J`
                            });
                        } else if (from === 'kwh') {
                            baseValueJoules = value * 3.6e6;
                            steps.push({
                                title: `Step 1: Convert ${initialUnitText} to Joules`,
                                formula: `$\\text{J} = \\text{kWh} \\cdot 3.6 \\cdot 10^6$`,
                                calculation: `${value.toFixed(6)} kWh \\cdot 3600000 = ${baseValueJoules.toFixed(6)} J`
                            });
                        } else if (from === 'btu') {
                            baseValueJoules = value * 1055.06;
                            steps.push({
                                title: `Step 1: Convert ${initialUnitText} to Joules`,
                                formula: `$\\text{J} = \\text{BTU} \\cdot 1055.06$`,
                                calculation: `${value.toFixed(6)} BTU \\cdot 1055.06 = ${baseValueJoules.toFixed(6)} J`
                            });
                        } else { return { convertedValue: null, steps: [] }; }

                        let finalValue;
                        if (to === 'j') {
                            finalValue = baseValueJoules;
                             steps.push({
                                title: `Step 2: Final Result in Joules`,
                                formula: '',
                                calculation: `Converted value is ${finalValue.toFixed(6)} J.`
                            });
                        } else if (to === 'wh') {
                            finalValue = baseValueJoules / 3600;
                            steps.push({
                                title: `Step 2: Convert Joules to ${targetUnitText}`,
                                formula: `$\\text{Wh} = \\frac{\\text{J}}{3600}$`,
                                calculation: `${baseValueJoules.toFixed(6)} J / 3600 = ${finalValue.toFixed(6)} Wh`
                            });
                        } else if (to === 'kwh') {
                            finalValue = baseValueJoules / 3.6e6;
                            steps.push({
                                title: `Step 2: Convert Joules to ${targetUnitText}`,
                                formula: `$\\text{kWh} = \\frac{\\text{J}}{3.6 \\cdot 10^6}$`,
                                calculation: `${baseValueJoules.toFixed(6)} J / 3600000 = ${finalValue.toFixed(6)} kWh`
                            });
                        } else if (to === 'btu') {
                            finalValue = baseValueJoules / 1055.06;
                            steps.push({
                                title: `Step 2: Convert Joules to ${targetUnitText}`,
                                formula: `$\\text{BTU} = \\frac{\\text{J}}{1055.06}$`,
                                calculation: `${baseValueJoules.toFixed(6)} J / 1055.06 = ${finalValue.toFixed(6)} BTU`
                            });
                        } else { return { convertedValue: null, steps: [] }; }
                        return { convertedValue: finalValue, steps: steps };
                    }
                },
                frequency: {
                    displayName: "Frequency (Hz, kHz, MHz, GHz)",
                    options: [
                        { value: 'hz', text: 'Hertz (Hz)' },
                        { value: 'khz', text: 'Kilohertz (kHz)' },
                        { value: 'mhz', text: 'Megahertz (MHz)' },
                        { value: 'ghz', text: 'Gigahertz (GHz)' }
                    ],
                    convert: function(value, from, to) {
                        let baseValueHz;
                        const steps = [];
                        let initialUnitText = getUnitText(from, 'frequency');
                        let targetUnitText = getUnitText(to, 'frequency');

                        if (from === 'hz') {
                            baseValueHz = value;
                             steps.push({
                                title: `Step 1: Initial Value`,
                                formula: '',
                                calculation: `Initial value is ${value.toFixed(6)} Hz. No conversion needed to base unit (Hertz).`
                            });
                        } else if (from === 'khz') {
                            baseValueHz = value * 1e3;
                            steps.push({
                                title: `Step 1: Convert ${initialUnitText} to Hertz`,
                                formula: `$\\text{Hz} = \\text{kHz} \\cdot 10^3$`,
                                calculation: `${value.toFixed(6)} kHz \\cdot 1000 = ${baseValueHz.toFixed(6)} Hz`
                            });
                        } else if (from === 'mhz') {
                            baseValueHz = value * 1e6;
                            steps.push({
                                title: `Step 1: Convert ${initialUnitText} to Hertz`,
                                formula: `$\\text{Hz} = \\text{MHz} \\cdot 10^6$`,
                                calculation: `${value.toFixed(6)} MHz \\cdot 1000000 = ${baseValueHz.toFixed(6)} Hz`
                            });
                        } else if (from === 'ghz') {
                            baseValueHz = value * 1e9;
                            steps.push({
                                title: `Step 1: Convert ${initialUnitText} to Hertz`,
                                formula: `$\\text{Hz} = \\text{GHz} \\cdot 10^9$`,
                                calculation: `${value.toFixed(6)} GHz \\cdot 1000000000 = ${baseValueHz.toFixed(6)} Hz`
                            });
                        } else { return { convertedValue: null, steps: [] }; }

                        let finalValue;
                        if (to === 'hz') {
                            finalValue = baseValueHz;
                            steps.push({
                                title: `Step 2: Final Result in Hertz`,
                                formula: '',
                                calculation: `Converted value is ${finalValue.toFixed(6)} Hz.`
                            });
                        } else if (to === 'khz') {
                            finalValue = baseValueHz / 1e3;
                            steps.push({
                                title: `Step 2: Convert Hertz to ${targetUnitText}`,
                                formula: `$\\text{kHz} = \\frac{\\text{Hz}}{10^3}$`,
                                calculation: `${baseValueHz.toFixed(6)} Hz / 1000 = ${finalValue.toFixed(6)} kHz`
                            });
                        } else if (to === 'mhz') {
                            finalValue = baseValueHz / 1e6;
                            steps.push({
                                title: `Step 2: Convert Hertz to ${targetUnitText}`,
                                formula: `$\\text{MHz} = \\frac{\\text{Hz}}{10^6}$`,
                                calculation: `${baseValueHz.toFixed(6)} Hz / 1000000 = ${finalValue.toFixed(6)} MHz`
                            });
                        } else if (to === 'ghz') {
                            finalValue = baseValueHz / 1e9;
                            steps.push({
                                title: `Step 2: Convert Hertz to ${targetUnitText}`,
                                formula: `$\\text{GHz} = \\frac{\\text{Hz}}{10^9}$`,
                                calculation: `${baseValueHz.toFixed(6)} Hz / 1000000000 = ${finalValue.toFixed(6)} GHz`
                            });
                        } else { return { convertedValue: null, steps: [] }; }
                        return { convertedValue: finalValue, steps: steps };
                    }
                },
                conductance: {
                    displayName: "Conductance (S, mS, µS, mho)",
                    options: [
                        { value: 's', text: 'Siemens (S)' },
                        { value: 'ms', text: 'MilliSiemens (mS)' },
                        { value: 'us', text: 'MicroSiemens (µS)' },
                        { value: 'mho', text: 'Mho (℧)' }
                    ],
                    convert: function(value, from, to) {
                        let baseValueSiemens;
                        const steps = [];
                        let initialUnitText = getUnitText(from, 'conductance');
                        let targetUnitText = getUnitText(to, 'conductance');

                        if (from === 's') {
                            baseValueSiemens = value;
                             steps.push({
                                title: `Step 1: Initial Value`,
                                formula: '',
                                calculation: `Initial value is ${value.toFixed(6)} S. No conversion needed to base unit (Siemens).`
                            });
                        } else if (from === 'ms') {
                            baseValueSiemens = value * 1e-3;
                            steps.push({
                                title: `Step 1: Convert ${initialUnitText} to Siemens`,
                                formula: `$\\text{S} = \\text{mS} \\cdot 10^{-3}$`,
                                calculation: `${value.toFixed(6)} mS \\cdot 0.001 = ${baseValueSiemens.toFixed(6)} S`
                            });
                        } else if (from === 'us') {
                            baseValueSiemens = value * 1e-6;
                            steps.push({
                                title: `Step 1: Convert ${initialUnitText} to Siemens`,
                                formula: `$\\text{S} = \\mu\\text{S} \\cdot 10^{-6}$`,
                                calculation: `${value.toFixed(6)} µS \\cdot 0.000001 = ${baseValueSiemens.toFixed(6)} S`
                            });
                        } else if (from === 'mho') {
                            baseValueSiemens = value; // 1 mho = 1 Siemens
                            steps.push({
                                title: `Step 1: Initial Value`,
                                formula: `$\\text{S} = \\text{mho}$`,
                                calculation: `Initial value is ${value.toFixed(6)} mho. 1 mho is equivalent to 1 Siemens, so base value is ${baseValueSiemens.toFixed(6)} S.`
                            });
                        } else { return { convertedValue: null, steps: [] }; }

                        let finalValue;
                        if (to === 's') {
                            finalValue = baseValueSiemens;
                             steps.push({
                                title: `Step 2: Final Result in Siemens`,
                                formula: '',
                                calculation: `Converted value is ${finalValue.toFixed(6)} S.`
                            });
                        } else if (to === 'ms') {
                            finalValue = baseValueSiemens / 1e-3;
                            steps.push({
                                title: `Step 2: Convert Siemens to ${targetUnitText}`,
                                formula: `$\\text{mS} = \\frac{\\text{S}}{10^{-3}}$`,
                                calculation: `${baseValueSiemens.toFixed(6)} S / 0.001 = ${finalValue.toFixed(6)} mS`
                            });
                        } else if (to === 'us') {
                            finalValue = baseValueSiemens / 1e-6;
                            steps.push({
                                title: `Step 2: Convert Siemens to ${targetUnitText}`,
                                formula: `$\\mu\\text{S} = \\frac{\\text{S}}{10^{-6}}$`,
                                calculation: `${baseValueSiemens.toFixed(6)} S / 0.000001 = ${finalValue.toFixed(6)} µS`
                            });
                        } else if (to === 'mho') {
                            finalValue = baseValueSiemens;
                            steps.push({
                                title: `Step 2: Convert Siemens to ${targetUnitText}`,
                                formula: `$\\text{mho} = \\text{S}$`,
                                calculation: `${baseValueSiemens.toFixed(6)} S = ${finalValue.toFixed(6)} mho`
                            });
                        } else { return { convertedValue: null, steps: [] }; }
                        return { convertedValue: finalValue, steps: steps };
                    }
                },
                charge: {
                    displayName: "Charge (C, mC, µC, nC, pC)",
                    options: [
                        { value: 'c', text: 'Coulomb (C)' },
                        { value: 'mc', text: 'MilliCoulomb (mC)' },
                        { value: 'uc', text: 'MicroCoulomb (µC)' },
                        { value: 'nc', text: 'NanoCoulomb (nC)' },
                        { value: 'pc', text: 'PicoCoulomb (pC)' }
                    ],
                    convert: function(value, from, to) {
                        let baseValueCoulombs;
                        const steps = [];
                        let initialUnitText = getUnitText(from, 'charge');
                        let targetUnitText = getUnitText(to, 'charge');

                        if (from === 'c') {
                            baseValueCoulombs = value;
                             steps.push({
                                title: `Step 1: Initial Value`,
                                formula: '',
                                calculation: `Initial value is ${value.toExponential(6)} C. No conversion needed to base unit (Coulombs).`
                            });
                        } else if (from === 'mc') {
                            baseValueCoulombs = value * 1e-3;
                            steps.push({
                                title: `Step 1: Convert ${initialUnitText} to Coulombs`,
                                formula: `$\\text{C} = \\text{mC} \\cdot 10^{-3}$`,
                                calculation: `${value.toFixed(6)} mC \\cdot 0.001 = ${baseValueCoulombs.toExponential(6)} C`
                            });
                        } else if (from === 'uc') {
                            baseValueCoulombs = value * 1e-6;
                            steps.push({
                                title: `Step 1: Convert ${initialUnitText} to Coulombs`,
                                formula: `$\\text{C} = \\mu\\text{C} \\cdot 10^{-6}$`,
                                calculation: `${value.toFixed(6)} µC \\cdot 0.000001 = ${baseValueCoulombs.toExponential(6)} C`
                            });
                        } else if (from === 'nc') {
                            baseValueCoulombs = value * 1e-9;
                            steps.push({
                                title: `Step 1: Convert ${initialUnitText} to Coulombs`,
                                formula: `$\\text{C} = \\text{nC} \\cdot 10^{-9}$`,
                                calculation: `${value.toFixed(6)} nC \\cdot 1e-9 = ${baseValueCoulombs.toExponential(6)} C`
                            });
                        } else if (from === 'pc') {
                            baseValueCoulombs = value * 1e-12;
                            steps.push({
                                title: `Step 1: Convert ${initialUnitText} to Coulombs`,
                                formula: `$\\text{C} = \\text{pC} \\cdot 10^{-12}$`,
                                calculation: `${value.toFixed(6)} pC \\cdot 1e-12 = ${baseValueCoulombs.toExponential(6)} C`
                            });
                        } else { return { convertedValue: null, steps: [] }; }

                        let finalValue;
                        if (to === 'c') {
                            finalValue = baseValueCoulombs;
                             steps.push({
                                title: `Step 2: Final Result in Coulombs`,
                                formula: '',
                                calculation: `Converted value is ${finalValue.toExponential(6)} C.`
                            });
                        } else if (to === 'mc') {
                            finalValue = baseValueCoulombs / 1e-3;
                            steps.push({
                                title: `Step 2: Convert Coulombs to ${targetUnitText}`,
                                formula: `$\\text{mC} = \\frac{\\text{C}}{10^{-3}}$`,
                                calculation: `${baseValueCoulombs.toExponential(6)} C / 0.001 = ${finalValue.toFixed(6)} mC`
                            });
                        } else if (to === 'uc') {
                            finalValue = baseValueCoulombs / 1e-6;
                            steps.push({
                                title: `Step 2: Convert Coulombs to ${targetUnitText}`,
                                formula: `$\\mu\\text{C} = \\frac{\\text{C}}{10^{-6}}$`,
                                calculation: `${baseValueCoulombs.toExponential(6)} C / 0.000001 = ${finalValue.toFixed(6)} µC`
                            });
                        } else if (to === 'nc') {
                            finalValue = baseValueCoulombs / 1e-9;
                            steps.push({
                                title: `Step 2: Convert Coulombs to ${targetUnitText}`,
                                formula: `$\\text{nC} = \\frac{\\text{C}}{10^{-9}}$`,
                                calculation: `${baseValueCoulombs.toExponential(6)} C / 1e-9 = ${finalValue.toFixed(6)} nC`
                            });
                        } else if (to === 'pc') {
                            finalValue = baseValueCoulombs / 1e-12;
                            steps.push({
                                title: `Step 2: Convert Coulombs to ${targetUnitText}`,
                                formula: `$\\text{pC} = \\frac{\\text{C}}{10^{-12}}$`,
                                calculation: `${baseValueCoulombs.toExponential(6)} C / 1e-12 = ${finalValue.toFixed(6)} pC`
                            });
                        } else { return { convertedValue: null, steps: [] }; }
                        return { convertedValue: finalValue, steps: steps };
                    }
                },
                magnetic_flux: {
                    displayName: "Magnetic Flux (Wb, Mx)",
                    options: [
                        { value: 'wb', text: 'Weber (Wb)' },
                        { value: 'mx', text: 'Maxwell (Mx)' }
                    ],
                    convert: function(value, from, to) {
                        let baseValueWebers;
                        const steps = [];
                        let initialUnitText = getUnitText(from, 'magnetic_flux');
                        let targetUnitText = getUnitText(to, 'magnetic_flux');

                        if (from === 'wb') {
                            baseValueWebers = value;
                             steps.push({
                                title: `Step 1: Initial Value`,
                                formula: '',
                                calculation: `Initial value is ${value.toExponential(6)} Wb. No conversion needed to base unit (Webers).`
                            });
                        } else if (from === 'mx') {
                            baseValueWebers = value * 1e-8;
                            steps.push({
                                title: `Step 1: Convert ${initialUnitText} to Webers`,
                                formula: `$\\text{Wb} = \\text{Mx} \\cdot 10^{-8}$`,
                                calculation: `${value.toFixed(6)} Mx \\cdot 1e-8 = ${baseValueWebers.toExponential(6)} Wb`
                            });
                        } else { return { convertedValue: null, steps: [] }; }

                        let finalValue;
                        if (to === 'wb') {
                            finalValue = baseValueWebers;
                             steps.push({
                                title: `Step 2: Final Result in Webers`,
                                formula: '',
                                calculation: `Converted value is ${finalValue.toExponential(6)} Wb.`
                            });
                        } else if (to === 'mx') {
                            finalValue = baseValueWebers / 1e-8;
                            steps.push({
                                title: `Step 2: Convert Webers to ${targetUnitText}`,
                                formula: `$\\text{Mx} = \\frac{\\text{Wb}}{10^{-8}}$`,
                                calculation: `${baseValueWebers.toExponential(6)} Wb / 1e-8 = ${finalValue.toFixed(6)} Mx`
                            });
                        } else { return { convertedValue: null, steps: [] }; }
                        return { convertedValue: finalValue, steps: steps };
                    }
                },
                magnetic_field_strength: {
                    displayName: "Magnetic Field Strength (A/m, Oe)",
                    options: [
                        { value: 'at_m', text: 'Ampere-turn/meter (AT/m)' },
                        { value: 'oe', text: 'Oersted (Oe)' }
                    ],
                    convert: function(value, from, to) {
                        let baseValueAmpsPerMeter;
                        const OE_TO_AT_M = 1000 / (4 * Math.PI); // 1 Oersted = (1000 / 4π) A/m ≈ 79.57747 A/m
                        const steps = [];
                        let initialUnitText = getUnitText(from, 'magnetic_field_strength');
                        let targetUnitText = getUnitText(to, 'magnetic_field_strength');

                        if (from === 'at_m') {
                            baseValueAmpsPerMeter = value;
                             steps.push({
                                title: `Step 1: Initial Value`,
                                formula: '',
                                calculation: `Initial value is ${value.toFixed(6)} AT/m. No conversion needed to base unit (Ampere-turn/meter).`
                            });
                        } else if (from === 'oe') {
                            baseValueAmpsPerMeter = value * OE_TO_AT_M;
                            steps.push({
                                title: `Step 1: Convert ${initialUnitText} to Ampere-turn/meter`,
                                formula: `$\\text{AT/m} = \\text{Oe} \\cdot \\frac{1000}{4\\pi}$`,
                                calculation: `${value.toFixed(6)} Oe \\cdot ${OE_TO_AT_M.toFixed(5)} = ${baseValueAmpsPerMeter.toFixed(6)} AT/m`
                            });
                        } else { return { convertedValue: null, steps: [] }; }

                        let finalValue;
                        if (to === 'at_m') {
                            finalValue = baseValueAmpsPerMeter;
                             steps.push({
                                title: `Step 2: Final Result in Ampere-turn/meter`,
                                formula: '',
                                calculation: `Converted value is ${finalValue.toFixed(6)} AT/m.`
                            });
                        } else if (to === 'oe') {
                            finalValue = baseValueAmpsPerMeter / OE_TO_AT_M;
                            steps.push({
                                title: `Step 2: Convert Ampere-turn/meter to ${targetUnitText}`,
                                formula: `$\\text{Oe} = \\frac{\\text{AT/m}}{\\frac{1000}{4\\pi}}$`,
                                calculation: `${baseValueAmpsPerMeter.toFixed(6)} AT/m / ${OE_TO_AT_M.toFixed(5)} = ${finalValue.toFixed(6)} Oe`
                            });
                        } else { return { convertedValue: null, steps: [] }; }
                        return { convertedValue: finalValue, steps: steps };
                    }
                },
                magnetic_flux_density: {
                    displayName: "Magnetic Flux Density (T, G)",
                    options: [
                        { value: 't', text: 'Tesla (T)' },
                        { value: 'g', text: 'Gauss (G)' }
                    ],
                    convert: function(value, from, to) {
                        let baseValueTeslas;
                        const steps = [];
                        let initialUnitText = getUnitText(from, 'magnetic_flux_density');
                        let targetUnitText = getUnitText(to, 'magnetic_flux_density');

                        if (from === 't') {
                            baseValueTeslas = value;
                             steps.push({
                                title: `Step 1: Initial Value`,
                                formula: '',
                                calculation: `Initial value is ${value.toFixed(6)} T. No conversion needed to base unit (Tesla).`
                            });
                        } else if (from === 'g') {
                            baseValueTeslas = value * 1e-4;
                            steps.push({
                                title: `Step 1: Convert ${initialUnitText} to Tesla`,
                                formula: `$\\text{T} = \\text{G} \\cdot 10^{-4}$`,
                                calculation: `${value.toFixed(6)} G \\cdot 0.0001 = ${baseValueTeslas.toFixed(6)} T`
                            });
                        } else { return { convertedValue: null, steps: [] }; }

                        let finalValue;
                        if (to === 't') {
                            finalValue = baseValueTeslas;
                             steps.push({
                                title: `Step 2: Final Result in Tesla`,
                                formula: '',
                                calculation: `Converted value is ${finalValue.toFixed(6)} T.`
                            });
                        } else if (to === 'g') {
                            finalValue = baseValueTeslas / 1e-4;
                            steps.push({
                                title: `Step 2: Convert Tesla to ${targetUnitText}`,
                                formula: `$\\text{G} = \\frac{\\text{T}}{10^{-4}}$`,
                                calculation: `${baseValueTeslas.toFixed(6)} T / 0.0001 = ${finalValue.toFixed(6)} G`
                            });
                        } else { return { convertedValue: null, steps: [] }; }
                        return { convertedValue: finalValue, steps: steps };
                    }
                },
                temperature: {
                    displayName: "Temperature (°C, °F, K)",
                    options: [
                        { value: 'celsius', text: 'Celsius (°C)' },
                        { value: 'fahrenheit', text: 'Fahrenheit (°F)' },
                        { value: 'kelvin', text: 'Kelvin (K)' }
                    ],
                    convert: function(value, from, to) {
                        let baseValueCelsius;
                        const steps = [];
                        let initialUnitText = getUnitText(from, 'temperature');
                        let targetUnitText = getUnitText(to, 'temperature');

                        if (from === 'celsius') {
                            baseValueCelsius = value;
                             steps.push({
                                title: `Step 1: Initial Value`,
                                formula: '',
                                calculation: `Initial value is ${value.toFixed(2)} °C. No conversion needed to base unit (Celsius).`
                            });
                        } else if (from === 'fahrenheit') {
                            baseValueCelsius = (value - 32) * 5/9;
                            steps.push({
                                title: `Step 1: Convert ${initialUnitText} to Celsius`,
                                formula: `$\\text{°C} = (\\text{°F} - 32) \\cdot \\frac{5}{9}$`,
                                calculation: `(${value.toFixed(2)} °F - 32) \\cdot 5/9 = ${baseValueCelsius.toFixed(2)} °C`
                            });
                        } else if (from === 'kelvin') {
                            baseValueCelsius = value - 273.15;
                            steps.push({
                                title: `Step 1: Convert ${initialUnitText} to Celsius`,
                                formula: `$\\text{°C} = \\text{K} - 273.15$`,
                                calculation: `${value.toFixed(2)} K - 273.15 = ${baseValueCelsius.toFixed(2)} °C`
                            });
                        } else { return { convertedValue: null, steps: [] }; }

                        let finalValue;
                        if (to === 'celsius') {
                            finalValue = baseValueCelsius;
                             steps.push({
                                title: `Step 2: Final Result in Celsius`,
                                formula: '',
                                calculation: `Converted value is ${finalValue.toFixed(2)} °C.`
                            });
                        } else if (to === 'fahrenheit') {
                            finalValue = (baseValueCelsius * 9/5) + 32;
                            steps.push({
                                title: `Step 2: Convert Celsius to ${targetUnitText}`,
                                formula: `$\\text{°F} = (\\text{°C} \\cdot \\frac{9}{5}) + 32$`,
                                calculation: `(${baseValueCelsius.toFixed(2)} °C \\cdot 9/5) + 32 = ${finalValue.toFixed(2)} °F`
                            });
                        } else if (to === 'kelvin') {
                            finalValue = baseValueCelsius + 273.15;
                            steps.push({
                                title: `Step 2: Convert Celsius to ${targetUnitText}`,
                                formula: `$\\text{K} = \\text{°C} + 273.15$`,
                                calculation: `${baseValueCelsius.toFixed(2)} °C + 273.15 = ${finalValue.toFixed(2)} K`
                            });
                        } else { return { convertedValue: null, steps: [] }; }
                        return { convertedValue: finalValue, steps: steps };
                    }
                }
            };

            // Populate unit dropdowns based on selected category
            conversionCategorySelect.addEventListener('change', function() {
                const category = this.value;
                const selectedCategory = units[category];

                // Clear existing options
                fromUnitSelect.innerHTML = '<option value="">Select a unit</option>';
                toUnitSelect.innerHTML = '<option value="">Select a unit</option>';

                if (selectedCategory) {
                    selectedCategory.options.forEach(unit => {
                        const optionFrom = document.createElement('option');
                        optionFrom.value = unit.value;
                        optionFrom.textContent = unit.text;
                        fromUnitSelect.appendChild(optionFrom);

                        const optionTo = document.createElement('option');
                        optionTo.value = unit.value;
                        optionTo.textContent = unit.text;
                        toUnitSelect.appendChild(optionTo);
                    });
                    fromUnitSelect.disabled = false;
                    toUnitSelect.disabled = false;

                    // Show/hide power factor based on category
                    if (category === 'power') {
                        powerFactorGroup.style.display = 'block';
                        // Note: It's always shown, but only *required* for cross-type conversions (handled in validation)
                    } else {
                        powerFactorGroup.style.display = 'none';
                    }
                } else {
                    fromUnitSelect.disabled = true;
                    toUnitSelect.disabled = true;
                    powerFactorGroup.style.display = 'none';
                }
                resultContainer.style.display = 'none'; // Hide results when category changes
                detailedCalculationsDiv.innerHTML = '<h3 class="text-xl font-semibold mb-3 text-gray-700 dark:text-white">Detailed Calculation Steps</h3>'; // Clear detailed steps
            });

            convertBtn.addEventListener('click', function() {
                const category = conversionCategorySelect.value;
                const value = parseFloat(valueToConvertInput.value);
                const fromUnit = fromUnitSelect.value;
                const toUnit = toUnitSelect.value;
                const powerFactor = parseFloat(powerFactorInput.value);

                // Input validation
                if (!category || isNaN(value) || !fromUnit || !toUnit) {
                    showCustomAlert("Please fill in all required fields (Category, Value, From Unit, To Unit).");
                    return;
                }
                if (value < 0 && category !== 'temperature') { // Allow negative temps
                    showCustomAlert("Please enter a non-negative value for conversion.");
                    return;
                }
                if (fromUnit === toUnit) {
                    showCustomAlert("Please select different 'From' and 'To' units for conversion.");
                    return;
                }

                // === NEW Power Factor Validation Logic ===
                let requiresPF = false;
                if (category === 'power') {
                    const realUnits = ['w', 'kw', 'mw', 'hp', 'btu_hr'];
                    const apparentUnits = ['va', 'kva', 'mva'];
                    const reactiveUnits = ['var', 'kvar', 'mvar'];

                    const fromGroup = realUnits.includes(fromUnit) ? 'real' : (apparentUnits.includes(fromUnit) ? 'apparent' : (reactiveUnits.includes(fromUnit) ? 'reactive' : ''));
                    const toGroup = realUnits.includes(toUnit) ? 'real' : (apparentUnits.includes(toUnit) ? 'apparent' : (reactiveUnits.includes(toUnit) ? 'reactive' : ''));
                    
                    requiresPF = fromGroup && toGroup && fromGroup !== toGroup;

                    if (requiresPF && (isNaN(powerFactor) || powerFactor <= 0 || powerFactor > 1)) {
                        showCustomAlert("Please enter a valid Power Factor (PF) between 0.01 and 1.0. This is required for conversions between Real (kW), Apparent (kVA), and Reactive (kVAR) power types.");
                        return;
                    }
                }
                // === END New Logic ===

                const selectedCategory = units[category];
                let conversionResult; // This will hold { convertedValue, steps }

                try {
                    if (requiresPF) {
                        conversionResult = selectedCategory.convert(value, fromUnit, toUnit, powerFactor);
                    } else {
                        // Pass PF anyway, but it will be ignored by conversions that don't use it
                        conversionResult = selectedCategory.convert(value, fromUnit, toUnit, powerFactor);
                    }

                    if (conversionResult.convertedValue === null) {
                        showCustomAlert("Conversion not supported for the selected units.");
                        return;
                    }

                    // Display summary results
                    resultTableBody.innerHTML = '';
                    addResultRow("Original Value", `${value} ${getUnitText(fromUnit, category)}`);
                    
                    let resultValueString = conversionResult.convertedValue.toFixed(6);
                    // Use exponential notation for very small or very large numbers
                    if (Math.abs(conversionResult.convertedValue) > 1e9 || (Math.abs(conversionResult.convertedValue) < 1e-6 && conversionResult.convertedValue !== 0)) {
                        resultValueString = conversionResult.convertedValue.toExponential(6);
                    }
                    addResultRow("Converted Value", `${resultValueString} ${getUnitText(toUnit, category)}`);


                    if (requiresPF) {
                        addResultRow("Power Factor Used", powerFactor.toFixed(2));
                    }

                    // Display detailed calculations
                    detailedCalculationsDiv.innerHTML = '<h3 class="text-xl font-semibold mb-3">Detailed Calculation Steps</h3>';
                    conversionResult.steps.forEach(step => {
                        addDetailedCalculationStep(step.title, step.formula, step.calculation);
                    });

                    resultContainer.style.display = 'block';
                    resultContainer.scrollIntoView({ behavior: 'smooth' });
                    
                    // IMPORTANT: Tell MathJax to re-render the newly added content after a small delay
                    if (window.MathJax && typeof window.MathJax.typesetPromise === 'function') {
                        setTimeout(() => {
                            window.MathJax.typesetPromise([detailedCalculationsDiv])
                                .catch((err) => console.error('MathJax typesetting failed:', err));
                        }, 50); 
                    }
                } catch (error) {
                    console.error("Conversion error:", error);
                    showCustomAlert("An error occurred during conversion. Please check your inputs. Note: Power Factor cannot be exactly 1.0 for kVAR conversions.");
                }
            });

            // Reset button functionality
            resetBtn.addEventListener('click', function() {
                document.getElementById('unit-converter-form').reset();
                fromUnitSelect.innerHTML = '<option value="">Select a unit</option>';
                toUnitSelect.innerHTML = '<option value="">Select a unit</option>';
                fromUnitSelect.disabled = true;
                toUnitSelect.disabled = true;
                powerFactorGroup.style.display = 'none';
                resultContainer.style.display = 'none';
                resultTableBody.innerHTML = '';
                detailedCalculationsDiv.innerHTML = '<h3 class="text-xl font-semibold mb-3">Detailed Calculation Steps</h3>'; // Clear detailed steps
            });

            // Helper function to get display text for a unit
            function getUnitText(unitValue, category) {
                const categoryOptions = units[category]?.options;
                if (categoryOptions) {
                    const unit = categoryOptions.find(opt => opt.value === unitValue);
                    // Return the full text (e.g., "Kilowatts (kW) [Real]")
                    return unit ? unit.text : unitValue;
                }
                return unitValue;
            }
            
            // Helper function to add a row to the result table
            function addResultRow(parameter, value) {
                const row = document.createElement('tr');
                
                const paramCell = document.createElement('td');
                paramCell.textContent = parameter;
                paramCell.style.fontWeight = '600'; // Make parameter bold
                
                const valueCell = document.createElement('td');
                valueCell.textContent = value;
                
                row.appendChild(paramCell);
                row.appendChild(valueCell);
                
                resultTableBody.appendChild(row);
            }

            // Helper function to add a detailed calculation step
            function addDetailedCalculationStep(stepTitle, formulaText, calculationText) {
                const stepDiv = document.createElement('div');
                stepDiv.classList.add('calculation-step');

                const titleElem = document.createElement('h4');
                titleElem.textContent = stepTitle;
                stepDiv.appendChild(titleElem);

                if (formulaText) {
                    const formulaElem = document.createElement('p');
                    formulaElem.classList.add('formula-display');
                    formulaElem.innerHTML = formulaText; 
                    stepDiv.appendChild(formulaElem);
                }

                if (calculationText) {
                    const calcElem = document.createElement('p');
                    // We'll use innerHTML to render MathJax expressions within the text if needed
                    calcElem.innerHTML = "<strong>Calculation:</strong> " + calculationText.replace(/\\rightarrow/g, '→'); // Replace LaTeX arrow with HTML arrow for clarity in text
                    stepDiv.appendChild(calcElem);
                }
                detailedCalculationsDiv.appendChild(stepDiv);
            }
        });
    </script>

    <!-- Theme Toggle Script from 'perfect.txt' -->
    <script>
    document.addEventListener('DOMContentLoaded', () => {
        const themeSwitch = document.getElementById('theme-switch');
        const body = document.body;
        // Ensure themeSwitch exists before adding listeners
        if (themeSwitch) {
            const currentTheme = localStorage.getItem('theme');
            if (currentTheme) {
                body.classList.add(currentTheme);
                if (currentTheme === 'dark-mode') themeSwitch.checked = true;
            }
            themeSwitch.addEventListener('change', () => {
                if (themeSwitch.checked) {
                    body.classList.add('dark-mode');
                    localStorage.setItem('theme', 'dark-mode');
                } else {
                    body.classList.remove('dark-mode');
                    localStorage.setItem('theme', 'light-mode');
                }
            });
        } else {
            console.error("Theme switch element (#theme-switch) not found.");
        }
    });
    </script>
</body>
</html>
