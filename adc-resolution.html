<!DOCTYPE html>
<html lang="en">
<head>
    <!-- SEO Meta Tags -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analog-to-Digital (ADC) Resolution Calculator - Instrumentation</title>
    <meta name="description" content="Professional ADC Resolution Calculator. Determine theoretical bits, voltage resolution, quantization error, and Effective Number of Bits (ENOB) based on signal range and noise.">
    <meta name="keywords" content="adc calculator, adc resolution, enob, effective number of bits, 4-20ma, 12-bit, 16-bit, quantization error, snr, instrumentation, plc">
    <meta name="author" content="Design Calculators">
    <meta name="robots" content="index, follow">

    <!-- AdSense & Analytics -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5936527763614780" crossorigin="anonymous"></script>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-23Y1V450SR"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-23Y1V450SR');
    </script>
    
    <!-- Fonts & Icons -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Montserrat:wght@700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- MathJax for Formulas -->
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$']],
                displayMath: [['$$', '$$']]
            },
            svg: { fontCache: 'global' },
            options: {
                processHtmlClass: 'math-content', // Process elements with this class
                ignoreHtmlClass: 'no-mathjax'     // Ignore elements with this class
            }
        };
    </script>
    <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    
    <!-- Favicon -->
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">

    <style>
        /* NEW: Root variables from provided file */
        :root {
            --primary: #1E3A8A;
            --secondary: #2563EB;
            --accent: #F59E0B;
            --success: #10B981;
            --danger: #DC2626;
            --warning: #F59E0B;
            --bg: #F8FAFC;
            --card: #FFFFFF;
            --text: #4B5563;
            --heading: #111827;
            --footer-bg: #0F172A;
            --border: #E2E8F0;
            --grad: linear-gradient(135deg, var(--primary), var(--secondary));
            --grad-dark: linear-gradient(135deg, #0F172A, #1E293B);
            --shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
            --shadow-lg: 0 10px 20px rgba(0, 0, 0, 0.1);
            
            /* Specific to this tool, using new theme */
            --reset-button-bg: var(--accent);
            --reset-button-hover-bg: #DAA520;
            --clear-button-bg: var(--secondary);
            --clear-button-hover-bg: var(--primary);
            
            /* NEW: Map tool-specific colors to theme */
            --ok-color: var(--success);
            --error-color: var(--danger);
            --warning-color: var(--warning);
        }

        /* NEW: Dark mode variables from provided file */
        body.dark-mode {
            --primary: #10B981;
            --secondary: #34D399;
            --bg: #0F172A;
            --card: #1E293B;
            --text: #CBD5E1;
            --heading: #F1F5F9;
            --footer-bg: #020617;
            --border: #334155;

            /* Specific to this tool, using new theme */
            --reset-button-bg: var(--accent);
            --reset-button-hover-bg: #DAA520;
            --clear-button-bg: var(--secondary);
            --clear-button-hover-bg: var(--primary);
            
            /* NEW: Map tool-specific colors to theme */
            --ok-color: var(--success);
            --error-color: var(--danger);
            --warning-color: var(--warning);
        }

        /* General Body Styling (Updated) */
        body {
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding: 0;
            background: var(--bg);
            color: var(--text);
            line-height: 1.7;
            transition: background-color 0.3s, color 0.3s;
        }

        .container {
            max-width: 1280px;
            margin: 0 auto;
            padding: 0 24px;
        }
        
        /* NEW: Header styles (from provided file) */
        header {
            background: var(--grad);
            color: white;
            padding: 24px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .logo-container {
            display: flex;
            flex-direction: column;
            text-decoration: none;
            color: white;
        }
        .logo-text {
            font-size: 1.75rem;
            font-weight: 800;
            font-family: 'Montserrat', sans-serif;
        }
        .logo-subtitle {
            font-size: 0.8rem;
            margin: 4px 0 0 0;
            color: #E0E7FF;
            opacity: 0.9;
        }
        .nav-links {
            display: flex;
            gap: 24px;
            list-style: none;
            margin: 0;
            padding: 0;
        }
        .nav-links a {
            color: white;
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s;
        }
        .nav-links a:hover { color: var(--accent); }
        .theme-toggle {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .switch {
            position: relative;
            width: 56px;
            height: 30px;
        }
        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0,0,0,0.2);
            transition: .4s;
            border-radius: 30px;
        }
        .slider:before {
            position: absolute;
            content: "";
            height: 22px;
            width: 22px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        input:checked + .slider {
            background-color: var(--accent);
        }
        input:checked + .slider:before {
            transform: translateX(26px);
        }

        main {
            padding: 40px 0;
        }

        /* Main Card Styling (Updated) */
        .tool-container {
            background-color: var(--card);
            border-radius: 12px;
            padding: 30px;
            box-shadow: var(--shadow);
            margin-bottom: 30px;
            border: 1px solid var(--border);
            transition: transform 0.3s ease-in-out;
        }

        .tool-container:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }

        .tool-container h2 {
            color: var(--primary);
            border-bottom: 3px solid var(--primary);
            padding-bottom: 15px;
            margin-top: 0;
            margin-bottom: 20px;
            font-family: 'Montserrat', sans-serif;
            font-size: 1.8rem;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .tool-description {
            margin-bottom: 20px;
            color: var(--text);
            font-size: 1.05rem;
        }

        /* NEW: Footer styles (from provided file) */
        footer {
            background: var(--grad-dark);
            color: #CBD5E1;
            padding: 50px 0 20px 0;
            margin-top: 60px;
        }
        .footer-content {
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 40px;
            margin-bottom: 30px;
        }
        .footer-col {
            flex: 1;
            min-width: 200px;
        }
        .footer-col h4 {
            color: white;
            margin-bottom: 15px;
            font-weight: 700;
        }
        .footer-col ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        .footer-col a {
            color: #CBD5E1;
            text-decoration: none;
            transition: color 0.3s;
        }
        .footer-col a:hover {
            color: var(--accent);
        }
        .social-buttons {
            display: flex;
            gap: 12px;
            margin-top: 15px;
        }
        .social-btn {
            width: 40px;
            height: 40px;
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            border-radius: 50%;
            font-size: 1.1rem;
            transition: transform 0.3s;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        .social-btn:hover {
            transform: translateY(-4px);
        }
        .social-btn.linkedin { background-color: #0A66C2; }
        .social-btn.youtube { background-color: #FF0000; }
        .social-btn.twitter { background-color: #1DA1F2; }
        .social-btn.facebook { background-color: #1877F2; }
        .social-btn.whatsapp { background-color: #25D366; }
        .footer-disclaimer {
            text-align: center;
            padding-top: 25px;
            border-top: 1px solid #334155;
            max-width: 800px;
            margin: 0 auto;
            font-size: 0.9rem;
        }
        .footer-bottom {
            text-align: center;
            padding-top: 20px;
            font-size: 0.9rem;
            color: #94A3B8;
        }

        /* Styles for Calculator Forms and Results (Updated) */
        .calculator-form {
            background-color: var(--card);
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
            box-shadow: none;
        }
        
        .form-section {
            background-color: var(--bg);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 25px; /* Space between sections */
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.05);
            opacity: 0; /* Initial state for fade-in animation */
            transform: translateY(10px); /* Initial state for slide-up animation */
            transition: opacity 0.5s ease-out, transform 0.5s ease-out;
        }

        .form-section.fade-in {
            opacity: 1;
            transform: translateY(0);
        }

        .form-section h3 {
            color: var(--secondary);
            margin-top: 0;
            margin-bottom: 15px;
            border-bottom: 1px dashed var(--border);
            padding-bottom: 10px;
        }

        .form-group {
            margin-bottom: 15px; /* Default margin for form groups */
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--heading);
        }
        
        .form-group input, .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--border);
            border-radius: 6px;
            background-color: var(--bg);
            color: var(--text);
            box-sizing: border-box; /* Ensure padding doesn't increase width */
            transition: border-color 0.3s, box-shadow 0.3s;
            font-size: 1rem;
        }
        
        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); /* Responsive grid */
            gap: 20px; /* Gap between grid items */
            margin-bottom: 0; /* Handled by form-group margin */
        }
        
        /* Updated Button Styles */
        .calculate-btn {
            background: var(--grad);
            color: white;
            border: none;
            padding: 16px 30px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: 700;
            margin-top: 25px;
            transition: all 0.3s;
            width: auto;
            min-width: 220px;
            box-shadow: 0 4px 12px rgba(30, 58, 138, 0.3);
            letter-spacing: 0.5px;
            text-transform: uppercase;
        }
        
        .calculate-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(30, 58, 138, 0.4);
        }

        .reset-btn {
            background-color: var(--reset-button-bg);
            color: #333;
            border: none;
            padding: 16px 30px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: 700;
            margin-top: 25px;
            margin-left: 15px;
            transition: all 0.3s;
            width: auto;
            min-width: 150px;
            box-shadow: 0 4px 12px rgba(245, 158, 11, 0.3);
            letter-spacing: 0.5px;
            text-transform: uppercase;
        }

        .reset-btn:hover {
            background-color: var(--reset-button-hover-bg);
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(245, 158, 11, 0.4);
        }

        .clear-results-btn {
            background-color: var(--clear-button-bg);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9em;
            font-weight: 700;
            margin-top: 15px;
            transition: all 0.3s;
            box-shadow: var(--shadow);
        }

        .clear-results-btn:hover {
            background-color: var(--clear-button-hover-bg);
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }
        
        .result-container {
            margin-top: 30px;
            padding: 30px;
            border-radius: 12px;
            background-color: var(--card);
            box-shadow: var(--shadow);
            border: 1px solid var(--border);
            display: none; /* Hidden by default */
            opacity: 0; /* For animation */
            transform: translateY(20px); /* Initial state for animation */
            transition: opacity 0.5s ease-in-out, transform 0.5s ease-in-out;
        }
        
        .result-container.show {
            opacity: 1;
            transform: translateY(0);
        }

        .result-container h3 {
            color: var(--primary);
            margin-bottom: 20px;
            text-align: center;
            font-family: 'Montserrat', sans-serif;
            font-size: 1.8rem;
        }
        
        .result-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 25px;
            border-radius: 8px;
            overflow: hidden; /* Ensures rounded corners apply to table content */
            box-shadow: var(--shadow);
        }
        
        .result-table th, .result-table td {
            padding: 16px;
            text-align: left;
            border-bottom: 1px solid var(--border);
            transition: background-color 0.3s;
        }
        
        .result-table th {
            background: var(--grad);
            font-weight: 700;
            color: white;
        }

        .result-table tr:last-child td {
            border-bottom: none; /* No border for the last row */
        }
        
        .result-table tr:nth-child(even) {
            background-color: var(--bg);
        }

        .result-table tbody tr:hover {
            background-color: var(--border);
        }
        
        .result-table td:first-child {
            font-weight: 600;
            color: var(--heading);
        }
        
        .standard-reference {
            margin-top: 20px;
            font-style: italic;
            font-size: 0.9rem;
            color: var(--text);
            padding: 15px;
            border-left: 4px solid var(--primary);
            background-color: var(--bg);
            border-radius: 4px;
        }
        
        .info-icon {
            color: var(--primary);
            margin-left: 5px;
            cursor: help;
            transition: color 0.3s;
        }

        .info-icon:hover {
            color: var(--accent);
        }
        
        .tooltip {
            position: relative;
            display: inline-block;
        }
        
        .tooltip .tooltiptext {
            visibility: hidden;
            width: 250px;
            background-color: #333;
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 8px;
            position: absolute;
            z-index: 10;
            bottom: 125%;
            left: 50%;
            margin-left: -125px;
            opacity: 0;
            transition: opacity 0.3s, transform 0.3s;
            transform: translateY(10px);
            font-size: 0.85em;
            font-family: 'Inter', sans-serif;
            line-height: 1.4;
        }
        
        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
            transform: translateY(0);
        }

        /* Custom message box style (Updated) */
        #custom-message-box {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            padding: 16px 28px;
            border-radius: 8px;
            box-shadow: 0 6px 16px rgba(0,0,0,0.25);
            z-index: 10000;
            font-weight: 600;
            color: white;
            opacity: 0;
            transition: all 0.4s;
            display: none;
            align-items: center;
            justify-content: center;
            min-width: 250px;
        }
        #custom-message-box.show {
            display: flex;
            opacity: 1;
            top: 30px;
        }

        /* NEW: Styles for calculation steps (from provided file) */
        .steps-container {
            display: none;
            margin-top: 30px;
        }
        .steps-container.active {
            display: block;
        }
        .step-card {
            background: var(--card);
            border-radius: 12px;
            padding: 25px 30px;
            box-shadow: var(--shadow);
            border: 1px solid var(--border);
            animation: slideIn 0.6s ease-out;
            transition: all 0.3s;
            margin-bottom: 25px; /* Spacing between cards */
        }
        @keyframes slideIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .step-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }
        .step-card h4 {
            color: var(--primary);
            margin: 0 0 20px 0;
            font-size: 1.4rem;
            font-family: 'Montserrat', sans-serif;
            display: flex;
            align-items: center;
        }
        .step-card .number {
            display: inline-block;
            width: 40px;
            height: 40px;
            background: var(--primary);
            color: white;
            border-radius: 50%;
            text-align: center;
            line-height: 40px;
            font-weight: 700;
            margin-right: 15px;
            font-size: 1.3rem;
            flex-shrink: 0;
        }
        .step-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
            align-items: start;
        }
        @media (max-width: 768px) {
            .step-content {
                grid-template-columns: 1fr;
            }
        }
        .step-content .formula-block {
            background: var(--bg);
            border-radius: 8px;
            padding: 20px;
            font-size: 1rem;
            border: 1px solid var(--border);
        }
        .step-content .formula-block p {
            margin-top: 0;
        }
        .step-content .formula {
            background: var(--bg);
            border-left: 3px solid var(--accent);
            padding: 15px;
            margin: 12px 0;
            font-size: 1rem;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            overflow-x: auto;
        }
        .step-value {
            font-size: 2.2rem;
            font-weight: 800;
            color: var(--success);
            margin: 10px 0;
            line-height: 1.2;
        }
        .step-unit {
            font-size: 1rem;
            color: var(--text);
            opacity: 0.8;
            font-weight: 500;
            margin-left: 5px;
        }
        .step-explanation {
            font-size: 1.05rem;
            line-height: 1.8;
        }
        
        .button-wrapper {
            display: flex;
            justify-content: center; /* Center the button horizontally */
            flex-wrap: wrap;
            gap: 15px;
            width: 100%;
            padding-top: 20px;
        }

        /* Animation for input fields on focus (Updated) */
        .form-group input:focus, .form-group select:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(30, 58, 138, 0.1);
            outline: none;
            /* Removed pulse animation */
        }
        body.dark-mode .form-group input:focus, 
        body.dark-mode .form-group select:focus {
             box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1);
        }

        /* Specific styles for ADC Calculator (MERGED) */
        .status-display {
            font-weight: bold;
            font-size: 1.2em; /* Updated */
            margin-top: 15px;
            padding: 10px 20px;
            border-radius: 5px;
            transition: background-color 0.5s, color 0.5s;
            text-align: center;
            width: auto; /* Updated */
            display: inline-block; /* Added */
            margin-bottom: 20px; /* Added */
        }
        .status-display.optimal {
            background-color: var(--ok-color);
            color: white;
        }
        .status-display.sufficient {
            background-color: #66bb6a; /* Lighter green */
            color: white;
        }
        .status-display.adequate {
            background-color: var(--secondary); /* Light blue */
            color: white;
        }
        body.dark-mode .status-display.adequate {
            background-color: var(--secondary);
            color: white;
        }
        .status-display.marginal {
            background-color: var(--warning-color);
            color: var(--heading);
        }
        .status-display.insufficient {
            background-color: var(--error-color);
            color: white;
        }
        
        /* Practical Recommendations Section */
        #practical-recommendations {
            margin-top: 20px;
            padding: 20px;
            border-radius: 8px;
            background-color: var(--bg);
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.05);
            color: var(--text);
            border: 1px solid var(--border);
        }
        #practical-recommendations h4 {
            color: var(--secondary);
            margin-top: 0;
            margin-bottom: 15px;
            border-bottom: 1px dashed var(--border);
            padding-bottom: 10px;
        }
        #practical-recommendations ul {
            list-style-type: disc;
            margin-left: 25px;
            padding-left: 0;
        }
        #practical-recommendations ul li {
            margin-bottom: 8px;
        }
        
        /* NEW: Educational Section Styles (from provided file) */
        .education-section {
            margin-top: 40px;
            margin-bottom: 40px;
            background: var(--card);
            border-radius: 12px;
            padding: 30px;
            box-shadow: var(--shadow);
            border: 1px solid var(--border);
        }
        
        .education-section h2 {
            color: var(--primary);
            border-bottom: 3px solid var(--primary);
            padding-bottom: 15px;
            margin-top: 0;
            font-family: 'Montserrat', sans-serif;
            font-size: 1.8rem;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .insight-card {
            background: linear-gradient(135deg, var(--card), rgba(37,99,235,0.03));
            border-radius: 12px;
            padding: 25px;
            margin: 20px 0;
            border-left: 5px solid var(--secondary);
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            transition: all 0.3s;
        }
        .insight-card:hover {
            transform: translateX(5px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        .insight-card h4 {
            color: var(--secondary);
            font-size: 1.3rem;
            margin: 0 0 15px 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .insight-card h4 i {
            font-size: 1.5rem;
        }
        .insight-card p {
            margin: 10px 0;
            line-height: 1.8;
        }
        .insight-card ol,
        .insight-card ul {
            padding-left: 20px;
            margin: 10px 0;
        }
        .insight-card li {
            margin-bottom: 10px;
        }

        .danger-box {
            background: linear-gradient(135deg, rgba(220,38,38,0.1), rgba(220,38,38,0.05));
            border-left: 5px solid var(--danger);
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
        }
        .danger-box h4 {
            color: var(--danger);
            margin-top: 0;
        }
        .success-box {
            background: linear-gradient(135deg, rgba(16,185,129,0.1), rgba(16,185,129,0.05));
            border-left: 5px solid var(--success);
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
        }
        .success-box h4 {
            color: var(--success);
            margin-top: 0;
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .container { padding: 0 15px; }
            .navbar { flex-direction: column; gap: 20px; }
            .nav-links { flex-direction: column; gap: 12px; text-align: center; }
            .form-row { grid-template-columns: 1fr; }
            .tool-container, .education-section, .result-container { padding: 20px; }
            .footer-content { flex-direction: column; gap: 25px; }
        }
        .hidden { display: none; }
        
    </style>
</head>
<body>
    <!-- NEW: Message box -->
    <div id="custom-message-box" class="message-box"></div>
    
    <!-- NEW: Header from provided file -->
    <header>
        <div class="container">
            <nav class="navbar">
                <a href="index.html" class="logo-container">
                    <span class="logo-text">Design Calculators</span>
                    <p class="logo-subtitle">Inspired by standards such as IEC, IEEE, ISA, ASME, and API.</p>
                </a>
                <ul class="nav-links">
                    <li><a href="index.html">Home</a></li>
                    <li><a href="articles.html">Articles</a></li>
                    <li><a href="indexmech.html">Mechanical</a></li>
                    <li><a href="indexele.html">Electrical</a></li>
                    <li><a href="indexinst.html">Instrumentation</a></li>
                </ul>
                <div class="theme-toggle">
                    <i class="fas fa-sun"></i>
                    <label class="switch">
                        <input type="checkbox" id="theme-switch">
                        <span class="slider"></span>
                    </label>
                    <i class="fas fa-moon"></i>
                </div>
            </nav>
        </div>
    </header>

    <main class="container">
        <!-- "Back to Tools" button REMOVED -->
        
        <div class="tool-container">
            <h2><i class="fas fa-digital-tachograph"></i> Analog-to-Digital Resolution Calculator</h2>
            
            <div class="tool-description">
                <p>This calculator helps instrument engineers determine the necessary Analog-to-Digital Converter (ADC) resolution for a given input range and desired precision. It calculates the <strong>voltage per bit (resolution)</strong>, <strong>quantization error</strong>, and the critical <strong>Effective Number of Bits (ENOB)</strong> based on system noise, providing essential insights for selecting the right ADC.</p>
            </div>
        
            <div class="calculator-form">
                <form id="adc-calculator-form">
                    <!-- Input Parameters -->
                    <div class="form-section">
                        <h3><i class="fas fa-sliders-h"></i> Input Signal Parameters</h3>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="min-input-value">Minimum Input Value <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">The lowest value in the input range (e.g., 4 for 4-20mA).</span></span></label>
                                <input type="number" id="min-input-value" step="any" value="4" required>
                            </div>
                            <div class="form-group">
                                <label for="max-input-value">Maximum Input Value <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">The highest value in the input range (e.g., 20 for 4-20mA).</span></span></label>
                                <input type="number" id="max-input-value" step="any" value="20" required>
                            </div>
                            <div class="form-group">
                                <label for="input-type">Input Signal Type</label>
                                <select id="input-type" required>
                                    <option value="current">Current (mA)</option>
                                    <option value="voltage">Voltage (V)</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Shunt Resistor (Conditional for Current) -->
                    <div class="form-section" id="shunt-resistor-section">
                        <h3><i class="fas fa-wave-square"></i> Current-to-Voltage Conversion</h3>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="shunt-resistor">Shunt Resistor Value (R<sub>shunt</sub>) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">The value of the shunt resistor used to convert current to voltage (Ohms). Common values are 250 Ohm for 4-20mA (1-5V).</span></span></label>
                                <input type="number" id="shunt-resistor" step="any" value="250" required>
                            </div>
                        </div>
                    </div>

                    <!-- Noise Parameters -->
                    <div class="form-section">
                        <h3><i class="fas fa-broadcast-tower"></i> Noise Parameters</h3>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="signal-noise">Signal Noise (RMS) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">The RMS value of the noise present on the signal. Enter 0 for an ideal (noise-free) calculation.</span></span></label>
                                <input type="number" id="signal-noise" step="any" value="0.0001" required>
                            </div>
                            <div class="form-group">
                                <label for="noise-unit">Noise Unit</label>
                                <select id="noise-unit" required>
                                    <option value="V">Volts (V)</option>
                                    <option value="mV">Millivolts (mV)</option>
                                    <option value="A">Amperes (A)</option>
                                    <option value="mA">Milliamperes (mA)</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Calculation Mode -->
                    <div class="form-section">
                        <h3><i class="fas fa-calculator"></i> Calculation Mode</h3>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="calculation-mode">Choose Calculation Type</label>
                                <select id="calculation-mode" required>
                                    <option value="bits-to-resolution">Calculate Resolution from Bits</option>
                                    <option value="resolution-to-bits">Calculate Bits from Desired Resolution</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Conditional Inputs -->
                    <div class="form-section" id="bits-input-section">
                        <h3><i class="fas fa-bolt"></i> ADC Bits</h3>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="num-bits">Theoretical Number of Bits (N) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">The theoretical resolution of the ADC in bits (e.g., 8, 10, 12, 16, 24).</span></span></label>
                                <input type="number" id="num-bits" step="1" min="1" value="12" required>
                            </div>
                        </div>
                    </div>
                    <div class="form-section" id="desired-resolution-input-section" style="display: none;">
                        <h3><i class="fas fa-search-plus"></i> Desired Resolution</h3>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="desired-resolution">Desired Voltage Resolution (V<sub>res_desired</sub>) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">The smallest voltage change you need to detect (Volts).</span></span></label>
                                <input type="number" id="desired-resolution" step="any" value="0.005" required>
                            </div>
                        </div>
                    </div>
                    
                    <div class="button-wrapper">
                        <button type="button" id="calculate-btn" class="calculate-btn"><i class="fas fa-calculator"></i> Calculate</button>
                        <button type="button" id="reset-form-btn" class="reset-btn"><i class="fas fa-sync-alt"></i> Reset</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Results Container (Updated) -->
        <div id="result-container" class="result-container">
            <h3><i class="fas fa-clipboard-check"></i> Calculation Results</h3>
            
            <div style="text-align: center;">
                <p class="status-display" id="resolution-status-display">Resolution Status: N/A</p>
            </div>

            <!-- NEW: Step-by-Step Calculation Cards -->
            <div id="steps-container" class="steps-container math-content">
                <!-- Calculation steps will be inserted here -->
            </div>
            
            <!-- Summary Table -->
            <table class="result-table">
                <thead>
                    <tr>
                        <th>Parameter</th>
                        <th>Value</th>
                    </tr>
                </thead>
                <tbody id="result-table-body">
                    <!-- Results will be dynamically inserted here -->
                </tbody>
            </table>
            
            <!-- Practical Recommendations -->
            <div id="practical-recommendations" style="display: none;">
                <h4><i class="fas fa-lightbulb"></i> Practical Considerations & Recommendations</h4>
                <ul id="recommendations-list">
                    <!-- Recommendations will be dynamically inserted here -->
                </ul>
            </div>

            <div style="display: flex; justify-content: center; margin-top: 20px;">
                <button type="button" id="clear-results-btn" class="clear-results-btn"><i class="fas fa-times-circle"></i> Clear Results</button>
            </div>
            
            <div class="standard-reference" id="standard-reference">
                <p><strong>Applicable Standards and Guidelines:</strong> The selection and implementation of ADCs in industrial systems are governed by various standards to ensure reliability, accuracy, and interoperability. Key standards and considerations include:</p>
                <ul>
                    <li><strong>IEC 61131-2: Programmable Controllers - Part 2: Equipment Requirements and Tests.</strong> This standard often defines requirements for analog input modules used in PLCs, which incorporate ADCs.</li>
                    <li><strong>IEEE 1057 / 1241:</strong> Standards for digitizing waveform recorders and ADC terminology/testing methods, which define parameters like ENOB, SNR, INL, and DNL.</li>
                    <li><strong>Manufacturer Specifications:</strong> Always refer to the ADC manufacturer's datasheet for detailed specifications, including INL (Integral Non-Linearity), DNL (Differential Non-Linearity), noise, and temperature drift.</li>
                </ul>
                <p>This tool provides a fundamental calculation for ADC resolution. For critical industrial applications, a comprehensive system design, including noise analysis, sensor accuracy, and environmental factors, is essential.</p>
            </div>
            
            <!-- NEW: Educational Section -->
            <div id="education-section" class="education-section">
                <h2><i class="fas fa-lightbulb"></i> Professional Insights: Understanding ADC Resolution</h2>
    
                <div class="insight-card">
                    <h4><i class="fas fa-exchange-alt"></i> What is an ADC? The Digital Translator</h4>
                    <p>An Analog-to-Digital Converter (ADC) is a chip that translates real-world analog signals (like voltage or current) into a digital language that computers, PLCs, and microcontrollers can understand. The analog world is <strong>continuous</strong>—a temperature can be 20°C, 20.1°C, 20.11°C, etc. The digital world is <strong>discrete</strong>—it only understands a fixed number of steps.</p>
                    <p>An ADC "samples" the analog signal and "quantizes" it, or forces it to the nearest available digital step. This calculator helps you determine how small those steps are and if they are small enough for your application.</p>
                </div>
    
                <div class="insight-card">
                    <h4><i class="fas fa-ruler-vertical"></i> The Key Parameter: "Bits" and "Resolution"</h4>
                    <p>The "power" of an ADC is defined by its number of bits (N). The number of discrete steps the ADC can use is $2^N$.</p>
                    <ul>
                        <li><strong>8-bit ADC:</strong> $2^8$ = 256 steps</li>
                        <li><strong>12-bit ADC:</strong> $2^{12}$ = 4,096 steps (Common in PLCs)</li>
                        <li><strong>16-bit ADC:</strong> $2^{16}$ = 65,536 steps (High-Resolution)</li>
                        <li><strong>24-bit ADC:</strong> $2^{24}$ = >16.7 million steps (High-Precision, e.g., Delta-Sigma)</li>
                    </ul>
                    <p><strong>Resolution (V<sub>res</sub>)</strong>, also called the <strong>Least Significant Bit (LSB)</strong>, is the size of one of these steps. It's the smallest change in the analog signal the ADC can *theoretically* detect. It's calculated by dividing the total measurement range by the number of steps.</p>
                    <div class="formula-block math-content" style="text-align:center; font-weight:bold; font-size: 1.1rem;">
                        $$V_{res} = \frac{V_{range}}{2^N}$$
                    </div>
                </div>

                <div class="insight-card">
                    <h4><i class="fas fa-tasks"></i> Practical Example: 4-20mA Loop</h4>
                    <p>This is the most common use case in instrumentation. A 4-20mA signal is not read directly by a PLC. First, it's passed through a high-precision <strong>250Ω shunt resistor</strong> to convert it to a voltage (Ohm's Law: $V = IR$).</p>
                    <ul>
                        <li>At <strong>4 mA:</strong> $V = 0.004 A \times 250 \Omega = 1.0 V$</li>
                        <li>At <strong>20 mA:</strong> $V = 0.020 A \times 250 \Omega = 5.0 V$</li>
                    </ul>
                    <p>Your "Input Voltage Range" ($V_{range}$) is therefore $5.0V - 1.0V = 4.0V$.</p>
                    <p>If you use a <strong>12-bit ADC</strong> (4,096 steps) for this 4V range:</p>
                    <div class="formula-block math-content" style="text-align:center; font-weight:bold; font-size: 1.1rem;">
                        $$V_{res} = \frac{4.0 V}{2^{12}} = \frac{4.0 V}{4096} \approx 0.000977 V \text{ (or } 0.977 \text{ mV)}$$
                    </div>
                    <p>This means for every 0.977mV change at its input, the ADC's digital value will increase by 1. This is the theoretical limit of your measurement precision.</p>
                </div>
                
                <div class="danger-box">
                    <h4><i class="fas fa-exclamation-triangle"></i> The "Gotcha": Resolution vs. Accuracy</h4>
                    <p>This is the most important concept many engineers misunderstand. <strong>High resolution does NOT equal high accuracy.</strong></p>
                    <ul>
                        <li><strong>Resolution (Precision):</strong> How many decimal places you can read. A 24-bit ADC has extremely high resolution.</li>
                        <li><strong>Accuracy:</strong> How *correct* that reading is.</li>
                    </ul>
                    <p><strong>Analogy:</strong> A cheap digital ruler might read "1.00001 inches" (high resolution), but if it's warped, that number is wrong (low accuracy). A high-quality, calibrated ruler that reads "1.00 inches" is more accurate, even with less resolution.</p>
                    <p>ADC accuracy is affected by <strong>linearity errors (INL/DNL)</strong>, <strong>offset/gain errors</strong>, and <strong>temperature drift</strong>. A high-quality 12-bit ADC from a reputable brand is often *more accurate* than a cheap 16-bit ADC.</p>
                </div>
    
                <div class="danger-box">
                    <h4><i class="fas fa-broadcast-tower"></i> The Real Enemy: Noise and "ENOB"</h4>
                    <p>Your ADC's theoretical resolution is almost always a lie in the real world. Every circuit has electrical noise—from power supplies, radio interference (RFI), and the sensor itself. This noise creates a "haze" over the signal.</p>
                    <p><strong>Analogy:</strong> Imagine your resolution ($V_{res}$) is 1 millimeter. You are trying to measure the height of a block. But the block is sitting on a table that is <strong>vibrating up and down by 10 millimeters (the noise)</strong>. Your 1mm resolution is completely useless. The noise is the *real* limit of your measurement.</p>
                    <p>This is where <strong>ENOB (Effective Number of Bits)</strong> comes in. It's the *true, usable resolution* of your system after accounting for noise. This calculator computes it using the Signal-to-Noise Ratio (SNR).</p>
                    <div class="formula-block math-content" style="text-align:center; font-weight:bold; font-size: 1.1rem;">
                        $$SNR_{dB} = 20 \log_{10}(\frac{V_{range}}{V_{noise\_rms}})$$
                        $$ENOB = \frac{SNR_{dB} - 1.76}{6.02}$$
                    </div>
                    <p>If you have a 16-bit ADC ($N=16$) but your circuit noise is high, you might only get an $ENOB = 12.5$. This means your 16-bit chip is only giving you 12.5 bits of *useful information*. The bottom 3.5 bits are just random noise. <strong>Your design goal is always to make ENOB as close to N as possible by reducing noise.</strong></small></p>
                </div>

                <div class="insight-card">
                    <h4><i class="fas fa-cogs"></i> ADC Types: SAR vs. Delta-Sigma</h4>
                    <p>Not all ADCs are the same. The two most common types in industry have different strengths:</p>
                    <ul>
                        <li><strong>SAR (Successive Approximation Register):</strong> The "All-Rounder." These are fast, affordable, and have good resolution (typically 12 to 18 bits). They take one "snapshot" of the signal at a time. Most PLC/DCS analog input cards use SAR ADCs because they are a good balance of speed and precision for general-purpose I/O.</li>
                        <li><strong>Delta-Sigma ($\Delta\Sigma$):</strong> The "Precision Specialist." These are generally slower but have extremely high resolution (20 to 24+ bits) and excellent built-in noise rejection. They work by oversampling (taking thousands of samples per second) and averaging them. They are perfect for applications where accuracy is paramount and speed is not, such as weigh scales (load cells) or high-precision temperature measurement.</li>
                    </ul>
                </div>
            </div>

        </div>
    </main>

    <!-- NEW: Footer from provided file -->
    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-col">
                    <h4>Design Calculators</h4>
                    <p style="font-size: 0.9rem; line-height: 1.6; margin-bottom: 15px;">If you find this tool helpful, please consider sharing it with your colleagues!</p>
                    <div class="social-buttons">
                        <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://designcalculators.co.in" target="_blank" rel="noopener noreferrer" class="social-btn linkedin" title="LinkedIn"><i class="fab fa-linkedin-in"></i></a>
                        <a href="https://www.youtube.com/@designcalculators" target="_blank" rel="noopener noreferrer" class="social-btn youtube" title="YouTube"><i class="fab fa-youtube"></i></a>
                        <a href="https://twitter.com/intent/tweet?url=https://designcalculators.co.in" target="_blank" rel="noopener noreferrer" class="social-btn twitter" title="Twitter"><i class="fab fa-twitter"></i></a>
                        <a href="https://www.facebook.com/sharer/sharer.php?u=https://designcalculators.co.in" target="_blank" rel="noopener noreferrer" class="social-btn facebook" title="Facebook"><i class="fab fa-facebook-f"></i></a>
                        <a href="https://api.whatsapp.com/send?text=Check%20out%20this%20amazing%20engineering%20resource%20https://designcalculators.co.in" target="_blank" rel="noopener noreferrer" class="social-btn whatsapp" title="WhatsApp"><i class="fab fa-whatsapp"></i></a>
                    </div>
                </div>
                <div class="footer-col">
                    <h4>Quick Links</h4>
                    <ul>
                        <li><a href="index.html">Home</a></li>
                        <li><a href="indexele">Electrical</a></li>
                        <li><a href="indexmech">Mechanical</a></li>
                        <li><a href="indexinst">Instrumentation</a></li>                        
                    </ul>
                </div>
                <div class="footer-col">
                    <h4>Resources</h4>
                    <ul>
                        <li><a href="about.html">About Us</a></li>
                        <li><a href="contact.html">Contact</a></li>
                        <li><a href="faq.html">FAQ</a></li>
                        <li><a href="privacy-policy.html">Privacy Policy</a></li>
                        <li><a href="terms-of-service.html">Terms of Service</a></li>
                    </ul>
                </div>
                <div class="footer-col">
                    <h4>More</h4>
                    <ul>
                        <li><a href="articles.html">Articles & Whitepapers</a></li>
                        <li><a href="sitemap2.html">Sitemap</a></li>                        
                    </ul>
                </div>
            </div>
            <div class="footer-disclaimer">
                <p>This tool offers general guidance. Results should be reviewed for accuracy and compliance with relevant project standards and regulations before use.</p>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 Design Calculators. Created by <span style="color: var(--secondary); font-weight: bold;">A Sharma</span>. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // --- Element Selection ---
            const minInputValue = document.getElementById('min-input-value');
            const maxInputValue = document.getElementById('max-input-value');
            const inputTypeSelect = document.getElementById('input-type');
            const shuntResistorInput = document.getElementById('shunt-resistor');
            const signalNoiseInput = document.getElementById('signal-noise');
            const noiseUnitSelect = document.getElementById('noise-unit');
            const calculationModeSelect = document.getElementById('calculation-mode');
            const numBitsInput = document.getElementById('num-bits');
            const desiredResolutionInput = document.getElementById('desired-resolution');

            const shuntResistorSection = document.getElementById('shunt-resistor-section');
            const bitsInputSection = document.getElementById('bits-input-section');
            const desiredResolutionInputSection = document.getElementById('desired-resolution-input-section');
            const practicalRecommendationsDiv = document.getElementById('practical-recommendations');
            const recommendationsList = document.getElementById('recommendations-list');

            const calculateBtn = document.getElementById('calculate-btn');
            const resetFormBtn = document.getElementById('reset-form-btn');
            const clearResultsBtn = document.getElementById('clear-results-btn');
            const resultContainer = document.getElementById('result-container');
            const resultTableBody = document.getElementById('result-table-body');
            const resolutionStatusDisplay = document.getElementById('resolution-status-display');
            
            // NEW: Get new steps container
            const stepsContainer = document.getElementById('steps-container');

            // --- Default Values ---
            const defaultValues = {
                'min-input-value': 4,
                'max-input-value': 20,
                'input-type': 'current',
                'shunt-resistor': 250,
                'signal-noise': 0.0001,
                'noise-unit': 'V',
                'calculation-mode': 'bits-to-resolution',
                'num-bits': 12,
                'desired-resolution': 0.005
            };

            // --- Helper Functions ---

            // NEW: Updated displayMessage function
            function displayMessage(message, type = "info") {
                let messageBox = document.getElementById('custom-message-box');
                
                messageBox.textContent = message;
                if (type === "error") {
                    messageBox.style.backgroundColor = 'var(--danger)';
                    messageBox.style.color = 'white';
                } else if (type === "warning") {
                    messageBox.style.backgroundColor = 'var(--warning)';
                    messageBox.style.color = '#333';
                } else {
                    messageBox.style.backgroundColor = 'var(--success)';
                    messageBox.style.color = 'white';
                }
                messageBox.classList.add('show');

                // Hide after 5 seconds
                setTimeout(() => {
                    messageBox.classList.remove('show');
                }, 5000);
            }
            
            function updateInputSectionVisibility() {
                if (calculationModeSelect.value === 'bits-to-resolution') {
                    bitsInputSection.style.display = 'block';
                    desiredResolutionInputSection.style.display = 'none';
                    desiredResolutionInput.value = defaultValues['desired-resolution'];
                } else {
                    bitsInputSection.style.display = 'none';
                    desiredResolutionInputSection.style.display = 'block';
                    numBitsInput.value = defaultValues['num-bits'];
                }

                if (inputTypeSelect.value === 'current') {
                    shuntResistorSection.style.display = 'block';
                } else {
                    shuntResistorSection.style.display = 'none';
                    shuntResistorInput.value = defaultValues['shunt-resistor'];
                }
            }

            function convertNoiseToVoltsRMS(value, unit, shuntResistor) {
                let noiseInVolts;
                let conversionStep = '';

                switch (unit) {
                    case 'V':
                        noiseInVolts = value;
                        conversionStep = `<p>Noise is already in Volts: <strong>${value} V (RMS)</strong></p>`;
                        break;
                    case 'mV':
                        noiseInVolts = value / 1000;
                        conversionStep = `<p>Convert noise from mV to V:</p><p class="formula">$$V_{noise} = ${value} \\text{ mV} / 1000 = ${noiseInVolts.toExponential(4)} \\text{ V (RMS)}$$</p>`;
                        break;
                    case 'A':
                        noiseInVolts = value * shuntResistor;
                        conversionStep = `<p>Convert current noise (A) to voltage noise (V) using $R_{shunt}$:</p><p class="formula">$$V_{noise} = I_{noise} \\times R_{shunt} = ${value} \\text{ A} \\times ${shuntResistor} \\Omega = ${noiseInVolts.toExponential(4)} \\text{ V (RMS)}$$</p>`;
                        break;
                    case 'mA':
                        const A = value / 1000;
                        noiseInVolts = A * shuntResistor;
                        conversionStep = `<p>Convert current noise (mA) to voltage noise (V) using $R_{shunt}$:</p><p class="formula">$$I_{noise} = ${value} \\text{ mA} / 1000 = ${A.toExponential(4)} \\text{ A}$$</p><p class="formula">$$V_{noise} = I_{noise} \\times R_{shunt} = ${A.toExponential(4)} \\text{ A} \\times ${shuntResistor} \\Omega = ${noiseInVolts.toExponential(4)} \\text{ V (RMS)}$$</p>`;
                        break;
                    default:
                        throw new Error('Unsupported noise unit for conversion.');
                }
                return { noiseInVolts, conversionStep };
            }

            // --- Event Listeners ---
            calculationModeSelect.addEventListener('change', updateInputSectionVisibility);
            inputTypeSelect.addEventListener('change', updateInputSectionVisibility);
            calculateBtn.addEventListener('click', calculateResolution);
            resetFormBtn.addEventListener('click', resetForm);
            clearResultsBtn.addEventListener('click', clearResults);

            // --- Initial Setup ---
            updateInputSectionVisibility();
            const formSections = document.querySelectorAll('.form-section');
            formSections.forEach((section, index) => {
                setTimeout(() => { section.classList.add('fade-in'); }, 100 * index);
            });

            // --- Reset and Clear ---
            function resetForm() {
                for (const key in defaultValues) {
                    const input = document.getElementById(key);
                    if (input) {
                        input.value = defaultValues[key];
                    }
                }
                updateInputSectionVisibility();
                clearResults();
                displayMessage('Form reset to default values.', 'info');
            }

            function clearResults() {
                resultContainer.classList.remove('show');
                setTimeout(() => {
                    resultContainer.style.display = 'none';
                    resultTableBody.innerHTML = '';
                    stepsContainer.innerHTML = '';
                    stepsContainer.classList.remove('active');
                    recommendationsList.innerHTML = '';
                    practicalRecommendationsDiv.style.display = 'none';
                    resolutionStatusDisplay.textContent = 'Resolution Status: N/A';
                    resolutionStatusDisplay.className = 'status-display';
                }, 500); // Wait for fade-out
                displayMessage('Results cleared.', 'info');
            }

            // --- MAIN CALCULATION FUNCTION ---
            function calculateResolution() {
                resultTableBody.innerHTML = '';
                stepsContainer.innerHTML = '';
                stepsContainer.classList.remove('active');
                recommendationsList.innerHTML = '';
                practicalRecommendationsDiv.style.display = 'none';
                resolutionStatusDisplay.textContent = 'Resolution Status: Calculating...';
                resolutionStatusDisplay.className = 'status-display';
                
                let stepHtml = '';

                try {
                    // --- 1. Parse Inputs & Validate ---
                    const minInputValueVal = parseFloat(minInputValue.value);
                    const maxInputValueVal = parseFloat(maxInputValue.value);
                    const inputType = inputTypeSelect.value;
                    const shuntResistor = parseFloat(shuntResistorInput.value);
                    const signalNoise = parseFloat(signalNoiseInput.value);
                    const noiseUnit = noiseUnitSelect.value;
                    const calculationMode = calculationModeSelect.value;

                    if (isNaN(minInputValueVal) || isNaN(maxInputValueVal)) throw new Error('Please enter valid numerical values for Input Range.');
                    if (maxInputValueVal <= minInputValueVal) throw new Error('Maximum Input Value must be greater than Minimum Input Value.');
                    if (inputType === 'current' && (isNaN(shuntResistor) || shuntResistor <= 0)) throw new Error('Shunt Resistor is required for Current input and must be a positive value.');
                    if (isNaN(signalNoise) || signalNoise < 0) throw new Error('Signal Noise must be a non-negative numerical value.');
                    
                    stepHtml += `<div class="step-card">
                        <h4><span class="number">1</span>Input Parameters</h4>
                        <div class="step-content">
                            <div class="step-explanation">
                                <strong>Input Signal:</strong> ${minInputValueVal} to ${maxInputValueVal} ${inputType === 'current' ? 'mA' : 'V'}<br>
                                <strong>Calc. Mode:</strong> ${calculationMode === 'bits-to-resolution' ? 'From Bits' : 'From Resolution'}<br>
                                ${inputType === 'current' ? `<strong>Shunt Resistor:</strong> ${shuntResistor} Ω<br>` : ''}
                            </div>
                            <div class="step-explanation">
                                <strong>Signal Noise:</strong> ${signalNoise} ${noiseUnit} (RMS)
                            </div>
                        </div>
                    </div>`;

                    // --- 2. Determine Voltage Range (V_range) ---
                    let minVoltage, maxVoltage;
                    stepHtml += `<div class="step-card math-content">
                                 <h4><span class="number">2</span>Determine Input Voltage Range (V<sub>range</sub>)</h4>`;
                    
                    if (inputType === 'current') {
                        minVoltage = minInputValueVal * (shuntResistor / 1000); // mA to A, then V
                        maxVoltage = maxInputValueVal * (shuntResistor / 1000); // mA to A, then V
                        stepHtml += `<div class="step-explanation"><p>Converting current range to voltage range using $R_{shunt}$:</p>
                            <div class="formula-block">
                                <p class="formula">$$V_{min} = I_{min} \\times R_{shunt} = ${minInputValueVal} \\text{ mA} \\times ${shuntResistor} \\Omega = ${minVoltage.toFixed(4)} \\text{ V}$$</p>
                                <p class="formula">$$V_{max} = I_{max} \\times R_{shunt} = ${maxInputValueVal} \\text{ mA} \\times ${shuntResistor} \\Omega = ${maxVoltage.toFixed(4)} \\text{ V}$$</p>
                            </div></div>`;
                    } else { // Voltage input
                        minVoltage = minInputValueVal;
                        maxVoltage = maxInputValueVal;
                        stepHtml += `<div class="step-explanation"><p>Input is already in voltage:</p>
                            <div class="formula-block">
                                <p class="formula">$$V_{min} = ${minVoltage.toFixed(4)} \\text{ V}$$</p>
                                <p class="formula">$$V_{max} = ${maxVoltage.toFixed(4)} \\text{ V}$$</p>
                            </div></div>`;
                    }
                    const V_range = maxVoltage - minVoltage;
                    stepHtml += `<div class="step-explanation"><p>Calculating the total voltage span:</p>
                        <div class="formula-block">
                            <p class="formula">$$V_{range} = V_{max} - V_{min} = ${maxVoltage.toFixed(4)} \\text{ V} - ${minVoltage.toFixed(4)} \\text{ V}$$</p>
                            <p class="formula">$$V_{range} = ${V_range.toFixed(4)} \\text{ V}$$</p>
                        </div></div></div>`;

                    // --- 3. Calculate Theoretical Resolution ---
                    let numBits, resolutionPerBit, quantizationError;
                    
                    if (calculationMode === 'bits-to-resolution') {
                        numBits = parseInt(numBitsInput.value);
                        if (isNaN(numBits) || numBits <= 0 || numBits > 32) throw new Error('Number of Bits must be a positive integer (e.g., 8, 10, 12, 16, 24) and less than or equal to 32.');
                        
                        stepHtml += `<div class="step-card math-content">
                                     <h4><span class="number">3</span>Calculate Theoretical Resolution (V<sub>res</sub>)</h4>
                                     <div class="step-explanation"><p>Using $N = ${numBits}$ bits:</p>
                                        <div class="formula-block">
                                            <p class="formula">$$Steps = 2^N = 2^{${numBits}} = ${Math.pow(2, numBits).toLocaleString()}$$</p>
                                            <p class="formula">$$V_{res} = \\frac{V_{range}}{2^N} = \\frac{${V_range.toFixed(4)} \\text{ V}}{${Math.pow(2, numBits).toLocaleString()}}$$</p>
                                            <p class="formula">$$V_{res} = ${ (V_range / Math.pow(2, numBits)).toExponential(4)} \\text{ V/bit}$$</p>
                                        </div>
                                     </div>`;
                        
                        resolutionPerBit = V_range / Math.pow(2, numBits);
                        quantizationError = resolutionPerBit / 2;
                        
                        stepHtml += `<div class="step-explanation"><p>Quantization Error is half the resolution:</p>
                                        <div class="formula-block">
                                            <p class="formula">$$Q_{err} = \\frac{V_{res}}{2} = ${quantizationError.toExponential(4)} \\text{ V}$$</p>
                                        </div>
                                     </div></div>`;

                    } else { // resolution-to-bits
                        const desiredResolution = parseFloat(desiredResolutionInput.value);
                        if (isNaN(desiredResolution) || desiredResolution <= 0 || desiredResolution >= V_range) throw new Error('Desired Voltage Resolution must be a positive value and less than the Input Voltage Range.');
                        
                        stepHtml += `<div class="step-card math-content">
                                     <h4><span class="number">3</span>Calculate Required Bits (N)</h4>
                                     <div class="step-explanation"><p>Using $V_{res, desired} = ${desiredResolution.toExponential(4)}$ V:</p>
                                        <div class="formula-block">
                                            <p class="formula">$$N = \\lceil \\log_2(\\frac{V_{range}}{V_{res, desired}}) \\rceil$$</p>
                                            <p class="formula">$$N = \\lceil \\log_2(\\frac{${V_range.toFixed(4)}}{${desiredResolution.toExponential(4)}}) \\rceil = \\lceil ${Math.log2(V_range / desiredResolution).toFixed(2)} \\rceil$$</p>
                                        </div>
                                     </div>`;
                        
                        numBits = Math.ceil(Math.log2(V_range / desiredResolution));
                        if (numBits > 32) {
                             displayMessage(`Required bits (${numBits}) is very high. Capping at 32.`, 'warning');
                             numBits = 32;
                        }
                        if (numBits <= 0) throw new Error('Calculated bits are too low. Check desired resolution and input range.');
                        
                        stepHtml += `<div class="step-explanation"><p>Required theoretical bits (N):</p>
                                        <div class="step-value" style="font-size: 1.5rem; color: var(--heading);">${numBits} bits</div>
                                     </div></div>`;
                        
                        // Now calculate the *actual* resolution with this bit number
                        resolutionPerBit = V_range / Math.pow(2, numBits);
                        quantizationError = resolutionPerBit / 2;
                        
                        stepHtml += `<div class="step-card math-content">
                                     <h4><span class="number">4</span>Calculate Actual Resolution</h4>
                                     <div class="step-explanation"><p>Actual resolution with $N = ${numBits}$ bits:</p>
                                        <div class="formula-block">
                                            <p class="formula">$$V_{res, actual} = \\frac{${V_range.toFixed(4)} \\text{ V}}{2^{${numBits}}} = ${resolutionPerBit.toExponential(4)} \\text{ V/bit}$$</p>
                                            <p class="formula">$$Q_{err, actual} = \\frac{V_{res, actual}}{2} = ${quantizationError.toExponential(4)} \\text{ V}$$</p>
                                        </div>
                                     </div>
                                     </div>`;
                    }
                    
                    // --- 4. Calculate Noise & ENOB ---
                    let V_noise_rms, SNR_db, ENOB, noiseLimitedResolution;
                    const noiseConversion = convertNoiseToVoltsRMS(signalNoise, noiseUnit, (inputType === 'current' ? shuntResistor : 1));
                    V_noise_rms = noiseConversion.noiseInVolts;

                    stepHtml += `<div class="step-card math-content">
                                 <h4><span class="number">5</span>Calculate Noise & Effective Bits (ENOB)</h4>
                                 <div class="step-explanation"><p>Convert input noise to Volts (RMS):</p>
                                    <div class="formula-block">${noiseConversion.conversionStep}</div>
                                 </div>`;
                    
                    if (V_noise_rms <= 0) {
                        displayMessage('Noise is zero. ENOB will equal theoretical bits.', 'info');
                        SNR_db = Infinity;
                        ENOB = numBits;
                        noiseLimitedResolution = resolutionPerBit;
                        stepHtml += `<div class="step-explanation"><p>Signal Noise is zero. Assuming ideal noise-free scenario:</p>
                                        <div class="formula-block">
                                            <p class="formula">$$SNR = \\infty \\text{ dB}$$</p>
                                            <p class="formula">$$ENOB = N = ${numBits} \\text{ bits}$$</p>
                                        </div>
                                     </div></div>`;
                    } else {
                        SNR_db = 20 * Math.log10(V_range / V_noise_rms);
                        ENOB = (SNR_db - 1.76) / 6.02;
                        if(ENOB > numBits) ENOB = numBits; // ENOB cannot be higher than theoretical bits
                        if(ENOB < 0) ENOB = 0;
                        
                        noiseLimitedResolution = V_range / Math.pow(2, ENOB);

                        stepHtml += `<div class="step-explanation"><p>Calculate SNR and ENOB:</p>
                                        <div class="formula-block">
                                            <p class="formula">$$SNR_{dB} = 20 \\log_{10}(\\frac{V_{range}}{V_{noise\\_rms}})$$</p>
                                            <p class="formula">$$SNR_{dB} = 20 \\log_{10}(\\frac{${V_range.toFixed(4)}}{${V_noise_rms.toExponential(4)}}) = ${SNR_db.toFixed(2)} \\text{ dB}$$</p>
                                            <p class="formula">$$ENOB = \\frac{SNR_{dB} - 1.76}{6.02}$$</p>
                                            <p class="formula">$$ENOB = \\frac{${SNR_db.toFixed(2)} - 1.76}{6.02} = ${ENOB.toFixed(2)} \\text{ bits}$$</p>
                                        </div>
                                     </div></div>`;
                        
                        stepHtml += `<div class="step-card math-content">
                                     <h4><span class="number">6</span>Calculate Noise-Limited Resolution</h4>
                                     <div class="step-explanation"><p>This is the smallest change you can *realistically* detect, limited by noise, not bits.</p>
                                        <div class="formula-block">
                                            <p class="formula">$$V_{res, effective} = \\frac{V_{range}}{2^{ENOB}}$$</p>
                                            <p class="formula">$$V_{res, effective} = \\frac{${V_range.toFixed(4)} \\text{ V}}{2^{${ENOB.toFixed(2)}}} = ${noiseLimitedResolution.toExponential(4)} \\text{ V/bit}$$</p>
                                        </div>
                                     </div>
                                     </div>`;
                    }
                    
                    // --- Display Results ---
                    stepsContainer.innerHTML = stepHtml;
                    stepsContainer.classList.add('active');
                    
                    // Display Results in table
                    const results = [
                        { param: 'Input Signal Range', value: `${minInputValueVal} to ${maxInputValueVal} ${inputType === 'current' ? 'mA' : 'V'}` },
                        { param: 'Shunt Resistor (R<sub>shunt</sub>)', value: inputType === 'current' ? `${shuntResistor} Ω` : 'N/A' },
                        { param: 'Input Voltage Range (V<sub>range</sub>)', value: `${V_range.toFixed(4)} V` },
                        { param: 'Signal Noise (V<sub>noise,rms</sub>)', value: `${V_noise_rms.toExponential(4)} V` },
                        { param: '<strong>Theoretical Number of Bits (N)</strong>', value: `<strong>${numBits} bits</strong>` },
                        { param: '<strong>Theoretical Resolution (V/bit)</strong>', value: `<strong>${resolutionPerBit.toExponential(4)} V/bit</strong>` },
                        { param: 'Theoretical Quantization Error', value: `${quantizationError.toExponential(4)} V` },
                        { param: 'Signal-to-Noise Ratio (SNR)', value: `${SNR_db.toFixed(2)} dB` },
                        { param: '<strong>Effective Number of Bits (ENOB)</strong>', value: `<strong>${ENOB.toFixed(2)} bits</strong>` },
                        { param: '<strong>Noise-Limited Resolution</strong>', value: `<strong>${noiseLimitedResolution.toExponential(4)} V/bit</strong>` }
                    ];

                    results.forEach(res => {
                        const row = resultTableBody.insertRow();
                        paramCell = row.insertCell(0);
                        valueCell = row.insertCell(1);
                        paramCell.innerHTML = res.param;
                        valueCell.innerHTML = res.value;
                    });

                    // Update Status Display and Recommendations
                    let statusText = 'Resolution Status: ';
                    let statusClass = 'status-display ';
                    let recommendations = [];

                    if (ENOB >= 20) {
                        statusText += 'Optimal (High Precision)';
                        statusClass += 'optimal';
                        recommendations.push("Effective resolution is optimal for high-precision applications. Focus on maintaining low noise.");
                        recommendations.push("Ensure your sensor and signal conditioning chain can fully utilize this high resolution.");
                    } else if (ENOB >= 16) {
                        statusText += 'Sufficient (Good Precision)';
                        statusClass += 'sufficient';
                        recommendations.push("Effective resolution is good for most industrial process control and data acquisition.");
                        recommendations.push("Pay attention to proper grounding, shielding, and power supply filtering.");
                    } else if (ENOB >= 12) {
                        statusText += 'Adequate (Standard Industrial)';
                        statusClass += 'adequate';
                        recommendations.push("Resolution is adequate for many standard industrial applications (e.g., typical PLC analog inputs).");
                        recommendations.push("Consider noise reduction if ENOB is significantly lower than theoretical bits.");
                    } else if (ENOB >= 8) {
                        statusText += 'Marginal (Basic Monitoring)';
                        statusClass += 'marginal';
                        recommendations.push("Effective resolution is marginal for precise measurements. May be suitable for basic monitoring only.");
                        recommendations.push("Strongly recommend investigating noise sources and implementing noise reduction (e.g., shielding, filtering).");
                    } else { // ENOB < 8
                        statusText += 'Insufficient (Low Precision)';
                        statusClass += 'insufficient';
                        recommendations.push("Effective resolution is insufficient for most industrial applications. Significant data loss due to noise is expected.");
                        recommendations.push("Immediate action is required: Identify and eliminate major noise sources.");
                        recommendations.push("Consider a higher resolution ADC (e.g., Delta-Sigma) and robust analog filtering.");
                    }
                    
                    if (ENOB < (numBits - 2)) {
                        recommendations.push(`<strong>Warning:</strong> Your Effective Number of Bits (${ENOB.toFixed(1)}) is significantly lower than your Theoretical Bits (${numBits}). This indicates that system noise, not the ADC, is your primary limitation. Your expensive ADC is being underutilized.`);
                    }

                    recommendationsList.innerHTML = '';
                    recommendations.forEach(rec => {
                        const li = document.createElement('li');
                        li.innerHTML = rec;
                        recommendationsList.appendChild(li);
                    });
                    practicalRecommendationsDiv.style.display = 'block';

                    resolutionStatusDisplay.textContent = statusText;
                    resolutionStatusDisplay.className = statusClass;

                    resultContainer.style.display = 'block';
                    setTimeout(() => {
                        resultContainer.classList.add('show');
                        displayMessage('Calculation successful!', 'success');
                    }, 100);
                    
                    // NEW: Typeset MathJax
                    if (window.MathJax && typeof window.MathJax.typesetPromise === 'function') {
                        setTimeout(() => {
                            window.MathJax.typesetPromise([stepsContainer]);
                        }, 50);
                    }

                } catch (error) {
                    displayMessage(error.message, 'error');
                    resultContainer.style.display = 'none';
                    resultContainer.classList.remove('show');
                }
            }

            // --- Theme switch logic (from provided file) ---
            const themeSwitch = document.getElementById('theme-switch');
            if (themeSwitch) {
                if (localStorage.getItem('theme') === 'dark') {
                    document.body.classList.add('dark-mode');
                    themeSwitch.checked = true;
                }
                themeSwitch.addEventListener('change', function() {
                    if (this.checked) {
                        document.body.classList.add('dark-mode');
                        localStorage.setItem('theme', 'dark');
                    } else {
                        document.body.classList.remove('dark-mode');
                        localStorage.setItem('theme', 'light');
                    }
                });
            }
        });
    </script>
</body>
</html>
