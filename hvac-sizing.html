<!DOCTYPE html><html lang="en"><head>  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5936527763614780"     crossorigin="anonymous"></script>                <!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-23Y1V450SR"></script><script>    window.dataLayer = window.dataLayer || [];    function gtag(){dataLayer.push(arguments);}    gtag('js', new Date());
    gtag('config', 'G-23Y1V450SR');      </script>  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5936527763614780"     crossorigin="anonymous"></script>    <meta charset="UTF-8">    <meta name="viewport" content="width=device-width, initial-scale=1.0">    <title>HVAC Sizing - Design Calculators - Electrical</title>  <link rel="canonical" href="https://designcalculators.co.in/hvac-sizing.html" />  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="manifest" href="/site.webmanifest"><link rel="icon" href="/favicon.ico" type="image/x-icon">
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Montserrat:wght@700;800;900&display=swap" rel="stylesheet">
    
    <!-- MathJax for LaTeX rendering -->    <script type="text/javascript" id="MathJax-script" async      src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">    </script>
    <style>
        /* STYLES FROM 'perfect.txt' FOR HEADER/FOOTER/THEME */
        :root {
            --primary: #1E3A8A;
            --secondary: #2563EB;
            --accent: #F59E0B;
            --success: #10B981;
            --danger: #DC2626;
            --warning: #F59E0B;
            --bg: #F8FAFC;
            --card: #FFFFFF;
            --text: #4B5563;
            --heading: #111827;
            --footer-bg: #0F172A;
            --border: #E2E8F0;
            --grad: linear-gradient(135deg, var(--primary), var(--secondary));
            --grad-dark: linear-gradient(135deg, #0F172A, #1E293B);
            --shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
            --shadow-lg: 0 10px 20px rgba(0, 0, 0, 0.1);

            /* Adding original file's colors for compatibility with calculator styles */
            --primary-color: #1E3A8A; /* Mapped to new primary */
            --secondary-color: #2563EB; /* Mapped to new secondary */
            --bg-color: #F8FAFC;
            --card-bg: #FFFFFF;
            --text-color: #4B5563;
            --border-color: #E2E8F0;
            --card-shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
            --hover-color: #f1f5f9; /* New hover color */
        }

        body.dark-mode {
            --primary: #10B981;
            --secondary: #34D399;
            --bg: #0F172A;
            --card: #1E293B;
            --text: #CBD5E1;
            --heading: #F1F5F9;
            --footer-bg: #020617;
            --border: #334155;

            /* Dark mode compatibility */
            --primary-color: #10B981;
            --secondary-color: #34D399;
            --bg-color: #0F172A;
            --card-bg: #1E293B;
            --text-color: #CBD5E1;
            --border-color: #334155;
            --hover-color: #334155;
        }

        * { box-sizing: border-box; }
        html { scroll-behavior: smooth; }
        
        /* General Body Styling */
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg);
            color: var(--text);
            line-height: 1.6;
            margin: 0;
            padding: 0;
            transition: background-color 0.3s, color 0.3s;
        }
        .container {
            max-width: 1280px;
            margin: 0 auto;
            padding: 0 24px;
        }

        /* Header & Nav */
        header {
            background: var(--grad);
            color: white;
            padding: 24px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .logo-container {
            display: flex;
            flex-direction: column;
            text-decoration: none;
            color: white;
        }
        .logo-text {
            font-size: 1.75rem;
            font-weight: 800;
            font-family: 'Montserrat', sans-serif;
        }
        .logo-subtitle {
            font-size: 0.8rem;
            margin: 4px 0 0 0;
            color: #E0E7FF;
            opacity: 0.9;
        }
        .nav-links {
            display: flex;
            gap: 24px;
            list-style: none;
            margin: 0;
            padding: 0;
        }
        .nav-links a {
            color: white;
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s;
        }
        .nav-links a:hover { color: var(--accent); }
        .theme-toggle {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .switch {
            position: relative;
            display: inline-block;
            width: 56px;
            height: 30px;
        }
        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0,0,0,0.2);
            transition: .4s;
            border-radius: 30px;
        }
        .slider:before {
            position: absolute;
            content: "";
            height: 22px;
            width: 22px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        input:checked + .slider {
            background-color: var(--accent);
        }
        input:checked + .slider:before {
            transform: translateX(26px);
        }

        /* Main Content & Cards */
        main { padding: 40px 0; }
        .tool-container, .card {
            background: var(--card);
            border-radius: 12px;
            padding: 30px;
            box-shadow: var(--shadow);
            margin-bottom: 30px;
            border: 1px solid var(--border);
        }

        /* Styles from original file, adapted for new theme */
        .tool-container h2 {
            color: var(--primary);
            border-bottom: 3px solid var(--primary);
            padding-bottom: 15px;
            margin-top: 0;
            font-family: 'Montserrat', sans-serif;
            font-size: 1.8rem;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .tool-description {
            margin-bottom: 20px;
            color: var(--text-color);
        }
        .back-button {
            display: inline-block;
            background: var(--grad);
            color: white;
            padding: 10px 20px;
            border-radius: 8px;
            text-decoration: none;
            margin-bottom: 20px;
            transition: all 0.3s;
            font-weight: 600;
            box-shadow: var(--shadow);
        }
        .back-button:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-lg);
        }
        
        /* Footer Styling */
        footer {
            background: var(--grad-dark);
            color: #CBD5E1;
            padding: 50px 0 20px 0;
            margin-top: 60px;
        }
        .footer-content {
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 40px;
            margin-bottom: 30px;
        }
        .footer-col {
            flex: 1;
            min-width: 200px;
        }
        .footer-col h4 {
            color: white;
            margin-bottom: 15px;
            font-weight: 700;
        }
        .footer-col ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        .footer-col a {
            color: #CBD5E1;
            text-decoration: none;
            transition: color 0.3s;
        }
        .footer-col a:hover {
            color: var(--accent);
        }
        .social-buttons {
            display: flex;
            gap: 12px;
            margin-top: 15px;
        }
        .social-btn {
            width: 40px;
            height: 40px;
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            border-radius: 50%;
            font-size: 1.1rem;
            transition: transform 0.3s;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        .social-btn:hover {
            transform: translateY(-4px);
        }
        .social-btn.linkedin { background-color: #0A66C2; }
        .social-btn.youtube { background-color: #FF0000; }
        .social-btn.twitter { background-color: #1DA1F2; }
        .social-btn.facebook { background-color: #1877F2; }
        .social-btn.whatsapp { background-color: #25D366; }

        .footer-disclaimer {
            text-align: center;
            padding-top: 25px;
            border-top: 1px solid #334155;
            max-width: 800px;
            margin: 0 auto;
            font-size: 0.9rem;
        }
        .footer-bottom {
            text-align: center;
            padding-top: 20px;
            font-size: 0.9rem;
            color: #94A3B8;
        }
        
        /* Styles for Calculator Forms and Results (Adapted) */
        .calculator-form {
            background-color: var(--card-bg);
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
        }                
        .form-section {
            background-color: var(--bg);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 25px;
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.05);
            opacity: 0;
            transform: translateY(10px);
            transition: opacity 0.5s ease-out, transform 0.5s ease-out;
        }
        .form-section.fade-in {
            opacity: 1;
            transform: translateY(0);
        }
        .form-section h3 {
            color: var(--heading);
            font-family: 'Montserrat', sans-serif;
            font-size: 1.5rem;
            margin-top: 0;
            margin-bottom: 15px;
            border-bottom: 1px dashed var(--border);
            padding-bottom: 10px;
        }
        .form-group {
            margin-bottom: 15px;
        }                
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--heading);
        }                
        .form-group input, .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--border);
            border-radius: 6px;
            background-color: var(--bg);
            color: var(--text);
            font-size: 1rem;
            box-sizing: border-box;
            transition: border-color 0.3s, box-shadow 0.3s;
        }                
        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 0;
        }                
        .calculate-btn, .btn {
            background: var(--grad);
            color: white;
            border: none;
            padding: 16px 30px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: 700;
            box-shadow: 0 4px 12px rgba(30, 58, 138, 0.3);
            transition: all 0.3s;
            width: auto;
            min-width: 220px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }                
        .calculate-btn:hover, .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(30, 58, 138, 0.4);
        }                
        .result-container {
            margin-top: 30px;
            padding: 30px;
            border-radius: 12px;
            background-color: var(--card-bg);
            border: 1px solid var(--border);
            box-shadow: var(--shadow);
            display: none;
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.5s ease-in-out, transform 0.5s ease-in-out;
        }                
        .result-container.show {
            opacity: 1;
            transform: translateY(0);
        }
        .result-container h3 {
            color: var(--primary);
            margin-bottom: 15px;
            text-align: center;
            font-family: 'Montserrat', sans-serif;
            font-size: 1.8rem;
        }                
        .result-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            border-radius: 8px;
            overflow: hidden; /* Ensures rounded corners apply to table content */
            box-shadow: var(--shadow);
        }                
        .result-table th, .result-table td {
            padding: 16px;
            text-align: left;
            border-bottom: 1px solid var(--border);
        }                
        .result-table th {
            background: var(--grad);
            color: white;
            font-weight: 700;
        }
        .result-table tr:nth-child(even) {
            background-color: var(--bg);
        }
        .result-table tr:last-child td {
            border-bottom: none; /* No border for the last row */
        }
        .result-table tbody tr:hover {
            background-color: var(--hover-color); /* Highlight row on hover */
        }                
        .standard-reference {
            margin-top: 20px;
            font-style: italic;
            font-size: 0.9rem;
            color: var(--text-color);
            padding: 15px;
            border-left: 4px solid var(--primary);
            background-color: var(--bg);
            border-radius: 4px;
        }                
        .info-icon {
            color: var(--primary);
            margin-left: 5px;
            cursor: help;
            transition: color 0.3s;
        }
        .info-icon:hover {
            color: var(--accent);
        }                
        .tooltip {
            position: relative;
            display: inline-block;
        }                
        .tooltip .tooltiptext {
            visibility: hidden;
            width: 200px;
            background-color: #333;
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 8px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -100px;
            opacity: 0;
            transition: opacity 0.3s, transform 0.3s;
            transform: translateY(10px);
            font-size: 0.85em;
        }                
        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
            transform: translateY(0);
        }
        /* Custom message box style */
        #custom-message-box {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            padding: 16px 28px;
            border-radius: 8px;
            box-shadow: 0 6px 16px rgba(0,0,0,0.25);
            z-index: 10000;
            font-weight: 600;
            color: white;
            opacity: 0;
            transition: all 0.4s;
            display: none;
        }
        #custom-message-box.show {
            display: block;
            opacity: 1;
            top: 30px;
        }
        #custom-message-box.success { background-color: var(--success); }
        #custom-message-box.error { background-color: var(--danger); }
        #custom-message-box.warning { background-color: var(--warning); color: #333; }
        #custom-message-box.info { background-color: var(--secondary); }

        /* Styles for calculation details */
        #calculation-details {
            background-color: var(--bg);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 25px;
            font-size: 0.95em;
            color: var(--text-color);
            box-shadow: inset 0 2px 5px rgba(0,0,0,0.05);
        }        
        #calculation-details h4 {
            color: var(--heading);
            margin-top: 0;
            margin-bottom: 15px;
            text-align: center;
            font-size: 1.4rem;
            font-family: 'Montserrat', sans-serif;
        }        
        #calculation-details p.formula {
            font-family: 'Courier New', monospace;
            font-style: italic;
            font-size: 1.1em;
            text-align: center;
            padding: 12px 10px;
            background-color: var(--hover-color);
            border-radius: 6px;
            margin: 15px 0;
            overflow-x: auto;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }        
        #calculation-details p.calculation-step {
            font-family: 'Courier New', monospace;
            background-color: var(--hover-color);
            padding: 8px 15px;
            border-radius: 4px;
            margin-bottom: 8px;
            color: var(--text-color);
            white-space: pre-wrap;
            word-break: break-word;
        }        
        #calculation-details ul {
            list-style-type: disc;
            margin-left: 25px;
            padding-left: 0;
            margin-top: 15px;
        }        
        #calculation-details ul li {
            margin-bottom: 8px;
            color: var(--text-color);
        }
        .button-wrapper {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 15px;
            width: 100%;
            padding-top: 20px;
        }
        /* Animation for input fields on focus */
        .form-group input:focus, .form-group select:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(30, 58, 138, 0.1);
            outline: none;
        }
        body.dark-mode .form-group input:focus, body.dark-mode .form-group select:focus {
             box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1);
        }

        /* Styles for dynamically added UPS units */
        .ups-unit {
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            background-color: var(--card-bg);
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            position: relative;
            transition: all 0.3s ease-in-out;
            animation: fadeInScale 0.3s ease-out;
        }
        .ups-unit:hover {
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            transform: translateY(-2px);
        }
        .ups-unit h4 {
            margin-top: 0;
            margin-bottom: 10px;
            color: var(--primary);
            font-size: 1.1em;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .remove-unit-btn {
            background-color: var(--danger);
            color: white;
            border: none;
            border-radius: 4px;
            padding: 5px 10px;
            cursor: pointer;
            font-size: 0.8em;
            transition: background-color 0.3s, transform 0.2s;
        }
        .remove-unit-btn:hover {
            background-color: #b91c1c; /* Darker red */
            transform: scale(1.05);
        }
        .add-unit-btn {
            background-color: var(--secondary);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 10px 15px;
            cursor: pointer;
            font-size: 1rem;
            margin-top: 10px;
            transition: all 0.3s;
            display: block;
            width: fit-content;
            margin-left: auto;
            margin-right: auto;
            font-weight: 600;
        }
        .add-unit-btn.btn.accent {
            background: var(--accent);
            box-shadow: 0 4px 12px rgba(245, 158, 11, 0.3);
        }
        .add-unit-btn:hover {
            background-color: var(--primary);
            transform: scale(1.02) translateY(-2px);
        }
        /* Animation for new unit addition */
        @keyframes fadeInScale {
            from {
                opacity: 0;
                transform: scale(0.95);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }
        .hidden {
            display: none;
        }
        /* Unit Selector Styling */
        .unit-selector {
            text-align: right;
            margin-bottom: 15px;
            color: var(--text-color);
        }        
        .unit-selector label {
            font-weight: bold;
            margin-right: 10px;
        }        
        .unit-selector select {
            padding: 8px 12px;
            border-radius: 6px;
            border: 2px solid var(--border);
            background-color: var(--card-bg);
            color: var(--text-color);
            transition: border-color 0.3s, box-shadow 0.3s;
        }        
        .unit-selector select:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(30, 58, 138, 0.1);
            outline: none;
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .container { padding: 0 15px; }
            .navbar { flex-direction: column; gap: 20px; }
            .nav-links { flex-direction: column; gap: 12px; text-align: center; }
            .form-row { grid-template-columns: 1fr; }
            .tool-container, .card { padding: 20px; }
            .footer-content { flex-direction: column; gap: 25px; }
            .button-wrapper { flex-direction: column; }
            .calculate-btn, .add-unit-btn { width: 100%; }
        }
    </style>
    <link rel="stylesheet" href="styles.css">
    <meta property="og:title" content="HVAC Sizing - Design Calculators - Electrical">
    <meta property="og:description" content="HVAC Sizing - Design Calculators - Electrical - Free professional engineering calculator by Design Calculators.">
    <meta name="description" content="HVAC sizing calculator for heating, ventilation, and air conditioning systems. Calculate cooling/heating loads, duct sizing, and equipment capacity per ASHRAE standards.">
</head>
<body>
    <div id="message-box" class="message-box"></div>

    <!-- NEW HEADER FROM perfect.txt -->
    <header class="header">
        <div class="header-bg-animation"></div>
        <div class="container">
            <nav class="navbar">
                <a href="/" class="logo-container">
                    <img src="logo.png" alt="Design Calculators Logo" class="logo">
                    <span class="logo-text">Design Calculators</span>
                </a>

                <div class="nav-menu">
                    <button class="mobile-menu-toggle" aria-label="Toggle menu">
                        <i class="fas fa-bars"></i>
                    </button>

                    <ul class="nav-links">
                        <li><a href="/index.html">Home</a></li>
                        
    <li class="dropdown">
        <a href="/indexele.html" class="dropdown-toggle">Electrical <i class="fas fa-chevron-down" style="font-size: 0.7em; margin-left: 4px;"></i></a>
        <div class="dropdown-menu">
            <div class="repo-grid"><div><a href="/arcflash.html">Arc Flash Calculator</a><a href="/breaker-sizing.html">Breaker Sizing</a><a href="/cable-thermal-rating.html">Cable Ampacity</a><a href="/comm-cable-loss.html">Comm Cable Loss</a><a href="/earth-conductor-size.html">Earth Conductor Size</a><a href="/generatorsizing.html">Generator Sizing</a><a href="/harmonicsanalyser.html">Harmonics Analyser</a><a href="/insulationresistance.html">Insulation Resistance</a><a href="/logicgate.html">Logic Gates Simulator</a><a href="/motor-starting.html">Motor Starting Current</a><a href="/pcbtrace.html">PCB Trace Width</a><a href="/protection-device.html">Protection Device</a><a href="/resistor.html">Resistor Color Code</a><a href="/solarcable.html">Solar Cable Sizing</a><a href="/systemxrcalculator.html">System X/R Ratio</a><a href="/transmissionline.html">Transmission Line</a><a href="/vfd-selection.html">VFD Selection Tool</a></div><div><a href="/batterylife.html">Battery Life Estimator</a><a href="/busbarampacity.html">Busbar Ampacity</a><a href="/cablepulling.html">Cable Pulling Tension</a><a href="/conduit-fill.html">Conduit Fill Calculator</a><a href="/earthingfaultsimulator.html">Earthing Fault Simulator</a><a href="/grounding.html">Grounding System Design</a><a href="/hvac-sizing.html">HVAC Sizing Calculator</a><a href="/lcresonancecalculator.html">LC Resonance Calculator</a><a href="/maintenance-guide.html">Maintenance Guide</a><a href="/nemaipconvertor.html">NEMA to IP Converter</a><a href="/power-factor.html">Power Factor Correction</a><a href="/relay-coordination.html">Relay Coordination</a><a href="/short-circuit.html">Short Circuit Current</a><a href="/solarpvarray.html">Solar PV Array</a><a href="/transformer-calculator.html">Transformer Calculator</a><a href="/unit-converter.html">Unit Converter</a><a href="/voltage-drop.html">Voltage Drop Calculator</a></div><div><a href="/battery-sizing.html">Battery Sizing (AH)</a><a href="/busbarshortcircuit.html">Busbar Short Circuit</a><a href="/cable-sizing.html">Cable Sizing Calculator</a><a href="/ctsaturation.html">CT Saturation</a><a href="/equipment-relay.html">Equipment Relay Setting</a><a href="/harmonic-distortion.html">Harmonic Distortion</a><a href="/industriallighting.html">Industrial Lighting</a><a href="/lighting-calulator.html">Lighting Calculator</a><a href="/motor-efficiency.html">Motor Efficiency</a><a href="/neutral-earth-fault-current.html">Neutral Earth Fault</a><a href="/powertriangletool.html">Power Triangle</a><a href="/electricalresidentialload.html">Residential Load Calc</a><a href="/skindepth.html">Skin Depth Calculator</a><a href="/symmetricalcomponents.html">Symmetrical Components</a><a href="/transformerinrush.html">Transformer Inrush</a><a href="/ups-sizing.html">UPS Sizing</a></div>
            </div>
            <div class="view-all-container">
                <a href="/indexele.html" class="view-all-link">View All Electrical Tools â†’</a>
            </div>
        </div>
    </li>
                        
    <li class="dropdown">
        <a href="/indexinst.html" class="dropdown-toggle">Instrumentation <i class="fas fa-chevron-down" style="font-size: 0.7em; margin-left: 4px;"></i></a>
        <div class="dropdown-menu">
            <div class="repo-grid"><div><a href="/adc-resolution.html">ADC Resolution</a><a href="/capillarylengthtemperatureerror.html">Capillary Error</a><a href="/cv-kv-valve.html">Cv/Kv Valve Sizing</a><a href="/dp-level.html">DP Level Measurement</a><a href="/hydrostatic-level.html">Hydrostatic Level</a><a href="/instrument-range.html">Instrument Range</a><a href="/loop-impedance.html">Loop Impedance</a><a href="/orifice-plate.html">Orifice Plate Beta</a><a href="/pid-tuning.html">PID Tuning</a><a href="/profibus.html">Profibus Calculator</a><a href="/tempsensorresponse.html">Response Time (Tau)</a><a href="/rtd-lead-comp.html">RTD Lead Wire Comp.</a><a href="/sealfluidzeroshift.html">Seal Fluid Shift</a><a href="/snr-calculator.html">SNR Calculator</a><a href="/thermocoupleextensioncable.html">TC Extension Cable</a><a href="/thermowellwakefreq.html">Thermowell Frequency</a><a href="/pressuretransmitteroverrange.html">Tx Overrange</a><a href="/valvecavitationcalculator.html">Valve Cavitation</a><a href="/vibrationtransmitter.html">Vibration Tx</a><a href="/zoneclassificationhelper.html">Zone Classification</a></div><div><a href="/baud-rate.html">Baud Rate Calculator</a><a href="/gascompressibility.html">Compressibility (Z)</a><a href="/dbcalculator.html">dB Gain/Loss Calc</a><a href="/flowprofiledistortioncalculator.html">Flow Distortion</a><a href="/impulselinefreezing.html">Impulse Freezing</a><a href="/intrinsic-safety.html">Intrinsic Safety Loop</a><a href="/measurement.html">Measurement Uncertainty</a><a href="/ph-temp-comp.html">pH Temp Compensation</a><a href="/plcscantime.html">PLC Scan Time</a><a href="/pressurereliefvalve.html">PRV Sizing (API 520)</a><a href="/reynoldsnumbercal.html">Reynolds Number</a><a href="/rtdselfheating.html">RTD Self-Heating</a><a href="/signal-scaling.html">Signal Scaling</a><a href="/staticheadcal.html">Static Head</a><a href="/temperaturesensorlag.html">Temp Sensor Lag</a><a href="/thermowell-wake.html">Thermowell Wake</a><a href="/ultrasoniclevel.html">Ultrasonic Level</a><a href="/valve-cv.html">Valve Cv Viewer</a><a href="/wetlegdensitycompensation.html">Wet Leg Compensation</a></div><div><a href="/capacitance-level.html">Capacitance Level</a><a href="/controlvalvenoise.html">Control Valve Noise</a><a href="/dp-flow-conversion.html">DP Flow Conversion</a><a href="/hartdevices.html">HART Devices</a><a href="/impulse-pressure-drop.html">Impulse Pressure Drop</a><a href="/junctionbox.html">Junction Box Sizing</a><a href="/orifice-flow.html">Orifice Flow Calculator</a><a href="/pid-symbol-library.html">PID Symbol Library</a><a href="/power-supply-load.html">Power Supply Load</a><a href="/prvsizing.html">Relief Orifice Area</a><a href="/rtdexcitationcurrentselection.html">RTD Excitation</a><a href="/rtd-tc-conversion.html">RTD/TC Conversion</a><a href="/sil.html">SIL Calculator</a><a href="/steamflow.html">Steam Flow</a><a href="/thermocouplecjccalculator.html">Thermocouple CJC</a><a href="/turndown.html">Turndown Ratio</a><a href="/controlvalveauthority.html">Valve Authority</a><a href="/controlvalveleakage.html">Valve Leakage Class</a><a href="/wirelesshart.html">WirelessHART Range</a></div>
            </div>
            <div class="view-all-container">
                <a href="/indexinst.html" class="view-all-link">View All Instrumentation Tools â†’</a>
            </div>
        </div>
    </li>
                        
    <li class="dropdown">
        <a href="/indexmech.html" class="dropdown-toggle">Mechanical <i class="fas fa-chevron-down" style="font-size: 0.7em; margin-left: 4px;"></i></a>
        <div class="dropdown-menu">
            <div class="repo-grid"><div><a href="/aircompressorfad.html">Air Compressor FAD</a><a href="/asme-vessel.html">ASME Vessel Design</a><a href="/belt-pulley.html">Belt & Pulley</a><a href="/bolt-torque.html">Bolt Torque</a><a href="/controlvalveactuator.html">Control Valve Actuator</a><a href="/frictionfactortool.html">Darcy Friction Factor</a><a href="/fatigue.html">Fatigue Analysis</a><a href="/fuel-combustion.html">Fuel Combustion</a><a href="/gas.html">Gas Properties</a><a href="/heat-exchanger.html">Heat Exchanger</a><a href="/hydroliccylinder.html">Hydraulic Cylinder</a><a href="/material-compatibility.html">Material Compatibility</a><a href="/nozzle-reinforcement.html">Nozzle Reinforcement</a><a href="/openchannelflow.html">Open Channel Flow</a><a href="/pipescheduletool.html">Pipe Schedule & Stress</a><a href="/pump-head.html">Pump Head</a><a href="/shaft-power-torque.html">Shaft Power & Torque</a><a href="/steam-table.html">Steam Table</a><a href="/vibrationanalysis.html">Vibration Analysis</a></div><div><a href="/air-flow-duct.html">Air Flow Duct Sizing</a><a href="/beam-deflection.html">Beam Deflection</a><a href="/bernoulli-equation.html">Bernoulli Equation</a><a href="/chiller-capacity.html">Chiller Capacity</a><a href="/cooling-tower-sizing.html">Cooling Tower Sizing</a><a href="/darcy-weisbach.html">Darcy-Weisbach</a><a href="/finned-tube-heat-transfer.html">Finned Tube Heat</a><a href="/furnace-heat-duty.html">Furnace Heat Duty</a><a href="/gear-design.html">Gear Design</a><a href="/heat-loss-pipes.html">Heat Loss Pipes</a><a href="/jacketed-vessel-heat-transfer.html">Jacketed Vessel</a><a href="/metalweight.html">Metal Weight Calculator</a><a href="/nptbspthreadcalculator.html">NPT/BSP Threads</a><a href="/overall-heat-transfer.html">Overall Heat Transfer</a><a href="/pipe-stress-flexibility.html">Pipe Stress</a><a href="/pump-power.html">Pump Power</a><a href="/specific-heat-enthalpy.html">Specific Heat</a><a href="/storage-tank-volume.html">Storage Tank Volume</a><a href="/weldingstress.html">Welding Stress</a></div><div><a href="/allowable-stress-safety-factor.html">Allowable Stress</a><a href="/bearinglife.html">Bearing Life Calculator</a><a href="/boiler-efficiency.html">Boiler Efficiency</a><a href="/compressor-power.html">Compressor Power</a><a href="/corrosion-rate.html">Corrosion Rate</a><a href="/fan-laws.html">Fan Laws</a><a href="/foundation.html">Foundation Design</a><a href="/gas-laws.html">Gas Laws</a><a href="/hardness.html">Hardness Converter</a><a href="/conduction-convection-radiation.html">Heat Transfer Modes</a><a href="/machining.html">Machining Calculator</a><a href="/momentofinertia.html">Moment of Inertia</a><a href="/oring.html">O-Ring Sizing</a><a href="/pipe-flow.html">Pipe Flow Calculator</a><a href="/psychrometric.html">Psychrometric Calc</a><a href="/reynolds-number.html">Reynolds Number</a><a href="/spring.html">Spring Design</a><a href="/thermal-expansion.html">Thermal Expansion</a></div>
            </div>
            <div class="view-all-container">
                <a href="/indexmech.html" class="view-all-link">View All Mechanical Tools â†’</a>
            </div>
        </div>
    </li>
                        <li><a href="/index.html#articles">Articles</a></li>
                        <li><a href="/sitemap2.html">Site Map</a></li>
                    </ul>

                    <div class="theme-toggle">
                        <i class="fas fa-sun icon"></i>
                        <label class="switch">
                            <input type="checkbox" id="theme-switch">
                            <span class="slider"></span>
                        </label>
                        <i class="fas fa-moon icon"></i>
                    </div>
                </div>
            </nav>
    </header>

    <main class="container">
        <!-- Changed back-button to be in its own container for independent centering -->
        <div style="display: flex; justify-content: center; margin-bottom: 20px;">
            
        </div>                
        
        <div class="tool-container">
            <h2><i class="fas fa-thermometer-half" style="margin-right: 10px;"></i> HVAC Sizing Calculator for UPS/Inverter Rooms</h2>
                        
            <div class="tool-description">
                <p>This calculator helps determine the required cooling capacity (HVAC size) for rooms housing Uninterruptible Power Supplies (UPS) or Inverter Drives. It considers heat gains from equipment, lighting, occupants, building fabric, and solar radiation, following industry-standard principles outlined by organizations such as <a href="https://www.ashrae.org/" target="_blank">ASHRAE (American Society of Heating, Refrigerating and Air-Conditioning Engineers)</a>, <a href="https://www.iso.org/" target="_blank">ISO (International Organization for Standardization)</a>, and <a href="https://www.cibse.org/" target="_blank">CIBSE (Chartered Institution of Building Services Engineers)</a>.</p>
            </div>                    
            
            <div class="calculator-form">
                <form id="hvac-sizing-form">
                    <div class="unit-selector">
                        <label for="unit-system">Select Units:</label>
                        <select id="unit-system">
                            <option value="metric">Metric (m, °C, W)</option>
                            <option value="imperial">Imperial (ft, °F, BTU/hr)</option>
                        </select>
                    </div>

                    <!-- Room Dimensions -->
                    <div class="form-section">
                        <h3>Room Dimensions</h3>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="room-length" id="label-room-length">Room Length (m) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext" id="tooltip-room-length">Length of the room in meters.</span></span></label>
                                <input type="number" id="room-length" min="0.1" step="0.1" value="5" required>
                            </div>
                            <div class="form-group">
                                <label for="room-width" id="label-room-width">Room Width (m) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext" id="tooltip-room-width">Width of the room in meters.</span></span></label>
                                <input type="number" id="room-width" min="0.1" step="0.1" value="4" required>
                            </div>
                            <div class="form-group">
                                <label for="room-height" id="label-room-height">Room Height (m) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext" id="tooltip-room-height">Height of the room in meters.</span></span></label>
                                <input type="number" id="room-height" min="0.1" step="0.1" value="3" required>
                            </div>
                        </div>
                    </div>

                    <!-- UPS/Inverter Heat Dissipation -->
                    <div class="form-section">
                        <h3>UPS/Inverter Heat Dissipation</h3>
                        <p class="tool-description">
                            For multiple UPS/Inverter units, add each unit separately. If you have manufacturer's heat dissipation data for multiple units, sum them up and enter the total value if you choose "Enter Manufacturer's Data" for a single unit.
                        </p>
                        <div id="ups-units-container">
                            <!-- Default/First UPS unit -->
                            <div class="ups-unit" data-unit-id="1">
                                <h4>UPS/Inverter Unit 1 <button type="button" class="remove-unit-btn" data-unit-id="1"><i class="fas fa-times"></i> Remove</button></h4>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="ups-heat-input-method-1">Heat Input Method <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Choose how to input UPS/Inverter heat: calculate from parameters or enter manufacturer's data.</span></span></label>
                                        <select id="ups-heat-input-method-1" class="ups-heat-input-method">
                                            <option value="calculate">Calculate from Parameters</option>
                                            <option value="manual">Enter Manufacturer's Data</option>
                                        </select>
                                    </div>
                                </div>

                                <div id="ups-parameters-fields-1" class="ups-parameters-fields">
                                    <div class="form-row">
                                        <div class="form-group">
                                            <label for="ups-rated-power-kva-1" class="label-ups-rated-power-kva">Rated Power (kVA) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext tooltip-ups-rated-power-kva">The maximum rated output power of this UPS or Inverter in kVA.</span></span></label>
                                            <input type="number" id="ups-rated-power-kva-1" min="0.1" step="0.1" value="10" required>
                                        </div>
                                        <div class="form-group">
                                            <label for="ups-load-percentage-1" class="label-ups-load-percentage">Load (%) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext tooltip-ups-load-percentage">The typical operational load percentage of this UPS/Inverter.</span></span></label>
                                            <input type="number" id="ups-load-percentage-1" min="0" max="100" step="1" value="80" required>
                                        </div>
                                        <div class="form-group">
                                            <label for="ups-efficiency-at-load-1" class="label-ups-efficiency-at-load">Efficiency (%) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext tooltip-ups-efficiency-at-load">The efficiency of this UPS/Inverter at the specified load. This determines heat loss.</span></span></label>
                                            <input type="number" id="ups-efficiency-at-load-1" min="0.1" max="100" step="0.1" value="95" required>
                                        </div>
                                    </div>
                                </div>

                                <div id="ups-manual-heat-fields-1" class="ups-manual-heat-fields hidden">
                                    <div class="form-row">
                                        <div class="form-group">
                                            <label for="ups-manufacturer-heat-1" class="label-ups-manufacturer-heat">Manufacturer's Heat Load (W) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext tooltip-ups-manufacturer-heat">Direct heat dissipation value provided by the manufacturer for this unit in Watts. If you have multiple units and are entering combined data, sum them here.</span></span></label>
                                            <input type="number" id="ups-manufacturer-heat-1" min="0" step="1" value="1000" required>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <button type="button" id="add-ups-unit-btn" class="add-unit-btn"><i class="fas fa-plus"></i> Add UPS/Inverter Unit</button>
                    </div>

                    <!-- Internal Heat Gains -->
                    <div class="form-section">
                        <h3>Internal Heat Gains</h3>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="lighting-power-density" id="label-lighting-power-density">Lighting Power Density (W/m²) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext" id="tooltip-lighting-power-density">Typical heat gain from lighting per square meter of floor area.</span></span></label>
                                <input type="number" id="lighting-power-density" min="0" step="0.1" value="10" required>
                            </div>
                            <div class="form-group">
                                <label for="num-people" id="label-num-people">Number of Occupants <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext" id="tooltip-num-people">Number of people typically present in the room. Each person generates sensible and latent heat.</span></span></label>
                                <input type="number" id="num-people" min="0" step="1" value="1" required>
                            </div>
                            <div class="form-group">
                                <label for="other-equipment-heat" id="label-other-equipment-heat">Other Equipment Heat Gain (W) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext" id="tooltip-other-equipment-heat">Total heat dissipated by other equipment (e.g., servers, monitors) in Watts.</span></span></label>
                                <input type="number" id="other-equipment-heat" min="0" step="1" value="500" required>
                            </div>
                        </div>
                    </div>

                    <!-- External Heat Gains (Fabric & Solar) -->
                    <div class="form-section">
                        <h3>External Heat Gains (Fabric & Solar)</h3>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="wall-u-value" id="label-wall-u-value">Wall U-Value (W/m²K) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext" id="tooltip-wall-u-value">Overall heat transfer coefficient for walls. Lower values mean better insulation.</span></span></label>
                                <input type="number" id="wall-u-value" min="0.01" step="0.01" value="0.5" required>
                            </div>
                            <div class="form-group">
                                <label for="roof-u-value" id="label-roof-u-value">Roof U-Value (W/m²K) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext" id="tooltip-roof-u-value">Overall heat transfer coefficient for the roof.</span></span></label>
                                <input type="number" id="roof-u-value" min="0.01" step="0.01" value="0.3" required>
                            </div>
                            <div class="form-group">
                                <label for="floor-u-value" id="label-floor-u-value">Floor U-Value (W/m²K) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext" id="tooltip-floor-u-value">Overall heat transfer coefficient for the floor.</span></span></label>
                                <input type="number" id="floor-u-value" min="0.01" step="0.01" value="0.5" required>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="window-area" id="label-window-area">Window Area (m²) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext" id="tooltip-window-area">Total area of windows exposed to sunlight. Set to 0 if no windows.</span></span></label>
                                <input type="number" id="window-area" min="0" step="0.1" value="0" required>
                            </div>
                            <div class="form-group">
                                <label for="window-shgc" id="label-window-shgc">Window SHGC <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext" id="tooltip-window-shgc">Solar Heat Gain Coefficient for windows (0 to 1). Lower is better for reducing solar gain.</span></span></label>
                                <input type="number" id="window-shgc" min="0" max="1" step="0.01" value="0.5" required>
                            </div>
                            <div class="form-group">
                                <label for="solar-radiation-factor" id="label-solar-radiation-factor">Peak Solar Radiation (W/m²) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext" id="tooltip-solar-radiation-factor">Peak solar radiation incident on windows. Varies by location and time of day.</span></span></label>
                                <input type="number" id="solar-radiation-factor" min="0" step="1" value="200" required>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="door-area" id="label-door-area">Door Area (m²) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext" id="tooltip-door-area">Total area of doors exposed to ambient conditions.</span></span></label>
                                <input type="number" id="door-area" min="0" step="0.1" value="2" required>
                            </div>
                            <div class="form-group">
                                <label for="door-u-value" id="label-door-u-value">Door U-Value (W/m²K) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext" id="tooltip-door-u-value">Overall heat transfer coefficient for doors.</span></span></label>
                                <input type="number" id="door-u-value" min="0.01" step="0.01" value="2.0" required>
                            </div>
                        </div>
                    </div>

                    <!-- Environmental Conditions & Infiltration -->
                    <div class="form-section">
                        <h3>Environmental Conditions & Infiltration</h3>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="desired-room-temp" id="label-desired-room-temp">Desired Room Temp (°C) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext" id="tooltip-desired-room-temp">The target temperature to maintain inside the room.</span></span></label>
                                <input type="number" id="desired-room-temp" value="22" step="0.1" required>
                            </div>
                            <div class="form-group">
                                <label for="ambient-temp-hvac" id="label-ambient-temp-hvac">Ambient Temp (°C) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext" id="tooltip-ambient-temp-hvac">The maximum expected outdoor ambient temperature.</span></span></label>
                                <input type="number" id="ambient-temp-hvac" value="35" step="0.1" required>
                            </div>
                            <div class="form-group">
                                <label for="infiltration-ach" id="label-infiltration-ach">Air Changes per Hour (ACH) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext" id="tooltip-infiltration-ach">Number of times the room's air volume is replaced per hour due to infiltration/ventilation. Typical values: 0.5 (well-sealed) to 2 (less sealed).</span></span></label>
                                <input type="number" id="infiltration-ach" min="0" step="0.1" value="0.5" required>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="ambient-rh" id="label-ambient-rh">Ambient Relative Humidity (%) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext" id="tooltip-ambient-rh">The relative humidity of the outdoor ambient air.</span></span></label>
                                <input type="number" id="ambient-rh" min="0" max="100" step="1" value="70" required>
                            </div>
                            <div class="form-group">
                                <label for="desired-rh" id="label-desired-rh">Desired Room Relative Humidity (%) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext" id="tooltip-desired-rh">The target relative humidity to maintain inside the room.</span></span></label>
                                <input type="number" id="desired-rh" min="0" max="100" step="1" value="50" required>
                            </div>
                        </div>
                    </div>

                    <!-- Safety Factor -->
                    <div class="form-section">
                        <h3>Safety Factor</h3>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="safety-factor">Safety Factor (%) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">An additional percentage added to the calculated load to account for uncertainties, future growth, and peak conditions. Typical values are 10-20%.</span></span></label>
                                <input type="number" id="safety-factor" min="0" step="1" value="15" required>
                            </div>
                        </div>
                    </div>

                    <div class="button-wrapper">
                        <button type="button" id="calculate-hvac-btn" class="calculate-btn"><i class="fas fa-calculator"></i> Calculate HVAC Size</button>
                        <button type="button" id="reset-form-btn" class="add-unit-btn btn accent" style="margin-left: 15px;"><i class="fas fa-sync-alt"></i> Reset Form</button>
                    </div>
                </form>
            </div>                        
        </div>

        <div id="result-container" class="result-container">
            <h3>HVAC Sizing Results</h3>
            <div id="calculation-details">
                <!-- Calculation steps will be inserted here -->
            </div>
            <table class="result-table">
                <thead>
                    <tr>
                        <th>Parameter</th>
                        <th>Value</th>
                    </tr>
                </thead>
                <tbody id="result-table-body">
                    <!-- Results will be dynamically inserted here -->
                </tbody>
            </table>
            <div class="standard-reference" id="standard-reference">
                <!-- Standard reference text will be inserted here -->
            </div>
        </div>

        <!-- NEW INFORMATIVE SECTION -->
        <div class="card" style="margin-top: 30px;">
            <h2 style="color: var(--primary); border-bottom: 3px solid var(--primary); padding-bottom: 15px;">
                <i class="fas fa-book-open" style="margin-right: 10px;"></i> Professional Insights: HVAC Sizing for Critical Environments
            </h2>

            <h3 style="color: var(--heading); font-family: 'Montserrat', sans-serif; font-size: 1.5rem; margin-top: 20px;">1. The Critical Difference: Comfort Cooling vs. Precision Cooling</h3>
            <p class="tool-description">A common and costly mistake is using standard "comfort cooling" (like a residential or office AC unit) for a UPS or server room. This approach is flawed because the two systems are designed for entirely different goals.</p>
            <ul class="tool-description" style="list-style-type: disc; margin-left: 20px; padding-left: 15px; line-height: 1.7;">
                <li style="margin-bottom: 10px;"><strong>Comfort Cooling:</strong> Designed to handle a high <i>latent heat load</i> (moisture from people breathing and infiltration). It runs in short cycles, aggressively dehumidifying the air. This is the opposite of what a data room needs and can lead to damaging static electricity.</li>
                <li><strong>Precision Cooling:</strong> Designed for a high <i>sensible heat load</i> (the dry heat generated by electronics). These units (often called CRAC - Computer Room Air Conditioner) are built to run continuously (24/7/365) and maintain a precise temperature and humidity, with a high Sensible Heat Ratio (SHR).</li>
            </ul>

            <h3 style="color: var(--heading); font-family: 'Montserrat', sans-serif; font-size: 1.5rem; margin-top: 20px;">2. Why "Tons per Square Foot" is a Dangerous Rule of Thumb</h3>
            <p class="tool-description">You will often hear rules of thumb like "1 ton of cooling per 400 sq. ft." These are dangerously inaccurate for critical environments. As this calculator demonstrates, the primary heat load is not the room's <i>area</i>, but the <i>equipment</i> within it. A 500 sq. ft. room with one UPS has a drastically different cooling need than a 500 sq. ft. room with ten high-density server racks.</p>
            <p class="tool-description">Relying on such rules almost always leads to severe undersizing, which causes component overheating, premature equipment failure, and costly downtime. Always calculate the load based on the specific heat dissipation (in Watts or BTU/hr) of your equipment.</p>

            <h3 style="color: var(--heading); font-family: 'Montserrat', sans-serif; font-size: 1.5rem; margin-top: 20px;">3. Understanding Your Heat Loads: Sensible vs. Latent</h3>
            <p class="tool-description">This calculator breaks down the heat load into two key components:</p>
            <ul class="tool-description" style="list-style-type: disc; margin-left: 20px; padding-left: 15px; line-height: 1.7;">
                <li style="margin-bottom: 10px;"><strong>Sensible Heat:</strong> This is the dry, measurable heat you can feel, generated by all electronics (UPS, servers, lights, etc.), building fabric, and solar gain. This is the <i>primary</i> load in a UPS room, often accounting for 90-100% of the total equipment heat.</li>
                <li><strong>Latent Heat:</strong> This is the "hidden" heat associated with moisture in the air (humidity). Its main sources are occupants (breathing, perspiration) and infiltration/ventilation of humid outdoor air. While a smaller part of the load, it <i>must</i> be managed. High humidity risks condensation and corrosion, while low humidity (common with comfort coolers) causes static discharge.</li>
            </ul>
            <p class="tool-description">A key metric for a precision AC unit is its <strong>Sensible Heat Ratio (SHR)</strong>. An SHR of 0.95 means 95% of its cooling capacity removes sensible heat and 5% removes latent heat. A typical comfort cooler might have an SHR of 0.65. Using the wrong unit means paying to remove moisture that isn't there, while failing to remove the electronic heat that is.</p>

            <h3 style="color: var(--heading); font-family: 'Montserrat', sans-serif; font-size: 1.5rem; margin-top: 20px;">4. The Importance of Redundancy (N+1, 2N)</h3>
            <p class="tool-description">The purpose of a UPS is to provide 100% uptime. If the cooling system fails, the UPS and the equipment it protects will overheat and shut down, defeating the entire purpose. For any truly critical facility, a single cooling unit (an 'N' system) represents a single point of failure.</p>
            <ul class="tool-description" style="list-style-type: disc; margin-left: 20px; padding-left: 15px; line-height: 1.7;">
                <li style="margin-bottom: 10px;"><strong>N+1 Redundancy:</strong> This is the most common and cost-effective strategy. If your calculated total cooling load is 10 tons ('N'), you would install <i>two</i> 10-ton units (or three 5-ton units). One unit can fail, and the remaining 'N' capacity can still handle 100% of the load. The units are typically rotated to ensure even wear.</li>
                <li><strong>2N Redundancy:</strong> This "fully redundant" system provides complete, independent backup. You would install two separate systems, each capable of handling 100% of the load (e.g., two 10-ton units for a 10-ton load). This protects against both unit failure and maintenance downtime.</li>
            </ul>
            <p class="tool-description">This calculator provides the 'N' load. You must apply the appropriate redundancy factor based on your business's uptime requirements.</p>

            <h3 style="color: var(--heading); font-family: 'Montserrat', sans-serif; font-size: 1.5rem; margin-top: 20px;">5. Airflow Management: Don't Just Cool the Room, Cool the Equipment</h3>
            <p class="tool-description">Simply dumping cold air into the room is inefficient. Effective cooling relies on managing airflow to ensure cold air reaches the equipment inlets and hot exhaust air is returned to the AC unit. The most common strategy is the <strong>Hot Aisle / Cold Aisle</strong> layout. Equipment racks are arranged in rows, with their fronts (inlets) facing each other (Cold Aisle) and their rears (exhausts) facing each other (Hot Aisle). The CRAC units supply cold air (often through a raised floor) into the cold aisles, and the hot air is drawn back from the hot aisles. This prevents hot and cold air from mixing, dramatically increasing efficiency and preventing "hot spots."</p>
        </div>
        <!-- END NEW SECTION -->
    </main>

    <!-- NEW FOOTER FROM perfect.txt -->
        <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-left">
                    <a href="/" class="footer-logo">
                        <img src="logo.png" alt="Design Calculators Logo" loading="lazy" decoding="async">
                        <span class="footer-logo-text">Design Calculators</span>
                    </a>
                    <p class="footer-description">A comprehensive engineering calculator hub based on IEC, IEEE, and
                        global standards.</p>
                    <div class="social-buttons">
                        <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://designcalculators.co.in"
                            target="_blank" rel="noopener noreferrer" class="social-btn linkedin"
                            aria-label="LinkedIn"><i class="fab fa-linkedin-in"></i></a>
                        <a href="https://www.youtube.com/@designcalculators" target="_blank" rel="noopener noreferrer"
                            class="social-btn youtube" aria-label="YouTube"><i class="fab fa-youtube"></i></a>
                        <a href="https://twitter.com/intent/tweet?url=https://designcalculators.co.in&text=Check%20out%20this%20amazing%20engineering%20calculator%20hub!"
                            target="_blank" rel="noopener noreferrer" class="social-btn twitter" aria-label="Twitter"><i
                                class="fab fa-twitter"></i></a>
                        <a href="https://www.facebook.com/sharer/sharer.php?u=https://designcalculators.co.in"
                            target="_blank" rel="noopener noreferrer" class="social-btn facebook"
                            aria-label="Facebook"><i class="fab fa-facebook-f"></i></a>
                        <a href="https://api.whatsapp.com/send?text=Check%20out%20this%20amazing%20engineering%20resource:%20https://designcalculators.co.in"
                            target="_blank" rel="noopener noreferrer" class="social-btn whatsapp"
                            aria-label="WhatsApp"><i class="fab fa-whatsapp"></i></a>
                    </div>
                </div>
                <div class="footer-right">
                    <div class="footer-col">
                        <h4>Quick Links</h4>
                        <ul>
                            <li><a href='/indexele.html'>Electrical Tools</a></li>
                            <li><a href='/indexmech.html'>Mechanical Tools</a></li>
                            <li><a href='/indexinst.html'>Instrumentation Tools</a></li>
                            <li><a href='/about.html'>About Us</a></li>
                            <li><a href='/faq.html'>FAQ</a></li>
                        </ul>
                    </div>
                    <div class="footer-col">
                        <h4>Learn More</h4>
                        <ul>
                            <li><a href="https://www.youtube.com/@designcalculators" target="_blank"
                                    rel="noopener noreferrer">YouTube Channel</a></li>
                            <li><a href='/contact.html'>Contact Us</a></li>
                            <li><a href='/privacy-policy.html'>Privacy Policy</a></li>
                            <li><a href='/terms-of-service.html'>Terms of Service</a></li>
                            <li><a href='/sitemap2.html'>Sitemap</a></li>
                        </ul>
                    </div>
                    <div class="footer-col">
                        <h4>Our Network</h4>
                        <ul>
                            <li style="margin-bottom: 12px;">
                                <a href="https://reliabilitytools.co.in/" target="_blank" rel="noopener"
                                   style="font-weight: 600; display: block; margin-bottom: 2px;">Reliability Tools</a>
                                <span style="font-size: 0.85rem; color: #94a3b8; line-height: 1.3; display: block;">Reliability
                                    & maintenance engineering calculators.</span>
                            </li>
                            <li style="margin-bottom: 12px;">
                                <a href="https://electrosafe.homes/" target="_blank" rel="noopener"
                                   style="font-weight: 600; display: block; margin-bottom: 2px;">ElectroSafe</a>
                                <span style="font-size: 0.85rem; color: #94a3b8; line-height: 1.3; display: block;">Dedicated
                                    to home electrical safety & protection.</span>
                            </li>
                            <li>
                                <a href="https://knowyourname.co.in/" target="_blank" rel="noopener"
                                   style="font-weight: 600; display: block; margin-bottom: 2px;">KnowYourName</a>
                                <span style="font-size: 0.85rem; color: #94a3b8; line-height: 1.3; display: block;">Scientific
                                    name analysis: Phonetics, Ergonomics & Acoustics.</span>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="footer-disclaimer">
                <p>All calculations are for preliminary engineering design guidance. Final designs must comply with all applicable local and international standards (including but not limited to ASHRAE 90.1, ARI 550/590). Always verify calculations and consult with a licensed professional engineer before implementation or construction.</p>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 Design Calculators. Created by <span style="color: var(--secondary); font-weight: bold;">Anil Sharma</span>. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <!-- ORIGINAL SCRIPT (CRITICAL FOR FUNCTIONALITY) -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const calculateHvacBtn = document.getElementById('calculate-hvac-btn');
            const resetFormBtn = document.getElementById('reset-form-btn');
            const resultContainer = document.getElementById('result-container');
            const resultTableBody = document.getElementById('result-table-body');
            const standardReference = document.getElementById('standard-reference');
            const calculationDetailsDiv = document.getElementById('calculation-details');
            const unitSystemSelect = document.getElementById('unit-system');

            const upsUnitsContainer = document.getElementById('ups-units-container');
            const addUpsUnitBtn = document.getElementById('add-ups-unit-btn');
            let unitCounter = 1; // To keep track of unique IDs for multiple units
            // Store default values for resetting
            const defaultValues = {
                'room-length': 5, 'room-width': 4, 'room-height': 3,
                'lighting-power-density': 10, 'num-people': 1, 'other-equipment-heat': 500,
                'wall-u-value': 0.5, 'roof-u-value': 0.3, 'floor-u-value': 0.5,
                'window-area': 0, 'window-shgc': 0.5, 'solar-radiation-factor': 200,
                'door-area': 2, 'door-u-value': 2.0,
                'desired-room-temp': 22, 'ambient-temp-hvac': 35, 'infiltration-ach': 0.5,
                'ambient-rh': 70, 'desired-rh': 50, 'safety-factor': 15
            };
            const defaultUpsUnitValues = {
                'ups-rated-power-kva': 10, 'ups-load-percentage': 80, 'ups-efficiency-at-load': 95,
                'ups-manufacturer-heat': 1000
            };

            // Conversion Factors (Metric to Imperial)
            const CONVERSION_FACTORS = {
                m_to_ft: 3.28084,
                sqm_to_sqft: 10.7639,
                cubm_to_cubft: 35.3147,
                W_to_BTUhr: 3.41214,
                Wm2K_to_BTUhr_sqft_F: 0.17611, // 1 W/m²K = 0.17611 BTU/hr·ft²·°F
                kg_to_lb: 2.20462,
                J_per_kgK_to_BTU_per_lbF: 0.000238846, // 1 J/kgK = 0.000238846 BTU/lb°F
                J_per_kg_to_BTU_per_lb: 0.000429923, // 1 J/kg = 0.000429923 BTU/lb
                TR_to_kW: 3.517,
                TR_to_BTUhr: 12000
            };

            // Labels and Tooltips for dynamic updating
            const unitSensitiveElements = {
                labels: {
                    'room-length': { metric: 'Room Length (m)', imperial: 'Room Length (ft)' },
                    'room-width': { metric: 'Room Width (m)', imperial: 'Room Width (ft)' },
                    'room-height': { metric: 'Room Height (m)', imperial: 'Room Height (ft)' },
                    'lighting-power-density': { metric: 'Lighting Power Density (W/m²)', imperial: 'Lighting Power Density (BTU/hr/ft²)' },
                    'other-equipment-heat': { metric: 'Other Equipment Heat Gain (W)', imperial: 'Other Equipment Heat Gain (BTU/hr)' },
                    'wall-u-value': { metric: 'Wall U-Value (W/m²K)', imperial: 'Wall U-Value (BTU/hr·ft²·°F)' },
                    'roof-u-value': { metric: 'Roof U-Value (W/m²K)', imperial: 'Roof U-Value (BTU/hr·ft²·°F)' },
                    'floor-u-value': { metric: 'Floor U-Value (W/m²K)', imperial: 'Floor U-Value (BTU/hr·ft²·°F)' },
                    'window-area': { metric: 'Window Area (m²)', imperial: 'Window Area (ft²)' },
                    'solar-radiation-factor': { metric: 'Peak Solar Radiation (W/m²)', imperial: 'Peak Solar Radiation (BTU/hr/ft²)' },
                    'door-area': { metric: 'Door Area (m²)', imperial: 'Door Area (ft²)' },
                    'door-u-value': { metric: 'Door U-Value (W/m²K)', imperial: 'Door U-Value (BTU/hr·ft²·°F)' },
                    'desired-room-temp': { metric: 'Desired Room Temp (°C)', imperial: 'Desired Room Temp (°F)' },
                    'ambient-temp-hvac': { metric: 'Ambient Temp (°C)', imperial: 'Ambient Temp (°F)' },
                    'ups-manufacturer-heat': { metric: 'Manufacturer\'s Heat Load (W)', imperial: 'Manufacturer\'s Heat Load (BTU/hr)' }
                },
                tooltips: {
                    'room-length': { metric: 'Length of the room in meters.', imperial: 'Length of the room in feet.' },
                    'room-width': { metric: 'Width of the room in meters.', imperial: 'Width of the room in feet.' },
                    'room-height': { metric: 'Height of the room in meters.', imperial: 'Height of the room in feet.' },
                    'lighting-power-density': { metric: 'Typical heat gain from lighting per square meter of floor area.', imperial: 'Typical heat gain from lighting per square foot of floor area.' },
                    'other-equipment-heat': { metric: 'Total heat dissipated by other equipment (e.g., servers, monitors) in Watts.', imperial: 'Total heat dissipated by other equipment (e.g., servers, monitors) in BTU/hr.' },
                    'wall-u-value': { metric: 'Overall heat transfer coefficient for walls. Lower values mean better insulation.', imperial: 'Overall heat transfer coefficient for walls. Lower values mean better insulation.' },
                    'roof-u-value': { metric: 'Overall heat transfer coefficient for the roof.', imperial: 'Overall heat transfer coefficient for the roof.' },
                    'floor-u-value': { metric: 'Overall heat transfer coefficient for the floor.', imperial: 'Overall heat transfer coefficient for the floor.' },
                    'window-area': { metric: 'Total area of windows exposed to sunlight. Set to 0 if no windows.', imperial: 'Total area of windows exposed to sunlight. Set to 0 if no windows.' },
                    'solar-radiation-factor': { metric: 'Peak solar radiation incident on windows. Varies by location and time of day.', imperial: 'Peak solar radiation incident on windows. Varies by location and time of day.' },
                    'door-area': { metric: 'Total area of doors exposed to ambient conditions.', imperial: 'Total area of doors exposed to ambient conditions.' },
                    'door-u-value': { metric: 'Overall heat transfer coefficient for doors.', imperial: 'Overall heat transfer coefficient for doors.' },
                    'desired-room-temp': { metric: 'The target temperature to maintain inside the room.', imperial: 'The target temperature to maintain inside the room.' },
                    'ambient-temp-hvac': { metric: 'The maximum expected outdoor ambient temperature.', imperial: 'The maximum expected outdoor ambient temperature.' },
                    'infiltration-ach': { metric: 'Number of times the room\'s air volume is replaced per hour due to infiltration/ventilation. Typical values: 0.5 (well-sealed) to 2 (less sealed).', imperial: 'Number of times the room\'s air volume is replaced per hour due to infiltration/ventilation. Typical values: 0.5 (well-sealed) to 2 (less sealed).' },
                    'ambient-rh': { metric: 'The relative humidity of the outdoor ambient air.', imperial: 'The relative humidity of the outdoor ambient air.' },
                    'desired-rh': { metric: 'The target relative humidity to maintain inside the room.', imperial: 'The target relative humidity to maintain inside the room.' },
                    'safety-factor': { metric: 'An additional percentage added to the calculated load to account for uncertainties, future growth, and peak conditions. Typical values are 10-20%.', imperial: 'An additional percentage added to the calculated load to account for uncertainties, future growth, and peak conditions. Typical values are 10-20%.' },
                    'ups-rated-power-kva': { metric: 'The maximum rated output power of this UPS or Inverter in kVA.', imperial: 'The maximum rated output power of this UPS or Inverter in kVA.' },
                    'ups-load-percentage': { metric: 'The typical operational load percentage of this UPS/Inverter.', imperial: 'The typical operational load percentage of this UPS/Inverter.' },
                    'ups-efficiency-at-load': { metric: 'The efficiency of this UPS/Inverter at the specified load. This determines heat loss.', imperial: 'The efficiency of this UPS/Inverter at the specified load. This determines heat loss.' },
                    'ups-manufacturer-heat': { metric: 'Direct heat dissipation value provided by the manufacturer for this unit in Watts. If you have multiple units and are entering combined data, sum them here.', imperial: 'Direct heat dissipation value provided by the manufacturer for this unit in BTU/hr. If you have multiple units and are entering combined data, sum them here.' }
                }
            };

            // Template for a new UPS unit
            const upsUnitTemplate = `
                <div class="ups-unit" data-unit-id="{UNIT_ID}">
                    <h4>UPS/Inverter Unit {UNIT_ID} <button type="button" class="remove-unit-btn" data-unit-id="{UNIT_ID}"><i class="fas fa-times"></i> Remove</button></h4>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="ups-heat-input-method-{UNIT_ID}">Heat Input Method <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Choose how to input UPS/Inverter heat: calculate from parameters or enter manufacturer's data.</span></span></label>
                            <select id="ups-heat-input-method-{UNIT_ID}" class="ups-heat-input-method">
                                <option value="calculate">Calculate from Parameters</option>
                                <option value="manual">Enter Manufacturer's Data</option>
                            </select>
                        </div>
                    </div>
                    <div id="ups-parameters-fields-{UNIT_ID}" class="ups-parameters-fields">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="ups-rated-power-kva-{UNIT_ID}" class="label-ups-rated-power-kva">Rated Power (kVA) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext tooltip-ups-rated-power-kva">The maximum rated output power of this UPS or Inverter in kVA.</span></span></label>
                                <input type="number" id="ups-rated-power-kva-{UNIT_ID}" min="0.1" step="0.1" value="10" required>
                            </div>
                            <div class="form-group">
                                <label for="ups-load-percentage-{UNIT_ID}" class="label-ups-load-percentage">Load (%) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext tooltip-ups-load-percentage">The typical operational load percentage of this UPS/Inverter.</span></span></label>
                                <input type="number" id="ups-load-percentage-{UNIT_ID}" min="0" max="100" step="1" value="80" required>
                            </div>
                            <div class="form-group">
                                <label for="ups-efficiency-at-load-{UNIT_ID}" class="label-ups-efficiency-at-load">Efficiency (%) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext tooltip-ups-efficiency-at-load">The efficiency of this UPS/Inverter at the specified load. This determines heat loss.</span></span></label>
                                <input type="number" id="ups-efficiency-at-load-{UNIT_ID}" min="0.1" max="100" step="0.1" value="95" required>
                            </div>
                        </div>
                    </div>
                    <div id="ups-manual-heat-fields-{UNIT_ID}" class="ups-manual-heat-fields hidden">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="ups-manufacturer-heat-{UNIT_ID}" class="label-ups-manufacturer-heat">Manufacturer's Heat Load (W) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext tooltip-ups-manufacturer-heat">Direct heat dissipation value provided by the manufacturer for this unit in Watts. If you have multiple units and are entering combined data, sum them here.</span></span></label>
                                <input type="number" id="ups-manufacturer-heat-{UNIT_ID}" min="0" step="1" value="1000" required>
                            </div>
                        </div>
                    </div>
                </div>
            `;

            // Function to add a new UPS unit
            function addUpsUnit() {
                unitCounter++;
                const newUnitHtml = upsUnitTemplate.replace(/{UNIT_ID}/g, unitCounter);
                const newUnitDiv = document.createElement('div');
                newUnitDiv.innerHTML = newUnitHtml;
                upsUnitsContainer.appendChild(newUnitDiv.firstElementChild); // Append the div itself

                // Re-attach event listeners for the new unit's elements
                const newUnitElement = upsUnitsContainer.querySelector(`[data-unit-id="${unitCounter}"]`);
                const newSelect = newUnitElement.querySelector(`.ups-heat-input-method`);
                newSelect.addEventListener('change', () => toggleUpsHeatInputFields(newUnitElement));                                
                const removeBtn = newUnitElement.querySelector(`.remove-unit-btn`);
                removeBtn.addEventListener('click', () => removeUpsUnit(newUnitElement));

                // Initialize the visibility for the new unit
                toggleUpsHeatInputFields(newUnitElement);
                updateUnitLabelsAndTooltips(unitSystemSelect.value); // Update units for new unit
            }

            // Function to remove a UPS unit
            function removeUpsUnit(unitElement) {
                if (upsUnitsContainer.children.length > 1) { // Ensure at least one unit remains
                    unitElement.remove();
                } else {
                    displayMessage("At least one UPS/Inverter unit must be present.", "warning");
                }
            }

            // Function to toggle UPS heat input fields for a specific unit
            function toggleUpsHeatInputFields(unitElement) {
                const selectElement = unitElement.querySelector('.ups-heat-input-method');
                const paramsFields = unitElement.querySelector('.ups-parameters-fields');
                const manualFields = unitElement.querySelector('.ups-manual-heat-fields');

                if (selectElement.value === 'calculate') {
                    paramsFields.classList.remove('hidden');
                    manualFields.classList.add('hidden');
                    Array.from(paramsFields.querySelectorAll('input')).forEach(input => input.disabled = false);
                    Array.from(manualFields.querySelectorAll('input')).forEach(input => input.disabled = true);
                } else {
                    paramsFields.classList.add('hidden');
                    manualFields.classList.remove('hidden');
                    Array.from(paramsFields.querySelectorAll('input')).forEach(input => input.disabled = true);
                    Array.from(manualFields.querySelectorAll('input')).forEach(input => input.disabled = false);
                }
            }

            // Function to update all labels and tooltips based on selected unit system
            function updateUnitLabelsAndTooltips(unitSystem) {
                // Update general labels and tooltips
                for (const id in unitSensitiveElements.labels) {
                    const labelElement = document.getElementById(`label-${id}`);
                    const tooltipElement = document.getElementById(`tooltip-${id}`);
                    if (labelElement) {
                        // Rebuild label to include tooltip span
                        labelElement.innerHTML = unitSensitiveElements.labels[id][unitSystem] + 
                            ` <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext" id="tooltip-${id}">${unitSensitiveElements.tooltips[id][unitSystem]}</span></span>`;
                    }
                }

                // Update UPS unit specific labels and tooltips
                upsUnitsContainer.querySelectorAll('.ups-unit').forEach(unitElement => {
                    for (const key of ['ups-rated-power-kva', 'ups-load-percentage', 'ups-efficiency-at-load', 'ups-manufacturer-heat']) {
                        const labelElement = unitElement.querySelector(`.label-${key}`);
                        if (labelElement && unitSensitiveElements.labels[key]) {
                             labelElement.innerHTML = unitSensitiveElements.labels[key][unitSystem] + 
                                ` <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext tooltip-${key}">${unitSensitiveElements.tooltips[key][unitSystem]}</span></span>`;
                        }
                    }
                });

                // Update input step and values if changing units
                const currentUnit = unitSystemSelect.value;
                const inputsToConvert = [
                    { id: 'room-length', factor: CONVERSION_FACTORS.m_to_ft, defaultMetric: defaultValues['room-length'] },
                    { id: 'room-width', factor: CONVERSION_FACTORS.m_to_ft, defaultMetric: defaultValues['room-width'] },
                    { id: 'room-height', factor: CONVERSION_FACTORS.m_to_ft, defaultMetric: defaultValues['room-height'] },
                    { id: 'lighting-power-density', factor: CONVERSION_FACTORS.W_to_BTUhr / CONVERSION_FACTORS.sqm_to_sqft, defaultMetric: defaultValues['lighting-power-density'] },
                    { id: 'other-equipment-heat', factor: CONVERSION_FACTORS.W_to_BTUhr, defaultMetric: defaultValues['other-equipment-heat'] },
                    { id: 'wall-u-value', factor: CONVERSION_FACTORS.Wm2K_to_BTUhr_sqft_F, defaultMetric: defaultValues['wall-u-value'] },
                    { id: 'roof-u-value', factor: CONVERSION_FACTORS.Wm2K_to_BTUhr_sqft_F, defaultMetric: defaultValues['roof-u-value'] },
                    { id: 'floor-u-value', factor: CONVERSION_FACTORS.Wm2K_to_BTUhr_sqft_F, defaultMetric: defaultValues['floor-u-value'] },
                    { id: 'window-area', factor: CONVERSION_FACTORS.sqm_to_sqft, defaultMetric: defaultValues['window-area'] },
                    { id: 'solar-radiation-factor', factor: CONVERSION_FACTORS.W_to_BTUhr / CONVERSION_FACTORS.sqm_to_sqft, defaultMetric: defaultValues['solar-radiation-factor'] },
                    { id: 'door-area', factor: CONVERSION_FACTORS.sqm_to_sqft, defaultMetric: defaultValues['door-area'] },
                    { id: 'door-u-value', factor: CONVERSION_FACTORS.Wm2K_to_BTUhr_sqft_F, defaultMetric: defaultValues['door-u-value'] },
                    { id: 'desired-room-temp', convertTemp: true, defaultMetric: defaultValues['desired-room-temp'] },
                    { id: 'ambient-temp-hvac', convertTemp: true, defaultMetric: defaultValues['ambient-temp-hvac'] },
                ];

                inputsToConvert.forEach(item => {
                    const inputElement = document.getElementById(item.id);
                    if (inputElement) {
                        let currentValue = parseFloat(inputElement.value);
                        let newValue;

                        if (unitSystem === 'imperial') {
                            if (item.convertTemp) {
                                newValue = (currentValue * 9/5) + 32; // C to F
                            } else {
                                newValue = currentValue * item.factor;
                            }
                            inputElement.step = item.id.includes('temp') ? '0.1' : (item.id.includes('area') ? '1' : '0.01'); // Adjust step for imperial
                        } else { // metric
                            if (item.convertTemp) {
                                newValue = (currentValue - 32) * 5/9; // F to C
                            } else {
                                newValue = currentValue / item.factor;
                            }
                            inputElement.step = item.id.includes('temp') ? '0.1' : (item.id.includes('area') ? '0.1' : '0.01'); // Adjust step for metric
                        }
                        inputElement.value = newValue.toFixed(item.id.includes('temp') ? 1 : 2); // Keep consistent decimal places
                    }
                });

                // Handle UPS manufacturer heat input separately as it's dynamic
                upsUnitsContainer.querySelectorAll('.ups-unit').forEach(unitElement => {
                    const unitId = unitElement.dataset.unitId;
                    const manualHeatInput = unitElement.querySelector(`#ups-manufacturer-heat-${unitId}`);
                    if (manualHeatInput && manualHeatInput.disabled === false) { // Only convert if visible and enabled
                        let currentValue = parseFloat(manualHeatInput.value);
                        let newValue;
                        if (unitSystem === 'imperial') {
                            newValue = currentValue * CONVERSION_FACTORS.W_to_BTUhr;
                        } else {
                            newValue = currentValue / CONVERSION_FACTORS.W_to_BTUhr;
                        }
                        manualHeatInput.value = newValue.toFixed(0); // Heat load usually integer
                    }
                });
            }

            // Initial setup for the first UPS unit
            const initialUnit = upsUnitsContainer.querySelector('[data-unit-id="1"]');
            const initialSelect = initialUnit.querySelector('.ups-heat-input-method');
            initialSelect.addEventListener('change', () => toggleUpsHeatInputFields(initialUnit));
            const initialRemoveBtn = initialUnit.querySelector('.remove-unit-btn');
            initialRemoveBtn.addEventListener('click', () => removeUpsUnit(initialUnit));
            toggleUpsHeatInputFields(initialUnit); // Set initial state

            addUpsUnitBtn.addEventListener('click', addUpsUnit);
            calculateHvacBtn.addEventListener('click', calculateHVAC);
            resetFormBtn.addEventListener('click', resetForm);
            unitSystemSelect.addEventListener('change', (event) => updateUnitLabelsAndTooltips(event.target.value));

            function resetForm() {
                // Reset standard inputs
                for (const id in defaultValues) {
                    const input = document.getElementById(id);
                    if (input) {
                        input.value = defaultValues[id];
                    }
                }

                // Remove all but the first UPS unit
                const existingUpsUnits = upsUnitsContainer.querySelectorAll('.ups-unit');
                for (let i = 1; i < existingUpsUnits.length; i++) {
                    existingUpsUnits[i].remove();
                }
                // Reset the first UPS unit's values and method
                const firstUnit = upsUnitsContainer.querySelector('[data-unit-id="1"]');
                firstUnit.querySelector('.ups-heat-input-method').value = 'calculate';
                firstUnit.querySelector(`#ups-rated-power-kva-1`).value = defaultUpsUnitValues['ups-rated-power-kva'];
                firstUnit.querySelector(`#ups-load-percentage-1`).value = defaultUpsUnitValues['ups-load-percentage'];
                firstUnit.querySelector(`#ups-efficiency-at-load-1`).value = defaultUpsUnitValues['ups-efficiency-at-load'];
                firstUnit.querySelector(`#ups-manufacturer-heat-1`).value = defaultUpsUnitValues['ups-manufacturer-heat'];
                toggleUpsHeatInputFields(firstUnit); // Ensure fields are correctly shown/hidden

                unitCounter = 1; // Reset unit counter
                // Reset unit system to Metric
                unitSystemSelect.value = 'metric';
                updateUnitLabelsAndTooltips('metric'); // Apply metric units
                // Clear results
                resultContainer.classList.remove('show');
                resultTableBody.innerHTML = '';
                calculationDetailsDiv.innerHTML = '';
                standardReference.innerHTML = '';

                displayMessage("Form reset to default values.", "info");
            }

            // Function to calculate saturation vapor pressure (kPa) using Antoine equation approximation for water
            function calculateSaturationVaporPressure(tempC) {
                // Simplified Antoine equation coefficients for water (valid approx 0-100 C)
                // log10(P_kPa) = A - B / (C + T_C)
                // A = 5.204, B = 1733.926, C = 233.426 (for P in mmHg, T in C)
                // Convert to kPa: 1 mmHg = 0.133322 kPa
                // Or use a direct formula for kPa:
                return 0.6108 * Math.exp((17.27 * tempC) / (tempC + 237.3));
            }

            // Function to calculate humidity ratio (kg water / kg dry air)
            function calculateHumidityRatio(tempC, relativeHumidityPercent, atmosphericPressurekPa = 101.325) {
                const Pws = calculateSaturationVaporPressure(tempC); // Saturation vapor pressure in kPa
                const Pw = (relativeHumidityPercent / 100) * Pws; // Partial pressure of water vapor in kPa                                
                // Humidity Ratio (W) = 0.622 * Pw / (Patm - Pw)
                // 0.622 is the ratio of molecular weight of water to dry air (18.015 / 28.964)
                if (atmosphericPressurekPa <= Pw) {
                    // This condition means air is saturated or super-saturated, or input is invalid
                    return 0.0; // Or handle as an error
                }
                return 0.622 * Pw / (atmosphericPressurekPa - Pw);
            }

            function calculateHVAC() {
                const currentUnitSystem = unitSystemSelect.value;
                
                // 1. Get all inputs and convert to Metric for calculation
                let roomLength = parseFloat(document.getElementById('room-length').value);
                let roomWidth = parseFloat(document.getElementById('room-width').value);
                let roomHeight = parseFloat(document.getElementById('room-height').value);

                let lightingPowerDensity = parseFloat(document.getElementById('lighting-power-density').value);
                const numPeople = parseInt(document.getElementById('num-people').value);
                let otherEquipmentHeat = parseFloat(document.getElementById('other-equipment-heat').value);

                let wallUValue = parseFloat(document.getElementById('wall-u-value').value);
                let roofUValue = parseFloat(document.getElementById('roof-u-value').value);
                let floorUValue = parseFloat(document.getElementById('floor-u-value').value);
                let windowArea = parseFloat(document.getElementById('window-area').value);
                const windowSHGC = parseFloat(document.getElementById('window-shgc').value);
                let solarRadiationFactor = parseFloat(document.getElementById('solar-radiation-factor').value);
                let doorArea = parseFloat(document.getElementById('door-area').value);
                let doorUValue = parseFloat(document.getElementById('door-u-value').value);

                let desiredRoomTemp = parseFloat(document.getElementById('desired-room-temp').value);
                let ambientTempHVAC = parseFloat(document.getElementById('ambient-temp-hvac').value);
                const infiltrationACH = parseFloat(document.getElementById('infiltration-ach').value);
                const ambientRH = parseFloat(document.getElementById('ambient-rh').value);
                const desiredRH = parseFloat(document.getElementById('desired-rh').value);
                const safetyFactor = parseFloat(document.getElementById('safety-factor').value);

                // Convert inputs from Imperial to Metric if necessary
                if (currentUnitSystem === 'imperial') {
                    roomLength /= CONVERSION_FACTORS.m_to_ft;
                    roomWidth /= CONVERSION_FACTORS.m_to_ft;
                    roomHeight /= CONVERSION_FACTORS.m_to_ft;
                    lightingPowerDensity /= (CONVERSION_FACTORS.W_to_BTUhr / CONVERSION_FACTORS.sqm_to_sqft); // BTU/hr/ft2 to W/m2
                    otherEquipmentHeat /= CONVERSION_FACTORS.W_to_BTUhr; // BTU/hr to W
                    wallUValue /= CONVERSION_FACTORS.Wm2K_to_BTUhr_sqft_F; // BTU/hr·ft²·°F to W/m²K
                    roofUValue /= CONVERSION_FACTORS.Wm2K_to_BTUhr_sqft_F;
                    floorUValue /= CONVERSION_FACTORS.Wm2K_to_BTUhr_sqft_F;
                    windowArea /= CONVERSION_FACTORS.sqm_to_sqft;
                    solarRadiationFactor /= (CONVERSION_FACTORS.W_to_BTUhr / CONVERSION_FACTORS.sqm_to_sqft); // BTU/hr/ft2 to W/m2
                    doorArea /= CONVERSION_FACTORS.sqm_to_sqft;
                    doorUValue /= CONVERSION_FACTORS.Wm2K_to_BTUhr_sqft_F;
                    desiredRoomTemp = (desiredRoomTemp - 32) * 5/9; // F to C
                    ambientTempHVAC = (ambientTempHVAC - 32) * 5/9; // F to C
                }

                // Input Validation for other fields
                if (isNaN(roomLength) || isNaN(roomWidth) || isNaN(roomHeight) || roomLength <= 0 || roomWidth <= 0 || roomHeight <= 0) {
                    displayMessage("Please enter valid positive room dimensions.", "error");
                    return;
                }
                if (isNaN(lightingPowerDensity) || lightingPowerDensity < 0 || isNaN(numPeople) || numPeople < 0 || isNaN(otherEquipmentHeat) || otherEquipmentHeat < 0) {
                    displayMessage("Please enter valid positive numbers for internal heat gains (Lighting, People, Other Equipment).", "error");
                    return;
                }
                if (isNaN(wallUValue) || wallUValue < 0 || isNaN(roofUValue) || roofUValue < 0 || isNaN(floorUValue) || floorUValue < 0 || isNaN(windowArea) || windowArea < 0 || isNaN(windowSHGC) || windowSHGC < 0 || windowSHGC > 1 || isNaN(solarRadiationFactor) || solarRadiationFactor < 0 || isNaN(doorArea) || doorArea < 0 || isNaN(doorUValue) || doorUValue < 0) {
                    displayMessage("Please enter valid positive numbers for external heat gains (U-Values, Areas, SHGC, Solar Factor).", "error");
                    return;
                }
                if (isNaN(desiredRoomTemp) || isNaN(ambientTempHVAC) || isNaN(infiltrationACH) || infiltrationACH < 0 || isNaN(ambientRH) || ambientRH < 0 || ambientRH > 100 || isNaN(desiredRH) || desiredRH < 0 || desiredRH > 100 || isNaN(safetyFactor) || safetyFactor < 0) {
                    displayMessage("Please enter valid numbers for environmental conditions (temperatures, ACH, RH) and safety factor (>= 0).", "error");
                    return;
                }

                // Initialize total UPS heat sensible
                let total_Q_ups_sensible = 0;
                let upsCalculationDetails = '';
                let upsUnitCount = 0;

                const upsUnits = upsUnitsContainer.querySelectorAll('.ups-unit');
                if (upsUnits.length === 0) {
                    displayMessage("Please add at least one UPS/Inverter unit.", "error");
                    return;
                }

                for (let i = 0; i < upsUnits.length; i++) {
                    const unitElement = upsUnits[i];
                    upsUnitCount++;
                    const unitId = unitElement.dataset.unitId;
                    const upsHeatMethod = unitElement.querySelector(`.ups-heat-input-method`).value;
                    let currentUnitHeat = 0;

                    if (upsHeatMethod === 'calculate') {
                        const upsRatedPowerKVA = parseFloat(unitElement.querySelector(`#ups-rated-power-kva-${unitId}`).value);
                        const upsLoadPercentage = parseFloat(unitElement.querySelector(`#ups-load-percentage-${unitId}`).value);
                        const upsEfficiencyAtLoad = parseFloat(unitElement.querySelector(`#ups-efficiency-at-load-${unitId}`).value);

                        if (isNaN(upsRatedPowerKVA) || isNaN(upsLoadPercentage) || isNaN(upsEfficiencyAtLoad) || upsRatedPowerKVA < 0 || upsLoadPercentage < 0 || upsLoadPercentage > 100 || upsEfficiencyAtLoad <= 0 || upsEfficiencyAtLoad > 100) {
                            displayMessage(`Please enter valid parameters for UPS/Inverter Unit ${upsUnitCount}. (Power > 0, Load 0-100%, Efficiency > 0-100%)`, "error");
                            return; // Stop calculation if validation fails for any unit
                        }
                        const upsOutputKW = upsRatedPowerKVA * (upsLoadPercentage / 100) * 0.8; // Assuming 0.8 power factor for the load
                        currentUnitHeat = upsOutputKW * 1000 * (100 / upsEfficiencyAtLoad - 1);
                        upsCalculationDetails += `<p class="calculation-step"><strong>Unit ${upsUnitCount} (Calculated):</strong> UPS Output kW (at load) = ${upsRatedPowerKVA.toFixed(2)} kVA x (${upsLoadPercentage}/100) x 0.8 = ${upsOutputKW.toFixed(2)} kW</p>`;
                        upsCalculationDetails += `<p class="calculation-step">Q<sub>UPS Unit ${upsUnitCount}</sub> = ${upsOutputKW.toFixed(2)} kW x 1000 W/kW x (100 / ${upsEfficiencyAtLoad} - 1) = ${currentUnitHeat.toFixed(2)} W</p>`;
                    } else { // manual
                        let upsManufacturerHeat = parseFloat(unitElement.querySelector(`#ups-manufacturer-heat-${unitId}`).value);
                        if (isNaN(upsManufacturerHeat) || upsManufacturerHeat < 0) {
                            displayMessage(`Please enter a valid non-negative value for Manufacturer's Heat Load for UPS/Inverter Unit ${upsUnitCount}.`, "error");
                            return; // Stop calculation if validation fails for any unit
                        }
                        if (currentUnitSystem === 'imperial') {
                            upsManufacturerHeat /= CONVERSION_FACTORS.W_to_BTUhr; // BTU/hr to W
                        }
                        currentUnitHeat = upsManufacturerHeat;
                        upsCalculationDetails += `<p class="calculation-step"><strong>Unit ${upsUnitCount} (Manufacturer Data):</strong> Q<sub>UPS Unit ${upsUnitCount}</sub> = ${currentUnitHeat.toFixed(2)} W</p>`;
                    }
                    total_Q_ups_sensible += currentUnitHeat;
                }

                let calculationHtml = '<h4>Detailed Calculation Steps:</h4>';
                let standardRefText = '';
                resultTableBody.innerHTML = ''; // Clear previous results
                resultContainer.classList.remove('show'); // Hide previous results for animation

                // Helper function to add rows to the result table
                function addResultRow(parameter, value) {
                    const row = resultTableBody.insertRow();
                    const paramCell = row.insertCell();
                    const valueCell = row.insertCell();
                    paramCell.innerHTML = parameter;
                    valueCell.innerHTML = value;
                }

                // Constants (already in Metric for calculation)
                const sensibleHeatPerPerson = 75; // W/person (ASHRAE typical for sedentary)
                const latentHeatPerPerson = 55; // W/person (ASHRAE typical for sedentary)
                const airDensity = 1.2; // kg/m³ at standard conditions (approx. 20°C, 1 atm)
                const specificHeatOfAir = 1006; // J/kgK (approx. for dry air)
                const latentHeatOfVaporization = 2450 * 1000; // J/kg (approx. at 25°C, 2450 kJ/kg)

                // 2. Room Geometry Calculations
                const roomVolume = roomLength * roomWidth * roomHeight;
                const roomFloorArea = roomLength * roomWidth;
                const roomWallArea = 2 * (roomLength + roomWidth) * roomHeight;
                const roomRoofArea = roomLength * roomWidth;

                calculationHtml += `<p><strong>1. Room Geometry:</strong></p>`;
                calculationHtml += `<p class="formula">Volume = L &times; W &times; H</p>`;
                calculationHtml += `<p class="formula">Floor Area = L &times; W</p>`;
                calculationHtml += `<p class="formula">Wall Area = 2 &times; (L + W) &times; H</p>`;
                calculationHtml += `<p class="formula">Roof Area = L &times; W</p>`;
                calculationHtml += `<p class="calculation-step">Volume = ${roomLength.toFixed(2)} m x ${roomWidth.toFixed(2)} m x ${roomHeight.toFixed(2)} m = ${roomVolume.toFixed(2)} m<sup>3</sup></p>`;
                calculationHtml += `<p class="calculation-step">Floor Area = ${roomLength.toFixed(2)} m x ${roomWidth.toFixed(2)} m = ${roomFloorArea.toFixed(2)} m<sup>2</sup></p>`;
                calculationHtml += `<p class="calculation-step">Wall Area = 2 x (${roomLength.toFixed(2)} m + ${roomWidth.toFixed(2)} m) x ${roomHeight.toFixed(2)} m = ${roomWallArea.toFixed(2)} m<sup>2</sup></p>`;
                calculationHtml += `<p class="calculation-step">Roof Area = ${roomLength.toFixed(2)} m x ${roomWidth.toFixed(2)} m = ${roomRoofArea.toFixed(2)} m<sup>2</sup></p>`;

                // 3. UPS/Inverter Heat Dissipation (Sensible)
                calculationHtml += `<p><strong>2. UPS/Inverter Heat Dissipation (Sensible):</strong></p>`;
                calculationHtml += upsCalculationDetails; // Add the accumulated details from the loop
                calculationHtml += `<p class="calculation-step"><strong>Total UPS/Inverter Heat Dissipation = ${total_Q_ups_sensible.toFixed(2)} W</strong></p>`;

                // 4. Lighting Heat Gain (Sensible)
                const Q_lights_sensible = roomFloorArea * lightingPowerDensity;
                calculationHtml += `<p><strong>3. Lighting Heat Gain (Sensible):</strong></p>`;
                calculationHtml += `<p class="formula">Q<sub>Lights</sub> = Floor Area &times; Lighting Power Density</p>`;
                calculationHtml += `<p class="calculation-step">Q<sub>Lights</sub> = ${roomFloorArea.toFixed(2)} m<sup>2</sup> x ${lightingPowerDensity.toFixed(2)} W/m<sup>2</sup> = ${Q_lights_sensible.toFixed(2)} W</p>`;

                // 5. Occupancy Heat Gain (Sensible & Latent)
                const Q_people_sensible = numPeople * sensibleHeatPerPerson;
                const Q_people_latent = numPeople * latentHeatPerPerson;
                calculationHtml += `<p><strong>4. Occupancy Heat Gain (Sensible & Latent):</strong></p>`;
                calculationHtml += `<p>Heat generated by human occupants, consisting of both sensible (temperature-raising) and latent (humidity-raising) components.</p>`;
                calculationHtml += `<p class="formula">Q<sub>People, Sensible</sub> = Number of People &times; Sensible Heat per Person</p>`;
                calculationHtml += `<p class="formula">Q<sub>People, Latent</sub> = Number of People &times; Latent Heat per Person</p>`;
                calculationHtml += `<p class="calculation-step">Q<sub>People, Sensible</sub> = ${numPeople} x ${sensibleHeatPerPerson} W/person = ${Q_people_sensible.toFixed(2)} W</p>`;
                calculationHtml += `<p class="calculation-step">Q<sub>People, Latent</sub> = ${numPeople} x ${latentHeatPerPerson} W/person = ${Q_people_latent.toFixed(2)} W</p>`;
                
                // 6. Other Equipment Heat Gain (Sensible)
                const Q_other_equipment_sensible = otherEquipmentHeat;
                calculationHtml += `<p><strong>5. Other Equipment Heat Gain (Sensible):</strong></p>`;
                calculationHtml += `<p>Heat dissipated by any other electrical equipment in the room.</p>`;
                calculationHtml += `<p class="formula">Q<sub>Other Equipment</sub> = Direct Input (W)</p>`;
                calculationHtml += `<p class="calculation-step">Q<sub>Other Equipment</sub> = ${Q_other_equipment_sensible.toFixed(2)} W</p>`;
                
                // 7. Fabric Heat Gain (Sensible)
                const deltaT = ambientTempHVAC - desiredRoomTemp;
                const Q_walls_sensible = wallUValue * roomWallArea * deltaT;
                const Q_roof_sensible = roofUValue * roomRoofArea * deltaT;
                const Q_floor_sensible = floorUValue * roomFloorArea * deltaT;
                const Q_doors_sensible = doorUValue * doorArea * deltaT;
                const Q_fabric_sensible = Q_walls_sensible + Q_roof_sensible + Q_floor_sensible + Q_doors_sensible;

                calculationHtml += `<p><strong>6. Fabric Heat Gain (Sensible):</strong></p>`;
                calculationHtml += `<p>Heat transfer through walls, roof, floor, and doors due to temperature difference between ambient and desired room temperature.</p>`;
                calculationHtml += `<p class="formula">Q<sub>Fabric</sub> = U &times; A &times; (T<sub>Ambient</sub> - T<sub>Room</sub>)</p>`;
                calculationHtml += `<p class="calculation-step">Q<sub>Walls</sub> = ${wallUValue.toFixed(2)} W/m²K x ${roomWallArea.toFixed(2)} m² x (${ambientTempHVAC.toFixed(1)} - ${desiredRoomTemp.toFixed(1)}) °C = ${Q_walls_sensible.toFixed(2)} W</p>`;
                calculationHtml += `<p class="calculation-step">Q<sub>Roof</sub> = ${roofUValue.toFixed(2)} W/m²K x ${roomRoofArea.toFixed(2)} m² x (${ambientTempHVAC.toFixed(1)} - ${desiredRoomTemp.toFixed(1)}) °C = ${Q_roof_sensible.toFixed(2)} W</p>`;
                calculationHtml += `<p class="calculation-step">Q<sub>Floor</sub> = ${floorUValue.toFixed(2)} W/m²K x ${roomFloorArea.toFixed(2)} m² x (${ambientTempHVAC.toFixed(1)} - ${desiredRoomTemp.toFixed(1)}) °C = ${Q_floor_sensible.toFixed(2)} W</p>`;
                calculationHtml += `<p class="calculation-step">Q<sub>Doors</sub> = ${doorUValue.toFixed(2)} W/m²K x ${doorArea.toFixed(2)} m² x (${ambientTempHVAC.toFixed(1)} - ${desiredRoomTemp.toFixed(1)}) °C = ${Q_doors_sensible.toFixed(2)} W</p>`;
                calculationHtml += `<p class="calculation-step">Total Q<sub>Fabric</sub> = ${Q_fabric_sensible.toFixed(2)} W</p>`;

                // 8. Solar Heat Gain (Sensible)
                const Q_solar_sensible = windowArea * windowSHGC * solarRadiationFactor;
                calculationHtml += `<p><strong>7. Solar Heat Gain (Sensible):</strong></p>`;
                calculationHtml += `<p>Heat gain through windows due to direct solar radiation.</p>`;
                calculationHtml += `<p class="formula">Q<sub>Solar</sub> = Window Area &times; SHGC &times; Solar Radiation Factor</p>`;
                calculationHtml += `<p class="calculation-step">Q<sub>Solar</sub> = ${windowArea.toFixed(2)} m² x ${windowSHGC} x ${solarRadiationFactor.toFixed(2)} W/m² = ${Q_solar_sensible.toFixed(2)} W</p>`;

                // 9. Infiltration Heat Gain (Sensible & Latent)
                const airFlowRate_m3_per_s = (roomVolume * infiltrationACH) / 3600; // m³/s
                const airMassFlowRate_kg_per_s = airFlowRate_m3_per_s * airDensity; // kg/s

                const W_ambient = calculateHumidityRatio(ambientTempHVAC, ambientRH);
                const W_desired = calculateHumidityRatio(desiredRoomTemp, desiredRH);

                const Q_infiltration_sensible = airMassFlowRate_kg_per_s * specificHeatOfAir * (ambientTempHVAC - desiredRoomTemp);
                const Q_infiltration_latent = airMassFlowRate_kg_per_s * (W_ambient - W_desired) * latentHeatOfVaporization;

                calculationHtml += `<p><strong>8. Infiltration Heat Gain (Sensible & Latent):</strong></p>`;
                calculationHtml += `<p>Heat gain due to unconditioned outside air leaking into the room, including both sensible (temperature) and latent (moisture) components.</p>`;
                calculationHtml += `<p class="formula">Q<sub>Infiltration, Sensible</sub> = Mass Flow Rate<sub>air</sub> &times; c<sub>p,air</sub> &times; (T<sub>Ambient</sub> - T<sub>Room</sub>)</p>`;
                calculationHtml += `<p class="formula">Q<sub>Infiltration, Latent</sub> = Mass Flow Rate<sub>air</sub> &times; (W<sub>Ambient</sub> - W<sub>Room</sub>) &times; h<sub>fg</sub></p>`;
                calculationHtml += `<p class="calculation-step">Air Flow Rate (volume) = (${roomVolume.toFixed(2)} m<sup>3</sup> x ${infiltrationACH} ACH) / 3600 s/hr = ${airFlowRate_m3_per_s.toFixed(4)} m<sup>3</sup>/s</p>`;
                calculationHtml += `<p class="calculation-step">Air Mass Flow Rate = ${airFlowRate_m3_per_s.toFixed(4)} m<sup>3</sup>/s x ${airDensity} kg/m<sup>3</sup> = ${airMassFlowRate_kg_per_s.toFixed(4)} kg/s</p>`;
                calculationHtml += `<p class="calculation-step">Humidity Ratio (Ambient, W<sub>amb</sub>) = ${W_ambient.toFixed(5)} kg<sub>water</sub>/kg<sub>dry air</sub></p>`;
                calculationHtml += `<p class="calculation-step">Humidity Ratio (Desired, W<sub>room</sub>) = ${W_desired.toFixed(5)} kg<sub>water</sub>/kg<sub>dry air</sub></p>`;
                calculationHtml += `<p class="calculation-step">Q<sub>Infiltration, Sensible</sub> = ${airMassFlowRate_kg_per_s.toFixed(4)} kg/s x ${specificHeatOfAir} J/kgK x (${ambientTempHVAC.toFixed(1)} - ${desiredRoomTemp.toFixed(1)}) °C = ${Q_infiltration_sensible.toFixed(2)} W</p>`;
                calculationHtml += `<p class="calculation-step">Q<sub>Infiltration, Latent</sub> = ${airMassFlowRate_kg_per_s.toFixed(4)} kg/s x (${W_ambient.toFixed(5)} - ${W_desired.toFixed(5)}) x ${latentHeatOfVaporization.toFixed(0)} J/kg = ${Q_infiltration_latent.toFixed(2)} W</p>`;

                // 10. Total Heat Loads
                let totalSensibleLoad = total_Q_ups_sensible + Q_lights_sensible + Q_people_sensible + Q_other_equipment_sensible + Q_fabric_sensible + Q_solar_sensible + Q_infiltration_sensible;
                let totalLatentLoad = Q_people_latent + Q_infiltration_latent;
                
                // Ensure latent load is not negative (which can happen if desired humidity is higher than ambient, or infiltration is 0)
                if (totalLatentLoad < 0) {
                    totalLatentLoad = 0;
                    calculationHtml += `<p class="calculation-step">Note: Calculated latent load was negative (net moisture loss). Setting latent load to 0 W. Humidification may be required.</p>`;
                }

                let totalCoolingLoadWatts = totalSensibleLoad + totalLatentLoad;
                
                // Calculate Sensible Heat Ratio (SHR)
                const sensibleHeatRatio = totalCoolingLoadWatts > 0 ? (totalSensibleLoad / totalCoolingLoadWatts) : 0;

                // Apply Safety Factor
                const rawTotalSensibleLoad = totalSensibleLoad;
                const rawTotalLatentLoad = totalLatentLoad;
                const rawTotalCoolingLoadWatts = totalCoolingLoadWatts;

                const safetyFactorDecimal = (1 + safetyFactor / 100);
                totalSensibleLoad *= safetyFactorDecimal;
                totalLatentLoad *= safetyFactorDecimal; // Apply safety factor to latent as well
                totalCoolingLoadWatts *= safetyFactorDecimal;

                let totalCoolingLoadKW = totalCoolingLoadWatts / 1000;
                let totalCoolingLoadBTUhr = totalCoolingLoadWatts * CONVERSION_FACTORS.W_to_BTUhr; // Convert to BTU/hr
                let totalCoolingLoadTR = totalCoolingLoadBTUhr / CONVERSION_FACTORS.TR_to_BTUhr; // Convert to Tons of Refrigeration

                calculationHtml += `<p><strong>9. Total Cooling Load (Before Safety Factor):</strong></p>`;
                calculationHtml += `<p class="formula">Total Sensible Load = &sum; Q<sub>Sensible</sub></p>`;
                calculationHtml += `<p class="formula">Total Latent Load = &sum; Q<sub>Latent</sub></p>`;
                calculationHtml += `<p class="formula">Total Cooling Load = Total Sensible Load + Total Latent Load</p>`;
                calculationHtml += `<p class="calculation-step">Total Sensible Load (Raw) = ${rawTotalSensibleLoad.toFixed(2)} W</p>`;
                calculationHtml += `<p class="calculation-step">Total Latent Load (Raw) = ${rawTotalLatentLoad.toFixed(2)} W</p>`;
                calculationHtml += `<p class="calculation-step">Total Cooling Load (Raw) = ${rawTotalCoolingLoadWatts.toFixed(2)} W</p>`;
                calculationHtml += `<p class="calculation-step">Sensible Heat Ratio (SHR) = ${rawTotalSensibleLoad.toFixed(2)} W / ${rawTotalCoolingLoadWatts.toFixed(2)} W = ${sensibleHeatRatio.toFixed(3)}</p>`;


                calculationHtml += `<p><strong>10. Applying Safety Factor (${safetyFactor}%):</strong></p>`;
                calculationHtml += `<p>A safety factor is applied to the calculated load to account for uncertainties, future growth, and peak conditions. This is a critical step in professional HVAC design.</p>`;
                calculationHtml += `<p class="formula">Final Load = Raw Load &times; (1 + Safety Factor / 100)</p>`;
                calculationHtml += `<p class="calculation-step">Final Total Sensible Load = ${rawTotalSensibleLoad.toFixed(2)} W x ${safetyFactorDecimal} = ${totalSensibleLoad.toFixed(2)} W</p>`;
                calculationHtml += `<p class="calculation-step">Final Total Latent Load = ${rawTotalLatentLoad.toFixed(2)} W x ${safetyFactorDecimal} = ${totalLatentLoad.toFixed(2)} W</p>`;
                calculationHtml += `<p class="calculation-step"><strong>Final Total Cooling Load = ${rawTotalCoolingLoadWatts.toFixed(2)} W x ${safetyFactorDecimal} = ${totalCoolingLoadWatts.toFixed(2)} W</strong></p>`;
                
                // Display Results
                calculationDetailsDiv.innerHTML = calculationHtml;

                resultTableBody.innerHTML = '';
                addResultRow("Room Volume", `${currentUnitSystem === 'metric' ? roomVolume.toFixed(2) + ' m³' : (roomVolume * CONVERSION_FACTORS.cubm_to_cubft).toFixed(2) + ' ft³'}`);
                addResultRow("Total UPS/Inverter Heat", `${currentUnitSystem === 'metric' ? total_Q_ups_sensible.toFixed(2) + ' W' : (total_Q_ups_sensible * CONVERSION_FACTORS.W_to_BTUhr).toFixed(2) + ' BTU/hr'}`);
                addResultRow("Lighting Heat Gain", `${currentUnitSystem === 'metric' ? Q_lights_sensible.toFixed(2) + ' W' : (Q_lights_sensible * CONVERSION_FACTORS.W_to_BTUhr).toFixed(2) + ' BTU/hr'}`);
                addResultRow("Occupancy Sensible Heat", `${currentUnitSystem === 'metric' ? Q_people_sensible.toFixed(2) + ' W' : (Q_people_sensible * CONVERSION_FACTORS.W_to_BTUhr).toFixed(2) + ' BTU/hr'}`);
                addResultRow("Other Equipment Heat", `${currentUnitSystem === 'metric' ? Q_other_equipment_sensible.toFixed(2) + ' W' : (Q_other_equipment_sensible * CONVERSION_FACTORS.W_to_BTUhr).toFixed(2) + ' BTU/hr'}`);
                addResultRow("Fabric Heat Gain", `${currentUnitSystem === 'metric' ? Q_fabric_sensible.toFixed(2) + ' W' : (Q_fabric_sensible * CONVERSION_FACTORS.W_to_BTUhr).toFixed(2) + ' BTU/hr'}`);
                addResultRow("Solar Heat Gain", `${currentUnitSystem === 'metric' ? Q_solar_sensible.toFixed(2) + ' W' : (Q_solar_sensible * CONVERSION_FACTORS.W_to_BTUhr).toFixed(2) + ' BTU/hr'}`);
                addResultRow("Infiltration Sensible Heat", `${currentUnitSystem === 'metric' ? Q_infiltration_sensible.toFixed(2) + ' W' : (Q_infiltration_sensible * CONVERSION_FACTORS.W_to_BTUhr).toFixed(2) + ' BTU/hr'}`);
                
                addResultRow("<strong>Total Sensible Load (with Safety Factor)</strong>", `<strong>${currentUnitSystem === 'metric' ? totalSensibleLoad.toFixed(2) + ' W' : (totalSensibleLoad * CONVERSION_FACTORS.W_to_BTUhr).toFixed(2) + ' BTU/hr'}</strong>`);
                addResultRow("<strong>Total Latent Load (with Safety Factor)</strong>", `<strong>${currentUnitSystem === 'metric' ? totalLatentLoad.toFixed(2) + ' W' : (totalLatentLoad * CONVERSION_FACTORS.W_to_BTUhr).toFixed(2) + ' BTU/hr'}</strong>`);
                
                addResultRow("<strong style='color: var(--success); font-size: 1.1em;'>Total Cooling Load (with Safety Factor)</strong>", `<strong style='color: var(--success); font-size: 1.1em;'>${currentUnitSystem === 'metric' ? totalCoolingLoadWatts.toFixed(2) + ' W' : (totalCoolingLoadWatts * CONVERSION_FACTORS.W_to_BTUhr).toFixed(2) + ' BTU/hr'}</strong>`);
                addResultRow("<strong style='color: var(--success); font-size: 1.1em;'>Required Cooling Capacity (kW)</strong>", `<strong style='color: var(--success); font-size: 1.1em;'>${totalCoolingLoadKW.toFixed(2)} kW</strong>`);
                addResultRow("<strong style='color: var(--success); font-size: 1.1em;'>Required Cooling Capacity (BTU/hr)</strong>", `<strong style='color: var(--success); font-size: 1.1em;'>${totalCoolingLoadBTUhr.toFixed(2)} BTU/hr</strong>`);
                addResultRow("<strong style='color: var(--success); font-size: 1.1em;'>Required Cooling Capacity (Tons)</strong>", `<strong style='color: var(--success); font-size: 1.1em;'>${totalCoolingLoadTR.toFixed(2)} TR</strong>`);
                addResultRow("<strong>Sensible Heat Ratio (SHR)</strong>", `<strong>${sensibleHeatRatio.toFixed(3)}</strong>`); // SHR is dimensionless

                standardRefText = "HVAC sizing calculations for critical environments like UPS/Inverter rooms are based on fundamental principles of thermodynamics and heat transfer, as outlined by international standards and guidelines from organizations such as <a href=\"https://www.ashrae.org/\" target=\"_blank\">ASHRAE (American Society of Heating, Refrigerating and Air-Conditioning Engineers)</a>, <a href=\"https://www.iso.org/\" target=\"_blank\">ISO (International Organization for Standardization)</a>, and <a href=\"https://www.cibse.org/\" target=\"_blank\">CIBSE (Chartered Institution of Building Services Engineers)</a>. These standards provide methodologies for calculating heat gains from various sources and determining the required cooling capacity. This tool provides an estimate; always refer to the complete official standards and consult with a qualified HVAC engineer for final design and safety verification.";
                standardReference.innerHTML = standardRefText;

                resultContainer.style.display = 'block';
                setTimeout(() => {
                    resultContainer.classList.add('show');
                    resultContainer.scrollIntoView({ behavior: 'smooth' });
                }, 10);
            }

            // Function to display messages (replaces alert())
            function displayMessage(message, type = "info") { // type can be 'info', 'success', 'warning', 'error'
                let messageBox = document.getElementById('custom-message-box');
                
                messageBox.textContent = message;
                messageBox.className = 'message-box'; // Reset classes
                
                if (type === "error") {
                    messageBox.classList.add('error');
                } else if (type === "warning") {
                    messageBox.classList.add('warning');
                } else if (type === "success") {
                     messageBox.classList.add('success');
                } else {
                    messageBox.classList.add('info');
                }
                
                messageBox.classList.add('show');

                // Hide after 5 seconds
                setTimeout(() => {
                    messageBox.classList.remove('show');
                }, 5000);
            }

            // Theme switch logic
            const themeSwitch = document.getElementById('theme-switch');
            if (themeSwitch) {
                if (localStorage.getItem('theme') === 'dark') {
                    document.body.classList.add('dark-mode');
                    themeSwitch.checked = true;
                }

                themeSwitch.addEventListener('change', function() {
                    if (this.checked) {
                        document.body.classList.add('dark-mode');
                        localStorage.setItem('theme', 'dark');
                    } else {
                        document.body.classList.remove('dark-mode');
                        localStorage.setItem('theme', 'light');
                    }
                });
            }

            // Initial fade-in for form sections
            const formSections = document.querySelectorAll('.form-section');
            formSections.forEach((section, index) => {
                setTimeout(() => {
                    section.classList.add('fade-in');
                }, 100 * index); // Staggered fade-in
            });

            // Initial unit display
            updateUnitLabelsAndTooltips(unitSystemSelect.value);
        });
    </script>
</body>
</html>

