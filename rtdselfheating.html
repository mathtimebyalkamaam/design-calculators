<!DOCTYPE html>
<html lang="en">
<head>
    <!-- AdSense & Analytics -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5936527763614780" crossorigin="anonymous"></script>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-23Y1V450SR"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-23Y1V450SR');
    </script>
    
    <!-- SEO Meta Tags -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RTD Self-Heating Error Calculator - Industrial Grade Analysis</title>
    <meta name="description" content="Professional RTD Self-Heating Calculator. Quantify temperature measurement errors caused by excitation current (Joule heating). Compare Pt100 vs Pt1000 in Air/Water contexts.">
    <meta name="keywords" content="RTD self-heating, joule heating, Pt100 error, excitation current, dissipation constant, temperature measurement, metrology, sensor calibration, instrumentation">
    <meta name="author" content="Design Calculators">
    <meta name="robots" content="index, follow">

    <!-- Fonts & Icons -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Montserrat:wght@700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- PDF Generation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.8.3/jspdf.plugin.autotable.min.js"></script>

    <!-- Chart.js for Visuals -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Chart.js Annotation Plugin -->
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation@2.2.1/dist/chartjs-plugin-annotation.min.js"></script>

    <!-- MathJax for Formulas -->
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['\\(', '\\)'], ['$', '$']],
                displayMath: [['\\[', '\\]'], ['$$', '$$']]
            },
            svg: { fontCache: 'global' }
        };
    </script>
    <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <!-- Favicon Links -->
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">

    <style>
        /* --- CORE THEME (Blue Industrial - Matches Symmetrical Components) --- */
        :root {
            --primary: #1E3A8A; /* Dark Blue */
            --secondary: #2563EB; /* Bright Blue */
            --accent: #F59E0B; /* Amber */
            --success: #10B981;
            --danger: #DC2626;
            --warning: #F59E0B;
            --bg: #F8FAFC;
            --card: #FFFFFF;
            --text: #4B5563;
            --heading: #111827;
            --footer-bg: #0F172A;
            --border: #E2E8F0;
            --grad: linear-gradient(135deg, var(--primary), var(--secondary));
            --grad-dark: linear-gradient(135deg, #0F172A, #1E293B);
            --shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
            --shadow-lg: 0 10px 20px rgba(0, 0, 0, 0.1);
        }

        body.dark-mode {
            --primary: #10B981;
            --secondary: #34D399;
            --bg: #0F172A;
            --card: #1E293B;
            --text: #CBD5E1;
            --heading: #F1F5F9;
            --footer-bg: #020617;
            --border: #334155;
            --accent: #F59E0B;
        }

        * { box-sizing: border-box; }
        html { scroll-behavior: smooth; }
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg);
            color: var(--text);
            line-height: 1.7;
            margin: 0;
            padding: 0;
        }

        .container { max-width: 1280px; margin: 0 auto; padding: 0 24px; }

        /* Header & Nav */
        header {
            background: var(--grad);
            color: white;
            padding: 24px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .logo-container {
            display: flex;
            flex-direction: column;
            text-decoration: none;
            color: white;
        }
        .logo-text {
            font-size: 1.75rem;
            font-weight: 800;
            font-family: 'Montserrat', sans-serif;
        }
        .logo-subtitle {
            font-size: 0.8rem;
            margin: 4px 0 0 0;
            color: #E0E7FF;
            opacity: 0.9;
        }
        .nav-links {
            display: flex;
            gap: 24px;
            list-style: none;
            margin: 0;
            padding: 0;
        }
        .nav-links a {
            color: white;
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s;
        }
        .nav-links a:hover { color: var(--accent); }
        
        /* Theme Toggle */
        .theme-toggle {
            display: flex;
            align-items: center;
            gap: 12px;
            color: white;
        }
        .switch {
            position: relative;
            width: 56px;
            height: 30px;
        }
        .switch input { opacity: 0; width: 0; height: 0; }
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0; left: 0; right: 0; bottom: 0;
            background-color: rgba(0,0,0,0.2);
            transition: .4s;
            border-radius: 30px;
        }
        .slider:before {
            position: absolute;
            content: "";
            height: 22px; width: 22px;
            left: 4px; bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        input:checked + .slider { background-color: var(--accent); }
        input:checked + .slider:before { transform: translateX(26px); }

        /* Main Content & Cards */
        main { padding: 40px 0; }
        .card {
            background: var(--card);
            border-radius: 12px;
            padding: 30px;
            box-shadow: var(--shadow);
            margin-bottom: 30px;
            border: 1px solid var(--border);
        }
        .card h2 {
            color: var(--primary);
            border-bottom: 3px solid var(--primary);
            padding-bottom: 15px;
            margin-top: 0;
            font-family: 'Montserrat', sans-serif;
            font-size: 1.8rem;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        h3 {
            color: var(--heading);
            font-family: 'Montserrat', sans-serif;
            font-size: 1.5rem;
            margin-top: 25px;
            margin-bottom: 20px;
        }

        /* Forms */
        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        .form-group { margin-bottom: 0; }
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--heading);
        }
        .form-group input, .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--border);
            border-radius: 6px;
            background-color: var(--bg);
            color: var(--text);
            font-size: 1rem;
            transition: all 0.3s ease;
        }
        .form-group input:focus, .form-group select:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 3px rgba(30, 58, 138, 0.1);
        }
        body.dark-mode .form-group input:focus { 
            box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1);
        }

        /* Buttons */
        .btn {
            background: var(--grad);
            color: white;
            border: none;
            padding: 16px 30px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: 700;
            box-shadow: 0 4px 12px rgba(30, 58, 138, 0.3);
            transition: all 0.3s;
            width: 100%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(30, 58, 138, 0.4);
        }
        .btn-outline {
            background: transparent;
            border: 2px solid var(--secondary);
            color: var(--secondary);
            font-size: 0.9rem;
            padding: 8px 16px;
        }
        .btn-outline:hover {
            background: var(--secondary);
            color: white;
        }
        .button-wrapper {
            display: flex;
            justify-content: center;
            width: 100%;
            padding-top: 15px;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        /* Quick Load Buttons */
        .preset-container {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }
        .preset-btn {
            padding: 8px 12px;
            font-size: 0.85rem;
            border: 1px solid var(--border);
            background: var(--card);
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.2s;
            color: var(--text);
            display: flex;
            align-items: center;
            gap: 5px;
        }
        .preset-btn:hover {
            background: var(--bg);
            border-color: var(--secondary);
            color: var(--secondary);
        }

        /* Results Layout */
        .results-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            align-items: start;
        }
        @media (max-width: 1024px) {
            .results-grid { grid-template-columns: 1fr; }
        }

        .results-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            border-radius: 8px;
            overflow: hidden;
        }
        .results-table th, .results-table td {
            padding: 14px;
            text-align: left;
            border-bottom: 1px solid var(--border);
        }
        .results-table th {
            background: var(--grad);
            color: white;
            font-weight: 700;
        }
        .results-table tr:nth-child(even) { background-color: var(--bg); }
        .results-table td:first-child {
            font-weight: 600;
            color: var(--heading);
        }
        .highlight { color: var(--success); font-weight: 700; }
        .danger-text { color: var(--danger); font-weight: 700; }

        /* Canvas Container */
        .chart-container {
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 15px;
            position: relative;
            height: 400px;
            width: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        canvas {
            max-width: 100%;
            max-height: 100%;
        }

        /* Educational Section Styling */
        .insight-card {
            background: linear-gradient(135deg, var(--card), rgba(37,99,235,0.03));
            border-radius: 12px;
            padding: 25px;
            margin: 20px 0;
            border-left: 5px solid var(--secondary);
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            transition: all 0.3s;
        }
        .insight-card:hover {
            transform: translateX(5px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        .insight-card h4 {
            color: var(--secondary);
            font-size: 1.3rem;
            margin: 0 0 15px 0;
            display: flex;
            align-items: center;
            gap: 10px;
            font-family: 'Montserrat', sans-serif;
        }
        .insight-card p, .insight-card ul {
            margin: 10px 0;
            line-height: 1.8;
            color: var(--text);
        }
        .insight-card ul { padding-left: 20px; }
        .insight-card li { margin-bottom: 8px; }

        /* Formulas & Steps */
        .formula {
            background: var(--bg);
            border-left: 3px solid var(--accent);
            padding: 15px;
            margin: 12px 0;
            font-size: 1.1rem;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            overflow-x: auto;
            color: var(--heading);
        }
        .calculation-step {
            font-family: 'Courier New', monospace;
            background-color: rgba(0,0,0,0.03);
            padding: 15px;
            border-radius: 4px;
            margin-bottom: 15px;
            border-left: 4px solid var(--success);
            font-size: 0.95rem;
            line-height: 1.6;
        }
        body.dark-mode .calculation-step { background-color: rgba(255,255,255,0.05); }

        /* Vector Input Group Styling (Reused) */
        .vector-input-group {
            background: var(--bg);
            padding: 15px;
            border-radius: 8px;
            border: 1px solid var(--border);
            position: relative;
        }
        .vector-input-header {
            font-weight: 700;
            margin-bottom: 10px;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        /* Print Styling */
        @media print {
            header, footer, .education-section, .theme-toggle, .button-wrapper, .preset-container { display: none !important; }
            .card { border: none; shadow: none; padding: 0; }
            .container { width: 100%; max-width: 100%; padding: 0; }
            .results-grid { grid-template-columns: 1fr 1fr; }
            .chart-container { height: 300px; page-break-inside: avoid; }
        }

        /* Message Box */
        .message-box {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            padding: 16px 28px;
            border-radius: 8px;
            box-shadow: 0 6px 16px rgba(0,0,0,0.25);
            z-index: 10000;
            font-weight: 600;
            color: white;
            opacity: 0;
            transition: all 0.4s;
            display: none;
        }
        .message-box.show { display: block; opacity: 1; top: 30px; }
        .hidden { display: none; }

        /* Tooltip */
        .info-icon { color: var(--secondary); margin-left: 5px; cursor: help; }
        .tooltip { position: relative; display: inline-block; }
        .tooltip .tooltiptext {
            visibility: hidden;
            width: 220px;
            background-color: #333;
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 8px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -110px;
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 0.85rem;
            font-weight: 400;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .tooltip:hover .tooltiptext { visibility: visible; opacity: 1; }

        /* Footer */
        footer {
            background: var(--grad-dark);
            color: #CBD5E1;
            padding: 50px 0 20px 0;
            margin-top: 60px;
        }
        .footer-content {
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 40px;
            margin-bottom: 30px;
        }
        .footer-col { flex: 1; min-width: 200px; }
        .footer-col h4 { color: white; margin-bottom: 15px; font-weight: 700; }
        .footer-col ul { list-style: none; padding: 0; margin: 0; }
        .footer-col a { color: #CBD5E1; text-decoration: none; transition: color 0.3s; }
        .footer-col a:hover { color: var(--accent); }
        .social-buttons { display: flex; gap: 12px; margin-top: 15px; }
        .social-btn {
            width: 40px; height: 40px;
            display: flex; justify-content: center; align-items: center;
            color: white; border-radius: 50%;
            font-size: 1.1rem; transition: transform 0.3s;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        .social-btn:hover { transform: translateY(-4px); }
        .social-btn.linkedin { background-color: #0A66C2; }
        .social-btn.youtube { background-color: #FF0000; }
        .social-btn.twitter { background-color: #1DA1F2; }
        .social-btn.facebook { background-color: #1877F2; }
        .social-btn.whatsapp { background-color: #25D366; }
        .footer-disclaimer {
            text-align: center; padding-top: 25px;
            border-top: 1px solid #334155;
            max-width: 800px; margin: 0 auto;
            font-size: 0.9rem;
        }
        .footer-bottom {
            text-align: center; padding-top: 20px;
            font-size: 0.9rem; color: #94A3B8;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .container { padding: 0 15px; }
            .navbar { flex-direction: column; gap: 20px; }
            .nav-links { flex-direction: column; gap: 12px; text-align: center; }
            .form-row { grid-template-columns: 1fr; }
            .card { padding: 20px; }
            .footer-content { flex-direction: column; gap: 25px; }
        }
    </style>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div id="message-box" class="message-box"></div>
    <header class="header">
        <div class="header-bg-animation"></div>
        <div class="container">
            <nav class="navbar">
                <a href="/" class="logo-container">
                    <img src="logo.png" alt="Design Calculators Logo" class="logo">
                    <span class="logo-text">Design Calculators</span>
                </a>

                <div class="nav-menu">
                    <button class="mobile-menu-toggle" aria-label="Toggle menu">
                        <i class="fas fa-bars"></i>
                    </button>

                    <ul class="nav-links">
                        <li><a href="/index.html">Home</a></li>
                        
    <li class="dropdown">
        <a href="/indexele.html" class="dropdown-toggle">Electrical <i class="fas fa-chevron-down" style="font-size: 0.7em; margin-left: 4px;"></i></a>
        <div class="dropdown-menu">
            <div class="repo-grid"><div><a href="/arcflash.html">Arc Flash Calculator</a><a href="/breaker-sizing.html">Breaker Sizing</a><a href="/cable-thermal-rating.html">Cable Ampacity</a><a href="/comm-cable-loss.html">Comm Cable Loss</a><a href="/earth-conductor-size.html">Earth Conductor Size</a><a href="/generatorsizing.html">Generator Sizing</a><a href="/harmonicsanalyser.html">Harmonics Analyser</a><a href="/insulationresistance.html">Insulation Resistance</a><a href="/logicgate.html">Logic Gates Simulator</a><a href="/motor-starting.html">Motor Starting Current</a><a href="/pcbtrace.html">PCB Trace Width</a><a href="/protection-device.html">Protection Device</a><a href="/resistor.html">Resistor Color Code</a><a href="/solarcable.html">Solar Cable Sizing</a><a href="/systemxrcalculator.html">System X/R Ratio</a><a href="/transmissionline.html">Transmission Line</a><a href="/vfd-selection.html">VFD Selection Tool</a></div><div><a href="/batterylife.html">Battery Life Estimator</a><a href="/busbarampacity.html">Busbar Ampacity</a><a href="/cablepulling.html">Cable Pulling Tension</a><a href="/conduit-fill.html">Conduit Fill Calculator</a><a href="/earthingfaultsimulator.html">Earthing Fault Simulator</a><a href="/grounding.html">Grounding System Design</a><a href="/hvac-sizing.html">HVAC Sizing Calculator</a><a href="/lcresonancecalculator.html">LC Resonance Calculator</a><a href="/maintenance-guide.html">Maintenance Guide</a><a href="/nemaipconvertor.html">NEMA to IP Converter</a><a href="/power-factor.html">Power Factor Correction</a><a href="/relay-coordination.html">Relay Coordination</a><a href="/short-circuit.html">Short Circuit Current</a><a href="/solarpvarray.html">Solar PV Array</a><a href="/transformer-calculator.html">Transformer Calculator</a><a href="/unit-converter.html">Unit Converter</a><a href="/voltage-drop.html">Voltage Drop Calculator</a></div><div><a href="/battery-sizing.html">Battery Sizing (AH)</a><a href="/busbarshortcircuit.html">Busbar Short Circuit</a><a href="/cable-sizing.html">Cable Sizing Calculator</a><a href="/ctsaturation.html">CT Saturation</a><a href="/equipment-relay.html">Equipment Relay Setting</a><a href="/harmonic-distortion.html">Harmonic Distortion</a><a href="/industriallighting.html">Industrial Lighting</a><a href="/lighting-calulator.html">Lighting Calculator</a><a href="/motor-efficiency.html">Motor Efficiency</a><a href="/neutral-earth-fault-current.html">Neutral Earth Fault</a><a href="/powertriangletool.html">Power Triangle</a><a href="/electricalresidentialload.html">Residential Load Calc</a><a href="/skindepth.html">Skin Depth Calculator</a><a href="/symmetricalcomponents.html">Symmetrical Components</a><a href="/transformerinrush.html">Transformer Inrush</a><a href="/ups-sizing.html">UPS Sizing</a></div>
            </div>
            <div class="view-all-container">
                <a href="/indexele.html" class="view-all-link">View All Electrical Tools â†’</a>
            </div>
        </div>
    </li>
                        
    <li class="dropdown">
        <a href="/indexinst.html" class="dropdown-toggle">Instrumentation <i class="fas fa-chevron-down" style="font-size: 0.7em; margin-left: 4px;"></i></a>
        <div class="dropdown-menu">
            <div class="repo-grid"><div><a href="/adc-resolution.html">ADC Resolution</a><a href="/capillarylengthtemperatureerror.html">Capillary Error</a><a href="/cv-kv-valve.html">Cv/Kv Valve Sizing</a><a href="/dp-level.html">DP Level Measurement</a><a href="/hydrostatic-level.html">Hydrostatic Level</a><a href="/instrument-range.html">Instrument Range</a><a href="/loop-impedance.html">Loop Impedance</a><a href="/orifice-plate.html">Orifice Plate Beta</a><a href="/pid-tuning.html">PID Tuning</a><a href="/profibus.html">Profibus Calculator</a><a href="/tempsensorresponse.html">Response Time (Tau)</a><a href="/rtd-lead-comp.html">RTD Lead Wire Comp.</a><a href="/sealfluidzeroshift.html">Seal Fluid Shift</a><a href="/snr-calculator.html">SNR Calculator</a><a href="/thermocoupleextensioncable.html">TC Extension Cable</a><a href="/thermowellwakefreq.html">Thermowell Frequency</a><a href="/pressuretransmitteroverrange.html">Tx Overrange</a><a href="/valvecavitationcalculator.html">Valve Cavitation</a><a href="/vibrationtransmitter.html">Vibration Tx</a><a href="/zoneclassificationhelper.html">Zone Classification</a></div><div><a href="/baud-rate.html">Baud Rate Calculator</a><a href="/gascompressibility.html">Compressibility (Z)</a><a href="/dbcalculator.html">dB Gain/Loss Calc</a><a href="/flowprofiledistortioncalculator.html">Flow Distortion</a><a href="/impulselinefreezing.html">Impulse Freezing</a><a href="/intrinsic-safety.html">Intrinsic Safety Loop</a><a href="/measurement.html">Measurement Uncertainty</a><a href="/ph-temp-comp.html">pH Temp Compensation</a><a href="/plcscantime.html">PLC Scan Time</a><a href="/pressurereliefvalve.html">PRV Sizing (API 520)</a><a href="/reynoldsnumbercal.html">Reynolds Number</a><a href="/rtdselfheating.html">RTD Self-Heating</a><a href="/signal-scaling.html">Signal Scaling</a><a href="/staticheadcal.html">Static Head</a><a href="/temperaturesensorlag.html">Temp Sensor Lag</a><a href="/thermowell-wake.html">Thermowell Wake</a><a href="/ultrasoniclevel.html">Ultrasonic Level</a><a href="/valve-cv.html">Valve Cv Viewer</a><a href="/wetlegdensitycompensation.html">Wet Leg Compensation</a></div><div><a href="/capacitance-level.html">Capacitance Level</a><a href="/controlvalvenoise.html">Control Valve Noise</a><a href="/dp-flow-conversion.html">DP Flow Conversion</a><a href="/hartdevices.html">HART Devices</a><a href="/impulse-pressure-drop.html">Impulse Pressure Drop</a><a href="/junctionbox.html">Junction Box Sizing</a><a href="/orifice-flow.html">Orifice Flow Calculator</a><a href="/pid-symbol-library.html">PID Symbol Library</a><a href="/power-supply-load.html">Power Supply Load</a><a href="/prvsizing.html">Relief Orifice Area</a><a href="/rtdexcitationcurrentselection.html">RTD Excitation</a><a href="/rtd-tc-conversion.html">RTD/TC Conversion</a><a href="/sil.html">SIL Calculator</a><a href="/steamflow.html">Steam Flow</a><a href="/thermocouplecjccalculator.html">Thermocouple CJC</a><a href="/turndown.html">Turndown Ratio</a><a href="/controlvalveauthority.html">Valve Authority</a><a href="/controlvalveleakage.html">Valve Leakage Class</a><a href="/wirelesshart.html">WirelessHART Range</a></div>
            </div>
            <div class="view-all-container">
                <a href="/indexinst.html" class="view-all-link">View All Instrumentation Tools â†’</a>
            </div>
        </div>
    </li>
                        
    <li class="dropdown">
        <a href="/indexmech.html" class="dropdown-toggle">Mechanical <i class="fas fa-chevron-down" style="font-size: 0.7em; margin-left: 4px;"></i></a>
        <div class="dropdown-menu">
            <div class="repo-grid"><div><a href="/aircompressorfad.html">Air Compressor FAD</a><a href="/asme-vessel.html">ASME Vessel Design</a><a href="/belt-pulley.html">Belt & Pulley</a><a href="/bolt-torque.html">Bolt Torque</a><a href="/controlvalveactuator.html">Control Valve Actuator</a><a href="/frictionfactortool.html">Darcy Friction Factor</a><a href="/fatigue.html">Fatigue Analysis</a><a href="/fuel-combustion.html">Fuel Combustion</a><a href="/gas.html">Gas Properties</a><a href="/heat-exchanger.html">Heat Exchanger</a><a href="/hydroliccylinder.html">Hydraulic Cylinder</a><a href="/material-compatibility.html">Material Compatibility</a><a href="/nozzle-reinforcement.html">Nozzle Reinforcement</a><a href="/openchannelflow.html">Open Channel Flow</a><a href="/pipescheduletool.html">Pipe Schedule & Stress</a><a href="/pump-head.html">Pump Head</a><a href="/shaft-power-torque.html">Shaft Power & Torque</a><a href="/steam-table.html">Steam Table</a><a href="/vibrationanalysis.html">Vibration Analysis</a></div><div><a href="/air-flow-duct.html">Air Flow Duct Sizing</a><a href="/beam-deflection.html">Beam Deflection</a><a href="/bernoulli-equation.html">Bernoulli Equation</a><a href="/chiller-capacity.html">Chiller Capacity</a><a href="/cooling-tower-sizing.html">Cooling Tower Sizing</a><a href="/darcy-weisbach.html">Darcy-Weisbach</a><a href="/finned-tube-heat-transfer.html">Finned Tube Heat</a><a href="/furnace-heat-duty.html">Furnace Heat Duty</a><a href="/gear-design.html">Gear Design</a><a href="/heat-loss-pipes.html">Heat Loss Pipes</a><a href="/jacketed-vessel-heat-transfer.html">Jacketed Vessel</a><a href="/metalweight.html">Metal Weight Calculator</a><a href="/nptbspthreadcalculator.html">NPT/BSP Threads</a><a href="/overall-heat-transfer.html">Overall Heat Transfer</a><a href="/pipe-stress-flexibility.html">Pipe Stress</a><a href="/pump-power.html">Pump Power</a><a href="/specific-heat-enthalpy.html">Specific Heat</a><a href="/storage-tank-volume.html">Storage Tank Volume</a><a href="/weldingstress.html">Welding Stress</a></div><div><a href="/allowable-stress-safety-factor.html">Allowable Stress</a><a href="/bearinglife.html">Bearing Life Calculator</a><a href="/boiler-efficiency.html">Boiler Efficiency</a><a href="/compressor-power.html">Compressor Power</a><a href="/corrosion-rate.html">Corrosion Rate</a><a href="/fan-laws.html">Fan Laws</a><a href="/foundation.html">Foundation Design</a><a href="/gas-laws.html">Gas Laws</a><a href="/hardness.html">Hardness Converter</a><a href="/conduction-convection-radiation.html">Heat Transfer Modes</a><a href="/machining.html">Machining Calculator</a><a href="/momentofinertia.html">Moment of Inertia</a><a href="/oring.html">O-Ring Sizing</a><a href="/pipe-flow.html">Pipe Flow Calculator</a><a href="/psychrometric.html">Psychrometric Calc</a><a href="/reynolds-number.html">Reynolds Number</a><a href="/spring.html">Spring Design</a><a href="/thermal-expansion.html">Thermal Expansion</a></div>
            </div>
            <div class="view-all-container">
                <a href="/indexmech.html" class="view-all-link">View All Mechanical Tools â†’</a>
            </div>
        </div>
    </li>
                        <li><a href="/index.html#articles">Articles</a></li>
                        <li><a href="/sitemap2.html">Site Map</a></li>
                    </ul>

                    <div class="theme-toggle">
                        <i class="fas fa-sun icon"></i>
                        <label class="switch">
                            <input type="checkbox" id="theme-switch">
                            <span class="slider"></span>
                        </label>
                        <i class="fas fa-moon icon"></i>
                    </div>
                </div>
            </nav>
    </header>

    <main class="container">
        <div class="card">
            <h2><i class="fas fa-thermometer-three-quarters"></i> RTD Self-Heating Error Calculator</h2>
            
            <div class="tool-description">
                <p>Calculate the measurement error caused by <strong>Joule Heating ($I^2R$)</strong> in RTD sensors. This industrial-grade tool helps instrumentation engineers validate excitation currents for high-precision applications. It simulates physics based on the <strong>Dissipation Constant ($P_D$)</strong> of the sensor in various media (Air/Water) and sensor types (Wire-Wound/Thin-Film).</p>
            </div>

            <div class="calculator-form">
                <form id="rtd-form">
                    <!-- Controls Row -->
                    <div class="form-row" style="align-items: end;">
                        <div class="form-group">
                            <label>Quick Load Scenarios:</label>
                            <div class="preset-container" style="margin-bottom: 0;">
                                <button type="button" class="preset-btn" onclick="loadPreset('standard_water')"><i class="fas fa-water"></i> Pt100 in Water (1mA)</button>
                                <button type="button" class="preset-btn" onclick="loadPreset('high_current_air')"><i class="fas fa-wind"></i> Pt100 High Current (2mA)</button>
                                <button type="button" class="preset-btn" onclick="loadPreset('pt1000_low')"><i class="fas fa-microchip"></i> Pt1000 Low Power</button>
                            </div>
                        </div>
                    </div>

                    <!-- Sensor Specs -->
                    <h4 style="color: var(--primary); margin-bottom: 15px; border-bottom: 1px solid var(--border); padding-bottom: 5px;">1. Sensor Configuration</h4>
                    <div class="form-row">
                        <div class="vector-input-group">
                            <div class="vector-input-header"><i class="fas fa-microchip"></i> Sensor Type</div>
                            <div class="form-group">
                                <label for="rtd-type">Element Type</label>
                                <select id="rtd-type">
                                    <option value="pt100" selected>Pt100 (100Ω @ 0°C)</option>
                                    <option value="pt500">Pt500 (500Ω @ 0°C)</option>
                                    <option value="pt1000">Pt1000 (1000Ω @ 0°C)</option>
                                </select>
                            </div>
                        </div>
                        <div class="vector-input-group">
                            <div class="vector-input-header"><i class="fas fa-ruler-horizontal"></i> Construction</div>
                            <div class="form-group">
                                <label for="construction">Element Construction</label>
                                <select id="construction">
                                    <option value="wire_wound">Wire Wound (Ceramic) - Better Dissipation</option>
                                    <option value="thin_film" selected>Thin Film (Glass) - Faster, Less Mass</option>
                                </select>
                            </div>
                        </div>
                        <div class="vector-input-group">
                            <div class="vector-input-header"><i class="fas fa-thermometer"></i> Process</div>
                            <div class="form-group">
                                <label for="process-temp">Process Temperature ($T_{proc}$) [°C]</label>
                                <input type="number" id="process-temp" value="100.0" step="0.1">
                            </div>
                        </div>
                    </div>

                    <!-- Excitation & Environment -->
                    <h4 style="color: var(--primary); margin-bottom: 15px; border-bottom: 1px solid var(--border); padding-bottom: 5px; margin-top: 20px;">2. Electronics & Environment</h4>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="excitation">Excitation Current ($I_{exc}$) [mA] <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Current supplied by the transmitter/PLC. Standard is ~1mA. Low power is <0.5mA.</span></span></label>
                            <input type="number" id="excitation" value="1.0" step="0.1">
                        </div>
                        <div class="form-group">
                            <label for="medium">Immersion Medium</label>
                            <select id="medium">
                                <option value="still_air">Still Air (Worst Case)</option>
                                <option value="moving_air">Flowing Air (10 m/s)</option>
                                <option value="still_water">Still Water</option>
                                <option value="moving_water" selected>Flowing Water (1 m/s)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="dissipation-const">Dissipation Constant ($P_D$) [mW/°C] <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Power required to raise sensor temp by 1°C. Auto-populated based on Medium/Construction, or enter datasheet value.</span></span></label>
                            <input type="number" id="dissipation-const" value="50.0" step="1.0">
                        </div>
                    </div>

                    <div class="button-wrapper">
                        <button type="button" id="calculate-btn" class="btn"><i class="fas fa-calculator"></i> Calculate Error</button>
                        <button type="button" id="pdf-btn" class="btn btn-outline"><i class="fas fa-file-pdf"></i> Download PDF Report</button>
                    </div>
                </form>
            </div>

            <!-- Results Section -->
            <div id="result-container" class="card hidden" style="margin-top: 40px;">
                <h3><i class="fas fa-poll"></i> Calculation Results</h3>
                
                <div class="results-grid">
                    <!-- Left Col: Table -->
                    <div>
                        <h4 style="margin-top: 0; color: var(--primary); margin-bottom: 15px;">Thermal Analysis</h4>
                        <table class="results-table">
                            <thead>
                                <tr>
                                    <th>Parameter</th>
                                    <th>Value</th>
                                    <th>Unit</th>
                                </tr>
                            </thead>
                            <tbody id="result-table-body">
                                <!-- Dynamic rows -->
                            </tbody>
                        </table>
                        
                        <div style="margin-top: 20px; background: var(--bg); padding: 15px; border-radius: 6px; border: 1px solid var(--border);">
                            <strong><i class="fas fa-info-circle"></i> Assessment:</strong>
                            <div id="interpretation-text" style="margin-top: 5px; font-size: 0.95rem;"></div>
                        </div>
                    </div>

                    <!-- Right Col: Visual Chart -->
                    <div>
                        <h4 style="margin-top: 0; color: var(--primary); margin-bottom: 15px;">Error vs Current Curve</h4>
                        <div class="chart-container">
                            <canvas id="heatingChart"></canvas>
                        </div>
                        <div style="text-align: center; margin-top: 10px; font-size: 0.85rem; color: var(--text);">
                            <span style="color: #EF4444;">● Current Setting Error</span> &nbsp;
                            <span style="color: #3B82F6;">— Error Trend</span>
                        </div>
                    </div>
                </div>

                <h4 style="margin-top: 30px; border-top: 1px solid var(--border); padding-top: 20px;">Step-by-Step Engineering Calculation</h4>
                <div id="calculation-details">
                    <!-- Dynamic math steps -->
                </div>

                <div class="standard-reference" style="margin-top: 20px; font-style: italic; color: var(--text);">
                     Based on Callendar-Van Dusen equation (IEC 60751) and Joule Heating Law ($P = I^2R$).
                </div>
            </div>
        </div>

        <!-- EDUCATIONAL CONTENT SECTION (MASSIVE) -->
        <div class="education-section card">
            <h2><i class="fas fa-lightbulb"></i> Engineering Insights: The Physics of RTD Self-Heating</h2>
            
            <!-- Insight 1: Joule Heating -->
            <div class="insight-card">
                <h4><i class="fas fa-fire"></i> 1. The Physics of Self-Heating (Joule Effect)</h4>
                <p>An RTD (Resistance Temperature Detector) is a passive resistor. To measure its resistance, the transmitter (or PLC card) must force a current ($I_{exc}$) through it to measure the voltage drop ($V=IR$). Physics dictates that passing current through any resistance generates heat. This is <strong>Joule Heating</strong>.</p>
                <div class="formula">
                    $$ P_{dissipated} = I_{exc}^2 \times R_{sensor} $$
                </div>
                <p>This power dissipation creates internal heat within the sensor element. Since the sensor is now generating heat, its temperature becomes slightly higher than the surrounding process fluid it is trying to measure. This temperature difference ($\Delta T$) is the <strong>Self-Heating Error</strong>.</p>
                <p>The magnitude of this error depends on two things:
                <ol>
                    <li><strong>Power Input:</strong> How much heat is generated ($mW$).</li>
                    <li><strong>Dissipation Constant ($P_D$):</strong> How efficiently the sensor can dump that heat into the surrounding medium ($mW/^\circ C$).</li>
                </ol>
                </p>
            </div>

            <!-- Insight 2: Dissipation Constant -->
            <div class="insight-card">
                <h4><i class="fas fa-wind"></i> 2. The Dissipation Constant ($P_D$)</h4>
                <p>The Self-Heating Coefficient or Dissipation Constant represents the amount of power required to raise the sensor's temperature by $1^\circ C$ above ambient. It is an index of thermal coupling.</p>
                <ul>
                    <li><strong>In Still Air:</strong> Heat transfer is poor (Natural Convection). $P_D$ is very low (typically 1-2 mW/°C for a 3mm probe). A small amount of power causes a large temperature rise.</li>
                    <li><strong>In Flowing Water:</strong> Heat transfer is excellent (Forced Convection). $P_D$ is high (typically 40-100 mW/°C). The water strips the heat away instantly, minimizing error.</li>
                </ul>
                <p><strong>Rule of Thumb:</strong> Self-heating is rarely an issue in liquids but is the #1 source of error in gas/air measurements, especially with high-resistance sensors (Pt1000).</p>
            </div>

            <!-- Insight 3: Pt100 vs Pt1000 -->
            <div class="insight-card">
                <h4><i class="fas fa-balance-scale"></i> 3. Pt100 vs. Pt1000 Selection Strategy</h4>
                <p>Engineers often choose Pt1000 to minimize lead wire resistance errors (2-wire circuits). However, Pt1000 introduces a new problem: <strong>10x Resistance = 10x Power Dissipation</strong> (if current is constant).</p>
                <p>Let's assume a transmitter uses a fixed 1mA excitation current:
                <ul>
                    <li><strong>Pt100 @ 0°C:</strong> $P = (0.001 A)^2 \times 100 \Omega = 0.1 mW$.</li>
                    <li><strong>Pt1000 @ 0°C:</strong> $P = (0.001 A)^2 \times 1000 \Omega = 1.0 mW$.</li>
                </ul>
                In still air ($P_D \approx 1 mW/^\circ C$), the Pt1000 will read <strong>$1.0^\circ C$ high</strong> purely due to self-heating! The Pt100 will only read $0.1^\circ C$ high.
                </p>
                <p><strong>Modern Solution:</strong> Smart transmitters reduce the current for Pt1000 sensors (e.g., to 0.1mA or 0.2mA) to balance this effect. Always check your transmitter's datasheet for "Excitation Current".</p>
            </div>

            <!-- Insight 4: Construction Types -->
            <div class="insight-card">
                <h4><i class="fas fa-layer-group"></i> 4. Wire Wound vs. Thin Film</h4>
                <p>The construction of the RTD element affects its ability to dissipate heat.</p>
                <ul>
                    <li><strong>Wire Wound:</strong> A coil of platinum wire inside a ceramic tube. It has more mass and surface area, generally offering a better dissipation constant ($P_D$), but is more fragile and susceptible to vibration.</li>
                    <li><strong>Thin Film:</strong> Platinum is deposited on a flat ceramic substrate. It is extremely small and fast. However, its tiny surface area means it has a lower $P_D$ in air, making it more prone to self-heating spikes if the current is high.</li>
                </ul>
            </div>

            <!-- Insight 5: Pulsed Excitation -->
            <div class="insight-card">
                <h4><i class="fas fa-wave-square"></i> 5. Advanced Mitigation: Pulsed Excitation</h4>
                <p>High-end battery-powered loggers or precision metrology bridges use <strong>Pulsed Excitation</strong>. Instead of sending a continuous 1mA current, they send a pulse for only 10-100ms, take the measurement, and turn it off.</p>
                <p>This technique drastically reduces the <strong>Average Power</strong> ($P_{avg} = P_{peak} \times DutyCycle$), virtually eliminating self-heating errors even in still air with Pt1000 sensors.</p>
            </div>
        </div>
    </main>    <!-- FOOTER -->
        <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-left">
                    <a href="/" class="footer-logo">
                        <img src="logo.png" alt="Design Calculators Logo" loading="lazy" decoding="async">
                        <span class="footer-logo-text">Design Calculators</span>
                    </a>
                    <p class="footer-description">A comprehensive engineering calculator hub based on IEC, IEEE, and
                        global standards.</p>
                    <div class="social-buttons">
                        <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://designcalculators.co.in"
                            target="_blank" rel="noopener noreferrer" class="social-btn linkedin"
                            aria-label="LinkedIn"><i class="fab fa-linkedin-in"></i></a>
                        <a href="https://www.youtube.com/@designcalculators" target="_blank" rel="noopener noreferrer"
                            class="social-btn youtube" aria-label="YouTube"><i class="fab fa-youtube"></i></a>
                        <a href="https://twitter.com/intent/tweet?url=https://designcalculators.co.in&text=Check%20out%20this%20amazing%20engineering%20calculator%20hub!"
                            target="_blank" rel="noopener noreferrer" class="social-btn twitter" aria-label="Twitter"><i
                                class="fab fa-twitter"></i></a>
                        <a href="https://www.facebook.com/sharer/sharer.php?u=https://designcalculators.co.in"
                            target="_blank" rel="noopener noreferrer" class="social-btn facebook"
                            aria-label="Facebook"><i class="fab fa-facebook-f"></i></a>
                        <a href="https://api.whatsapp.com/send?text=Check%20out%20this%20amazing%20engineering%20resource:%20https://designcalculators.co.in"
                            target="_blank" rel="noopener noreferrer" class="social-btn whatsapp"
                            aria-label="WhatsApp"><i class="fab fa-whatsapp"></i></a>
                    </div>
                </div>
                <div class="footer-right">
                    <div class="footer-col">
                        <h4>Quick Links</h4>
                        <ul>
                            <li><a href='/indexele.html'>Electrical Tools</a></li>
                            <li><a href='/indexmech.html'>Mechanical Tools</a></li>
                            <li><a href='/indexinst.html'>Instrumentation Tools</a></li>
                            <li><a href='/about.html'>About Us</a></li>
                            <li><a href='/faq.html'>FAQ</a></li>
                        </ul>
                    </div>
                    <div class="footer-col">
                        <h4>Learn More</h4>
                        <ul>
                            <li><a href="https://www.youtube.com/@designcalculators" target="_blank"
                                    rel="noopener noreferrer">YouTube Channel</a></li>
                            <li><a href='/contact.html'>Contact Us</a></li>
                            <li><a href='/privacy-policy.html'>Privacy Policy</a></li>
                            <li><a href='/terms-of-service.html'>Terms of Service</a></li>
                            <li><a href='/sitemap2.html'>Sitemap</a></li>
                        </ul>
                    </div>
                    <div class="footer-col">
                        <h4>Our Network</h4>
                        <ul>
                            <li style="margin-bottom: 12px;">
                                <a href="https://reliabilitytools.co.in/" target="_blank" rel="noopener"
                                   style="font-weight: 600; display: block; margin-bottom: 2px;">Reliability Tools</a>
                                <span style="font-size: 0.85rem; color: #94a3b8; line-height: 1.3; display: block;">Reliability
                                    & maintenance engineering calculators.</span>
                            </li>
                            <li style="margin-bottom: 12px;">
                                <a href="https://electrosafe.homes/" target="_blank" rel="noopener"
                                   style="font-weight: 600; display: block; margin-bottom: 2px;">ElectroSafe</a>
                                <span style="font-size: 0.85rem; color: #94a3b8; line-height: 1.3; display: block;">Dedicated
                                    to home electrical safety & protection.</span>
                            </li>
                            <li>
                                <a href="https://knowyourname.co.in/" target="_blank" rel="noopener"
                                   style="font-weight: 600; display: block; margin-bottom: 2px;">KnowYourName</a>
                                <span style="font-size: 0.85rem; color: #94a3b8; line-height: 1.3; display: block;">Scientific
                                    name analysis: Phonetics, Ergonomics & Acoustics.</span>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="footer-disclaimer">
                <p>All calculations are for preliminary engineering design guidance. Final designs must comply with all applicable local and international standards (including but not limited to ASHRAE 90.1, ARI 550/590). Always verify calculations and consult with a licensed professional engineer before implementation or construction.</p>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 Design Calculators. Created by <span style="color: var(--secondary); font-weight: bold;">Anil Sharma</span>. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script>
        // Global State
        let heatingChart = null;
        let lastResult = null;

        // Constants
        const ALPHA = 0.00385; 
        const CVD_A = 3.9083e-3; // Renamed from A
        const CVD_B = -5.775e-7; // Renamed from B
        // C is used for T < 0, simplified for T > 0 demo

        // Dissipation Constant Presets (Approximate mW/C)
        // Construction factor: Wire Wound vs Thin Film
        // Thin film has smaller surface area -> Lower Pd -> Higher Error
        const pdData = {
            'still_air': { wire: 2.0, film: 1.0, name: 'Still Air' },
            'moving_air': { wire: 8.0, film: 4.0, name: 'Flowing Air (10m/s)' },
            'still_water': { wire: 20.0, film: 10.0, name: 'Still Water' },
            'moving_water': { wire: 100.0, film: 50.0, name: 'Flowing Water (1m/s)' }
        };

        function calculateResistance(type, t) {
            let r0 = 100;
            if (type === 'pt500') r0 = 500;
            if (type === 'pt1000') r0 = 1000;

            // Callendar-Van Dusen (T > 0 simplified)
            // R(t) = R0 * (1 + A*t + B*t^2)
            const rt = r0 * (1 + CVD_A * t + CVD_B * t * t);
            return rt;
        }

        // Helper to update PD based on selection
        function updateDissipation() {
            const med = document.getElementById('medium').value;
            const cons = document.getElementById('construction').value;
            const factor = (cons === 'wire_wound') ? 'wire' : 'film';
            const pd = pdData[med][factor];
            document.getElementById('dissipation-const').value = pd;
        }

        function loadPreset(type) {
            if (type === 'standard_water') {
                document.getElementById('rtd-type').value = 'pt100';
                document.getElementById('construction').value = 'thin_film';
                document.getElementById('medium').value = 'moving_water';
                document.getElementById('excitation').value = '1.0';
                document.getElementById('process-temp').value = '25.0';
                updateDissipation();
            } else if (type === 'high_current_air') {
                document.getElementById('rtd-type').value = 'pt100';
                document.getElementById('construction').value = 'thin_film';
                document.getElementById('medium').value = 'still_air';
                document.getElementById('excitation').value = '2.0'; // High current!
                document.getElementById('process-temp').value = '25.0';
                updateDissipation();
            } else if (type === 'pt1000_low') {
                document.getElementById('rtd-type').value = 'pt1000';
                document.getElementById('construction').value = 'wire_wound';
                document.getElementById('medium').value = 'still_air';
                document.getElementById('excitation').value = '0.2'; // Good practice
                document.getElementById('process-temp').value = '100.0';
                updateDissipation();
            }
            displayMessage(`${type.toUpperCase()} scenario loaded.`, "success");
        }

        function displayMessage(message, type = "info") {
            let messageBox = document.getElementById('message-box');
            messageBox.textContent = message;
            if (type === "error") messageBox.style.backgroundColor = 'var(--danger)';
            else if (type === "success") messageBox.style.backgroundColor = 'var(--success)';
            else messageBox.style.backgroundColor = 'var(--primary)';
            messageBox.classList.add('show');
            setTimeout(() => messageBox.classList.remove('show'), 4000);
        }

        document.addEventListener('DOMContentLoaded', function() {
            // Theme handling
            const themeSwitch = document.getElementById('theme-switch');
            if (themeSwitch && localStorage.getItem('theme') === 'dark') {
                document.body.classList.add('dark-mode');
                themeSwitch.checked = true;
            }
            if(themeSwitch) {
                themeSwitch.addEventListener('change', function() {
                    document.body.classList.toggle('dark-mode');
                    localStorage.setItem('theme', this.checked ? 'dark' : 'light');
                });
            }

            // Listeners
            document.getElementById('medium').addEventListener('change', updateDissipation);
            document.getElementById('construction').addEventListener('change', updateDissipation);
            
            document.getElementById('calculate-btn').addEventListener('click', performCalculation);
            document.getElementById('pdf-btn').addEventListener('click', generatePDF);
        });

        function performCalculation() {
            // 1. Get Inputs
            const type = document.getElementById('rtd-type').value;
            const t_proc = parseFloat(document.getElementById('process-temp').value);
            const i_ma = parseFloat(document.getElementById('excitation').value);
            const pd = parseFloat(document.getElementById('dissipation-const').value);

            if (isNaN(t_proc) || isNaN(i_ma) || isNaN(pd) || i_ma <= 0 || pd <= 0) {
                displayMessage("Please enter valid positive numbers for current and dissipation.", "error");
                return;
            }

            // 2. Physics Calculation
            // Resistance at Temp
            const r_t = calculateResistance(type, t_proc);
            
            // Power Dissipation (P = I^2 * R)
            // i in Amps, R in Ohms -> P in Watts
            const i_amps = i_ma / 1000;
            const p_watts = Math.pow(i_amps, 2) * r_t;
            const p_mw = p_watts * 1000; // Convert to mW for Pd calc

            // Temperature Rise (Delta T = P_mw / Pd)
            const delta_t = p_mw / pd;

            // Measured Temp
            const t_meas = t_proc + delta_t;

            lastResult = { type, t_proc, i_ma, pd, r_t, p_mw, delta_t, t_meas };

            // 4. Render Step-by-Step
            let html = `<h4>Step 1: Resistance Calculation (IEC 60751)</h4>`;
            html += `<div class="calculation-step">`;
            html += `Calculating resistance of <strong>${type.toUpperCase()}</strong> at <strong>${t_proc.toFixed(2)} °C</strong>.<br>`;
            html += `$$ R(t) = R_0 \\cdot (1 + A \\cdot t + B \\cdot t^2) $$`;
            html += `$$ R(${t_proc}) = \\mathbf{${r_t.toFixed(3)} \\, \\Omega} $$`;
            html += `</div>`;

            html += `<h4>Step 2: Power Dissipation (Joule Heating)</h4>`;
            html += `<div class="calculation-step">`;
            html += `Using excitation current $I = ${i_ma} \\text{ mA} = ${i_amps} \\text{ A}$.<br>`;
            html += `$$ P_{diss} = I^2 \\cdot R = (${i_amps})^2 \\cdot ${r_t.toFixed(2)} = ${p_watts.toExponential(4)} \\text{ W} $$`;
            html += `$$ P_{diss} = \\mathbf{${p_mw.toFixed(3)} \\text{ mW}} $$`;
            html += `</div>`;

            html += `<h4>Step 3: Temperature Error Calculation</h4>`;
            html += `<div class="calculation-step">`;
            html += `Using Dissipation Constant $P_D = ${pd} \\text{ mW}/^\\circ\\text{C}$.<br>`;
            html += `$$ \\Delta T_{error} = \\frac{P_{diss}}{P_D} = \\frac{${p_mw.toFixed(3)}}{${pd}} = \\mathbf{${delta_t.toFixed(4)} \\, ^\\circ\\text{C}} $$`;
            html += `Measured Temperature: ${t_meas.toFixed(4)} °C`;
            html += `</div>`;

            document.getElementById('calculation-details').innerHTML = html;

            // 5. Update Table
            const tbody = document.getElementById('result-table-body');
            tbody.innerHTML = '';
            const addRow = (n, v, u, c="") => {
                tbody.innerHTML += `<tr style="${c ? 'color:'+c : ''}"><td><strong>${n}</strong></td><td>${v}</td><td>${u}</td></tr>`;
            };
            addRow("Sensor Resistance", r_t.toFixed(2), "Ω");
            addRow("Power Dissipated", p_mw.toFixed(3), "mW");
            addRow("Self-Heating Error", "+" + delta_t.toFixed(3), "°C", delta_t > 0.1 ? "var(--danger)" : "var(--success)");
            
            const interpEl = document.getElementById('interpretation-text');
            if (delta_t > 0.5) {
                interpEl.innerHTML = `<span style="color:var(--danger); font-weight:bold;">High Error!</span> The error exceeds 0.5°C. This is significant for RTD measurements. Reduce excitation current or increase flow.`;
            } else if (delta_t > 0.1) {
                interpEl.innerHTML = `<span style="color:var(--warning); font-weight:bold;">Moderate Error.</span> Noticeable drift. Acceptable for general process, bad for metrology.`;
            } else {
                interpEl.innerHTML = `<span style="color:var(--success); font-weight:bold;">Negligible.</span> Measurement is accurate.`;
            }

            // 6. Draw Chart
            drawChart(type, t_proc, pd);

            // 7. Show
            document.getElementById('result-container').classList.remove('hidden');
            if(window.MathJax) window.MathJax.typesetPromise([document.getElementById('calculation-details')]);
            document.getElementById('result-container').scrollIntoView({ behavior: 'smooth' });
        }

        function drawChart(type, temp, pd) {
            const ctx = document.getElementById('heatingChart').getContext('2d');
            if (heatingChart) heatingChart.destroy();

            // Generate Data Points (Current 0.1 to 5.0 mA)
            const labels = [];
            const data = [];
            
            for (let i = 0.1; i <= 5.0; i += 0.1) {
                const r = calculateResistance(type, temp);
                const p_mw = Math.pow(i/1000, 2) * r * 1000;
                const err = p_mw / pd;
                labels.push(i.toFixed(1));
                data.push(err);
            }

            // Get current point
            const currentI = parseFloat(document.getElementById('excitation').value);
            const currentR = calculateResistance(type, temp);
            const currentP = Math.pow(currentI/1000, 2) * currentR * 1000;
            const currentErr = currentP / pd;

            heatingChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Temp Error (°C)',
                        data: data,
                        borderColor: '#3B82F6', // Blue
                        backgroundColor: 'rgba(59, 130, 246, 0.1)',
                        borderWidth: 2,
                        pointRadius: 0,
                        fill: true
                    },
                    {
                        label: 'Current Point',
                        data: [{x: currentI, y: currentErr}], // Annotation handled by plugin or simple overlay
                        pointRadius: 6,
                        pointBackgroundColor: '#EF4444',
                        showLine: false
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: { title: { display: true, text: 'Excitation Current (mA)' } },
                        y: { title: { display: true, text: 'Error (°C)' } }
                    },
                    plugins: {
                        annotation: {
                            annotations: {
                                point1: {
                                    type: 'point',
                                    xValue: labels.indexOf(currentI.toFixed(1)),
                                    yValue: currentErr,
                                    backgroundColor: '#EF4444',
                                    radius: 6
                                }
                            }
                        }
                    }
                }
            });
        }

        function generatePDF() {
            if (!lastResult) {
                displayMessage("Calculate first.", "error");
                return;
            }
            const { jsPDF } = window.jspdf;
            const pdf = new jsPDF('p', 'mm', 'a4');
            let y = 15;

            // Header
            pdf.setFont('helvetica', 'bold');
            pdf.setFontSize(16);
            pdf.setTextColor(30, 58, 138); // Blue
            pdf.text('RTD Self-Heating Error Report', 105, y, { align: 'center' });
            y += 10;

            pdf.setFontSize(10);
            pdf.setTextColor(100);
            pdf.text(`Date: ${new Date().toLocaleString()}`, 105, y, { align: 'center' });
            y += 15;

            // Inputs
            pdf.setFontSize(12);
            pdf.setTextColor(0);
            pdf.text('1. Measurement Parameters', 14, y);
            y += 5;

            const inputData = [
                ['Sensor Type', lastResult.type.toUpperCase()],
                ['Process Temp', `${lastResult.t_proc} °C`],
                ['Excitation Current', `${lastResult.i_ma} mA`],
                ['Dissipation Constant', `${lastResult.pd} mW/°C`]
            ];

            pdf.autoTable({
                startY: y,
                head: [['Parameter', 'Value']],
                body: inputData,
                margin: { left: 14, right: 14 },
                theme: 'grid',
                headStyles: { fillColor: [30, 58, 138] }
            });
            y = pdf.lastAutoTable.finalY + 15;

            // Results
            pdf.text('2. Calculated Error', 14, y);
            y += 5;

            const resData = [
                ['Sensor Resistance', `${lastResult.r_t.toFixed(2)} Ω`],
                ['Power Dissipated', `${lastResult.p_mw.toFixed(3)} mW`],
                ['Temp Error', `${lastResult.delta_t.toFixed(3)} °C`],
                ['Corrected Temp', `${(lastResult.t_proc - lastResult.delta_t).toFixed(3)} °C`] // Actually True Temp = Meas - Error
            ];

            pdf.autoTable({
                startY: y,
                head: [['Metric', 'Result']],
                body: resData,
                margin: { left: 14, right: 14 },
                theme: 'grid',
                headStyles: { fillColor: [30, 58, 138] },
                didParseCell: function(data) {
                    if(data.row.index === 2) {
                        data.cell.styles.fontStyle = 'bold';
                        data.cell.styles.textColor = lastResult.delta_t > 0.1 ? [220, 38, 38] : [16, 185, 129];
                    }
                }
            });

            // Footer
            y = pdf.lastAutoTable.finalY + 20;
            pdf.setFontSize(8);
            pdf.setTextColor(150);
            pdf.text('Calculations based on standard Joule heating physics.', 105, y, { align: 'center' });

            pdf.save('RTD_Heating_Report.pdf');
            displayMessage("PDF Downloaded", "success");
        }
    </script>
</body>
</html>
