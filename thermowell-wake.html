<!DOCTYPE html>
<html lang="en">
<head>
    <!-- SEO Meta Tags -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Thermowell Wake Frequency - Design Calculators - Instrumentation</title>
    <link rel="canonical" href="https://designcalculators.co.in/thermowell-wake.html" />
    <meta name="description" content="Professional thermowell wake frequency calculator based on ASME PTC 19.3 TW-2016. Prevents flow-induced vibration (FIV) and resonance failure.">
    <meta name="keywords" content="thermowell, wake frequency, asme ptc 19.3, vortex shedding, resonance, fiv, instrumentation, mechanical integrity, strouhal, reynolds">
    <meta name="author" content="Design Calculators">
    <meta name="robots" content="index, follow">

    <!-- AdSense & Analytics -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5936527763614780" crossorigin="anonymous"></script>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-23Y1V450SR"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-23Y1V450SR');
    </script>
    
    <!-- Fonts & Icons -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Montserrat:wght@700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- MathJax for Formulas -->
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$']],
                displayMath: [['$$', '$$']]
            },
            svg: { fontCache: 'global' },
            options: {
                processHtmlClass: 'math-content', // Process elements with this class
                ignoreHtmlClass: 'no-mathjax'     // Ignore elements with this class
            }
        };
    </script>
    <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    
    <!-- Favicon -->
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">

    <style>
        /* NEW: Root variables from provided file */
        :root {
            --primary: #1E3A8A;
            --secondary: #2563EB;
            --accent: #F59E0B;
            --success: #10B981;
            --danger: #DC2626;
            --warning: #F59E0B;
            --bg: #F8FAFC;
            --card: #FFFFFF;
            --text: #4B5563;
            --heading: #111827;
            --footer-bg: #0F172A;
            --border: #E2E8F0;
            --grad: linear-gradient(135deg, var(--primary), var(--secondary));
            --grad-dark: linear-gradient(135deg, #0F172A, #1E293B);
            --shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
            --shadow-lg: 0 10px 20px rgba(0, 0, 0, 0.1);
            
            /* Specific to this tool, using new theme */
            --reset-button-bg: var(--accent);
            --reset-button-hover-bg: #DAA520;
            --clear-button-bg: var(--secondary);
            --clear-button-hover-bg: var(--primary);
            
            /* NEW: Map tool-specific colors to theme */
            --ok-color: var(--success);
            --error-color: var(--danger);
            --warning-color: var(--warning); 
        }

        /* NEW: Dark mode variables from provided file */
        body.dark-mode {
            --primary: #10B981;
            --secondary: #34D399;
            --bg: #0F172A;
            --card: #1E293B;
            --text: #CBD5E1;
            --heading: #F1F5F9;
            --footer-bg: #020617;
            --border: #334155;

            /* Specific to this tool, using new theme */
            --reset-button-bg: var(--accent);
            --reset-button-hover-bg: #DAA520;
            --clear-button-bg: var(--secondary);
            --clear-button-hover-bg: var(--primary);
            
            /* NEW: Map tool-specific colors to theme */
            --ok-color: var(--success);
            --error-color: var(--danger);
            --warning-color: var(--warning);
        }

        /* General Body Styling (Updated) */
        body {
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding: 0;
            background: var(--bg);
            color: var(--text);
            line-height: 1.7;
            transition: background-color 0.3s, color 0.3s;
        }

        .container {
            max-width: 1280px;
            margin: 0 auto;
            padding: 0 24px;
        }
        
        /* NEW: Header styles (from provided file) */
        header {
            background: var(--grad);
            color: white;
            padding: 24px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .logo-container {
            display: flex;
            flex-direction: column;
            text-decoration: none;
            color: white;
        }
        .logo-text {
            font-size: 1.75rem;
            font-weight: 800;
            font-family: 'Montserrat', sans-serif;
        }
        .logo-subtitle {
            font-size: 0.8rem;
            margin: 4px 0 0 0;
            color: #E0E7FF;
            opacity: 0.9;
        }
        .nav-links {
            display: flex;
            gap: 24px;
            list-style: none;
            margin: 0;
            padding: 0;
        }
        .nav-links a {
            color: white;
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s;
        }
        .nav-links a:hover { color: var(--accent); }
        .theme-toggle {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .switch {
            position: relative;
            width: 56px;
            height: 30px;
        }
        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0,0,0,0.2);
            transition: .4s;
            border-radius: 30px;
        }
        .slider:before {
            position: absolute;
            content: "";
            height: 22px;
            width: 22px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        input:checked + .slider {
            background-color: var(--accent);
        }
        input:checked + .slider:before {
            transform: translateX(26px);
        }

        main {
            padding: 40px 0;
        }

        /* Main Card Styling (Updated) */
        .tool-container {
            background-color: var(--card);
            border-radius: 12px;
            padding: 30px;
            box-shadow: var(--shadow);
            margin-bottom: 30px;
            border: 1px solid var(--border);
            transition: transform 0.3s ease-in-out;
        }

        .tool-container:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }

        .tool-container h2 {
            color: var(--primary);
            border-bottom: 3px solid var(--primary);
            padding-bottom: 15px;
            margin-top: 0;
            margin-bottom: 20px;
            font-family: 'Montserrat', sans-serif;
            font-size: 1.8rem;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .tool-description {
            margin-bottom: 20px;
            color: var(--text);
            font-size: 1.05rem;
        }

        /* NEW: Footer styles (from provided file) */
        footer {
            background: var(--grad-dark);
            color: #CBD5E1;
            padding: 50px 0 20px 0;
            margin-top: 60px;
        }
        .footer-content {
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 40px;
            margin-bottom: 30px;
        }
        .footer-col {
            flex: 1;
            min-width: 200px;
        }
        .footer-col h4 {
            color: white;
            margin-bottom: 15px;
            font-weight: 700;
        }
        .footer-col ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        .footer-col a {
            color: #CBD5E1;
            text-decoration: none;
            transition: color 0.3s;
        }
        .footer-col a:hover {
            color: var(--accent);
        }
        .social-buttons {
            display: flex;
            gap: 12px;
            margin-top: 15px;
        }
        .social-btn {
            width: 40px;
            height: 40px;
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            border-radius: 50%;
            font-size: 1.1rem;
            transition: transform 0.3s;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        .social-btn:hover {
            transform: translateY(-4px);
        }
        .social-btn.linkedin { background-color: #0A66C2; }
        .social-btn.youtube { background-color: #FF0000; }
        .social-btn.twitter { background-color: #1DA1F2; }
        .social-btn.facebook { background-color: #1877F2; }
        .social-btn.whatsapp { background-color: #25D366; }
        .footer-disclaimer {
            text-align: center;
            padding-top: 25px;
            border-top: 1px solid #334155;
            max-width: 800px;
            margin: 0 auto;
            font-size: 0.9rem;
        }
        .footer-bottom {
            text-align: center;
            padding-top: 20px;
            font-size: 0.9rem;
            color: #94A3B8;
        }

        /* Styles for Calculator Forms and Results (Updated) */
        .calculator-form {
            background-color: var(--card);
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
            box-shadow: none;
        }
        
        .form-section {
            background-color: var(--bg);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 25px; /* Space between sections */
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.05);
            opacity: 0; /* Initial state for fade-in animation */
            transform: translateY(10px); /* Initial state for slide-up animation */
            transition: opacity 0.5s ease-out, transform 0.5s ease-out;
        }

        .form-section.fade-in {
            opacity: 1;
            transform: translateY(0);
        }

        .form-section h3 {
            color: var(--secondary);
            margin-top: 0;
            margin-bottom: 15px;
            border-bottom: 1px dashed var(--border);
            padding-bottom: 10px;
        }

        .form-group {
            margin-bottom: 15px; /* Default margin for form groups */
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--heading);
        }
        
        .form-group input, .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--border);
            border-radius: 6px;
            background-color: var(--bg);
            color: var(--text);
            box-sizing: border-box; /* Ensure padding doesn't increase width */
            transition: border-color 0.3s, box-shadow 0.3s;
            font-size: 1rem;
        }
        
        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); /* Responsive grid */
            gap: 20px; /* Gap between grid items */
            margin-bottom: 0; /* Handled by form-group margin */
        }
        
        /* Updated Button Styles */
        .calculate-btn {
            background: var(--grad);
            color: white;
            border: none;
            padding: 16px 30px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: 700;
            margin-top: 25px;
            transition: all 0.3s;
            width: auto;
            min-width: 220px;
            box-shadow: 0 4px 12px rgba(30, 58, 138, 0.3);
            letter-spacing: 0.5px;
            text-transform: uppercase;
        }
        
        .calculate-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(30, 58, 138, 0.4);
        }

        .reset-btn {
            background-color: var(--reset-button-bg);
            color: #333;
            border: none;
            padding: 16px 30px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: 700;
            margin-top: 25px;
            margin-left: 15px;
            transition: all 0.3s;
            width: auto;
            min-width: 150px;
            box-shadow: 0 4px 12px rgba(245, 158, 11, 0.3);
            letter-spacing: 0.5px;
            text-transform: uppercase;
        }

        .reset-btn:hover {
            background-color: var(--reset-button-hover-bg);
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(245, 158, 11, 0.4);
        }

        .clear-results-btn {
            background-color: var(--clear-button-bg);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9em;
            font-weight: 700;
            margin-top: 15px;
            transition: all 0.3s;
            box-shadow: var(--shadow);
        }

        .clear-results-btn:hover {
            background-color: var(--clear-button-hover-bg);
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }
        
        .result-container {
            margin-top: 30px;
            padding: 30px;
            border-radius: 12px;
            background-color: var(--card);
            box-shadow: var(--shadow);
            border: 1px solid var(--border);
            display: none; /* Hidden by default */
            opacity: 0; /* For animation */
            transform: translateY(20px); /* Initial state for animation */
            transition: opacity 0.5s ease-in-out, transform 0.5s ease-in-out;
        }
        
        .result-container.show {
            opacity: 1;
            transform: translateY(0);
        }

        .result-container h3 {
            color: var(--primary);
            margin-bottom: 20px;
            text-align: center;
            font-family: 'Montserrat', sans-serif;
            font-size: 1.8rem;
        }
        
        .result-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 25px;
            border-radius: 8px;
            overflow: hidden; /* Ensures rounded corners apply to table content */
            box-shadow: var(--shadow);
        }
        
        .result-table th, .result-table td {
            padding: 16px;
            text-align: left;
            border-bottom: 1px solid var(--border);
            transition: background-color 0.3s;
        }
        
        .result-table th {
            background: var(--grad);
            font-weight: 700;
            color: white;
        }

        .result-table tr:last-child td {
            border-bottom: none; /* No border for the last row */
        }
        
        .result-table tr:nth-child(even) {
            background-color: var(--bg);
        }

        .result-table tbody tr:hover {
            background-color: var(--border);
        }
        
        .result-table td:first-child {
            font-weight: 600;
            color: var(--heading);
        }
        
        .standard-reference {
            margin-top: 20px;
            font-style: italic;
            font-size: 0.9rem;
            color: var(--text);
            padding: 15px;
            border-left: 4px solid var(--primary);
            background-color: var(--bg);
            border-radius: 4px;
        }
        
        .info-icon {
            color: var(--primary);
            margin-left: 5px;
            cursor: help;
            transition: color 0.3s;
        }

        .info-icon:hover {
            color: var(--accent);
        }
        
        .tooltip {
            position: relative;
            display: inline-block;
        }
        
        .tooltip .tooltiptext {
            visibility: hidden;
            width: 250px;
            background-color: #333;
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 8px;
            position: absolute;
            z-index: 10;
            bottom: 125%;
            left: 50%;
            margin-left: -125px;
            opacity: 0;
            transition: opacity 0.3s, transform 0.3s;
            transform: translateY(10px);
            font-size: 0.85em;
            font-family: 'Inter', sans-serif;
            line-height: 1.4;
        }
        
        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
            transform: translateY(0);
        }

        /* Custom message box style (Updated) */
        #custom-message-box {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            padding: 16px 28px;
            border-radius: 8px;
            box-shadow: 0 6px 16px rgba(0,0,0,0.25);
            z-index: 10000;
            font-weight: 600;
            color: white;
            opacity: 0;
            transition: all 0.4s;
            display: none;
            align-items: center;
            justify-content: center;
            min-width: 250px;
        }
        #custom-message-box.show {
            display: flex;
            opacity: 1;
            top: 30px;
        }

        /* NEW: Styles for calculation steps (from provided file) */
        .steps-container {
            display: none;
            margin-top: 30px;
        }
        .steps-container.active {
            display: block;
        }
        .step-card {
            width: 100% !important;
            max-width: 100% !important;
            box-sizing: border-box; /* v6 */
            background: var(--card);
            border-radius: 12px;
            padding: 25px 30px;
            box-shadow: var(--shadow);
            border: 1px solid var(--border);
            animation: slideIn 0.6s ease-out;
            transition: all 0.3s;
            margin-bottom: 25px; /* Spacing between cards */
        }
        @keyframes slideIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .step-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }
        .step-card h4 {
            color: var(--primary);
            margin: 0 0 20px 0;
            font-size: 1.4rem;
            font-family: 'Montserrat', sans-serif;
            display: block; /* Changed from flex */
        }
        .step-card h4::after {
            content: "";
            display: table;
            clear: both;
        }
        .step-card .number {
            float: left; /* Changed to float */
            width: 40px;
            height: 40px;
            background: var(--primary);
            color: white;
            border-radius: 50%;
            text-align: center;
            line-height: 40px;
            font-weight: 700;
            margin-right: 15px;
            font-size: 1.3rem;
            /* Removed flex-shrink */
        }
        .step-content {
            width: 100% !important;
            max-width: 100% !important;
            box-sizing: border-box; /* v6 */
            display: grid;
            grid-template-columns: 1fr !important;
            gap: 25px;
            align-items: start;
        }
        .step-content > * { min-width: 0; }
        .step-content .formula-block {
            background: var(--bg);
            border-radius: 8px;
            padding: 20px;
            font-size: 1rem;
            border: 1px solid var(--border);
        }
        .step-content .formula-block p {
            margin-top: 0;
        }
        .step-content .formula {
            background: var(--bg);
            border-left: 3px solid var(--accent);
            padding: 15px;
            margin: 12px 0;
            font-size: 1rem;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            overflow-x: auto;
        }
        .step-value {
            font-size: 2.2rem;
            font-weight: 800;
            color: var(--success);
            margin: 10px 0;
            line-height: 1.2;
        }
        .step-unit {
            font-size: 1rem;
            color: var(--text);
            opacity: 0.8;
            font-weight: 500;
            margin-left: 5px;
        }
        .step-explanation {
            font-size: 1.05rem;
            line-height: 1.8;
        }
        
        .button-wrapper {
            display: flex;
            justify-content: center; /* Center the button horizontally */
            flex-wrap: wrap;
            gap: 15px;
            width: 100%;
            padding-top: 20px;
        }

        /* Animation for input fields on focus (Updated) */
        .form-group input:focus, .form-group select:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(30, 58, 138, 0.1);
            outline: none;
            /* Removed pulse animation */
        }
        body.dark-mode .form-group input:focus, 
        body.dark-mode .form-group select:focus {
             box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1);
        }

        /* Specific styles for Thermowell Wake Frequency Calculator (MERGED) */
        .thermowell-diagram {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 30px;
            margin-bottom: 20px;
            padding: 20px;
            background-color: var(--bg);
            border-radius: 8px;
            box-shadow: var(--shadow);
            border: 1px solid var(--border);
            flex-direction: column;
            position: relative;
        }
        .thermowell-diagram svg {
            width: 100%;
            max-width: 400px;
            height: auto;
            border: 1px solid var(--border);
            border-radius: 5px;
            background-color: var(--card);
        }
        .diagram-label {
            position: absolute;
            font-size: 0.8em;
            font-weight: bold;
            color: var(--text);
            background-color: rgba(255, 255, 255, 0.8);
            padding: 2px 5px;
            border-radius: 3px;
            pointer-events: none; /* Allow clicks to pass through */
        }
        .status-display { /* Renamed from loop-status-display */
            font-weight: bold;
            font-size: 1.2em;
            margin-top: 15px;
            padding: 10px 20px;
            border-radius: 5px;
            transition: background-color 0.5s, color 0.5s;
            text-align: center;
            width: 80%; /* Adjusted width */
        }
        .status-display.ok {
            background-color: var(--ok-color);
            color: white;
        }
        .status-display.error {
            background-color: var(--error-color);
            color: white;
        }
        .status-display.warning {
            background-color: var(--warning-color);
            color: var(--heading);
        }
        
        /* NEW: Educational Section Styles (from provided file) */
        .education-section {
            margin-top: 40px;
            margin-bottom: 40px;
            background: var(--card);
            border-radius: 12px;
            padding: 30px;
            box-shadow: var(--shadow);
            border: 1px solid var(--border);
        }
        
        .education-section h2 {
            color: var(--primary);
            border-bottom: 3px solid var(--primary);
            padding-bottom: 15px;
            margin-top: 0;
            font-family: 'Montserrat', sans-serif;
            font-size: 1.8rem;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .insight-card {
            background: linear-gradient(135deg, var(--card), rgba(37,99,235,0.03));
            border-radius: 12px;
            padding: 25px;
            margin: 20px 0;
            border-left: 5px solid var(--secondary);
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            transition: all 0.3s;
        }
        .insight-card:hover {
            transform: translateX(5px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        .insight-card h4 {
            color: var(--secondary);
            font-size: 1.3rem;
            margin: 0 0 15px 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .insight-card h4 i {
            font-size: 1.5rem;
        }
        .insight-card p {
            margin: 10px 0;
            line-height: 1.8;
        }
        .insight-card ol,
        .insight-card ul {
            padding-left: 20px;
            margin: 10px 0;
        }
        .insight-card li {
            margin-bottom: 10px;
        }

        .danger-box {
            background: linear-gradient(135deg, rgba(220,38,38,0.1), rgba(220,38,38,0.05));
            border-left: 5px solid var(--danger);
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
        }
        .danger-box h4 {
            color: var(--danger);
            margin-top: 0;
        }
        .success-box {
            background: linear-gradient(135deg, rgba(16,185,129,0.1), rgba(16,185,129,0.05));
            border-left: 5px solid var(--success);
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
        }
        .success-box h4 {
            color: var(--success);
            margin-top: 0;
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .container { padding: 0 15px; }
            .navbar { flex-direction: column; gap: 20px; }
            .nav-links { flex-direction: column; gap: 12px; text-align: center; }
            .form-row { grid-template-columns: 1fr; }
            .tool-container, .education-section, .result-container { padding: 20px; }
            .footer-content { flex-direction: column; gap: 25px; }
        }
        .hidden { display: none; }
        
    </style>
    <link rel="stylesheet" href="styles.css">
    <meta property="og:title" content="Thermowell Wake Frequency - Design Calculators - Instrumentation">
    <meta property="og:description" content="Professional thermowell wake frequency calculator based on ASME PTC 19.3 TW-2016. Prevents flow-induced vibration (FIV) and resonance failure.">
</head>
<body>
    <!-- NEW: Message box -->
    <div id="custom-message-box" class="message-box"></div>
    
    <!-- NEW: Header from provided file -->
    <header class="header">
        <div class="header-bg-animation"></div>
        <div class="container">
            <nav class="navbar">
                <a href="/" class="logo-container">
                    <img src="logo.png" alt="Design Calculators Logo" class="logo">
                    <span class="logo-text">Design Calculators</span>
                </a>

                <div class="nav-menu">
                    <button class="mobile-menu-toggle" aria-label="Toggle menu">
                        <i class="fas fa-bars"></i>
                    </button>

                    <ul class="nav-links">
                        <li><a href="/index.html">Home</a></li>
                        
    <li class="dropdown">
        <a href="/indexele.html" class="dropdown-toggle">Electrical <i class="fas fa-chevron-down" style="font-size: 0.7em; margin-left: 4px;"></i></a>
        <div class="dropdown-menu">
            <div class="repo-grid"><div><a href="/arcflash.html">Arc Flash Calculator</a><a href="/breaker-sizing.html">Breaker Sizing</a><a href="/cable-thermal-rating.html">Cable Ampacity</a><a href="/comm-cable-loss.html">Comm Cable Loss</a><a href="/earth-conductor-size.html">Earth Conductor Size</a><a href="/generatorsizing.html">Generator Sizing</a><a href="/harmonicsanalyser.html">Harmonics Analyser</a><a href="/insulationresistance.html">Insulation Resistance</a><a href="/logicgate.html">Logic Gates Simulator</a><a href="/motor-starting.html">Motor Starting Current</a><a href="/pcbtrace.html">PCB Trace Width</a><a href="/protection-device.html">Protection Device</a><a href="/resistor.html">Resistor Color Code</a><a href="/solarcable.html">Solar Cable Sizing</a><a href="/systemxrcalculator.html">System X/R Ratio</a><a href="/transmissionline.html">Transmission Line</a><a href="/vfd-selection.html">VFD Selection Tool</a></div><div><a href="/batterylife.html">Battery Life Estimator</a><a href="/busbarampacity.html">Busbar Ampacity</a><a href="/cablepulling.html">Cable Pulling Tension</a><a href="/conduit-fill.html">Conduit Fill Calculator</a><a href="/earthingfaultsimulator.html">Earthing Fault Simulator</a><a href="/grounding.html">Grounding System Design</a><a href="/hvac-sizing.html">HVAC Sizing Calculator</a><a href="/lcresonancecalculator.html">LC Resonance Calculator</a><a href="/maintenance-guide.html">Maintenance Guide</a><a href="/nemaipconvertor.html">NEMA to IP Converter</a><a href="/power-factor.html">Power Factor Correction</a><a href="/relay-coordination.html">Relay Coordination</a><a href="/short-circuit.html">Short Circuit Current</a><a href="/solarpvarray.html">Solar PV Array</a><a href="/transformer-calculator.html">Transformer Calculator</a><a href="/unit-converter.html">Unit Converter</a><a href="/voltage-drop.html">Voltage Drop Calculator</a></div><div><a href="/battery-sizing.html">Battery Sizing (AH)</a><a href="/busbarshortcircuit.html">Busbar Short Circuit</a><a href="/cable-sizing.html">Cable Sizing Calculator</a><a href="/ctsaturation.html">CT Saturation</a><a href="/equipment-relay.html">Equipment Relay Setting</a><a href="/harmonic-distortion.html">Harmonic Distortion</a><a href="/industriallighting.html">Industrial Lighting</a><a href="/lighting-calulator.html">Lighting Calculator</a><a href="/motor-efficiency.html">Motor Efficiency</a><a href="/neutral-earth-fault-current.html">Neutral Earth Fault</a><a href="/powertriangletool.html">Power Triangle</a><a href="/electricalresidentialload.html">Residential Load Calc</a><a href="/skindepth.html">Skin Depth Calculator</a><a href="/symmetricalcomponents.html">Symmetrical Components</a><a href="/transformerinrush.html">Transformer Inrush</a><a href="/ups-sizing.html">UPS Sizing</a></div>
            </div>
            <div class="view-all-container">
                <a href="/indexele.html" class="view-all-link">View All Electrical Tools â†’</a>
            </div>
        </div>
    </li>
                        
    <li class="dropdown">
        <a href="/indexinst.html" class="dropdown-toggle">Instrumentation <i class="fas fa-chevron-down" style="font-size: 0.7em; margin-left: 4px;"></i></a>
        <div class="dropdown-menu">
            <div class="repo-grid"><div><a href="/adc-resolution.html">ADC Resolution</a><a href="/capillarylengthtemperatureerror.html">Capillary Error</a><a href="/cv-kv-valve.html">Cv/Kv Valve Sizing</a><a href="/dp-level.html">DP Level Measurement</a><a href="/hydrostatic-level.html">Hydrostatic Level</a><a href="/instrument-range.html">Instrument Range</a><a href="/loop-impedance.html">Loop Impedance</a><a href="/orifice-plate.html">Orifice Plate Beta</a><a href="/pid-tuning.html">PID Tuning</a><a href="/profibus.html">Profibus Calculator</a><a href="/tempsensorresponse.html">Response Time (Tau)</a><a href="/rtd-lead-comp.html">RTD Lead Wire Comp.</a><a href="/sealfluidzeroshift.html">Seal Fluid Shift</a><a href="/snr-calculator.html">SNR Calculator</a><a href="/thermocoupleextensioncable.html">TC Extension Cable</a><a href="/thermowellwakefreq.html">Thermowell Frequency</a><a href="/pressuretransmitteroverrange.html">Tx Overrange</a><a href="/valvecavitationcalculator.html">Valve Cavitation</a><a href="/vibrationtransmitter.html">Vibration Tx</a><a href="/zoneclassificationhelper.html">Zone Classification</a></div><div><a href="/baud-rate.html">Baud Rate Calculator</a><a href="/gascompressibility.html">Compressibility (Z)</a><a href="/dbcalculator.html">dB Gain/Loss Calc</a><a href="/flowprofiledistortioncalculator.html">Flow Distortion</a><a href="/impulselinefreezing.html">Impulse Freezing</a><a href="/intrinsic-safety.html">Intrinsic Safety Loop</a><a href="/measurement.html">Measurement Uncertainty</a><a href="/ph-temp-comp.html">pH Temp Compensation</a><a href="/plcscantime.html">PLC Scan Time</a><a href="/pressurereliefvalve.html">PRV Sizing (API 520)</a><a href="/reynoldsnumbercal.html">Reynolds Number</a><a href="/rtdselfheating.html">RTD Self-Heating</a><a href="/signal-scaling.html">Signal Scaling</a><a href="/staticheadcal.html">Static Head</a><a href="/temperaturesensorlag.html">Temp Sensor Lag</a><a href="/thermowell-wake.html">Thermowell Wake</a><a href="/ultrasoniclevel.html">Ultrasonic Level</a><a href="/valve-cv.html">Valve Cv Viewer</a><a href="/wetlegdensitycompensation.html">Wet Leg Compensation</a></div><div><a href="/capacitance-level.html">Capacitance Level</a><a href="/controlvalvenoise.html">Control Valve Noise</a><a href="/dp-flow-conversion.html">DP Flow Conversion</a><a href="/hartdevices.html">HART Devices</a><a href="/impulse-pressure-drop.html">Impulse Pressure Drop</a><a href="/junctionbox.html">Junction Box Sizing</a><a href="/orifice-flow.html">Orifice Flow Calculator</a><a href="/pid-symbol-library.html">PID Symbol Library</a><a href="/power-supply-load.html">Power Supply Load</a><a href="/prvsizing.html">Relief Orifice Area</a><a href="/rtdexcitationcurrentselection.html">RTD Excitation</a><a href="/rtd-tc-conversion.html">RTD/TC Conversion</a><a href="/sil.html">SIL Calculator</a><a href="/steamflow.html">Steam Flow</a><a href="/thermocouplecjccalculator.html">Thermocouple CJC</a><a href="/turndown.html">Turndown Ratio</a><a href="/controlvalveauthority.html">Valve Authority</a><a href="/controlvalveleakage.html">Valve Leakage Class</a><a href="/wirelesshart.html">WirelessHART Range</a></div>
            </div>
            <div class="view-all-container">
                <a href="/indexinst.html" class="view-all-link">View All Instrumentation Tools â†’</a>
            </div>
        </div>
    </li>
                        
    <li class="dropdown">
        <a href="/indexmech.html" class="dropdown-toggle">Mechanical <i class="fas fa-chevron-down" style="font-size: 0.7em; margin-left: 4px;"></i></a>
        <div class="dropdown-menu">
            <div class="repo-grid"><div><a href="/aircompressorfad.html">Air Compressor FAD</a><a href="/asme-vessel.html">ASME Vessel Design</a><a href="/belt-pulley.html">Belt & Pulley</a><a href="/bolt-torque.html">Bolt Torque</a><a href="/controlvalveactuator.html">Control Valve Actuator</a><a href="/frictionfactortool.html">Darcy Friction Factor</a><a href="/fatigue.html">Fatigue Analysis</a><a href="/fuel-combustion.html">Fuel Combustion</a><a href="/gas.html">Gas Properties</a><a href="/heat-exchanger.html">Heat Exchanger</a><a href="/hydroliccylinder.html">Hydraulic Cylinder</a><a href="/material-compatibility.html">Material Compatibility</a><a href="/nozzle-reinforcement.html">Nozzle Reinforcement</a><a href="/openchannelflow.html">Open Channel Flow</a><a href="/pipescheduletool.html">Pipe Schedule & Stress</a><a href="/pump-head.html">Pump Head</a><a href="/shaft-power-torque.html">Shaft Power & Torque</a><a href="/steam-table.html">Steam Table</a><a href="/vibrationanalysis.html">Vibration Analysis</a></div><div><a href="/air-flow-duct.html">Air Flow Duct Sizing</a><a href="/beam-deflection.html">Beam Deflection</a><a href="/bernoulli-equation.html">Bernoulli Equation</a><a href="/chiller-capacity.html">Chiller Capacity</a><a href="/cooling-tower-sizing.html">Cooling Tower Sizing</a><a href="/darcy-weisbach.html">Darcy-Weisbach</a><a href="/finned-tube-heat-transfer.html">Finned Tube Heat</a><a href="/furnace-heat-duty.html">Furnace Heat Duty</a><a href="/gear-design.html">Gear Design</a><a href="/heat-loss-pipes.html">Heat Loss Pipes</a><a href="/jacketed-vessel-heat-transfer.html">Jacketed Vessel</a><a href="/metalweight.html">Metal Weight Calculator</a><a href="/nptbspthreadcalculator.html">NPT/BSP Threads</a><a href="/overall-heat-transfer.html">Overall Heat Transfer</a><a href="/pipe-stress-flexibility.html">Pipe Stress</a><a href="/pump-power.html">Pump Power</a><a href="/specific-heat-enthalpy.html">Specific Heat</a><a href="/storage-tank-volume.html">Storage Tank Volume</a><a href="/weldingstress.html">Welding Stress</a></div><div><a href="/allowable-stress-safety-factor.html">Allowable Stress</a><a href="/bearinglife.html">Bearing Life Calculator</a><a href="/boiler-efficiency.html">Boiler Efficiency</a><a href="/compressor-power.html">Compressor Power</a><a href="/corrosion-rate.html">Corrosion Rate</a><a href="/fan-laws.html">Fan Laws</a><a href="/foundation.html">Foundation Design</a><a href="/gas-laws.html">Gas Laws</a><a href="/hardness.html">Hardness Converter</a><a href="/conduction-convection-radiation.html">Heat Transfer Modes</a><a href="/machining.html">Machining Calculator</a><a href="/momentofinertia.html">Moment of Inertia</a><a href="/oring.html">O-Ring Sizing</a><a href="/pipe-flow.html">Pipe Flow Calculator</a><a href="/psychrometric.html">Psychrometric Calc</a><a href="/reynolds-number.html">Reynolds Number</a><a href="/spring.html">Spring Design</a><a href="/thermal-expansion.html">Thermal Expansion</a></div>
            </div>
            <div class="view-all-container">
                <a href="/indexmech.html" class="view-all-link">View All Mechanical Tools â†’</a>
            </div>
        </div>
    </li>
                        <li><a href="/index.html#articles">Articles</a></li>
                        <li><a href="/sitemap2.html">Site Map</a></li>
                    </ul>

                    <div class="theme-toggle">
                        <i class="fas fa-sun icon"></i>
                        <label class="switch">
                            <input type="checkbox" id="theme-switch">
                            <span class="slider"></span>
                        </label>
                        <i class="fas fa-moon icon"></i>
                    </div>
                </div>
            </nav>
    </header>

    <main class="container">
        <!-- "Back to Tools" button REMOVED -->
        
        <div class="tool-container">
            <h2><i class="fas fa-wind"></i> Thermowell Wake Frequency Calculator</h2>
            
            <div class="tool-description">
                <p>This calculator validates the mechanical stability of thermowells against flow-induced vibrations, specifically addressing vortex-induced resonance. It adheres to the guidelines of <strong>ASME PTC 19.3 TW-2016</strong> and is essential for ensuring the integrity and safety of thermowells in industrial processes worldwide.</p>
            </div>
        
            <div class="calculator-form">
                <form id="thermowell-calculator-form">
                    <!-- Thermowell Dimensions -->
                    <div class="form-section">
                        <h3><i class="fas fa-ruler-combined"></i> Thermowell Dimensions</h3>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="insertion-length">Insertion Length (L) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Length from the outside of the nozzle to the tip of the thermowell (mm).</span></span></label>
                                <input type="number" id="insertion-length" step="0.1" value="150" required>
                            </div>
                            <div class="form-group">
                                <label for="tip-diameter">Tip Diameter (D<sub>t</sub>) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Outside diameter of the thermowell tip (mm).</span></span></label>
                                <input type="number" id="tip-diameter" step="0.1" value="12.7" required>
                            </div>
                            <div class="form-group">
                                <label for="root-diameter">Root Diameter (D<sub>r</sub>) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Outside diameter of the thermowell at the root (mm).</span></span></label>
                                <input type="number" id="root-diameter" step="0.1" value="19.05" required>
                            </div>
                            <div class="form-group">
                                <label for="bore-diameter">Bore Diameter (D<sub>b</sub>) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Inside diameter of the thermowell bore (mm).</span></span></label>
                                <input type="number" id="bore-diameter" step="0.1" value="6.35" required>
                            </div>
                            <div class="form-group">
                                <label for="thermowell-material">Thermowell Material <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Material of construction for the thermowell.</span></span></label>
                                <select id="thermowell-material" required>
                                    <option value="stainless_steel_316">Stainless Steel 316</option>
                                    <option value="stainless_steel_304">Stainless Steel 304</option>
                                    <option value="hastelloy_c276">Hastelloy C-276</option>
                                    <option value="inconel_600">Inconel 600</option>
                                    <option value="titanium">Titanium</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Process Fluid Conditions -->
                    <div class="form-section">
                        <h3><i class="fas fa-water"></i> Process Fluid Conditions</h3>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="fluid-density">Fluid Density (ρ<sub>f</sub>) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Density of the process fluid (kg/m³).</span></span></label>
                                <input type="number" id="fluid-density" step="0.1" value="1000" required>
                            </div>
                            <div class="form-group">
                                <label for="fluid-viscosity">Fluid Dynamic Viscosity (μ<sub>f</sub>) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Dynamic viscosity of the process fluid (Pa·s or N·s/m²).</span></span></label>
                                <input type="number" id="fluid-viscosity" step="0.000001" value="0.001" required>
                            </div>
                            <div class="form-group">
                                <label for="fluid-velocity">Fluid Velocity (U) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Velocity of the process fluid perpendicular to the thermowell (m/s).</span></span></label>
                                <input type="number" id="fluid-velocity" step="0.1" value="5" required>
                            </div>
                            <div class="form-group">
                                <label for="process-temperature">Process Temperature (T) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Operating temperature of the process fluid (Celsius).</span></span></label>
                                <input type="number" id="process-temperature" step="1" value="25" required>
                            </div>
                        </div>
                    </div>

                    <!-- Mounting & Geometry Factors -->
                    <div class="form-section">
                        <h3><i class="fas fa-cogs"></i> Mounting & Geometry Factors</h3>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="thermowell-type">Thermowell Type <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Straight or Tapered thermowell.</span></span></label>
                                <select id="thermowell-type" required>
                                    <option value="tapered">Tapered</option>
                                    <option value="straight">Straight</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="mounting-type">Mounting Type <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">How the thermowell is mounted (e.g., Cantilevered, Fixed-Fixed).</span></span></label>
                                <select id="mounting-type" required>
                                    <option value="cantilevered">Cantilevered</option>
                                    <option value="fixed_fixed">Fixed-Fixed</option>
                                    <option value="fixed_pinned">Fixed-Pinned</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <div class="button-wrapper">
                        <button type="button" id="calculate-btn" class="calculate-btn"><i class="fas fa-calculator"></i> Calculate</button>
                        <button type="button" id="reset-form-btn" class="reset-btn"><i class="fas fa-sync-alt"></i> Reset</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Results Container (Updated) -->
        <div id="result-container" class="result-container">
            <h3><i class="fas fa-clipboard-check"></i> Calculation Results</h3>
            
            <div class="thermowell-diagram">
                <p style="margin-bottom: 25px; font-weight: bold; color: var(--secondary);">Thermowell Diagram (Simplified)</p>
                <svg viewBox="0 0 100 200" preserveAspectRatio="xMidYMid meet">
                    <!-- Pipe Wall -->
                    <rect x="0" y="0" width="100" height="20" fill="#a0a0a0" stroke="#555" stroke-width="1"/>
                    <rect x="0" y="180" width="100" height="20" fill="#a0a0a0" stroke="#555" stroke-width="1"/>
                    <line x1="0" y1="20" x2="0" y2="180" stroke="#555" stroke-width="1"/>
                    <line x1="100" y1="20" x2="100" y2="180" stroke="#555" stroke-width="1"/>
                    <!-- Thermowell Body (Tapered/Straight representation) -->
                    <polygon id="thermowell-body" points="40,20 60,20 60,180 40,180" fill="#cccccc" stroke="#333333" stroke-width="1"/>
                    <!-- Bore -->
                    <line x1="50" y1="20" x2="50" y2="180" stroke="#666666" stroke-width="0.5" stroke-dasharray="2,2"/>
                    <!-- Labels -->
                    <text x="70" y="100" font-size="8" fill="#333" text-anchor="middle">L</text>
                    <text x="50" y="175" font-size="8" fill="#333" text-anchor="middle">D_t</text>
                    <text x="50" y="25" font-size="8" fill="#333" text-anchor="middle">D_r</text>
                    <text x="45" y="100" font-size="8" fill="#333" text-anchor="end">D_b</text>
                </svg>
                <p class="status-display" id="stability-status-display">Stability Status: N/A</p>
            </div>
            
            <!-- NEW: Step-by-Step Calculation Cards -->
            <div id="steps-container" class="steps-container math-content">
                <!-- Calculation steps will be inserted here -->
            </div>
            
            <!-- Summary Table -->
            <table class="result-table">
                <thead>
                    <tr>
                        <th>Parameter</th>
                        <th>Value</th>
                    </tr>
                </thead>
                <tbody id="result-table-body">
                    <!-- Results will be dynamically inserted here -->
                </tbody>
            </table>
            
            <div style="display: flex; justify-content: center; margin-top: 20px;">
                <button type="button" id="clear-results-btn" class="clear-results-btn"><i class="fas fa-times-circle"></i> Clear Results</button>
            </div>
            
            <div class="standard-reference" id="standard-reference">
                <!-- Standard reference text will be inserted here -->
            </div>

            <!-- NEW: Educational Section -->
            <div id="education-section" class="education-section">
                <h2><i class="fas fa-lightbulb"></i> Professional Insights: Thermowell Failure Explained</h2>
    
                <div class="insight-card">
                    <h4><i class="fas fa-tools"></i> What is a Thermowell?</h4>
                    <p>A thermowell is a strong, sealed tube that protects a temperature sensor (like a thermocouple, RTD, or thermometer) from the process fluid it's measuring. Think of it as a permanent "sleeve" installed in a pipe or vessel. This allows the sensor to be safely removed for calibration or replacement without shutting down or draining the entire process.</p>
                    <p>While it provides essential protection, the thermowell itself, being a blunt object protruding into a moving fluid, is subject to powerful aerodynamic (or hydrodynamic) forces. Failure to properly engineer this component can lead to catastrophic mechanical failure.</p>
                </div>
    
                <div class="insight-card">
                    <h4><i class="fas fa-water"></i> The Danger: Flow-Induced Vibration (FIV)</h4>
                    <p>When a fluid (like steam, gas, or liquid) flows past a thermowell, it doesn't just flow *around* it; it creates a turbulent pattern called a <strong>Kármán vortex street</strong>. The fluid creates swirling vortices, or "wakes," that detach from alternating sides of the thermowell. You can see this same effect when wind blows past a flagpole, causing it to "sing" or flutter.</p>
                    <p>This alternating vortex shedding creates a periodic force that pushes the thermowell back and forth, perpendicular to the direction of the flow. The frequency of this pushing force is called the <strong>wake frequency (f<sub>w</sub>)</strong>.</p>
                </div>
                
                <div class="danger-box">
                    <h4><i class="fas fa-exclamation-triangle"></i> Resonance: The "Silent Killer"</h4>
                    <p>Like a guitar string, every physical object has a <strong>natural frequency (f<sub>n</sub>)</strong>—the frequency at which it "wants" to vibrate if you "pluck" it. This is determined by its length, diameter, material stiffness (Young's Modulus), and how it's mounted (e.g., cantilevered).</p>
                    <p><strong>Resonance</strong> is the catastrophic phenomenon that occurs when the external forcing frequency (the wake frequency, $f_w$) gets too close to the thermowell's internal natural frequency ($f_n$).</p>
                    <p>When this "lock-in" occurs, the tiny pushes from the vortices perfectly align with the thermowell's own vibration, amplifying the motion with each cycle. The vibrations can grow exponentially, leading to high-cycle fatigue and causing the thermowell to snap off and be sent downstream, potentially destroying pumps, turbines, or other critical equipment.</p>
                    <p>The goal of this calculation, and the entire ASME PTC 19.3 TW-2016 standard, is to ensure this <strong>never</strong> happens.</p>
                </div>

                <div class="insight-card">
                    <h4><i class="fas fa-book-open"></i> The ASME PTC 19.3 TW-2016 Standard</h4>
                    <p>This is the global standard for the mechanical design and selection of thermowells. It is a rigorous check that evaluates multiple failure modes. This calculator performs the most critical of these checks: the frequency limit.</p>
                    <p>The standard mandates several checks, including:</p>
                    <ul>
                        <li><strong>Frequency Limit (This Calculator):</strong> The primary safety check. The standard states that the thermowell's natural frequency ($f_n$) must be high enough to avoid resonance. The wake frequency ($f_w$) must be less than 80% of the natural frequency.
                        <div class="formula-block" style="text-align:center; font-weight:bold; font-size: 1.1rem;">$f_w < 0.8 \times f_n$ &nbsp;&nbsp; (or) &nbsp;&nbsp; $\frac{f_n}{f_w} > 1.25$</div></li>
                        <li><strong>Static Stress Limit:</strong> Checks if the thermowell is strong enough to resist the simple "push" (drag force) of the fluid without bending or breaking.</li>
                        <li><strong>Dynamic Stress Limit:</strong> Checks if the thermowell can withstand the cyclic stress from the vibrating forces, even if it's not in full resonance.</li>
                        <li><strong>Pressure Rating:</strong> Ensures the thermowell can withstand the process pressure without bursting.</li>
                    </ul>
                    <p><strong>Note:</strong> This tool only evaluates the Frequency Limit. A complete design must satisfy all four criteria.</p>
                </div>
                
                <div class="success-box">
                    <h4><i class="fas fa-check-circle"></i> How to "Fix" a Failing Thermowell Design</h4>
                    <p>If the calculation shows a failure ($f_n / f_w < 1.25$), the design is unsafe and must be changed. Engineers have several options, all of which aim to either <strong>increase the natural frequency ($f_n$)</strong> or <strong>disrupt the wake frequency ($f_w$)</strong>:</p>
                    <ol>
                        <li><strong>Shorten the Insertion Length (L):</strong> This is the most effective solution. $f_n$ is inversely proportional to $L^2$. Halving the length quadruples the natural frequency. This is why you should always use the shortest thermowell possible that still reaches the representative flow.</li>
                        <li><strong>Increase the Root/Tip Diameter (D):</strong> A thicker thermowell is stiffer, which increases $f_n$. A larger diameter may also reduce the wake frequency ($f_w = S_t \times U / D$).</li>
                        <li><strong>Change Material:</strong> Using a stiffer material (higher Young's Modulus, $E$) or a lighter material (lower $\rho_s$) will increase $f_n$.</li>
                        <li><strong>Add a Velocity Collar:</strong> This is a support collar added partway down the thermowell. It effectively "shortens" the unsupported length ($L$) and changes the mounting from a simple cantilever, dramatically increasing $f_n$.</li>
                        <li><strong>Use a Helical Strake Profile:</strong> Instead of a smooth cylinder, these thermowells have a helical (spiral) fin. This design, borrowed from industrial chimneys, "trips" the fluid flow and breaks up the vortices, preventing a coherent, resonant wake from ever forming. This *disrupts* $f_w$ rather than changing $f_n$.</li>
                    </ol>
                </div>
    
                <div class="insight-card">
                    <h4><i class="fas-calculator"></i> Key Parameters in the Calculation</h4>
                    <ul>
                        <li><strong>Reynolds Number ($R_e$):</strong> A dimensionless number that describes the flow regime (laminar, turbulent). It's calculated using fluid density, velocity, diameter, and viscosity. $R_e$ is used to find the correct Strouhal number.</li>
                        <li><strong>Strouhal Number ($S_t$):</strong> A dimensionless number that links the wake frequency, velocity, and diameter. For most industrial flows ($R_e > 1000$), $S_t$ is a near-constant, typically around 0.22.</li>
                        <li><strong>Young's Modulus ($E$):</strong> A measure of material stiffness. A higher $E$ (like Hastelloy) means a stiffer thermowell and a higher $f_n$ compared to a more flexible material (like Titanium). This value also decreases as temperature increases.</li>
                    </ul>
                </div>
            </div>

        </div>
    </main>

    <!-- NEW: Footer from provided file -->
        <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-left">
                    <a href="/" class="footer-logo">
                        <img src="logo.png" alt="Design Calculators Logo" loading="lazy" decoding="async">
                        <span class="footer-logo-text">Design Calculators</span>
                    </a>
                    <p class="footer-description">A comprehensive engineering calculator hub based on IEC, IEEE, and
                        global standards.</p>
                    <div class="social-buttons">
                        <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://designcalculators.co.in"
                            target="_blank" rel="noopener noreferrer" class="social-btn linkedin"
                            aria-label="LinkedIn"><i class="fab fa-linkedin-in"></i></a>
                        <a href="https://www.youtube.com/@designcalculators" target="_blank" rel="noopener noreferrer"
                            class="social-btn youtube" aria-label="YouTube"><i class="fab fa-youtube"></i></a>
                        <a href="https://twitter.com/intent/tweet?url=https://designcalculators.co.in&text=Check%20out%20this%20amazing%20engineering%20calculator%20hub!"
                            target="_blank" rel="noopener noreferrer" class="social-btn twitter" aria-label="Twitter"><i
                                class="fab fa-twitter"></i></a>
                        <a href="https://www.facebook.com/sharer/sharer.php?u=https://designcalculators.co.in"
                            target="_blank" rel="noopener noreferrer" class="social-btn facebook"
                            aria-label="Facebook"><i class="fab fa-facebook-f"></i></a>
                        <a href="https://api.whatsapp.com/send?text=Check%20out%20this%20amazing%20engineering%20resource:%20https://designcalculators.co.in"
                            target="_blank" rel="noopener noreferrer" class="social-btn whatsapp"
                            aria-label="WhatsApp"><i class="fab fa-whatsapp"></i></a>
                    </div>
                </div>
                <div class="footer-right">
                    <div class="footer-col">
                        <h4>Quick Links</h4>
                        <ul>
                            <li><a href='/indexele.html'>Electrical Tools</a></li>
                            <li><a href='/indexmech.html'>Mechanical Tools</a></li>
                            <li><a href='/indexinst.html'>Instrumentation Tools</a></li>
                            <li><a href='/about.html'>About Us</a></li>
                            <li><a href='/faq.html'>FAQ</a></li>
                        </ul>
                    </div>
                    <div class="footer-col">
                        <h4>Learn More</h4>
                        <ul>
                            <li><a href="https://www.youtube.com/@designcalculators" target="_blank"
                                    rel="noopener noreferrer">YouTube Channel</a></li>
                            <li><a href='/contact.html'>Contact Us</a></li>
                            <li><a href='/privacy-policy.html'>Privacy Policy</a></li>
                            <li><a href='/terms-of-service.html'>Terms of Service</a></li>
                            <li><a href='/sitemap2.html'>Sitemap</a></li>
                        </ul>
                    </div>
                    <div class="footer-col">
                        <h4>Our Network</h4>
                        <ul>
                            <li style="margin-bottom: 12px;">
                                <a href="https://reliabilitytools.co.in/" target="_blank" rel="noopener"
                                   style="font-weight: 600; display: block; margin-bottom: 2px;">Reliability Tools</a>
                                <span style="font-size: 0.85rem; color: #94a3b8; line-height: 1.3; display: block;">Reliability
                                    & maintenance engineering calculators.</span>
                            </li>
                            <li style="margin-bottom: 12px;">
                                <a href="https://electrosafe.homes/" target="_blank" rel="noopener"
                                   style="font-weight: 600; display: block; margin-bottom: 2px;">ElectroSafe</a>
                                <span style="font-size: 0.85rem; color: #94a3b8; line-height: 1.3; display: block;">Dedicated
                                    to home electrical safety & protection.</span>
                            </li>
                            <li>
                                <a href="https://knowyourname.co.in/" target="_blank" rel="noopener"
                                   style="font-weight: 600; display: block; margin-bottom: 2px;">KnowYourName</a>
                                <span style="font-size: 0.85rem; color: #94a3b8; line-height: 1.3; display: block;">Scientific
                                    name analysis: Phonetics, Ergonomics & Acoustics.</span>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="footer-disclaimer">
                <p>All calculations are for preliminary engineering design guidance. Final designs must comply with all applicable local and international standards (including but not limited to ASHRAE 90.1, ARI 550/590). Always verify calculations and consult with a licensed professional engineer before implementation or construction.</p>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 Design Calculators. Created by <span style="color: var(--secondary); font-weight: bold;">Anil Sharma</span>. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // --- Element Selection ---
            const insertionLengthInput = document.getElementById('insertion-length');
            const tipDiameterInput = document.getElementById('tip-diameter');
            const rootDiameterInput = document.getElementById('root-diameter');
            const boreDiameterInput = document.getElementById('bore-diameter');
            const thermowellMaterialInput = document.getElementById('thermowell-material');
            const fluidDensityInput = document.getElementById('fluid-density');
            const fluidViscosityInput = document.getElementById('fluid-viscosity');
            const fluidVelocityInput = document.getElementById('fluid-velocity');
            const processTemperatureInput = document.getElementById('process-temperature');
            const thermowellTypeInput = document.getElementById('thermowell-type');
            const mountingTypeInput = document.getElementById('mounting-type');

            const calculateBtn = document.getElementById('calculate-btn');
            const resetFormBtn = document.getElementById('reset-form-btn');
            const clearResultsBtn = document.getElementById('clear-results-btn');
            const resultContainer = document.getElementById('result-container');
            const resultTableBody = document.getElementById('result-table-body');
            const standardReference = document.getElementById('standard-reference');
            
            // UPDATED: Get new calculation steps container
            const calculationDetailsDiv = document.getElementById('steps-container');
            
            const stabilityStatusDisplay = document.getElementById('stability-status-display');
            const thermowellBodySVG = document.getElementById('thermowell-body');

            // --- Material Properties ---
            const materialProperties = {
                'stainless_steel_316': { E_25C: 193e9, rho_s: 8000, alpha: 16.5e-6 },
                'stainless_steel_304': { E_25C: 193e9, rho_s: 8000, alpha: 17.3e-6 },
                'hastelloy_c276': { E_25C: 205e9, rho_s: 8890, alpha: 11.2e-6 },
                'inconel_600': { E_25C: 207e9, rho_s: 8470, alpha: 14.0e-6 },
                'titanium': { E_25C: 116e9, rho_s: 4500, alpha: 8.6e-6 }
            };

            const getYoungsModulus = (material, temperatureC) => {
                const { E_25C } = materialProperties[material];
                const tempCorrectionFactor = 1 - (0.0005 * (temperatureC - 25));
                return E_25C * Math.max(0.5, tempCorrectionFactor);
            };

            // --- Default Values ---
            const defaultValues = {
                'insertion-length': 150, 'tip-diameter': 12.7, 'root-diameter': 19.05,
                'bore-diameter': 6.35, 'thermowell-material': 'stainless_steel_316',
                'fluid-density': 1000, 'fluid-viscosity': 0.001, 'fluid-velocity': 5,
                'process-temperature': 25, 'thermowell-type': 'tapered', 'mounting-type': 'cantilevered'
            };

            // --- Helper Functions ---
            function addResultRow(parameter, value) {
                const row = resultTableBody.insertRow();
                row.insertCell().innerHTML = parameter;
                row.insertCell().innerHTML = value;
            }

            // NEW: Updated displayMessage function
            function displayMessage(message, type = "info") {
                let messageBox = document.getElementById('custom-message-box');
                
                messageBox.textContent = message;
                if (type === "error") {
                    messageBox.style.backgroundColor = 'var(--danger)';
                    messageBox.style.color = 'white';
                } else if (type === "warning") {
                    messageBox.style.backgroundColor = 'var(--warning)';
                    messageBox.style.color = '#333';
                } else {
                    messageBox.style.backgroundColor = 'var(--success)';
                    messageBox.style.color = 'white';
                }
                messageBox.classList.add('show');

                setTimeout(() => {
                    messageBox.classList.remove('show');
                }, 5000);
            }

            function clearResults() {
                resultContainer.classList.remove('show');
                resultTableBody.innerHTML = '';
                calculationDetailsDiv.innerHTML = '';
                calculationDetailsDiv.classList.remove('active'); // NEW: Hide steps
                standardReference.innerHTML = '';
                stabilityStatusDisplay.textContent = 'Stability Status: N/A';
                stabilityStatusDisplay.classList.remove('ok', 'error', 'warning');
                updateThermowellDiagram('tapered');
                displayMessage("Results cleared.", "info");
            }

            function resetForm() {
                for (const key in defaultValues) {
                    document.getElementById(key).value = defaultValues[key];
                }
                clearResults();
                displayMessage("Form reset to default values.", "info");
            }

            function updateThermowellDiagram(type) {
                if (type === 'tapered') {
                    thermowellBodySVG.setAttribute('points', '40,20 60,20 55,180 45,180');
                } else { // straight
                    thermowellBodySVG.setAttribute('points', '40,20 60,20 60,180 40,180');
                }
            }
            
            thermowellTypeInput.addEventListener('change', function() {
                updateThermowellDiagram(this.value);
            });

            // --- MAJOR UPDATE: New Calculation Function ---
            function calculateWakeFrequency() {
                clearResults(); // Clear previous results

                // --- Input Parsing and Validation ---
                const L_mm = parseFloat(insertionLengthInput.value);
                const Dt_mm = parseFloat(tipDiameterInput.value);
                const Dr_mm = parseFloat(rootDiameterInput.value);
                const Db_mm = parseFloat(boreDiameterInput.value);
                const materialKey = thermowellMaterialInput.value;
                const rho_f = parseFloat(fluidDensityInput.value);
                const mu_f = parseFloat(fluidViscosityInput.value);
                const U = parseFloat(fluidVelocityInput.value);
                const T_C = parseFloat(processTemperatureInput.value);
                const thermowellType = thermowellTypeInput.value;
                const mountingType = mountingTypeInput.value;

                if (isNaN(L_mm) || isNaN(Dt_mm) || isNaN(Dr_mm) || isNaN(Db_mm) ||
                    isNaN(rho_f) || isNaN(mu_f) || isNaN(U) || isNaN(T_C)) {
                    displayMessage("Please fill in all input fields with valid numbers.", "error"); return;
                }
                if (L_mm <= 0 || Dt_mm <= 0 || Dr_mm <= 0 || Db_mm <= 0) {
                    displayMessage("All dimensions must be positive values.", "error"); return;
                }
                if (Dt_mm >= Dr_mm && thermowellType === 'tapered') {
                    displayMessage("For tapered thermowells, Tip Diameter must be less than Root Diameter.", "error"); return;
                }
                if (Db_mm >= Dt_mm || Db_mm >= Dr_mm) {
                    displayMessage("Bore Diameter must be less than both Tip and Root Diameters.", "error"); return;
                }
                if (rho_f <= 0 || mu_f <= 0 || U <= 0) {
                    displayMessage("Fluid density, viscosity, and velocity must be positive values.", "error"); return;
                }

                // --- Conversions to SI Units ---
                const L = L_mm / 1000; // meters
                const Dt = Dt_mm / 1000; // meters
                const Dr = Dr_mm / 1000; // meters
                const Db = Db_mm / 1000; // meters

                const materialData = materialProperties[materialKey];
                const E = getYoungsModulus(materialKey, T_C);
                const rho_s = materialData.rho_s;
                
                let stepHtml = ''; // Initialize string for all steps

                // --- Step 1: Input Parameters ---
                stepHtml += `<div class="step-card">
                    <h4><span class="number">1</span>Input Parameters</h4>
                    <div class="step-content">
                        <div class="step-explanation">
                            <strong>Material:</strong> ${thermowellMaterialInput.options[thermowellMaterialInput.selectedIndex].text}<br>
                            <strong>Mounting:</strong> ${mountingType.charAt(0).toUpperCase() + mountingType.slice(1)}<br>
                            <strong>Type:</strong> ${thermowellType.charAt(0).toUpperCase() + thermowellType.slice(1)}<br>
                            <strong>Temp (T):</strong> ${T_C.toFixed(1)} °C
                        </div>
                        <div class="step-explanation">
                            <strong>Fluid Density (ρ<sub>f</sub>):</strong> ${rho_f.toFixed(2)} kg/m³<br>
                            <strong>Fluid Viscosity (μ<sub>f</sub>):</strong> ${mu_f.toExponential(2)} Pa·s<br>
                            <strong>Fluid Velocity (U):</strong> ${U.toFixed(2)} m/s
                        </div>
                    </div>
                    <div class="step-explanation" style="margin-top: 15px;">
                        <strong>Dimensions (m):</strong> 
                        L: ${L.toFixed(4)}, 
                        D<sub>r</sub>: ${Dr.toFixed(4)}, 
                        D<sub>t</sub>: ${Dt.toFixed(4)}, 
                        D<sub>b</sub>: ${Db.toFixed(4)}
                    </div>
                </div>`;

                // --- Step 2: Calculate Geometric & Material Properties ---
                const D_avg = (Dt + Dr) / 2;
                const I = (Math.PI / 64) * (Math.pow(D_avg, 4) - Math.pow(Db, 4));
                const m = (Math.PI / 4) * (Math.pow(D_avg, 2) - Math.pow(Db, 2)) * rho_s;
                
                stepHtml += `<div class="step-card math-content">
                    <h4><span class="number">2</span>Calculate Geometric & Material Properties</h4>
                    <div class="step-content">
                        <div class="step-explanation">
                            <p><strong>Avg. Outer Diameter (D<sub>avg</sub>):</strong></p>
                            <div class="formula-block">
                                <p class="formula">$$D_{avg} = \\frac{D_r + D_t}{2} = ${D_avg.toFixed(4)} \\text{ m}$$</p>
                            </div>
                            <p><strong>Young's Modulus at T (E):</strong></p>
                            <div class="formula-block">
                                <p class="formula">$$E = ${E.toExponential(2)} \\text{ Pa}$$</p>
                            </div>
                        </div>
                        <div class="step-explanation">
                            <p><strong>Moment of Inertia (I):</strong></p>
                            <div class="formula-block">
                                <p class="formula">$$I = \\frac{\\pi}{64} (D_{avg}^4 - D_b^4) = ${I.toExponential(4)} \\text{ m}^4$$</p>
                            </div>
                            <p><strong>Mass per Unit Length (m):</strong></p>
                            <div class="formula-block">
                                <p class="formula">$$m = \\frac{\\pi}{4} (D_{avg}^2 - D_b^2) \\rho_s = ${m.toFixed(4)} \\text{ kg/m}$$</p>
                            </div>
                        </div>
                    </div>
                </div>`;

                // --- Step 3: Calculate Fluid Dynamics (Re, St) ---
                const Re = (rho_f * U * D_avg) / mu_f;
                let St;
                let warnings = [];
                if (Re < 100) {
                    St = 0.2; 
                    warnings.push("Reynolds Number (Re) is very low (< 100). Strouhal number (St) is an approximation.");
                } else if (Re >= 100 && Re <= 200000) {
                    St = 0.22;
                } else {
                    St = 0.27;
                }
                
                stepHtml += `<div class="step-card math-content">
                    <h4><span class="number">3</span>Calculate Fluid Dynamics (Re, St)</h4>
                    <div class="step-content">
                        <div class="step-explanation">
                            <p><strong>Reynolds Number (Re):</strong></p>
                            <div class="formula-block">
                                <p class="formula">$$Re = \\frac{\\rho_f U D_{avg}}{\\mu_f}$$</p>
                                <p class="formula">$$Re = \\frac{${rho_f.toFixed(2)} \\times ${U.toFixed(2)} \\times ${D_avg.toFixed(4)}}{${mu_f.toExponential(2)}} = ${Re.toExponential(2)}$$</p>
                            </div>
                        </div>
                        <div class="step-explanation">
                            <p><strong>Strouhal Number (St):</strong></p>
                            <div class="formula-block">
                                <p>Based on Re, $S_t$ is approximated (per ASME PTC 19.3 guidelines).</p>
                                <p class="formula">$$S_t = ${St.toFixed(2)}$$</p>
                            </div>
                        </div>
                    </div>
                </div>`;

                // --- Step 4: Calculate Wake Frequency (f_w) ---
                const f_w = (St * U) / D_avg;
                
                stepHtml += `<div class="step-card math-content">
                    <h4><span class="number">4</span>Calculate Wake Frequency (f<sub>w</sub>)</h4>
                    <div class="step-explanation">
                        <p>The frequency at which vortices are shed from the thermowell.</p>
                        <div class="formula-block">
                            <p class="formula">$$f_w = \\frac{S_t \\times U}{D_{avg}}$$</p>
                            <p class="formula">$$f_w = \\frac{${St.toFixed(2)} \\times ${U.toFixed(2)}}{${D_avg.toFixed(4)}} = ${f_w.toFixed(2)} \\text{ Hz}$$</p>
                        </div>
                        <div class="step-value" style="color:var(--danger);">${f_w.toFixed(2)}<span class="step-unit">Hz (Forcing)</span></div>
                    </div>
                </div>`;

                // --- Step 5: Calculate Natural Frequency (f_n) ---
                let K;
                switch (mountingType) {
                    case 'cantilevered': K = 3.5156; break;
                    case 'fixed_fixed': K = 22.37; break;
                    case 'fixed_pinned': K = 15.42; break;
                    default: K = 3.5156;
                }
                const f_n = (K / (2 * Math.PI)) * Math.sqrt((E * I) / (m * Math.pow(L, 4)));
                
                stepHtml += `<div class="step-card math-content">
                    <h4><span class="number">5</span>Calculate Natural Frequency (f<sub>n</sub>)</h4>
                    <div class="step-explanation">
                        <p>The inherent frequency at which the thermowell will vibrate. (K=${K.toFixed(4)} for ${mountingType})</p>
                        <div class="formula-block">
                            <p class="formula">$$f_n = \\frac{K}{2\\pi} \\sqrt{\\frac{E \\times I}{m \\times L^4}}$$</p>
                            <p class="formula">$$f_n = \\frac{${K.toFixed(4)}}{2\\pi} \\sqrt{\\frac{${E.toExponential(2)} \\times ${I.toExponential(4)}}{${m.toFixed(4)} \\times ${L.toFixed(4)}^4}}$$</p>
                            <p class="formula">$$f_n = ${f_n.toFixed(2)} \\text{ Hz}$$</p>
                        </div>
                        <div class="step-value">${f_n.toFixed(2)}<span class="step-unit">Hz (Natural)</span></div>
                    </div>
                </div>`;

                // --- Step 6: Resonance Check ---
                const safetyFactor = 1.25; // Per ASME PTC 19.3 (fn/fw > 1.25, or fw/fn < 0.8)
                const frequencyRatio = f_n / f_w;
                const isStable = frequencyRatio > safetyFactor;
                
                let statusMessage, statusClass;
                
                if (isStable) {
                    statusMessage = "STABLE";
                    statusClass = "ok";
                } else {
                    statusMessage = "NOT STABLE - RISK OF RESONANCE";
                    statusClass = "error";
                    displayMessage("Warning: Thermowell is NOT stable and is at risk of failure!", "error");
                }
                
                if (Re < 10000 && Re > 1000) {
                    warnings.push("Reynolds Number is in a variable range. Consider a larger safety margin.");
                }
                if (frequencyRatio < 2 && isStable) {
                    warnings.push("Stable, but with a low safety margin (f_n/f_w < 2).");
                    statusClass = "warning"; // Downgrade to warning
                    statusMessage = "STABLE (LOW MARGIN)";
                    displayMessage("Thermowell is stable, but the safety margin is low.", "warning");
                }
                
                stepHtml += `<div class="step-card math-content">
                    <h4><span class="number">6</span>Final Resonance Check (ASME PTC 19.3)</h4>
                    <div class="step-explanation">
                        <p>To prevent resonance, the natural frequency must be sufficiently higher than the wake frequency.</p>
                        <p><strong>Safety Criteria:</strong> $f_n / f_w > 1.25$</p>
                        <div class="formula-block">
                            <p class="formula">$$Ratio = \\frac{f_n}{f_w} = \\frac{${f_n.toFixed(2)} \\text{ Hz}}{${f_w.toFixed(2)} \\text{ Hz}} = ${frequencyRatio.toFixed(2)}$$</p>
                        </div>
                        <p><strong>Is ${frequencyRatio.toFixed(2)} > 1.25? ${isStable ? "YES." : "NO."}</strong></p>
                        <div class="step-value" style="color: var(--${statusClass});">${statusMessage}</div>
                        ${warnings.length > 0 ? `<p style="margin-top:15px; color:var(--warning-color); font-weight:bold;">Warnings: ${warnings.join(' ')}</p>` : ''}
                    </div>
                </div>`;


                // --- Display Results ---
                resultTableBody.innerHTML = '';
                addResultRow("Reynolds Number (Re)", `${Re.toExponential(2)}`);
                addResultRow("Strouhal Number (St)", `${St.toFixed(2)}`);
                addResultRow("<strong>Calculated Wake Frequency (f<sub>w</sub>)</strong>", `<strong>${f_w.toFixed(2)} Hz</strong>`);
                addResultRow("<strong>Calculated Natural Frequency (f<sub>n</sub>)</strong>", `<strong>${f_n.toFixed(2)} Hz</strong>`);
                addResultRow("<strong>Frequency Ratio (f<sub>n</sub> / f<sub>w</sub>)</strong>", `<strong>${frequencyRatio.toFixed(2)}</strong>`);
                addResultRow("ASME PTC 19.3 Criteria (f<sub>n</sub> / f<sub>w</sub> > 1.25)", isStable ? `<strong class="ok">PASS</strong>` : `<strong class="error">FAIL</strong>`);
                addResultRow("<strong>Mechanical Stability Status</strong>", `<strong class="${statusClass}">${statusMessage}</strong>`);

                updateThermowellDiagram(thermowellType);
                stabilityStatusDisplay.textContent = `Stability Status: ${statusMessage}`;
                stabilityStatusDisplay.classList.remove('ok', 'error', 'warning');
                stabilityStatusDisplay.classList.add(statusClass);

                standardReference.innerHTML = `
                    <h4>International Standards Compliance & Best Practices:</h4>
                    <p>This calculator adheres to the principles and methodologies outlined in <strong>ASME PTC 19.3 TW-2016: Thermowells</strong>. This is the primary standard governing thermowell design, including the critical wake frequency analysis to prevent resonant vibrations.</p>
                    <p>This tool provides a preliminary assessment of the <strong>Frequency Limit</strong> criteria. A complete thermowell design per the standard must also satisfy <strong>Static Stress</strong>, <strong>Dynamic Stress</strong>, and <strong>Pressure Rating</strong> limits. For critical applications, always perform a full ASME PTC 19.3 TW-2016 calculation or consult a qualified engineer.</p>
                `;

                calculationDetailsDiv.innerHTML = stepHtml;
                calculationDetailsDiv.classList.add('active'); // <-- This makes it visible
                
                resultContainer.style.display = 'block';
                setTimeout(() => {
                    resultContainer.classList.add('show');
                    resultContainer.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }, 10);
                
                // NEW: Typeset MathJax
                if (window.MathJax && typeof window.MathJax.typesetPromise === 'function') {
                    setTimeout(() => {
                        window.MathJax.typesetPromise([calculationDetailsDiv]);
                    }, 50);
                }
            }

            // --- Event Listeners ---
            calculateBtn.addEventListener('click', calculateWakeFrequency);
            resetFormBtn.addEventListener('click', resetForm);
            clearResultsBtn.addEventListener('click', clearResults);

            const formSections = document.querySelectorAll('.form-section');
            formSections.forEach((section, index) => {
                setTimeout(() => {
                    section.classList.add('fade-in');
                }, 100 * index);
            });

            // NEW: Theme switch logic
            const themeSwitch = document.getElementById('theme-switch');
            if (themeSwitch) {
                if (localStorage.getItem('theme') === 'dark') {
                    document.body.classList.add('dark-mode');
                    themeSwitch.checked = true;
                }
                themeSwitch.addEventListener('change', function() {
                    if (this.checked) {
                        document.body.classList.add('dark-mode');
                        localStorage.setItem('theme', 'dark');
                    } else {
                        document.body.classList.remove('dark-mode');
                        localStorage.setItem('theme', 'light');
                    }
                });
            }

            updateThermowellDiagram(thermowellTypeInput.value);
        });
    </script>
</body>
</html>
