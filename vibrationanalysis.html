<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Vibration Analysis Calculator - Natural Frequencies & Mode Shapes | Design Calculators</title>
<meta name="description" content="Professional vibration analysis calculator to determine natural frequencies and mode shapes for beams, shafts, and structures. Calculate critical speeds, resonance frequencies following ISO 10816 and API standards.">
<meta name="keywords" content="vibration analysis, natural frequency, mode shapes, critical speed, resonance frequency, ISO 10816, API 684, mechanical vibration, modal analysis">
<meta name="author" content="Design Calculators">
<meta name="robots" content="index, follow">

<!-- AdSense & Analytics -->
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5936527763614780" crossorigin="anonymous"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-23Y1V450SR"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-23Y1V450SR');
</script>

<!-- Preconnect -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Montserrat:wght@700;800;900&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<!-- MathJax for equations -->
<script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script>
MathJax = {
tex: {
inlineMath: [['$', '$'], ['\\(', '\\)']],
displayMath: [['$$', '$$'], ['\\[', '\\]']]
},
svg: {
fontCache: 'global'
}
};
</script>

<!-- Favicon -->
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="icon" href="/favicon.ico" type="image/x-icon">

<style>
:root {
--primary-color: #1E3A8A;
--secondary-color: #2563EB;
--accent-color: #F59E0B;
--bg-color: #F8FAFC;
--card-bg: #FFFFFF;
--text-color: #4B5563;
--heading-color: #111827;
--footer-bg: #0F172A;
--border-color: #E2E8F0;
--gradient-primary: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
--gradient-dark: linear-gradient(135deg, #0F172A, #1E293B);
--card-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
--hover-color: #e2e6ea;
--button-hover-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
--highlight-bg: rgba(245, 158, 11, 0.2);
}

body.dark-mode {
--primary-color: #10B981;
--secondary-color: #34D399;
--bg-color: #0F172A;
--card-bg: #1E293B;
--text-color: #CBD5E1;
--heading-color: #F1F5F9;
--footer-bg: #020617;
--border-color: #334155;
--highlight-bg: rgba(16, 185, 129, 0.3);
--hover-color: #1E293B;
}

html { 
scroll-behavior: smooth;
}

body {
font-family: 'Inter', sans-serif;
background-color: var(--bg-color);
color: var(--text-color);
line-height: 1.8;
transition: background-color 0.3s, color 0.3s;
overflow-x: hidden;
margin: 0;
padding: 0;
}

.container { 
max-width: 1280px; 
margin: 0 auto; 
padding: 0 24px; 
}

.content-container {
max-width: 1200px;
margin: 0 auto;
padding: 20px;
}

/* Header */
.header {
background: var(--gradient-primary);
color: white;
padding: 24px 0;
position: relative;
overflow: hidden;
}

.navbar { 
display: flex; 
justify-content: space-between;
align-items: center; 
}

.logo-container { 
display: flex; 
align-items: center; 
gap: 16px; 
text-decoration: none; 
color: white; 
}

.logo { 
height: 56px;
}

.logo-text {
font-size: 1.75rem;
font-weight: 800;
font-family: 'Montserrat', sans-serif;
}

.nav-links {
display: flex;
gap: 24px;
align-items: center;
list-style: none;
margin: 0;
padding: 0;
}

.nav-links a {
color: white;
text-decoration: none;
font-weight: 500;
transition: color 0.3s;
}

.nav-links a:hover {
color: var(--accent-color);
}

.theme-toggle { 
display: flex; 
align-items: center; 
gap: 12px;
}

.theme-toggle .icon { 
color: white; 
font-size: 1.2rem; 
}

.switch { 
position: relative; 
display: inline-block; 
width: 56px; 
height: 30px;
}

.switch input { 
opacity: 0; 
width: 0; 
height: 0; 
}

.slider { 
position: absolute; 
cursor: pointer; 
top: 0; 
left: 0;
right: 0; 
bottom: 0; 
background-color: rgba(0,0,0,0.2); 
transition: .4s; 
border-radius: 30px; 
}

.slider:before { 
position: absolute; 
content: ""; 
height: 22px; 
width: 22px;
left: 4px; 
bottom: 4px; 
background-color: white; 
transition: .4s; 
border-radius: 50%; 
}

input:checked + .slider { 
background-color: var(--accent-color);
}

input:checked + .slider:before { 
transform: translateX(26px); 
}

main { 
padding: 40px 0; 
}

/* Calculator Specific Styles */
.tool-container {
background-color: var(--card-bg);
border-radius: 8px;
padding: 30px;
box-shadow: var(--card-shadow);
margin-bottom: 30px;
}

.tool-container h2 {
color: var(--primary-color);
border-bottom: 3px solid var(--primary-color);
padding-bottom: 15px;
margin-top: 0;
margin-bottom: 25px;
font-family: 'Montserrat', sans-serif;
}

.tool-description {
margin-bottom: 25px;
color: var(--text-color);
font-size: 1.1rem;
}

.calculator-form {
background-color: var(--card-bg);
border-radius: 8px;
padding: 25px;
margin-top: 25px;
box-shadow: var(--card-shadow);
}

.form-group {
margin-bottom: 20px;
}

.form-group label {
display: block;
margin-bottom: 8px;
font-weight: 600;
color: var(--heading-color);
}

.form-group input, .form-group select {
width: 100%;
padding: 12px;
border: 1px solid var(--border-color);
border-radius: 5px;
background-color: var(--bg-color);
color: var(--text-color);
box-sizing: border-box;
transition: border-color 0.3s, box-shadow 0.3s;
font-size: 1rem;
}

.form-group input:focus, .form-group select:focus {
border-color: var(--primary-color);
box-shadow: 0 0 8px rgba(30, 58, 138, 0.3);
outline: none;
}

.form-row {
display: grid;
grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
gap: 20px;
}

.calculate-btn {
background: var(--gradient-primary);
color: white;
border: none;
padding: 15px 25px;
border-radius: 5px;
cursor: pointer;
font-size: 1.1rem;
font-weight: 700;
margin-top: 15px;
transition: transform 0.2s, box-shadow 0.3s;
position: relative;
overflow: hidden;
width: 100%;
}

.calculate-btn:hover {
transform: translateY(-3px);
box-shadow: var(--button-hover-shadow);
}

.calculate-btn .ripple {
position: absolute;
border-radius: 50%;
background-color: rgba(255, 255, 255, 0.7);
animation: ripple-effect 0.6s linear forwards;
transform: scale(0);
pointer-events: none;
}

@keyframes ripple-effect {
to {
transform: scale(4);
opacity: 0;
}
}

.result-container {
margin-top: 40px;
padding: 25px;
border-radius: 8px;
background-color: var(--card-bg);
box-shadow: var(--card-shadow);
display: none;
opacity: 0;
transform: translateY(20px);
transition: opacity 0.5s ease-out, transform 0.5s ease-out;
}

.result-container.show {
display: block;
opacity: 1;
transform: translateY(0);
}

.result-container h3 {
color: var(--primary-color);
margin-bottom: 20px;
font-family: 'Montserrat', sans-serif;
font-size: 1.5rem;
}

.calculation-step-container {
margin-bottom: 20px;
border: 1px solid var(--border-color);
border-radius: 8px;
overflow: hidden;
opacity: 0;
transform: translateX(-20px);
animation: fadeInSlideIn 0.5s ease-out forwards;
}

.calculation-step-container:nth-child(odd) {
background-color: rgba(0,0,0,0.02);
}

body.dark-mode .calculation-step-container:nth-child(odd) {
background-color: rgba(255,255,255,0.02);
}

.step-header {
background-color: var(--hover-color);
padding: 12px 15px;
font-weight: 700;
color: var(--heading-color);
border-bottom: 1px solid var(--border-color);
cursor: pointer;
display: flex;
align-items: center;
justify-content: space-between;
}

.step-content {
padding: 15px;
display: block;
}

.step-content p.formula {
font-family: 'Times New Roman', serif;
font-size: 1.1em;
text-align: center;
padding: 12px;
background-color: var(--bg-color);
border: 1px solid var(--border-color);
border-radius: 4px;
margin: 10px 0;
overflow-x: auto;
color: var(--text-color);
line-height: 1.8;
}

.step-content p.calculation {
font-family: 'Courier New', monospace;
background-color: var(--bg-color);
padding: 10px 12px;
border-radius: 3px;
margin: 8px 0;
color: var(--text-color);
word-wrap: break-word;
line-height: 1.6;
border-left: 3px solid var(--secondary-color);
}

.step-content .final-result {
font-weight: 700;
font-size: 1.1rem;
color: var(--primary-color);
background: var(--highlight-bg);
padding: 12px 15px;
border-radius: 5px;
text-align: center;
margin-top: 12px;
border-left: 4px solid var(--primary-color);
}

.mode-shapes-table {
width: 100%;
border-collapse: collapse;
margin: 20px 0;
}

.mode-shapes-table th,
.mode-shapes-table td {
border: 1px solid var(--border-color);
padding: 12px;
text-align: center;
}

.mode-shapes-table th {
background-color: var(--primary-color);
color: white;
font-weight: 700;
}

.mode-shapes-table tr:nth-child(even) {
background-color: rgba(0,0,0,0.02);
}

body.dark-mode .mode-shapes-table tr:nth-child(even) {
background-color: rgba(255,255,255,0.02);
}

.recommendations {
margin-top: 30px;
padding: 20px;
border: 1px solid var(--border-color);
border-radius: 8px;
background-color: var(--bg-color);
}

.recommendations h4 {
color: var(--secondary-color);
margin-top: 0;
margin-bottom: 15px;
}

.recommendations ul {
padding-left: 20px;
margin: 0;
}

.recommendations ul li {
margin-bottom: 12px;
line-height: 1.6;
}

.info-icon {
color: var(--primary-color);
margin-left: 8px;
cursor: help;
}

.tooltip {
position: relative;
display: inline-block;
}

.tooltip .tooltiptext {
visibility: hidden;
width: 250px;
background-color: #333;
color: #fff;
text-align: center;
border-radius: 6px;
padding: 8px;
position: absolute;
z-index: 1;
bottom: 125%;
left: 50%;
margin-left: -125px;
opacity: 0;
transition: opacity 0.3s;
font-size: 0.9rem;
line-height: 1.4;
}

.tooltip:hover .tooltiptext {
visibility: visible;
opacity: 1;
}

#custom-message-box {
position: fixed;
top: 20px;
left: 50%;
transform: translateX(-50%);
padding: 15px 25px;
border-radius: 8px;
box-shadow: 0 4px 10px rgba(0,0,0,0.2);
z-index: 1000;
font-weight: bold;
color: white;
opacity: 0;
transition: opacity 0.5s ease-in-out;
}

@keyframes fadeInSlideIn {
from {
opacity: 0;
transform: translateX(-20px);
}
to {
opacity: 1;
transform: translateX(0);
}
}

/* Mode shape diagram container */
.mode-diagram-container {
margin-top: 30px;
padding: 20px;
border: 1px solid var(--border-color);
border-radius: 8px;
background-color: var(--card-bg);
}

.mode-diagram-container h4 {
color: var(--primary-color);
margin-top: 0;
margin-bottom: 15px;
font-family: 'Montserrat', sans-serif;
text-align: center;
}

#mode-shape-canvas {
display: block;
width: 100%;
max-width: 800px;
height: 400px;
margin: 0 auto;
border: 1px solid var(--border-color);
border-radius: 5px;
background-color: var(--bg-color);
}

.vibration-analysis {
margin-top: 30px;
padding: 20px;
border: 1px solid var(--border-color);
border-radius: 8px;
background-color: var(--card-bg);
}

.vibration-analysis h4 {
color: var(--primary-color);
margin-top: 0;
margin-bottom: 15px;
font-family: 'Montserrat', sans-serif;
}

.vibration-item {
margin-bottom: 15px;
padding: 15px;
border-radius: 5px;
background-color: var(--hover-color);
}

.vibration-item.critical {
border-left: 4px solid #EF4444;
background-color: rgba(239, 68, 68, 0.1);
}

.vibration-item.warning {
border-left: 4px solid var(--accent-color);
background-color: rgba(245, 158, 11, 0.1);
}

.vibration-item.info {
border-left: 4px solid var(--secondary-color);
background-color: rgba(37, 99, 235, 0.1);
}

.vibration-item h5 {
margin-top: 0;
margin-bottom: 10px;
display: flex;
align-items: center;
gap: 8px;
color: var(--heading-color);
}

.vibration-item p {
margin: 0;
line-height: 1.6;
}

.export-section {
margin-top: 25px;
text-align: center;
}

.export-btn {
background-color: var(--secondary-color);
color: white;
border: none;
padding: 12px 20px;
border-radius: 5px;
cursor: pointer;
font-weight: 600;
transition: background-color 0.3s;
display: inline-flex;
align-items: center;
gap: 8px;
}

.export-btn:hover {
background-color: var(--primary-color);
}

/* Footer */
footer { 
background: var(--gradient-dark);
color: #CBD5E1;
padding: 50px 0 20px 0; 
}

.footer-content {
display: flex;
justify-content: space-between;
align-items: flex-start;
flex-wrap: wrap;
gap: 40px;
margin-bottom: 30px;
}

.footer-col {
flex: 1;
min-width: 200px;
}

.footer-col h4 { 
font-size: 1.1rem;
color: white; 
margin-bottom: 15px; 
font-weight: 700;
}

.footer-col ul { 
list-style: none; 
padding: 0; 
margin: 0;
}

.footer-col ul li { 
margin-bottom: 10px;
}

.footer-col a { 
color: #CBD5E1; 
text-decoration: none; 
transition: color 0.3s;
font-size: 0.95rem;
}

.footer-col a:hover { 
color: var(--accent-color); 
}

.footer-disclaimer {
text-align: center;
margin: 30px auto;
padding-top: 25px;
border-top: 1px solid #334155;
max-width: 800px;
font-size: 0.9rem;
line-height: 1.6;
}

.footer-bottom { 
text-align: center; 
padding-top: 20px;
font-size: 0.9rem; 
color: #94A3B8;
}

.creator-name { 
color: var(--secondary-color); 
font-weight: bold; 
}

.social-buttons {
display: flex;
gap: 12px;
margin-top: 15px;
}

.social-btn {
width: 40px;
height: 40px;
display: inline-flex;
justify-content: center;
align-items: center;
color: white;
border-radius: 50%;
text-decoration: none;
font-size: 1.1rem;
transition: transform 0.3s, box-shadow 0.3s;
box-shadow: 0 4px 8px rgba(0,0,0,0.2);
}

.social-btn:hover {
transform: translateY(-4px);
box-shadow: 0 8px 16px rgba(0,0,0,0.3);
}

.social-btn.linkedin {
background-color: #0A66C2;
}

.social-btn.youtube {
background-color: #FF0000;
}

.social-btn.twitter {
background-color: #1DA1F2;
}

.social-btn.facebook {
background-color: #1877F2;
}

.social-btn.whatsapp {
background-color: #25D366;
}

@media (max-width: 768px) {
.navbar { 
flex-direction: column;
gap: 20px; 
}

.nav-links {
flex-direction: column;
gap: 12px;
text-align: center;
}

.form-row {
grid-template-columns: 1fr;
}

.container {
padding: 15px;
}

.content-container {
padding: 15px;
}

.tool-container {
padding: 20px;
}

.footer-content {
flex-direction: column;
gap: 25px;
}

#mode-shape-canvas {
height: 300px;
}
}
</style>
</head>
<body>

<header class="header">
<div class="container">
<nav class="navbar">
<a href="/" class="logo-container">
<span class="logo-text">Design Calculators</span>
</a>
<ul class="nav-links">
<li><a href="/">Home</a></li>
<li><a href="/articles.html">Articles</a></li>
<li><a href="/indexMech.html">Mechanical</a></li>
<li><a href="/indexele.html">Electrical</a></li>
<li><a href="/indexinst.html">Instrumentation</a></li>
</ul>
<div class="theme-toggle">
<i class="fas fa-sun icon"></i>
<label class="switch">
<input type="checkbox" id="theme-switch">
<span class="slider"></span>
</label>
<i class="fas fa-moon icon"></i>
</div>
</nav>
</div>
</header>

<main class="content-container">

<div class="tool-container">
<h2>Vibration Analysis Calculator - Natural Frequencies & Mode Shapes</h2>

<div class="tool-description">
<p>This professional vibration analysis calculator determines natural frequencies and mode shapes for beams, shafts, cantilevers, and simply-supported structures. Based on ISO 10816, API 684, and VDI 2056 standards, this tool calculates first, second, and third natural frequencies, critical speeds for rotating machinery, damping requirements, and resonance avoidance zones. Essential for mechanical engineers, rotating equipment specialists, and structural analysts to prevent resonance-induced failures and ensure safe operation of machinery and structures.</p>

<p><strong>Key Features:</strong> Calculate natural frequencies using Euler-Bernoulli beam theory, determine mode shapes and nodal points, analyze critical speeds for shafts with concentrated loads, evaluate operating speed separation margins, assess damping ratios, and visualize mode shapes graphically. Supports various boundary conditions including fixed-fixed, fixed-free (cantilever), and simply-supported configurations.</p>
</div>

<div class="calculator-form">
<form id="vibration-form">

<!-- System Type -->
<div class="form-group">
<label for="system-type">System Type</label>
<select id="system-type" required>
<option value="beam-simple" selected>Simply Supported Beam</option>
<option value="beam-cantilever">Cantilever Beam</option>
<option value="beam-fixed">Fixed-Fixed Beam</option>
<option value="shaft-simple">Rotating Shaft (Simply Supported)</option>
<option value="shaft-cantilever">Rotating Shaft (Cantilever)</option>
</select>
</div>

<!-- Beam/Shaft Properties -->
<div class="form-row">
<div class="form-group">
<label for="length">Length, L (m) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Distance between supports or cantilever length</span></span></label>
<input type="number" id="length" value="2" min="0.1" step="0.1" required>
</div>
<div class="form-group">
<label for="diameter">Diameter / Width, d (mm) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">For circular shaft: diameter; For rectangular beam: width</span></span></label>
<input type="number" id="diameter" value="50" min="1" step="1" required>
</div>
</div>

<div class="form-row">
<div class="form-group">
<label for="thickness">Thickness / Height, h (mm) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">For rectangular beam only. Leave 0 for circular shaft.</span></span></label>
<input type="number" id="thickness" value="0" min="0" step="1">
</div>
<div class="form-group">
<label for="modulus">Modulus of Elasticity, E (GPa) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Steel: 200-210 GPa, Aluminum: 69-70 GPa, Titanium: 110-120 GPa</span></span></label>
<input type="number" id="modulus" value="200" min="1" step="1" required>
</div>
</div>

<div class="form-row">
<div class="form-group">
<label for="density">Material Density, ρ (kg/m³) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Steel: 7850, Aluminum: 2700, Titanium: 4500</span></span></label>
<input type="number" id="density" value="7850" min="100" step="10" required>
</div>
<div class="form-group">
<label for="mass-concentrated">Concentrated Mass, m (kg) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Additional mass at center (rotor, equipment). Enter 0 if none.</span></span></label>
<input type="number" id="mass-concentrated" value="0" min="0" step="1">
</div>
</div>

<!-- Operating Conditions (for rotating machinery) -->
<div class="form-group" id="operating-speed-group" style="display:none;">
<label for="operating-speed">Operating Speed (RPM) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Actual operating speed for resonance check</span></span></label>
<input type="number" id="operating-speed" value="3000" min="0" step="10">
</div>

<!-- Analysis Options -->
<div class="form-row">
<div class="form-group">
<label for="damping-ratio">Damping Ratio, ζ (%) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Typical: 0.5-2% for steel structures, 2-5% for machinery</span></span></label>
<input type="number" id="damping-ratio" value="1" min="0.1" max="20" step="0.1" required>
</div>
<div class="form-group">
<label for="safety-margin">Resonance Separation Margin (%) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Required separation from natural frequencies. API 684 recommends ±15-20%</span></span></label>
<input type="number" id="safety-margin" value="15" min="5" max="50" step="5" required>
</div>
</div>

<!-- Standards Selection -->
<div class="form-group">
<label for="standard">Applicable Standard</label>
<select id="standard" required>
<option value="iso" selected>ISO 10816 (Mechanical Vibration)</option>
<option value="api">API 684 (Rotordynamic Tutorial)</option>
<option value="vdi">VDI 2056 (Evaluation Criteria)</option>
<option value="general">General Analysis</option>
</select>
</div>

<button type="button" id="calculate-btn" class="calculate-btn">Calculate Natural Frequencies</button>
</form>
</div>

<div id="result-container" class="result-container">
<h3>Vibration Analysis Results</h3>
<div id="calculation-steps">
<!-- Calculation steps will be dynamically inserted here -->
</div>

<div class="mode-diagram-container">
<h4>First Three Mode Shapes</h4>
<canvas id="mode-shape-canvas"></canvas>
<p style="text-align: center; margin-top: 10px; font-size: 0.9rem; color: var(--text-color);">
<strong>Mode 1 (Red):</strong> First mode | <strong>Mode 2 (Blue):</strong> Second mode | <strong>Mode 3 (Green):</strong> Third mode
</p>
</div>

<div class="vibration-analysis">
<h4>Resonance Assessment & Operating Conditions</h4>
<div id="vibration-analysis-content">
<!-- Vibration assessment will be dynamically inserted here -->
</div>
</div>

<div class="recommendations">
<h4>Design Standards & Recommendations</h4>
<div id="recommendations-content">
<!-- Recommendations will be dynamically inserted here -->
</div>
</div>

<div class="export-section">
<button id="export-report" class="export-btn"><i class="fas fa-file-pdf"></i> Export Vibration Report</button>
</div>
</div>
</div>

<!-- Educational Content -->
<div class="tool-container" style="margin-top: 40px;">
<h2>Understanding Vibration Analysis and Natural Frequencies</h2>

<h3 style="color: var(--primary-color); margin-top: 25px;">What is Vibration Analysis?</h3>
<p>Vibration analysis is the systematic study of oscillatory motion in mechanical systems to predict natural frequencies, mode shapes, and dynamic response characteristics. Every structure and rotating machine possesses inherent natural frequencies at which it will resonate when excited. When operating frequencies coincide with natural frequencies, resonance occurs, amplifying vibration amplitudes by factors of 10-100 or more, leading to excessive stress, fatigue failure, bearing damage, and catastrophic breakdowns. Approximately 40% of all mechanical failures in industrial equipment are vibration-related, making proper vibration analysis critical for reliability and safety.</p>

<p>Natural frequency analysis using Euler-Bernoulli beam theory provides fundamental understanding of structural dynamics. This calculator determines the first, second, and third natural frequencies using exact analytical solutions for various boundary conditions. For rotating machinery, these natural frequencies correspond to critical speeds where the shaft exhibits maximum deflection and must be avoided or passed through quickly during startup and shutdown. Modern turbines, compressors, and motors routinely operate above their first critical speed, necessitating careful analysis to ensure adequate separation margins.</p>

<h3 style="color: var(--primary-color); margin-top: 25px;">Fundamental Concepts</h3>

<p><strong>Natural Frequency:</strong> The frequency at which a system naturally vibrates when disturbed and allowed to oscillate freely without external forcing. Natural frequency depends on mass (inertia) and stiffness properties. Increasing stiffness or reducing mass increases natural frequency, while adding mass or reducing stiffness decreases it. For beams, natural frequency is proportional to √(stiffness/mass), and for a given material and geometry, shorter, thicker members have higher natural frequencies than longer, slender ones.</p>

<p><strong>Mode Shapes:</strong> The characteristic deformation patterns a structure exhibits when vibrating at each natural frequency. The first mode (fundamental mode) has the lowest frequency and shows simple bending with no nodal points (zero displacement locations) except at supports. Higher modes exhibit more complex shapes with multiple nodal points. For a simply-supported beam, mode 2 has one node at center, mode 3 has two nodes at L/3 and 2L/3, and so on. Understanding mode shapes is essential for proper sensor placement and vibration mitigation strategies.</p>

<p><strong>Critical Speed:</strong> For rotating shafts, critical speeds correspond to rotational speeds (in RPM) where the excitation frequency matches a natural frequency. At critical speed, even minute imbalances create large vibrations. The first critical speed is most important and must typically have 15-20% separation margin from operating speed per API 684. Flexible shafts in high-speed machinery operate between critical speeds, requiring careful balancing and damping design. The Jeffcott rotor model provides foundational understanding of critical speed behavior.</p>

<p><strong>Damping:</strong> Energy dissipation mechanism that reduces vibration amplitude. Damping ratio (ζ) quantifies how quickly vibrations decay. Low damping (ζ < 2%) results in large amplitudes at resonance and slow decay, while high damping (ζ > 5%) provides good vibration control but may mask underlying problems. Material damping in steel is typically 0.1-0.5%, structural connections add 0.5-2%, and bearing damping in rotating machinery contributes 1-3%. Additional damping through viscous dampers or friction elements improves system stability.</p>

<h3 style="color: var(--primary-color); margin-top: 25px;">Boundary Conditions and System Types</h3>

<p><strong>Simply Supported Beams:</strong> Most common configuration with pin supports at both ends allowing rotation but preventing translation. First natural frequency coefficient λ₁ = π for simply supported beams. This configuration applies to shafts between bearings, bridge spans, and floor beams. Simply-supported systems have lowest natural frequencies for given dimensions, making them most susceptible to resonance but easiest to analyze.</p>

<p><strong>Cantilever Beams:</strong> Fixed at one end, free at the other. Examples include aircraft wings, diving boards, and overhanging shafts. Cantilevers have λ₁ = 1.875 and exhibit much lower natural frequencies than equivalent simply-supported beams (approximately 3.5 times lower for same length). The first mode shows maximum deflection at free end with rotation at fixed end. Cantilevers are sensitive to concentrated masses at free end, significantly reducing natural frequency.</p>

<p><strong>Fixed-Fixed Beams:</strong> Both ends rigidly clamped preventing translation and rotation. Used in aircraft fuselages, pressure vessel nozzles, and structural frames. Fixed-fixed beams have highest natural frequencies (λ₁ = 4.73), approximately 2.3 times higher than simply-supported beams. These systems are stiffest but most difficult to achieve perfect fixity in practice, as real connections have some flexibility that reduces actual natural frequencies below theoretical values.</p>

<p><strong>Rotating Shafts:</strong> Shafts in turbines, pumps, motors, and compressors operate at high speeds and must avoid critical speeds. Shaft natural frequencies depend on bearing stiffness, gyroscopic effects, and rotor mass distribution. Overhung rotors (cantilever configuration) in fans and pumps have lower critical speeds than between-bearing designs. API 684 provides comprehensive guidance on rotordynamic analysis including Campbell diagrams, stability maps, and unbalance response prediction.</p>

<h3 style="color: var(--primary-color); margin-top: 25px;">Factors Affecting Natural Frequency</h3>

<p><strong>Geometry:</strong> Length dominates - natural frequency is inversely proportional to length squared (f ∝ 1/L²). Doubling length reduces frequency by factor of 4. Diameter/thickness affects area moment of inertia - increasing diameter 20% raises frequency approximately 45% for circular shafts. For rectangular sections, increasing height (perpendicular to bending axis) has cubic effect on frequency. Optimization involves maximizing stiffness-to-weight ratio.</p>

<p><strong>Material Properties:</strong> Natural frequency scales as √(E/ρ). High modulus materials (steel, titanium) have higher frequencies than low modulus materials (aluminum, plastics) of equal geometry. However, density also matters - aluminum's lower density partially compensates for lower modulus. Composite materials offer excellent stiffness-to-weight ratios enabling high natural frequencies with reduced weight. Temperature affects modulus and must be considered for high-temperature applications.</p>

<p><strong>Concentrated Masses:</strong> Adding concentrated mass at maximum deflection location (midspan for simply-supported, free end for cantilever) dramatically reduces natural frequency. Dunkerley's method provides approximate formulas: 1/f²_total ≈ 1/f²_beam + 1/f²_mass. For shafts, disk/rotor mass at midspan can reduce critical speed by 50-80%. Mass distribution affects higher modes differently - masses at nodal points of higher modes don't affect those mode frequencies.</p>

<p><strong>Support Conditions:</strong> Real supports are never perfectly rigid or perfectly pinned. Bearing stiffness in rotating machinery significantly affects critical speeds. Soft supports reduce critical speed while adding damping. Foundation flexibility in structures reduces natural frequencies - soil-structure interaction can lower building frequencies by 20-40%. Accurately modeling support conditions requires experimental validation or detailed finite element analysis.</p>

<h3 style="color: var(--primary-color); margin-top: 25px;">Industrial Applications and Design Guidelines</h3>

<p>Rotating machinery design follows API standards requiring critical speed separation. First critical speed must be >125% or <75% of maximum continuous speed. For variable speed equipment crossing critical speeds, acceleration must be rapid (<30 seconds through ±20% of critical) to minimize time at resonance. Balancing quality per ISO 1940 depends on operating speed and equipment type - precision machinery requires balance quality G0.4 to G1, while general industrial equipment uses G2.5 to G6.3.</p>

<p>Structural applications include bridges, buildings, and platforms where wind, earthquake, or machinery excitation must not coincide with natural frequencies. The Tacoma Narrows Bridge collapse (1940) illustrated catastrophic resonance effects. Modern codes require dynamic analysis for structures exceeding certain heights or spans. Floor vibrations from walking in buildings must consider natural frequencies >3 Hz for comfort per ISO 2631. Machine foundations must have natural frequency at least 2-3 times machine operating frequency to prevent resonance and excessive vibration transmission.</p>

<p>Mitigation strategies when operating near resonance include: (1) Increasing stiffness through reinforcement or bracing, (2) Adding damping via viscous dampers or friction elements, (3) Changing mass distribution by relocating equipment or adding counterweights, (4) Modifying operating speed to avoid resonance zones, (5) Using tuned mass dampers or vibration absorbers tuned to problematic frequencies. Computer simulations using finite element analysis (FEA) with modal analysis modules provide detailed predictions for complex geometries, guiding optimal design decisions.</p>
</div>

<div class="tool-container" style="margin-top: 40px;">
<h2>Standards and References</h2>

<p>This calculator implements methodologies from the following authoritative vibration standards:</p>

<ul style="line-height: 2;">
<li><strong>ISO 10816-1:</strong> Mechanical vibration - Evaluation of machine vibration by measurements on non-rotating parts</li>
<li><strong>ISO 10816-3:</strong> Industrial machines with nominal power above 15 kW and nominal speeds between 120 r/min and 15000 r/min</li>
<li><strong>ISO 1940-1:</strong> Mechanical vibration - Balance quality requirements for rotors in a constant (rigid) state</li>
<li><strong>API 684:</strong> API Tutorial on Rotordynamic Critical Speed Analysis</li>
<li><strong>API 617:</strong> Axial and Centrifugal Compressors and Expander-compressors (vibration limits)</strong></li>
<li><strong>VDI 2056:</strong> Evaluation criteria for mechanical vibrations of machines</li>
<li><strong>ISO 2631:</strong> Mechanical vibration and shock - Evaluation of human exposure to whole-body vibration</li>
<li><strong>ASME B73.1:</strong> Specification for Horizontal End Suction Centrifugal Pumps for Chemical Process</li>
<li><strong>DIN 4024:</strong> Machine foundations - Flexible structures that support machines with rotating elements</li>
</ul>

<p><strong>Important Note:</strong> This calculator provides preliminary natural frequency estimates based on Euler-Bernoulli beam theory, which assumes slender members and neglects shear deformation and rotary inertia effects. For more accurate analysis of short, thick members, use Timoshenko beam theory. Complex geometries, multiple masses, and coupled vibration modes require finite element analysis (FEA). Critical rotating equipment must undergo detailed rotordynamic analysis by qualified engineers using specialized software per API standards. Always verify calculations against measured data during commissioning.</p>
</div>

</main>

<footer>
<div class="container">
<div class="footer-content">
<div class="footer-col">
<h4>Design Calculators</h4>
<p style="font-size: 0.9rem; line-height: 1.6; margin-bottom: 15px;">The world's first comprehensive engineering calculator hub based on IEC, IEEE, ISA, ASME, and API standards.</p>
<div class="social-buttons">
<a href="https://www.linkedin.com/shareArticle?mini=true&url=https://designcalculators.co.in" target="_blank" rel="noopener noreferrer" class="social-btn linkedin" aria-label="LinkedIn"><i class="fab fa-linkedin-in"></i></a>
<a href="https://www.youtube.com/@designcalculators" target="_blank" rel="noopener noreferrer" class="social-btn youtube" aria-label="YouTube"><i class="fab fa-youtube"></i></a>
<a href="https://twitter.com/intent/tweet?url=https://designcalculators.co.in" target="_blank" rel="noopener noreferrer" class="social-btn twitter" aria-label="Twitter"><i class="fab fa-twitter"></i></a>
<a href="https://www.facebook.com/sharer/sharer.php?u=https://designcalculators.co.in" target="_blank" rel="noopener noreferrer" class="social-btn facebook" aria-label="Facebook"><i class="fab fa-facebook-f"></i></a>
<a href="https://api.whatsapp.com/send?text=Check%20out%20this%20amazing%20engineering%20resource:%20https://designcalculators.co.in" target="_blank" rel="noopener noreferrer" class="social-btn whatsapp" aria-label="WhatsApp"><i class="fab fa-whatsapp"></i></a>
</div>
</div>
<div class="footer-col">
<h4>Quick Links</h4>
<ul>
<li><a href="/">Home</a></li>
<li><a href="/indexele.html">Electrical</a></li>
<li><a href="/indexMech.html">Mechanical</a></li>
<li><a href="/indexinst.html">Instrumentation</a></li>
<li><a href="/articles.html">Articles</a></li>
</ul>
</div>
<div class="footer-col">
<h4>Resources</h4>
<ul>
<li><a href="/about.html">About Us</a></li>
<li><a href="/contact.html">Contact</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/privacy-policy.html">Privacy Policy</a></li>
<li><a href="/terms-of-service.html">Terms of Service</a></li>
</ul>
</div>
<div class="footer-col">
<h4>More</h4>
<ul>
<li><a href="/blog.html">Blog</a></li>
<li><a href="/sitemap2.html">Sitemap</a></li>
<li><a href="https://www.youtube.com/@designcalculators" target="_blank" rel="noopener noreferrer">YouTube Channel</a></li>
</ul>
</div>
</div>

<div class="footer-disclaimer">
<p>All tools are for guidance only and should not replace professional engineering judgment. Vibration calculations must be verified by qualified professional engineers using appropriate testing and measurement. Critical rotating equipment requires detailed rotordynamic analysis per API standards. This site is not affiliated with or endorsed by ISO, API, or any standards organization.</p>
</div>

<div class="footer-bottom">
<p>&copy; 2025 Design Calculators. Created by <span class="creator-name">A Sharma</span>. All rights reserved.</p>
</div>
</div>
</footer>

<div id="custom-message-box"></div>

<script>
// Wait for DOM to be fully loaded
window.addEventListener('DOMContentLoaded', function() {
    // Form Elements
    const systemType = document.getElementById('system-type');
    const length = document.getElementById('length');
    const diameter = document.getElementById('diameter');
    const thickness = document.getElementById('thickness');
    const modulus = document.getElementById('modulus');
    const density = document.getElementById('density');
    const massConcentrated = document.getElementById('mass-concentrated');
    const operatingSpeed = document.getElementById('operating-speed');
    const operatingSpeedGroup = document.getElementById('operating-speed-group');
    const dampingRatio = document.getElementById('damping-ratio');
    const safetyMargin = document.getElementById('safety-margin');
    const standard = document.getElementById('standard');
    const calculateBtn = document.getElementById('calculate-btn');
    const resultContainer = document.getElementById('result-container');
    const calculationStepsDiv = document.getElementById('calculation-steps');
    const vibrationAnalysisDiv = document.getElementById('vibration-analysis-content');
    const recommendationsDiv = document.getElementById('recommendations-content');
    const exportReportBtn = document.getElementById('export-report');
    
    // Canvas for mode shapes
    const canvas = document.getElementById('mode-shape-canvas');
    if (!canvas) {
        console.error('Canvas element not found!');
        return;
    }
    
    const ctx = canvas.getContext('2d');
    if (!ctx) {
        console.error('Cannot get canvas 2D context!');
        return;
    }
    
    // Set canvas dimensions
    function resizeCanvas() {
        const container = canvas.parentElement;
        const displayWidth = Math.min(container.clientWidth - 40, 800);
        const displayHeight = 400;
        
        canvas.style.width = displayWidth + 'px';
        canvas.style.height = displayHeight + 'px';
        
        const scale = window.devicePixelRatio || 1;
        canvas.width = displayWidth * scale;
        canvas.height = displayHeight * scale;
        ctx.scale(scale, scale);
    }
    
    resizeCanvas();
    window.addEventListener('resize', resizeCanvas);

    // Show/hide operating speed field
    systemType.addEventListener('change', function() {
        if (this.value.startsWith('shaft')) {
            operatingSpeedGroup.style.display = 'block';
        } else {
            operatingSpeedGroup.style.display = 'none';
        }
    });

    calculateBtn.addEventListener('click', (e) => {
        const ripple = document.createElement('span');
        const diameter = Math.max(calculateBtn.clientWidth, calculateBtn.clientHeight);
        const radius = diameter / 2;
        ripple.style.width = ripple.style.height = `${diameter}px`;
        ripple.style.left = `${e.clientX - (calculateBtn.getBoundingClientRect().left + radius)}px`;
        ripple.style.top = `${e.clientY - (calculateBtn.getBoundingClientRect().top + radius)}px`;
        ripple.classList.add('ripple');
        calculateBtn.appendChild(ripple);
        ripple.addEventListener('animationend', () => ripple.remove());
        
        if (validateInputs()) {
            performVibrationAnalysis();
        }
    });

    function validateInputs() {
        const inputs = document.querySelectorAll('#vibration-form [required]');
        for (const input of inputs) {
            if (!input.value || (input.type === 'number' && parseFloat(input.value) <= 0)) {
                displayMessage(`Error: "${input.previousElementSibling.textContent}" must be a positive value.`, "error");
                return false;
            }
        }
        return true;
    }

    function performVibrationAnalysis() {
        calculationStepsDiv.innerHTML = '';
        vibrationAnalysisDiv.innerHTML = '';
        
        // Get inputs
        const system = systemType.value;
        const L = parseFloat(length.value); // meters
        const d = parseFloat(diameter.value) / 1000; // convert mm to m
        const h = parseFloat(thickness.value) / 1000; // convert mm to m
        const E = parseFloat(modulus.value) * 1e9; // convert GPa to Pa
        const rho = parseFloat(density.value); // kg/m³
        const m_conc = parseFloat(massConcentrated.value); // kg
        const omega_op = parseFloat(operatingSpeed.value); // RPM
        const zeta = parseFloat(dampingRatio.value) / 100; // Convert % to decimal
        const margin = parseFloat(safetyMargin.value) / 100; // Convert % to decimal
        const std = standard.value;

        // Step 1: Calculate area moment of inertia
        let I, A;
        if (h > 0) {
            // Rectangular cross-section
            I = (d * Math.pow(h, 3)) / 12; // m⁴
            A = d * h; // m²
        } else {
            // Circular cross-section
            I = (Math.PI * Math.pow(d, 4)) / 64; // m⁴
            A = (Math.PI * Math.pow(d, 2)) / 4; // m²
        }
        
        const crossSection = h > 0 ? `rectangular (${(d*1000).toFixed(1)} mm × ${(h*1000).toFixed(1)} mm)` : `circular (diameter ${(d*1000).toFixed(1)} mm)`;
        
        addCalculationStep(1, 'Cross-Sectional Properties',
            h > 0 ? '$$I = \\frac{b h^3}{12}$$<br>$$A = b \\times h$$' : '$$I = \\frac{\\pi d^4}{64}$$<br>$$A = \\frac{\\pi d^2}{4}$$',
            `Cross-section: ${crossSection}<br>I = ${(I*1e12).toExponential(3)} mm⁴<br>A = ${(A*1e6).toFixed(2)} mm²`,
            `Second Moment of Area: <strong>${(I*1e12).toExponential(3)} mm⁴</strong>`
        );

        // Step 2: Calculate mass per unit length
        const m = rho * A; // kg/m
        
        addCalculationStep(2, 'Mass Per Unit Length',
            '$$m = \\rho \\times A$$',
            `m = ${rho} kg/m³ × ${(A*1e6).toFixed(2)} mm²<br>m = ${m.toFixed(3)} kg/m`,
            `Linear Mass Density: <strong>${m.toFixed(3)} kg/m</strong>`
        );

        // Step 3: Determine frequency coefficients based on boundary conditions
        let lambda = [];
        let modeNames = [];
        
        if (system === 'beam-simple' || system === 'shaft-simple') {
            lambda = [Math.PI, 2*Math.PI, 3*Math.PI];
            modeNames = ['Simply Supported', 'Simply Supported', 'Simply Supported'];
        } else if (system === 'beam-cantilever' || system === 'shaft-cantilever') {
            lambda = [1.875, 4.694, 7.855];
            modeNames = ['Cantilever', 'Cantilever', 'Cantilever'];
        } else { // fixed-fixed
            lambda = [4.730, 7.853, 10.996];
            modeNames = ['Fixed-Fixed', 'Fixed-Fixed', 'Fixed-Fixed'];
        }
        
        addCalculationStep(3, 'Frequency Coefficients (λ)',
            'Based on boundary conditions',
            `System type: ${system}<br>λ₁ = ${lambda[0].toFixed(3)}<br>λ₂ = ${lambda[1].toFixed(3)}<br>λ₃ = ${lambda[2].toFixed(3)}`,
            `Frequency Coefficients Determined`
        );

        // Step 4: Calculate natural frequencies
        const frequencies = lambda.map(l => (Math.pow(l, 2) / (2 * Math.PI * Math.pow(L, 2))) * Math.sqrt((E * I) / m));
        const f1 = frequencies[0];
        const f2 = frequencies[1];
        const f3 = frequencies[2];
        
        addCalculationStep(4, 'Natural Frequencies Calculation',
            '$$f_n = \\frac{\\lambda_n^2}{2\\pi L^2} \\sqrt{\\frac{EI}{m}}$$',
            `f₁ = ${f1.toFixed(2)} Hz<br>f₂ = ${f2.toFixed(2)} Hz<br>f₃ = ${f3.toFixed(2)} Hz`,
            `<strong>First Natural Frequency: ${f1.toFixed(2)} Hz</strong><br>Second: ${f2.toFixed(2)} Hz | Third: ${f3.toFixed(2)} Hz`
        );

        // Step 5: Effect of concentrated mass (if present)
        let f1_modified = f1;
        if (m_conc > 0) {
            // Dunkerley's approximation
            const f_beam = f1;
            const f_mass_equiv = (1 / (2 * Math.PI)) * Math.sqrt((48 * E * I) / (m_conc * Math.pow(L, 3)));
            f1_modified = 1 / Math.sqrt((1/Math.pow(f_beam, 2)) + (1/Math.pow(f_mass_equiv, 2)));
            
            addCalculationStep(5, 'Effect of Concentrated Mass (Dunkerley)',
                '$$\\frac{1}{f_{total}^2} = \\frac{1}{f_{beam}^2} + \\frac{1}{f_{mass}^2}$$',
                `Concentrated mass = ${m_conc} kg<br>f_beam = ${f_beam.toFixed(2)} Hz<br>f_modified = ${f1_modified.toFixed(2)} Hz<br>Reduction: ${((1 - f1_modified/f_beam)*100).toFixed(1)}%`,
                `<strong>Modified First Frequency: ${f1_modified.toFixed(2)} Hz</strong>`
            );
        } else {
            addCalculationStep(5, 'Effect of Concentrated Mass',
                'No concentrated mass',
                'Using beam natural frequency as calculated',
                `First Frequency: <strong>${f1_modified.toFixed(2)} Hz</strong>`
            );
        }

        // Step 6: Critical speeds for rotating machinery
        if (system.startsWith('shaft')) {
            const n1_critical = f1_modified * 60; // Convert Hz to RPM
            const n2_critical = f2 * 60;
            const n3_critical = f3 * 60;
            
            addCalculationStep(6, 'Critical Speeds (Rotating Machinery)',
                '$$N_{critical} = f_n \\times 60 \\ \\text{(RPM)}$$',
                `N₁_critical = ${n1_critical.toFixed(0)} RPM<br>N₂_critical = ${n2_critical.toFixed(0)} RPM<br>N₃_critical = ${n3_critical.toFixed(0)} RPM`,
                `<strong>First Critical Speed: ${n1_critical.toFixed(0)} RPM</strong><br>Second: ${n2_critical.toFixed(0)} RPM | Third: ${n3_critical.toFixed(0)} RPM`
            );
            
            // Step 7: Operating speed check
            if (omega_op > 0) {
                const separation1 = Math.abs((omega_op - n1_critical) / n1_critical);
                const is_safe1 = separation1 >= margin;
                const ratio1 = omega_op / n1_critical;
                
                addCalculationStep(7, 'Operating Speed Separation Check',
                    '$$\\text{Separation} = \\frac{|N_{op} - N_{crit}|}{N_{crit}}$$',
                    `Operating speed = ${omega_op} RPM<br>First critical = ${n1_critical.toFixed(0)} RPM<br>Separation = ${(separation1*100).toFixed(1)}%<br>Speed ratio = ${ratio1.toFixed(3)}<br>Required margin = ${(margin*100)}%`,
                    `Separation Status: <strong style="color: ${is_safe1 ? '#10B981' : '#EF4444'}">${is_safe1 ? 'ADEQUATE ✓' : 'INSUFFICIENT ✗'}</strong>`
                );
            }
        }

        // Render MathJax
        if (window.MathJax) {
            window.MathJax.typesetPromise([calculationStepsDiv]);
        }

        // Draw mode shapes
        drawModeShapes(system, lambda);

        // Vibration assessment
        performVibrationAssessment(system, f1_modified, f2, f3, omega_op, margin, zeta);

        // Recommendations
        generateRecommendations(system, f1_modified, omega_op, margin, L, d, std);

        // Show results
        resultContainer.classList.add('show');
        setTimeout(() => resultContainer.scrollIntoView({ behavior: 'smooth', block: 'start' }), 300);
    }

    function addCalculationStep(step, title, formula, calculation, result) {
        const stepDiv = document.createElement('div');
        stepDiv.className = 'calculation-step-container';
        
        let content = `<div class="step-header">Step ${step}: ${title}</div>
                       <div class="step-content">`;
        if (formula) content += `<p class="formula">${formula}</p>`;
        if (calculation) content += `<p class="calculation">${calculation}</p>`;
        if (result) content += `<p class="final-result">${result}</p>`;
        content += `</div>`;
        
        stepDiv.innerHTML = content;
        calculationStepsDiv.appendChild(stepDiv);
    }

    function drawModeShapes(system, lambda) {
        const width = canvas.width / (window.devicePixelRatio || 1);
        const height = canvas.height / (window.devicePixelRatio || 1);
        
        ctx.clearRect(0, 0, width, height);
        
        const marginX = 60;
        const marginY = 40;
        const beamLength = width - 2 * marginX;
        const centerY = height / 2;
        const amplitude = 60;
        const modes = 3;
        const modeSpacing = (height - 2 * marginY) / modes;
        
        // Draw three mode shapes
        const colors = ['#EF4444', '#2563EB', '#10B981'];
        const modeLabels = ['Mode 1', 'Mode 2', 'Mode 3'];
        
        for (let mode = 0; mode < modes; mode++) {
            const yOffset = marginY + mode * modeSpacing + modeSpacing / 2;
            const lambda_n = lambda[mode];
            
            // Draw reference line
            ctx.strokeStyle = '#94A3B8';
            ctx.lineWidth = 1;
            ctx.setLineDash([5, 5]);
            ctx.beginPath();
            ctx.moveTo(marginX, yOffset);
            ctx.lineTo(marginX + beamLength, yOffset);
            ctx.stroke();
            ctx.setLineDash([]);
            
            // Draw mode shape
            ctx.strokeStyle = colors[mode];
            ctx.lineWidth = 3;
            ctx.beginPath();
            
            const points = 100;
            for (let i = 0; i <= points; i++) {
                const x = marginX + (i / points) * beamLength;
                const xi = i / points;
                let y;
                
                if (system.includes('cantilever')) {
                    // Cantilever mode shape
                    y = yOffset - amplitude * (Math.cosh(lambda_n * xi) - Math.cos(lambda_n * xi) - 
                        (Math.cosh(lambda_n) - Math.cos(lambda_n)) / (Math.sinh(lambda_n) - Math.sin(lambda_n)) * 
                        (Math.sinh(lambda_n * xi) - Math.sin(lambda_n * xi)));
                } else if (system.includes('simple')) {
                    // Simply supported mode shape
                    y = yOffset - amplitude * Math.sin((mode + 1) * Math.PI * xi);
                } else {
                    // Fixed-fixed mode shape
                    y = yOffset - amplitude * (Math.cosh(lambda_n * xi) - Math.cos(lambda_n * xi) - 
                        (Math.cosh(lambda_n) + Math.cos(lambda_n)) / (Math.sinh(lambda_n) + Math.sin(lambda_n)) * 
                        (Math.sinh(lambda_n * xi) - Math.sin(lambda_n * xi)));
                }
                
                if (i === 0) ctx.moveTo(x, y);
                else ctx.lineTo(x, y);
            }
            ctx.stroke();
            
            // Draw support symbols
            ctx.fillStyle = '#111827';
            ctx.font = 'bold 12px Inter';
            if (system.includes('cantilever')) {
                // Fixed support at left
                ctx.fillRect(marginX - 5, yOffset - 40, 5, 80);
            } else if (system.includes('simple')) {
                // Pin supports
                ctx.beginPath();
                ctx.arc(marginX, yOffset, 6, 0, 2 * Math.PI);
                ctx.fill();
                ctx.beginPath();
                ctx.arc(marginX + beamLength, yOffset, 6, 0, 2 * Math.PI);
                ctx.fill();
            } else {
                // Fixed supports
                ctx.fillRect(marginX - 5, yOffset - 40, 5, 80);
                ctx.fillRect(marginX + beamLength, yOffset - 40, 5, 80);
            }
            
            // Label
            ctx.fillStyle = colors[mode];
            ctx.fillText(modeLabels[mode], 10, yOffset + 5);
        }
    }

    function performVibrationAssessment(system, f1, f2, f3, omega_op, margin, zeta) {
        let html = '';
        
        // Frequency summary
        html += `
            <div class="vibration-item info">
                <h5><i class="fas fa-wave-square"></i> Natural Frequency Summary</h5>
                <p>The system exhibits three calculated natural frequencies:<br>
                <strong>First Mode:</strong> ${f1.toFixed(2)} Hz (${(f1*60).toFixed(0)} RPM) - Primary concern for resonance<br>
                <strong>Second Mode:</strong> ${f2.toFixed(2)} Hz (${(f2*60).toFixed(0)} RPM) - Secondary mode with nodal point(s)<br>
                <strong>Third Mode:</strong> ${f3.toFixed(2)} Hz (${(f3*60).toFixed(0)} RPM) - Higher order mode with multiple nodes</p>
            </div>
        `;
        
        // Rotating machinery assessment
        if (system.startsWith('shaft') && omega_op > 0) {
            const n1_critical = f1 * 60;
            const separation = Math.abs((omega_op - n1_critical) / n1_critical);
            const is_safe = separation >= margin;
            
            if (is_safe) {
                if (omega_op < n1_critical * 0.75) {
                    html += `
                        <div class="vibration-item info">
                            <h5><i class="fas fa-check-circle"></i> Subcritical Operation - Safe</h5>
                            <p>Operating speed (${omega_op} RPM) is ${(separation*100).toFixed(1)}% below first critical speed (${n1_critical.toFixed(0)} RPM). 
                            This is SUBCRITICAL operation - the shaft operates below its first critical speed, which is inherently safer. 
                            Ensure smooth startup through lower speed ranges. Damping ratio of ${(zeta*100).toFixed(1)}% provides adequate vibration control.</p>
                        </div>
                    `;
                } else {
                    html += `
                        <div class="vibration-item info">
                            <h5><i class="fas fa-check-circle"></i> Supercritical Operation - Separation Adequate</h5>
                            <p>Operating speed (${omega_op} RPM) is ${(separation*100).toFixed(1)}% above first critical speed (${n1_critical.toFixed(0)} RPM). 
                            This is SUPERCRITICAL operation - the shaft passes through its critical speed during startup. 
                            Separation margin of ${(margin*100)}% is met. Ensure: (1) Rapid acceleration through critical speed region (< 30 seconds), 
                            (2) Precise rotor balancing per ISO 1940 (quality grade G2.5 or better), (3) Bearing damping is adequate.</p>
                        </div>
                    `;
                }
            } else {
                html += `
                    <div class="vibration-item critical">
                        <h5><i class="fas fa-exclamation-triangle"></i> Resonance Risk - Insufficient Separation</h5>
                        <p>CRITICAL: Operating speed (${omega_op} RPM) has only ${(separation*100).toFixed(1)}% separation from first critical speed (${n1_critical.toFixed(0)} RPM). 
                        Required margin is ${(margin*100)}%. At resonance, vibration amplitudes will be magnified by factor Q = 1/(2ζ) ≈ ${(1/(2*zeta)).toFixed(0)}×, 
                        causing excessive deflection, bearing wear, and potential failure. <strong>IMMEDIATE ACTION REQUIRED:</strong> 
                        (1) Change operating speed to ${(n1_critical * (1 + margin)).toFixed(0)} RPM or ${(n1_critical * (1 - margin)).toFixed(0)} RPM, 
                        (2) Increase shaft diameter by ${(Math.pow(1 + margin*2, 0.25) * 100 - 100).toFixed(0)}%, or 
                        (3) Shorten bearing span by ${((1 - Math.sqrt(1/(1 + margin*2))) * 100).toFixed(0)}%.</p>
                    </div>
                `;
            }
        }
        
        // Structural vibration assessment
        if (!system.startsWith('shaft')) {
            if (f1 < 3) {
                html += `
                    <div class="vibration-item warning">
                        <h5><i class="fas fa-exclamation-circle"></i> Low Natural Frequency - Human Comfort Concern</h5>
                        <p>First natural frequency (${f1.toFixed(2)} Hz) is below 3 Hz. Per ISO 2631, frequencies below 3 Hz can cause discomfort, nausea, 
                        and seasickness in humans. For floors and walkways, this may violate building codes for vibration serviceability. 
                        Consider: (1) Increasing stiffness through deeper sections or additional supports, 
                        (2) Limiting dynamic loads such as dancing, rhythmic activities, or machinery, 
                        (3) Adding tuned mass dampers if stiffness cannot be increased.</p>
                    </div>
                `;
            } else if (f1 < 8) {
                html += `
                    <div class="vibration-item info">
                        <h5><i class="fas fa-info-circle"></i> Moderate Frequency - Monitor Excitation Sources</h5>
                        <p>First natural frequency (${f1.toFixed(2)} Hz) is in the range where walking excitation (1.8-2.2 Hz) and its harmonics can coincide. 
                        For residential or office floors, ensure walking-induced vibrations remain below perception threshold. 
                        For industrial structures, verify that machinery operating frequencies (including harmonics) do not match natural frequencies. 
                        Current damping of ${(zeta*100).toFixed(1)}% helps control resonant response.</p>
                    </div>
                `;
            } else {
                html += `
                    <div class="vibration-item info">
                        <h5><i class="fas fa-check-circle"></i> High Natural Frequency - Good Design</h5>
                        <p>First natural frequency (${f1.toFixed(2)} Hz) is well above typical excitation frequencies. 
                        This indicates a stiff structure with low susceptibility to resonance from machinery, wind, or human activities. 
                        Maintain adequate clearance from equipment operating frequencies and their harmonics. 
                        Monitor for fatigue if subjected to high-cycle dynamic loads.</p>
                    </div>
                `;
            }
        }
        
        // Damping assessment
        if (zeta < 0.005) {
            html += `
                <div class="vibration-item warning">
                    <h5><i class="fas fa-exclamation-triangle"></i> Very Low Damping</h5>
                    <p>Damping ratio of ${(zeta*100).toFixed(2)}% is very low. At resonance, amplification factor will be approximately ${(1/(2*zeta)).toFixed(0)}×, 
                    resulting in large vibration amplitudes and slow decay. Consider adding damping through: 
                    (1) Viscous dampers or shock absorbers, (2) Friction elements at joints, (3) Viscoelastic materials, or (4) Tuned mass dampers.</p>
                </div>
            `;
        }
        
        vibrationAnalysisDiv.innerHTML = html;
    }

    function generateRecommendations(system, f1, omega_op, margin, L, d, std) {
        let html = '<ul>';
        
        if (std === 'iso') {
            html += `<li><strong>ISO 10816 Compliance:</strong> This standard specifies vibration limits for machine evaluation. 
                     For Group 1 machines (small machines < 15 kW), velocity limits are typically 0.71-2.8 mm/s RMS. 
                     Group 2 (medium machines 15-75 kW on rigid foundations) allows 1.8-4.5 mm/s RMS. 
                     Ensure measured vibrations during operation remain within Zone A (good) or Zone B (acceptable) per ISO 10816-3 Table 1.</li>`;
        } else if (std === 'api') {
            html += `<li><strong>API 684 Rotordynamic Requirements:</strong> API 684 Tutorial provides comprehensive guidance on critical speed analysis. 
                     First critical speed must have separation margin of ±15-20% from maximum continuous speed. 
                     For flexible shafts operating above first critical, lateral analysis showing stability and acceptable unbalance response is required. 
                     Campbell diagrams must demonstrate that no critical speeds coincide with excitation frequencies across operating range.</li>`;
        } else if (std === 'vdi') {
            html += `<li><strong>VDI 2056 Evaluation:</strong> VDI 2056 provides evaluation criteria based on velocity and displacement limits. 
                     For elastic structures, acceptable vibration velocity is typically < 10 mm/s peak for concrete foundations, 
                     < 20 mm/s for steel structures. Displacement limits depend on frequency: at low frequencies (< 10 Hz), 
                     displacement becomes more critical than velocity for evaluating potential damage and resonance effects.</li>`;
        }
        
        html += `<li><strong>Natural Frequency Result: ${f1.toFixed(2)} Hz</strong> - First natural frequency is the most critical for resonance avoidance. 
                 If operating near this frequency, consider: (1) Modifying design to shift frequency by ±20%, 
                 (2) Installing vibration isolation with natural frequency < 0.3 × operating frequency, 
                 (3) Implementing condition monitoring with accelerometers at critical locations, or (4) Adding supplemental damping devices.</li>`;
        
        if (system.startsWith('shaft')) {
            const n_crit = f1 * 60;
            html += `<li><strong>Critical Speed: ${n_crit.toFixed(0)} RPM</strong> - For rotating machinery, this is the speed where resonance occurs. 
                     If operating speed is within ±20% of critical, redesign is recommended. Options: 
                     (1) Increase shaft diameter to raise critical speed: new diameter = ${(d*1000 * Math.pow(1.5, 0.25)).toFixed(1)} mm raises critical by ~50%, 
                     (2) Reduce bearing span to ${(L * 0.7).toFixed(2)} m raises critical by ~40%, 
                     (3) Add midspan support to create two shorter spans, or (4) Use flexible couplings to reduce transmitted vibration.</li>`;
            
            if (omega_op > 0) {
                html += `<li><strong>Operating Speed: ${omega_op} RPM</strong> - Ensure precision balancing per ISO 1940. 
                         For pumps and fans: quality grade G6.3, General machinery: G2.5, Precision machinery: G1.0 or better. 
                         Balancing quality G = (e × ω), where e is eccentricity and ω is angular velocity. 
                         For ${omega_op} RPM and G2.5, maximum eccentricity = ${((2.5 * 60) / (2 * Math.PI * omega_op) * 1000).toFixed(2)} mm. 
                         Monitor vibration during commissioning - if levels exceed ISO limits, perform field balancing.</li>`;
            }
        } else {
            html += `<li><strong>Structural Design Considerations:</strong> For structures with natural frequency < 5 Hz, 
                     dynamic amplification factors must be considered for transient loads. 
                     Floor vibrations from machinery should be isolated using spring or elastomeric mounts with natural frequency 
                     < 0.5 × machine operating frequency. For cantilever structures, reducing overhang length by 20% increases frequency by ~45%. 
                     Fixed supports must be verified for true fixity - even 10% reduction in actual fixity can lower natural frequency by 15-20%.</li>`;
        }
        
        html += `<li><strong>Measurement and Monitoring:</strong> Install permanent or periodic vibration monitoring at critical locations. 
                 For rotating machinery: radial vibration at bearings using proximity probes or accelerometers. 
                 For structures: three-axis accelerometers at points of maximum deflection. 
                 Trending data using FFT (Fast Fourier Transform) analysis reveals frequency components and enables predictive maintenance. 
                 Sudden increases in vibration at natural frequencies indicate developing problems like looseness, misalignment, or foundation issues.</li>`;
        
        html += `<li><strong>Damping Enhancement Strategies:</strong> Current damping ratio of ${(dampingRatio.value)}% may be insufficient for resonant conditions. 
                 Methods to increase damping: (1) Tuned mass dampers (TMD) tuned to natural frequency can achieve 5-10× vibration reduction, 
                 (2) Viscous dampers or dashpots at high-velocity locations, (3) Friction dampers at joints and connections, 
                 (4) Viscoelastic materials in sandwich construction, (5) For rotating machinery, squeeze film dampers in bearings provide excellent damping. 
                 Target damping ratio: 2-5% for acceptable resonant response.</li>`;
        
        html += `<li><strong>Design Modifications for Frequency Shifting:</strong> If natural frequency is too close to excitation frequency, 
                 systematic modifications can shift frequency away from problematic range. Increasing stiffness (E×I) by 40% raises frequency by ~18%. 
                 Reducing mass by 25% raises frequency by ~15%. For shafts: increasing diameter from ${(d*1000).toFixed(0)} mm to ${(d*1000*1.2).toFixed(0)} mm 
                 raises critical speed by ~38%. For beams: reducing span by 20% raises natural frequency by ~56%. 
                 Use finite element analysis (FEA) modal analysis for complex geometries to optimize modifications before implementation.</li>`;
        
        html += `<li><strong>Installation and Commissioning Best Practices:</strong> During installation, verify: 
                 (1) Alignment within tolerance (typically < 0.05 mm for precision machinery), 
                 (2) Soft foot conditions corrected (< 0.05 mm), (3) Foundation bolt torque per manufacturer specifications, 
                 (4) Grout properly cured and level. During commissioning, perform bump test or coast-down test to verify natural frequencies match predictions within ±10%. 
                 Record baseline vibration signature (FFT spectrum) for future condition monitoring comparisons. 
                 For supercritical operation, verify smooth passage through critical speed with peak amplitudes < 2× normal running values.</li>`;
        
        html += '</ul>';
        recommendationsDiv.innerHTML = html;
    }

    function displayMessage(message, type = "info") {
        const messageBox = document.getElementById('custom-message-box');
        messageBox.textContent = message;
        messageBox.style.color = 'white';
        if (type === "error") messageBox.style.backgroundColor = '#dc3545';
        else if (type === "warning") {
            messageBox.style.backgroundColor = '#ffc107';
            messageBox.style.color = '#333';
        } else messageBox.style.backgroundColor = '#28a745';
        messageBox.style.opacity = 1;
        setTimeout(() => { messageBox.style.opacity = 0; }, 5000);
    }

    exportReportBtn.addEventListener('click', function() {
        displayMessage("Export feature would generate detailed vibration analysis PDF in full implementation", "success");
    });
    
    console.log('Vibration analysis calculator initialized successfully');
});

// Theme Toggle
document.addEventListener('DOMContentLoaded', () => {
    const themeSwitch = document.getElementById('theme-switch');
    const body = document.body;
    const currentTheme = localStorage.getItem('theme');
    if (currentTheme) {
        body.classList.add(currentTheme);
        if (currentTheme === 'dark-mode') themeSwitch.checked = true;
    }
    themeSwitch.addEventListener('change', () => {
        if (themeSwitch.checked) {
            body.classList.add('dark-mode');
            localStorage.setItem('theme', 'dark-mode');
        } else {
            body.classList.remove('dark-mode');
            localStorage.setItem('theme', 'light-mode');
        }
    });
});
</script>

</body>
</html>
