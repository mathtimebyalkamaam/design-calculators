<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Industrial Spring Design Calculator (Helical Compression) - Pro Edition</title>
<meta name="description" content="A professional, industrial-grade calculator for designing helical compression springs, featuring detailed stress analysis, buckling checks, and fatigue safety factors.">
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5936527763614780" crossorigin="anonymous"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-23Y1V450SR"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-23Y1V450SR');
</script>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Montserrat:wght@700;800;900&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script>
MathJax = {
tex: {inlineMath: [['$', '$'], ['\\(', '\\)']]},
svg: {fontCache: 'global'}
};
</script>

<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="icon" href="/favicon.ico" type="image/x-icon">
<style>
/* Base Styles */
:root {
--primary-color: #1E3A8A;
--secondary-color: #2563EB;
--accent-color: #F59E0B;
--bg-color: #F8FAFC;
--card-bg: #FFFFFF;
--text-color: #4B5563;
--heading-color: #111827;
--footer-bg: #0F172A;
--border-color: #E2E8F0;
--gradient-primary: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
--gradient-dark: linear-gradient(135deg, #0F172A, #1E293B);
--card-shadow: 0 10px 25px rgba(0, 0, 0, 0.1), 0 5px 10px rgba(0, 0, 0, 0.04);
--hover-color: #eef2ff;
--button-hover-shadow: 0 7px 20px rgba(37, 99, 235, 0.4);
--highlight-bg: rgba(245, 158, 11, 0.15);
--success-color: #10B981;
--fail-color: #EF4444;
--warning-color: #F59E0B;
}

body.dark-mode {
--primary-color: #10B981;
--secondary-color: #34D399;
--bg-color: #0F172A;
--card-bg: #1E293B;
--text-color: #CBD5E1;
--heading-color: #F1F5F9;
--footer-bg: #020617;
--border-color: #334155;
--highlight-bg: rgba(16, 185, 129, 0.2);
--hover-color: #334155;
--button-hover-shadow: 0 7px 20px rgba(16, 185, 129, 0.3);
}

html { scroll-behavior: smooth; }

body {
font-family: 'Inter', sans-serif;
background-color: var(--bg-color);
color: var(--text-color);
line-height: 1.8;
transition: background-color 0.3s, color 0.3s;
overflow-x: hidden;
margin: 0;
padding: 0;
}

.container { max-width: 1280px; margin: 0 auto; padding: 0 24px; }
.content-container { max-width: 1100px; margin: 0 auto; padding: 20px; }

/* New Header Styles from Reynolds File */
.header {
background: var(--gradient-primary);
color: white;
padding: 24px 0;
box-shadow: 0 2px 10px rgba(0,0,0,0.1);
}

.navbar {
display: flex;
justify-content: space-between;
align-items: center;
}

.logo-container {
display: flex;
align-items: center;
gap: 16px;
text-decoration: none;
color: white;
}

.logo-text {
font-size: 1.75rem;
font-weight: 800;
font-family: 'Montserrat', sans-serif;
}

.nav-links {
display: flex;
gap: 24px;
list-style: none;
margin: 0;
padding: 0;
}

.nav-links a {
color: white;
text-decoration: none;
font-weight: 500;
transition: all 0.3s;
}

.nav-links a:hover {
color: var(--accent-color);
transform: translateY(-2px);
}

.theme-toggle {
display: flex;
align-items: center;
gap: 12px;
}

.theme-toggle .icon {
color: white;
font-size: 1.2rem;
}

.switch {
position: relative;
display: inline-block;
width: 56px;
height: 30px;
}

.switch input { opacity: 0; width: 0; height: 0; }

.slider {
position: absolute;
cursor: pointer;
top: 0;
left: 0;
right: 0;
bottom: 0;
background-color: rgba(0,0,0,0.2);
transition: .4s;
border-radius: 30px;
}

.slider:before {
position: absolute;
content: "";
height: 22px;
width: 22px;
left: 4px;
bottom: 4px;
background-color: white;
transition: .4s;
border-radius: 50%;
}

input:checked + .slider { background-color: var(--accent-color); }
input:checked + .slider:before { transform: translateX(26px); }
/* End of New Header Styles */

main { padding: 40px 0; }

.tool-container {
background-color: var(--card-bg);
border-radius: 12px;
padding: 30px;
box-shadow: var(--card-shadow);
margin-bottom: 30px;
}

.tool-container h2 {
color: var(--primary-color);
border-bottom: 3px solid var(--primary-color);
padding-bottom: 15px;
margin-top: 0;
margin-bottom: 25px;
font-family: 'Montserrat', sans-serif;
font-size: 1.8rem; /* Added for consistency */
}

/* Added styles for new content */
.tool-container h3 {
color: var(--primary-color);
margin-top: 25px;
font-family: 'Montserrat', sans-serif;
}
.tool-container p {
margin-bottom: 15px;
}
.tool-container ul {
padding-left: 20px;
margin-bottom: 15px;
}
.tool-container li {
margin-bottom: 10px;
}
.tool-container h4 {
color: var(--secondary-color);
margin-top: 20px;
font-family: 'Montserrat', sans-serif;
}
/* End of added styles */


.intro-section {
background-color: var(--hover-color);
border-radius: 8px;
padding: 25px;
margin-bottom: 30px;
border-left: 5px solid var(--primary-color);
}

.intro-section h3 { margin-top: 0; color: var(--primary-color); font-family: 'Montserrat', sans-serif; }
.intro-section p { color: var(--text-color); }

.back-button {
display: inline-block;
background-color: var(--primary-color);
color: white;
padding: 12px 20px;
border-radius: 8px; /* Rounded corners */
text-decoration: none;
margin-bottom: 25px;
transition: background-color 0.3s, transform 0.2s;
font-weight: 600;
}

.back-button:hover { background-color: var(--secondary-color); transform: translateY(-2px); }

.calculator-form {
background-color: var(--card-bg);
border-radius: 8px;
padding: 25px;
margin-top: 25px;
box-shadow: 0 4px 15px rgba(0,0,0,0.05);
}

.form-section-header {
font-size: 1.2rem;
font-weight: 700;
color: var(--primary-color);
margin-top: 25px;
margin-bottom: 15px;
padding-bottom: 8px;
border-bottom: 2px solid var(--border-color);
}

.form-group { margin-bottom: 20px; }

.form-group label {
display: flex;
align-items: center;
margin-bottom: 8px;
font-weight: 600;
color: var(--heading-color);
}

.form-group input, .form-group select {
width: 100%;
padding: 12px;
border: 1px solid var(--border-color);
border-radius: 5px;
background-color: var(--bg-color);
color: var(--text-color);
box-sizing: border-box;
transition: border-color 0.3s, box-shadow 0.3s;
font-size: 1rem;
}

.form-group input:focus, .form-group select:focus {
border-color: var(--primary-color);
box-shadow: 0 0 8px rgba(30, 58, 138, 0.3);
outline: none;
}

.form-row {
display: grid;
grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
gap: 20px;
}

.calculate-btn {
background: var(--gradient-primary);
color: white;
border: none;
padding: 15px 25px;
border-radius: 8px;
cursor: pointer;
font-size: 1.2rem;
font-weight: 700;
font-family: 'Montserrat', sans-serif;
margin-top: 25px;
transition: transform 0.2s, box-shadow 0.3s;
position: relative;
overflow: hidden;
width: 100%;
}

.calculate-btn:hover {
transform: translateY(-3px);
box-shadow: var(--button-hover-shadow);
}

.calculate-btn .ripple {
position: absolute;
border-radius: 50%;
background-color: rgba(255, 255, 255, 0.7);
animation: ripple-effect 0.6s linear forwards;
transform: scale(0);
pointer-events: none;
}

@keyframes ripple-effect { to { transform: scale(4); opacity: 0; } }

.result-container {
margin-top: 40px;
padding: 25px;
border-radius: 12px;
background-color: var(--card-bg);
box-shadow: var(--card-shadow);
display: none;
opacity: 0;
transform: translateY(30px);
transition: opacity 0.6s ease-out, transform 0.6s ease-out;
}

.result-container.show { display: block; opacity: 1; transform: translateY(0); }
.result-container h3 {
color: var(--primary-color);
margin-bottom: 25px;
font-family: 'Montserrat', sans-serif;
font-size: 1.8rem;
text-align: center;
}

.calculation-step-container {
margin-bottom: 20px;
border: 1px solid var(--border-color);
border-radius: 8px;
overflow: hidden;
opacity: 0;
animation: fadeInSlideUp 0.5s ease-out forwards;
transition: box-shadow 0.3s;
}

.calculation-step-container:hover { box-shadow: 0 5px 15px rgba(0,0,0,0.08); }

.step-header {
background-color: var(--hover-color);
padding: 15px 20px;
font-weight: 700;
font-size: 1.1rem;
color: var(--heading-color);
border-bottom: 1px solid var(--border-color);
display: flex;
justify-content: space-between;
align-items: center;
}

.step-content {
padding: 20px;
display: block;
border-top: 1px solid var(--border-color);
}

.step-content p.formula {
font-family: 'Times New Roman', serif;
font-style: italic;
font-size: 1.1em;
text-align: center;
padding: 12px;
background-color: var(--bg-color);
border: 1px solid var(--border-color);
border-radius: 4px;
margin: 15px 0;
overflow-x: auto;
color: var(--text-color);
}

.step-content p.calculation {
font-family: 'Courier New', monospace;
background-color: var(--bg-color);
padding: 10px 15px;
border-radius: 3px;
margin-bottom: 10px;
color: var(--text-color);
word-wrap: break-word;
border-left: 3px solid var(--secondary-color);
}

.step-content .final-result {
font-weight: 700;
color: var(--primary-color);
background: var(--highlight-bg);
padding: 12px;
border-radius: 4px;
text-align: center;
margin-top: 15px;
font-size: 1.1rem;
}

.final-verdict {
padding: 20px;
border-radius: 8px;
text-align: center;
font-size: 1.5rem;
font-weight: 700;
font-family: 'Montserrat', sans-serif;
margin-top: 20px;
}

.final-verdict.safe { background-color: var(--success-color); color: white; }
.final-verdict.fail { background-color: var(--fail-color); color: white; }
.final-verdict.warning { background-color: var(--warning-color); color: white; }

.recommendations {
margin-top: 30px;
padding: 20px;
border: 2px solid var(--border-color);
border-radius: 8px;
background-color: var(--bg-color);
}

.recommendations h4 { color: var(--secondary-color); margin-top: 0; font-family: 'Montserrat', sans-serif; }
.recommendations ul { padding-left: 20px; }
.recommendations ul li { margin-bottom: 10px; }

.info-icon {
color: var(--secondary-color);
margin-left: 8px;
cursor: help;
font-size: 0.9em;
}

.tooltip { position: relative; display: inline-block; }

.tooltip .tooltiptext {
visibility: hidden;
width: 280px;
background-color: #333;
color: #fff;
text-align: center;
border-radius: 6px;
padding: 10px;
position: absolute;
z-index: 10;
bottom: 135%;
left: 50%;
margin-left: -140px;
opacity: 0;
transition: opacity 0.3s;
font-weight: normal;
font-size: 0.9rem;
}

.tooltip:hover .tooltiptext { visibility: visible; opacity: 1; }

#custom-message-box {
position: fixed;
top: 20px;
left: 50%;
transform: translateX(-50%);
padding: 15px 25px;
border-radius: 8px;
box-shadow: 0 4px 10px rgba(0,0,0,0.2);
z-index: 1000;
font-weight: bold;
color: white;
opacity: 0;
visibility: hidden;
transition: opacity 0.5s ease-in-out, visibility 0.5s;
}

#custom-message-box.show { opacity: 1; visibility: visible; }

.summary-table {
width: 100%;
margin: 20px 0;
border-collapse: collapse;
}

.summary-table th, .summary-table td {
padding: 12px;
text-align: left;
border: 1px solid var(--border-color);
}

.summary-table th {
background-color: var(--hover-color);
font-weight: 600;
color: var(--heading-color);
}

.summary-table td { background-color: var(--bg-color); }

.pass-indicator {
display: inline-block;
padding: 4px 12px;
border-radius: 4px;
font-weight: 600;
font-size: 0.9rem;
}

.pass-indicator.pass { background-color: var(--success-color); color: white; }
.pass-indicator.fail { background-color: var(--fail-color); color: white; }
.pass-indicator.warning { background-color: var(--warning-color); color: white; }

@keyframes fadeInSlideUp {
from { opacity: 0; transform: translateY(20px); }
to { opacity: 1; transform: translateY(0); }
}

/* New Footer Styles from Reynolds File */
footer {
background: var(--gradient-dark);
color: #CBD5E1;
padding: 50px 0 20px 0;
}

.footer-content {
display: flex;
justify-content: space-between;
flex-wrap: wrap;
gap: 40px;
margin-bottom: 30px;
}

.footer-col {
flex: 1;
min-width: 200px;
}

.footer-col h4 {
color: white;
margin-bottom: 15px;
font-weight: 700;
}

.footer-col ul {
list-style: none;
padding: 0;
margin: 0;
}

.footer-col ul li {
margin-bottom: 10px;
}

.footer-col a {
color: #CBD5E1;
text-decoration: none;
transition: all 0.3s;
}

.footer-col a:hover {
color: var(--accent-color);
transform: translateX(3px);
}

.footer-disclaimer {
text-align: center;
margin: 30px auto;
padding-top: 25px;
border-top: 1px solid #334155;
max-width: 800px;
font-size: 0.9rem;
line-height: 1.6;
}

.footer-bottom {
text-align: center;
padding-top: 20px;
font-size: 0.9rem;
color: #94A3B8;
}

.creator-name {
color: var(--secondary-color);
font-weight: bold;
}

.social-buttons {
display: flex;
gap: 12px;
margin-top: 15px;
}

.social-btn {
width: 40px;
height: 40px;
display: flex;
justify-content: center;
align-items: center;
color: white;
border-radius: 50%;
text-decoration: none;
transition: all 0.3s;
box-shadow: 0 4px 8px rgba(0,0,0,0.2);
}

.social-btn:hover {
transform: translateY(-4px) scale(1.1);
box-shadow: 0 8px 16px rgba(0,0,0,0.3);
}

.social-btn.linkedin { background-color: #0A66C2; }
.social-btn.youtube { background-color: #FF0000; }
.social-btn.twitter { background-color: #1DA1F2; }
.social-btn.facebook { background-color: #1877F2; }
.social-btn.whatsapp { background-color: #25D366; }
/* End of New Footer Styles */


@media (max-width: 768px) {
.navbar { flex-direction: column; gap: 24px; }
.nav-links { flex-direction: column; gap: 12px; text-align: center; } /* Added from Reynolds */
.form-row { grid-template-columns: 1fr; }
.container, .content-container { padding: 0 15px; } /* Updated */
.tool-container { padding: 20px; }
.tooltip .tooltiptext { width: 200px; margin-left: -100px; }
.footer-content { flex-direction: column; } /* Added from Reynolds */
}
</style>
    <link rel="stylesheet" href="styles.css">
</head>
<body>

<!-- HEADER (Replaced from Reynolds File) -->
<header class="header">
        <div class="header-bg-animation"></div>
        <div class="container">
            <nav class="navbar">
                <a href="/" class="logo-container">
                    <img src="logo.png" alt="Design Calculators Logo" class="logo">
                    <span class="logo-text">Design Calculators</span>
                </a>

                <div class="nav-menu">
                    <button class="mobile-menu-toggle" aria-label="Toggle menu">
                        <i class="fas fa-bars"></i>
                    </button>

                    <ul class="nav-links">
                        <li><a href="/index.html">Home</a></li>
                        
    <li class="dropdown">
        <a href="/indexele.html" class="dropdown-toggle">Electrical <i class="fas fa-chevron-down" style="font-size: 0.7em; margin-left: 4px;"></i></a>
        <div class="dropdown-menu">
            <div class="repo-grid"><div><a href="/arcflash.html">Arc Flash Calculator</a><a href="/breaker-sizing.html">Breaker Sizing</a><a href="/cable-thermal-rating.html">Cable Ampacity</a><a href="/comm-cable-loss.html">Comm Cable Loss</a><a href="/earth-conductor-size.html">Earth Conductor Size</a><a href="/generatorsizing.html">Generator Sizing</a><a href="/harmonicsanalyser.html">Harmonics Analyser</a><a href="/insulationresistance.html">Insulation Resistance</a><a href="/logicgate.html">Logic Gates Simulator</a><a href="/motor-starting.html">Motor Starting Current</a><a href="/pcbtrace.html">PCB Trace Width</a><a href="/protection-device.html">Protection Device</a><a href="/resistor.html">Resistor Color Code</a><a href="/solarcable.html">Solar Cable Sizing</a><a href="/systemxrcalculator.html">System X/R Ratio</a><a href="/transmissionline.html">Transmission Line</a><a href="/vfd-selection.html">VFD Selection Tool</a></div><div><a href="/batterylife.html">Battery Life Estimator</a><a href="/busbarampacity.html">Busbar Ampacity</a><a href="/cablepulling.html">Cable Pulling Tension</a><a href="/conduit-fill.html">Conduit Fill Calculator</a><a href="/earthingfaultsimulator.html">Earthing Fault Simulator</a><a href="/grounding.html">Grounding System Design</a><a href="/hvac-sizing.html">HVAC Sizing Calculator</a><a href="/lcresonancecalculator.html">LC Resonance Calculator</a><a href="/maintenance-guide.html">Maintenance Guide</a><a href="/nemaipconvertor.html">NEMA to IP Converter</a><a href="/power-factor.html">Power Factor Correction</a><a href="/relay-coordination.html">Relay Coordination</a><a href="/short-circuit.html">Short Circuit Current</a><a href="/solarpvarray.html">Solar PV Array</a><a href="/transformer-calculator.html">Transformer Calculator</a><a href="/unit-converter.html">Unit Converter</a><a href="/voltage-drop.html">Voltage Drop Calculator</a></div><div><a href="/battery-sizing.html">Battery Sizing (AH)</a><a href="/busbarshortcircuit.html">Busbar Short Circuit</a><a href="/cable-sizing.html">Cable Sizing Calculator</a><a href="/ctsaturation.html">CT Saturation</a><a href="/equipment-relay.html">Equipment Relay Setting</a><a href="/harmonic-distortion.html">Harmonic Distortion</a><a href="/industriallighting.html">Industrial Lighting</a><a href="/lighting-calulator.html">Lighting Calculator</a><a href="/motor-efficiency.html">Motor Efficiency</a><a href="/neutral-earth-fault-current.html">Neutral Earth Fault</a><a href="/powertriangletool.html">Power Triangle</a><a href="/electricalresidentialload.html">Residential Load Calc</a><a href="/skindepth.html">Skin Depth Calculator</a><a href="/symmetricalcomponents.html">Symmetrical Components</a><a href="/transformerinrush.html">Transformer Inrush</a><a href="/ups-sizing.html">UPS Sizing</a></div>
            </div>
            <div class="view-all-container">
                <a href="/indexele.html" class="view-all-link">View All Electrical Tools √¢‚Ä†‚Äô</a>
            </div>
        </div>
    </li>
                        
    <li class="dropdown">
        <a href="/indexinst.html" class="dropdown-toggle">Instrumentation <i class="fas fa-chevron-down" style="font-size: 0.7em; margin-left: 4px;"></i></a>
        <div class="dropdown-menu">
            <div class="repo-grid"><div><a href="/adc-resolution.html">ADC Resolution</a><a href="/capillarylengthtemperatureerror.html">Capillary Error</a><a href="/cv-kv-valve.html">Cv/Kv Valve Sizing</a><a href="/dp-level.html">DP Level Measurement</a><a href="/hydrostatic-level.html">Hydrostatic Level</a><a href="/instrument-range.html">Instrument Range</a><a href="/loop-impedance.html">Loop Impedance</a><a href="/orifice-plate.html">Orifice Plate Beta</a><a href="/pid-tuning.html">PID Tuning</a><a href="/profibus.html">Profibus Calculator</a><a href="/tempsensorresponse.html">Response Time (Tau)</a><a href="/rtd-lead-comp.html">RTD Lead Wire Comp.</a><a href="/sealfluidzeroshift.html">Seal Fluid Shift</a><a href="/snr-calculator.html">SNR Calculator</a><a href="/thermocoupleextensioncable.html">TC Extension Cable</a><a href="/thermowellwakefreq.html">Thermowell Frequency</a><a href="/pressuretransmitteroverrange.html">Tx Overrange</a><a href="/valvecavitationcalculator.html">Valve Cavitation</a><a href="/vibrationtransmitter.html">Vibration Tx</a><a href="/zoneclassificationhelper.html">Zone Classification</a></div><div><a href="/baud-rate.html">Baud Rate Calculator</a><a href="/gascompressibility.html">Compressibility (Z)</a><a href="/dbcalculator.html">dB Gain/Loss Calc</a><a href="/flowprofiledistortioncalculator.html">Flow Distortion</a><a href="/impulselinefreezing.html">Impulse Freezing</a><a href="/intrinsic-safety.html">Intrinsic Safety Loop</a><a href="/measurement.html">Measurement Uncertainty</a><a href="/ph-temp-comp.html">pH Temp Compensation</a><a href="/plcscantime.html">PLC Scan Time</a><a href="/pressurereliefvalve.html">PRV Sizing (API 520)</a><a href="/reynoldsnumbercal.html">Reynolds Number</a><a href="/rtdselfheating.html">RTD Self-Heating</a><a href="/signal-scaling.html">Signal Scaling</a><a href="/staticheadcal.html">Static Head</a><a href="/temperaturesensorlag.html">Temp Sensor Lag</a><a href="/thermowell-wake.html">Thermowell Wake</a><a href="/ultrasoniclevel.html">Ultrasonic Level</a><a href="/valve-cv.html">Valve Cv Viewer</a><a href="/wetlegdensitycompensation.html">Wet Leg Compensation</a></div><div><a href="/capacitance-level.html">Capacitance Level</a><a href="/controlvalvenoise.html">Control Valve Noise</a><a href="/dp-flow-conversion.html">DP Flow Conversion</a><a href="/hartdevices.html">HART Devices</a><a href="/impulse-pressure-drop.html">Impulse Pressure Drop</a><a href="/junctionbox.html">Junction Box Sizing</a><a href="/orifice-flow.html">Orifice Flow Calculator</a><a href="/pid-symbol-library.html">PID Symbol Library</a><a href="/power-supply-load.html">Power Supply Load</a><a href="/prvsizing.html">Relief Orifice Area</a><a href="/rtdexcitationcurrentselection.html">RTD Excitation</a><a href="/rtd-tc-conversion.html">RTD/TC Conversion</a><a href="/sil.html">SIL Calculator</a><a href="/steamflow.html">Steam Flow</a><a href="/thermocouplecjccalculator.html">Thermocouple CJC</a><a href="/turndown.html">Turndown Ratio</a><a href="/controlvalveauthority.html">Valve Authority</a><a href="/controlvalveleakage.html">Valve Leakage Class</a><a href="/wirelesshart.html">WirelessHART Range</a></div>
            </div>
            <div class="view-all-container">
                <a href="/indexinst.html" class="view-all-link">View All Instrumentation Tools √¢‚Ä†‚Äô</a>
            </div>
        </div>
    </li>
                        
    <li class="dropdown">
        <a href="/indexmech.html" class="dropdown-toggle">Mechanical <i class="fas fa-chevron-down" style="font-size: 0.7em; margin-left: 4px;"></i></a>
        <div class="dropdown-menu">
            <div class="repo-grid"><div><a href="/aircompressorfad.html">Air Compressor FAD</a><a href="/asme-vessel.html">ASME Vessel Design</a><a href="/belt-pulley.html">Belt & Pulley</a><a href="/bolt-torque.html">Bolt Torque</a><a href="/controlvalveactuator.html">Control Valve Actuator</a><a href="/frictionfactortool.html">Darcy Friction Factor</a><a href="/fatigue.html">Fatigue Analysis</a><a href="/fuel-combustion.html">Fuel Combustion</a><a href="/gas.html">Gas Properties</a><a href="/heat-exchanger.html">Heat Exchanger</a><a href="/hydroliccylinder.html">Hydraulic Cylinder</a><a href="/material-compatibility.html">Material Compatibility</a><a href="/nozzle-reinforcement.html">Nozzle Reinforcement</a><a href="/openchannelflow.html">Open Channel Flow</a><a href="/pipescheduletool.html">Pipe Schedule & Stress</a><a href="/pump-head.html">Pump Head</a><a href="/shaft-power-torque.html">Shaft Power & Torque</a><a href="/steam-table.html">Steam Table</a><a href="/vibrationanalysis.html">Vibration Analysis</a></div><div><a href="/air-flow-duct.html">Air Flow Duct Sizing</a><a href="/beam-deflection.html">Beam Deflection</a><a href="/bernoulli-equation.html">Bernoulli Equation</a><a href="/chiller-capacity.html">Chiller Capacity</a><a href="/cooling-tower-sizing.html">Cooling Tower Sizing</a><a href="/darcy-weisbach.html">Darcy-Weisbach</a><a href="/finned-tube-heat-transfer.html">Finned Tube Heat</a><a href="/furnace-heat-duty.html">Furnace Heat Duty</a><a href="/gear-design.html">Gear Design</a><a href="/heat-loss-pipes.html">Heat Loss Pipes</a><a href="/jacketed-vessel-heat-transfer.html">Jacketed Vessel</a><a href="/metalweight.html">Metal Weight Calculator</a><a href="/nptbspthreadcalculator.html">NPT/BSP Threads</a><a href="/overall-heat-transfer.html">Overall Heat Transfer</a><a href="/pipe-stress-flexibility.html">Pipe Stress</a><a href="/pump-power.html">Pump Power</a><a href="/specific-heat-enthalpy.html">Specific Heat</a><a href="/storage-tank-volume.html">Storage Tank Volume</a><a href="/weldingstress.html">Welding Stress</a></div><div><a href="/allowable-stress-safety-factor.html">Allowable Stress</a><a href="/bearinglife.html">Bearing Life Calculator</a><a href="/boiler-efficiency.html">Boiler Efficiency</a><a href="/compressor-power.html">Compressor Power</a><a href="/corrosion-rate.html">Corrosion Rate</a><a href="/fan-laws.html">Fan Laws</a><a href="/foundation.html">Foundation Design</a><a href="/gas-laws.html">Gas Laws</a><a href="/hardness.html">Hardness Converter</a><a href="/conduction-convection-radiation.html">Heat Transfer Modes</a><a href="/machining.html">Machining Calculator</a><a href="/momentofinertia.html">Moment of Inertia</a><a href="/oring.html">O-Ring Sizing</a><a href="/pipe-flow.html">Pipe Flow Calculator</a><a href="/psychrometric.html">Psychrometric Calc</a><a href="/reynolds-number.html">Reynolds Number</a><a href="/spring.html">Spring Design</a><a href="/thermal-expansion.html">Thermal Expansion</a></div>
            </div>
            <div class="view-all-container">
                <a href="/indexmech.html" class="view-all-link">View All Mechanical Tools √¢‚Ä†‚Äô</a>
            </div>
        </div>
    </li>
                        <li><a href="/index.html#articles">Articles</a></li>
                        <li><a href="/sitemap2.html">Site Map</a></li>
                    </ul>

                    <div class="theme-toggle">
                        <i class="fas fa-sun icon"></i>
                        <label class="switch">
                            <input type="checkbox" id="theme-switch">
                            <span class="slider"></span>
                        </label>
                        <i class="fas fa-moon icon"></i>
                    </div>
                </div>
            </nav>
    </header>

<main class="content-container">
<div class="tool-container">
<h2>üî© Industrial Spring Design Calculator (Helical Compression)</h2>
<div class="intro-section">
<h3>üéØ The Science of Stored Energy</h3>
<p>Helical compression springs are fundamental mechanical components used in countless applications, from ballpoint pens to automotive suspensions. Their function is to store mechanical energy when compressed and release it when the load is removed. Designing a spring is a precise engineering task; it must provide the correct force at specific lengths, endure stress without failing, and fit within the physical constraints of an assembly.</p>
<h3>‚ö° Engineering a Reliable Spring</h3>
<p>A successful spring design balances geometry, material properties, and loading conditions. This professional-grade calculator provides a complete analysis, determining not just the spring rate but also critical safety parameters. It calculates shear stress using the <strong>Wahl Correction Factor</strong> for accuracy, checks for the possibility of buckling in long springs, evaluates fatigue life using the <strong>Modified Goodman Criterion</strong>, and includes <strong>set removal</strong> considerations for real-world performance.</p>
</div>

<div class="calculator-form">
<form id="spring-form">
<!-- Form content remains identical -->
<div class="form-section-header">üìê Material & Geometry</div>
<div class="form-row">
<div class="form-group">
<label for="material-type">Spring Material</label>
<select id="material-type" required>
<option value="A228" selected>Music Wire (ASTM A228) - Premium Quality</option>
<option value="A227">Hard Drawn Wire (ASTM A227) - General Purpose</option>
<option value="A229">Oil Tempered Wire (ASTM A229) - High Stress</option>
<option value="A231">Chrome Vanadium (ASTM A231) - High Temp</option>
<option value="A313">Stainless Steel 302 (ASTM A313) - Corrosion Resistant</option>
<option value="A313-316">Stainless Steel 316 (ASTM A313) - Marine Grade</option>
<option value="Inconel">Inconel X-750 - Extreme Temperature</option>
<option value="Phosphor">Phosphor Bronze - Electrical Applications</option>
</select>
</div>
<div class="form-group">
<label for="wire-diameter">Wire Diameter, d (mm) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">The diameter of the spring wire. Typical range: 0.2 - 20 mm</span></span></label>
<input type="number" id="wire-diameter" value="2.5" min="0.1" step="0.01" required>
</div>
</div>
<div class="form-row">
<div class="form-group">
<label for="outer-diameter">Outer Diameter, D<sub>o</sub> (mm) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">The overall outer diameter of the spring coils.</span></span></label>
<input type="number" id="outer-diameter" value="20" min="1" step="0.1" required>
</div>
<div class="form-group">
<label for="end-type">End Type <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Affects total coils and solid length. Squared & Ground provides the most stable seating surface.</span></span></label>
<select id="end-type" required>
<option value="squared-ground" selected>Squared and Ground (Most Common)</option>
<option value="squared">Squared Only</option>
<option value="plain-ground">Plain and Ground</option>
<option value="plain">Plain Ends</option>
</select>
</div>
</div>

<div class="form-section-header">‚ö° Loading & Operational Lengths</div>
<div class="form-row">
<div class="form-group">
<label for="force-1">Force 1, F‚ÇÅ (N) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">The first known operating force on the spring (e.g., minimum load or preload).</span></span></label>
<input type="number" id="force-1" value="50" min="0" step="0.1" required>
</div>
<div class="form-group">
<label for="length-1">Length at Force 1, L‚ÇÅ (mm) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">The compressed length of the spring when Force 1 is applied.</span></span></label>
<input type="number" id="length-1" value="55" min="1" step="0.1" required>
</div>
</div>
<div class="form-row">
<div class="form-group">
<label for="force-2">Force 2, F‚ÇÇ (N) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">The second known operating force (must be greater than Force 1).</span></span></label>
<input type="number" id="force-2" value="200" min="1" step="0.1" required>
</div>
<div class="form-group">
<label for="length-2">Length at Force 2, L‚ÇÇ (mm) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">The compressed length of the spring when Force 2 is applied (must be less than Length 1).</span></span></label>
<input type="number" id="length-2" value="40" min="1" step="0.1" required>
</div>
</div>

<div class="form-section-header">üîß Advanced Parameters</div>
<div class="form-row">
<div class="form-group">
<label for="application-type">Application Type</label>
<select id="application-type">
<option value="static" selected>Static Loading (Minimal Cycling)</option>
<option value="average">Average Service (< 10‚Å¥ cycles)</option>
<option value="light">Light Dynamic Service (10‚Å¥ - 10‚Åµ cycles)</option>
<option value="severe">Severe Cyclic Service (> 10‚Åµ cycles)</option>
</select>
</div>
<div class="form-group">
<label for="temp">Operating Temperature (¬∞C) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Temperature affects material properties significantly.</span></span></label>
<input type="number" id="temp" value="20" min="-200" max="800" step="5">
</div>
</div>
<div class="form-row">
<div class="form-group">
<label for="surface-condition">Surface Condition</label>
<select id="surface-condition">
<option value="peened" selected>Shot Peened (Highest Fatigue Strength)</option>
<option value="removed">Set Removed (Standard)</option>
<option value="not-removed">As-Manufactured (Not Set Removed)</option>
</select>
</div>
<div class="form-group">
<label for="reliability">Required Reliability <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Higher reliability requires larger safety factors.</span></span></label>
<select id="reliability">
<option value="0.90">90% (General Applications)</option>
<option value="0.95">95% (Important Applications)</option>
<option value="0.99" selected>99% (Critical Applications)</option>
<option value="0.999">99.9% (Safety-Critical)</option>
</select>
</div>
</div>

<button type="button" id="calculate-btn" class="calculate-btn">üî¨ Design & Analyze Spring</button>
</form>
</div>
<div id="result-container" class="result-container">
<h3>üìä Complete Spring Design Analysis</h3>
<div id="calculation-steps"></div>
<div class="recommendations">
<h4>üìã Design Summary & Recommendations</h4>
<div id="recommendations-content"></div>
</div>
</div>
</div>

<!-- START: NEW 800+ WORD EDUCATIONAL CONTENT -->
<div class="tool-container" style="margin-top: 40px; animation: fadeInSlideUp 0.8s ease;">
<h2>Beyond the Coils: An Industrial Deep-Dive into Spring Technology</h2>

<h3 style="color: var(--primary-color); margin-top: 25px;">The Unseen Force: Why Industrial Springs Matter</h3>
<p>At its core, a helical compression spring is a simple, elegant device for storing and releasing mechanical energy. Yet, this simplicity belies its critical role in modern engineering. From the precision-damped valve springs in a high-performance engine, operating millions of cycles without fail, to the massive suspension coils on off-highway vehicles, absorbing immense shock loads, springs are the unsung heroes of mechanical design. Their behavior dictates the safety, reliability, and performance of the entire system. This calculator is built to move beyond simple estimation and into the realm of professional, industrial-grade design, where failure is not an option.</p>

<h3 style="color: var(--primary-color); margin-top: 25px;">The "Golden Ratio" of Spring Design: Spring Index (C)</h3>
<p>While this tool calculates over a dozen parameters, one of the first and most important is the <strong>Spring Index (C = D/d)</strong>. This ratio of mean coil diameter (D) to wire diameter (d) is the "golden ratio" of spring manufacturing.
<ul>
<li><strong>Low Index (C < 4):</strong> This is a "heavy" spring with a thick wire relative to its diameter. It is extremely difficult to manufacture, as the wire must be bent sharply, inducing high residual stress and risking cracks. It also results in very high stress concentration (as seen in the Wahl Factor).</li>
<li><strong>High Index (C > 12):</strong> This is a "flimsy" spring with a thin wire relative to its diameter. It is prone to tangling during handling, buckling under load (as checked in Step 11), and inconsistent spring rates.</li>
<li><strong>Optimal Range (4 < C < 12):</strong> This is the manufacturing sweet spot. It provides a stable, predictable, and manufacturable spring with a good balance of stress and performance.</li>
</ul>
</p>

<h3 style="color: var(--primary-color); margin-top: 25px;">The Language of Design: Applicable International Standards</h3>
<p>A professional design is one that can be communicated, manufactured, and tested. International standards ensure that the spring you design is the spring you get. This tool's calculations are based on the principles enshrined in these key documents:</p>
<ul>
<li><strong>DIN EN 13906-1 (Cylindrical Helical Compression Springs):</strong> This German/European standard is a cornerstone for spring design. It provides the core calculation methods for stress, deflection, and fatigue, forming the basis for much of the logic in this calculator.</li>
<li><strong>ISO 2162 (Technical Product Documentation - Springs):</strong> This standard dictates *how* to draw and specify a spring on an engineering drawing, including representations of end types, coiling direction, and required technical data.</li>
<li><strong>ASTM / SAE (Material Standards):</strong> A spring is only as good as its material. Standards like <strong>ASTM A228 (Music Wire)</strong>, <strong>ASTM A229 (Oil Tempered)</strong>, and <strong>ASTM A313 (Stainless Steel)</strong> define the chemical composition, tensile strength (Sut), and quality requirements for the wire itself. This calculator's material database is built directly from these standards.</li>
</ul>

<h3 style="color: var(--primary-color); margin-top: 25px;">From Design to Reality: Critical Quality & Validation Checks</h3>
<p>After the design is finalized, a spring must be validated. In an industrial setting, the following checks are paramount:</p>
<ol>
<li><strong>Load Testing (The Litmus Test):</strong> This is the most important check. The spring is compressed to two or more specified lengths (like L‚ÇÅ and L‚ÇÇ) and the corresponding forces (F‚ÇÅ and F‚ÇÇ) are measured. This confirms the <strong>Spring Rate (k)</strong>, which is the heart of the spring's function.</li>
<li><strong>Dimensional Verification:</strong> This includes measuring the <strong>Free Length (L‚ÇÄ)</strong> and, critically, the <strong>Squareness</strong> (or perpendicularity) of the ends (for squared & ground types). A spring that doesn't stand straight will introduce side-loads, causing wear and premature failure.</li>
<li><strong>Non-Destructive Testing (NDT):</strong> For critical applications (aerospace, automotive), springs may undergo Magnetic Particle Inspection (MPI) or dye penetrant testing to find microscopic surface flaws that could become the initiation point for a fatigue crack.</li>
</ol>

<h3 style="color: var(--primary-color); margin-top: 25px;">The Science of Failure: Fatigue, Creep, and Set Removal</h3>
<p>A spring can fail in two ways: it can break (a static or fatigue failure), or it can "relax" and stop doing its job. This calculator is designed to prevent both.</p>

<h4>The "Magic" of Set Removal (Prestressting)</h4>
<p>This is a critical concept, included as an option in this tool. "Set Removed" means the spring was intentionally compressed *past its yield point* (usually to its solid height) during manufacturing. This may sound destructive, but it's a clever manufacturing trick. This one-time yielding induces favorable compressive residual stresses on the *inside* of the coil, where operating stresses are highest. This process effectively increases the spring's elastic limit for all future compressions, making it resistant to "taking a set" (permanently shrinking) in service. This is why the tool applies a higher yield strength (Ssy_corrected) for set-removed springs.</p>

<h4>The Silent Killer: Fatigue Failure</h4>
<p>As calculated in Step 10, fatigue is the primary concern for dynamically loaded springs. It's not the maximum stress (œÑ_solid) that breaks the spring, but the *repeated cycle* of stress (the alternating stress, œÑ_a). <strong>Shot Peening</strong> (an option in this tool) is a process that bombards the spring with tiny steel balls, creating a compressive "skin" on the wire. This compressive layer makes it much harder for fatigue cracks to form, dramatically increasing the spring's life, which is why the tool applies a fatigue modification factor (k_f) for it.</p>

<h4>Creep vs. Relaxation: The Temperature-Driven Threats</h4>
<p>Temperature is a major factor, which is why it's a key input.
<ul>
<li><strong>Creep:</strong> If you hang a constant weight (load) on a spring in a hot environment, over time you will find the spring has gotten *longer*. This is creep.</li>
<li><strong>Relaxation:</strong> If you compress a spring to a fixed length (like a valve spring or a spring in a bolted joint) and leave it in a hot environment, over time the *force* it pushes back with will *decrease*. This is relaxation, and it's a critical failure mode for preloaded components.</li>
</ul>
This is why material choice is vital. A Chrome Vanadium (A231) or Inconel spring is chosen specifically for its resistance to this temperature-driven relaxation.</p>

<h3 style="color: var(--primary-color); margin-top: 25px;">The Future of Spring Technology: Innovations & Trends</h3>
<p>The humble spring is still evolving. The future is focused on lighter, more durable, and "smarter" designs.
<ul>
<li><strong>Advanced Materials:</strong> Super-alloys like the <strong>Inconel X-750</strong> in this tool are used in jet engines and downhole oil & gas tools, operating at temperatures that would instantly ruin carbon steel. Titanium alloys are used in motorsports and aerospace for their exceptional strength-to-weight ratio.</li>
<li><strong>Composite Springs:</strong> While complex to make, springs made of glass or carbon fiber composites are now used in niche applications (like the suspension on some heavy-duty trucks). They can be up to 70% lighter than their steel counterparts.</li>
<li><strong>Smart Manufacturing & Simulation:</strong> Modern CNC coiling machines can produce springs with variable pitch and even variable diameters (like barrel or conical springs) in a single operation. This allows engineers to create springs with non-linear spring rates (e.g., a spring that gets progressively stiffer as it's compressed). This is combined with Finite Element Analysis (FEA) software, which moves beyond 1D formulas to create a complete 3D model of the stress in the wire, allowing for hyper-accurate fatigue life prediction.</li>
</ul>
</p>
</div>
<!-- END: NEW 800+ WORD EDUCATIONAL CONTENT -->

</main>

<!-- FOOTER (Replaced from Reynolds File) -->
    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-left">
                    <a href="/" class="footer-logo">
                        <img src="logo.png" alt="Design Calculators Logo" loading="lazy" decoding="async">
                        <span class="footer-logo-text">Design Calculators</span>
                    </a>
                    <p class="footer-description">A comprehensive engineering calculator hub based on IEC, IEEE, and
                        global standards.</p>
                    <div class="social-buttons">
                        <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://designcalculators.co.in"
                            target="_blank" rel="noopener noreferrer" class="social-btn linkedin"
                            aria-label="LinkedIn"><i class="fab fa-linkedin-in"></i></a>
                        <a href="https://www.youtube.com/@designcalculators" target="_blank" rel="noopener noreferrer"
                            class="social-btn youtube" aria-label="YouTube"><i class="fab fa-youtube"></i></a>
                        <a href="https://twitter.com/intent/tweet?url=https://designcalculators.co.in&text=Check%20out%20this%20amazing%20engineering%20calculator%20hub!"
                            target="_blank" rel="noopener noreferrer" class="social-btn twitter" aria-label="Twitter"><i
                                class="fab fa-twitter"></i></a>
                        <a href="https://www.facebook.com/sharer/sharer.php?u=https://designcalculators.co.in"
                            target="_blank" rel="noopener noreferrer" class="social-btn facebook"
                            aria-label="Facebook"><i class="fab fa-facebook-f"></i></a>
                        <a href="https://api.whatsapp.com/send?text=Check%20out%20this%20amazing%20engineering%20resource:%20https://designcalculators.co.in"
                            target="_blank" rel="noopener noreferrer" class="social-btn whatsapp"
                            aria-label="WhatsApp"><i class="fab fa-whatsapp"></i></a>
                    </div>
                </div>
                <div class="footer-right">
                    <div class="footer-col">
                        <h4>Quick Links</h4>
                        <ul>
                            <li><a href='/indexele.html'>Electrical Tools</a></li>
                            <li><a href='/indexmech.html'>Mechanical Tools</a></li>
                            <li><a href='/indexinst.html'>Instrumentation Tools</a></li>
                            <li><a href='/about.html'>About Us</a></li>
                            <li><a href='/faq.html'>FAQ</a></li>
                        </ul>
                    </div>
                    <div class="footer-col">
                        <h4>Learn More</h4>
                        <ul>
                            <li><a href="https://www.youtube.com/@designcalculators" target="_blank"
                                    rel="noopener noreferrer">YouTube Channel</a></li>
                            <li><a href='/contact.html'>Contact Us</a></li>
                            <li><a href='/privacy-policy.html'>Privacy Policy</a></li>
                            <li><a href='/terms-of-service.html'>Terms of Service</a></li>
                            <li><a href='/sitemap2.html'>Sitemap</a></li>
                        </ul>
                    </div>
                    <div class="footer-col">
                        <h4>Our Network</h4>
                        <ul>
                            <li style="margin-bottom: 12px;">
                                <a href="https://reliabilitytools.co.in/" target="_blank" rel="noopener"
                                   style="font-weight: 600; display: block; margin-bottom: 2px;">Reliability Tools</a>
                                <span style="font-size: 0.85rem; color: #94a3b8; line-height: 1.3; display: block;">Reliability
                                    & maintenance engineering calculators.</span>
                            </li>
                            <li style="margin-bottom: 12px;">
                                <a href="https://electrosafe.homes/" target="_blank" rel="noopener"
                                   style="font-weight: 600; display: block; margin-bottom: 2px;">ElectroSafe</a>
                                <span style="font-size: 0.85rem; color: #94a3b8; line-height: 1.3; display: block;">Dedicated
                                    to home electrical safety & protection.</span>
                            </li>
                            <li>
                                <a href="https://knowyourname.co.in/" target="_blank" rel="noopener"
                                   style="font-weight: 600; display: block; margin-bottom: 2px;">KnowYourName</a>
                                <span style="font-size: 0.85rem; color: #94a3b8; line-height: 1.3; display: block;">Scientific
                                    name analysis: Phonetics, Ergonomics & Acoustics.</span>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="footer-disclaimer">
                <p>All calculations are for preliminary engineering design guidance. Final designs must comply with all applicable local and international standards (including but not limited to ASHRAE 90.1, ARI 550/590). Always verify calculations and consult with a licensed professional engineer before implementation or construction.</p>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 Design Calculators. Created by <span style="color: var(--secondary); font-weight: bold;">Anil Sharma</span>. All rights reserved.</p>
            </div>
        </div>
    </footer>

<div id="custom-message-box"></div>

<!-- Original Spring Calculator Script (Untouched) -->
<script>
// ============================================================================
// INDUSTRIAL SPRING DESIGN CALCULATOR - PROFESSIONAL EDITION
// Based on: Shigley's Mechanical Engineering Design, ASME Standards, DIN 2095
// ============================================================================
document.addEventListener('DOMContentLoaded', function() {
const calculateBtn = document.getElementById('calculate-btn');
const resultContainer = document.getElementById('result-container');
const calculationStepsDiv = document.getElementById('calculation-steps');
const recommendationsDiv = document.getElementById('recommendations-content');

// ============================================================================
// MATERIAL DATABASE - Industry Standard Properties
// ============================================================================
const materialData = {
'A228': { G: 81.7, // Shear Modulus (GPa)
E: 207, // Young's Modulus (GPa)
A: 2211, // Tensile strength coefficient (MPa)
b: -0.145, // Exponent for wire diameter (mm)
name: 'Music Wire (ASTM A228)',
density: 7850, // kg/m¬≥
maxTemp: 120, // ¬∞C
Se_percent: 0.50, // Endurance limit ratio
surfaceFactor: 0.85,
reliability: { 0.90: 1.0, 0.95: 0.868, 0.99: 0.814, 0.999: 0.753 }},
'A227': { G: 79.3, E: 207,
A: 1783, b: -0.190,
name: 'Hard Drawn Wire (ASTM A227)',
density: 7850,
maxTemp: 120,
Se_percent: 0.42,
surfaceFactor: 0.77,
reliability: { 0.90: 1.0, 0.95: 0.868, 0.99: 0.814, 0.999: 0.753 }},
'A229': { G: 79.3, E: 207,
A: 1855, b: -0.187,
name: 'Oil Tempered Wire (ASTM A229)',
density: 7850,
maxTemp: 180,
Se_percent: 0.45,
surfaceFactor: 0.83,
reliability: { 0.90: 1.0, 0.95: 0.868, 0.99: 0.814, 0.999: 0.753 }},
'A231': { G: 77.2, E: 207,
A: 1909, b: -0.146,
name: 'Chrome Vanadium (ASTM A231)',
density: 7850,
maxTemp: 220,
Se_percent: 0.47,
surfaceFactor: 0.88,
reliability: { 0.90: 1.0, 0.95: 0.868, 0.99: 0.814, 0.999: 0.753 }},
'A313': { G: 69.0, E: 193,
A: 1867, b: -0.146,
name: 'Stainless Steel 302 (ASTM A313)',
density: 8000,
maxTemp: 260,
Se_percent: 0.35,
surfaceFactor: 0.50,
reliability: { 0.90: 1.0, 0.95: 0.868, 0.99: 0.814, 0.999: 0.753 }},
'A313-316': { G: 69.0, E: 193,
A: 1867, b: -0.146,
name: 'Stainless Steel 316 (ASTM A313)',
density: 8000,
maxTemp: 260,
Se_percent: 0.35,
surfaceFactor: 0.50,
reliability: { 0.90: 1.0, 0.95: 0.868, 0.99: 0.814, 0.999: 0.753 }},
'Inconel': { G: 75.8, E: 214,
A: 2085, b: -0.130,
name: 'Inconel X-750',
density: 8280,
maxTemp: 650,
Se_percent: 0.40,
surfaceFactor: 0.82,
reliability: { 0.90: 1.0, 0.95: 0.868, 0.99: 0.814, 0.999: 0.753 }},
'Phosphor': { G: 41.4, E: 110,
A: 913, b: -0.064,
name: 'Phosphor Bronze',
density: 8860,
maxTemp: 100,
Se_percent: 0.35,
surfaceFactor: 0.65,
reliability: { 0.90: 1.0, 0.95: 0.868, 0.99: 0.814, 0.999: 0.753 }}
};

// ============================================================================
// END TYPE COEFFICIENTS
// ============================================================================
const endTypeData = {
'squared-ground': { coils: 2, name: 'Squared and Ground',
effectiveCoils: 0, // Inactive coils
buckling: 0.5 // End fixity coefficient
},
'squared': { coils: 2, name: 'Squared',
effectiveCoils: 1,
buckling: 0.707
},
'plain-ground': { coils: 1, name: 'Plain and Ground',
effectiveCoils: 1,
buckling: 0.707
},
'plain': { coils: 0, name: 'Plain Ends',
effectiveCoils: 2,
buckling: 1.0
}
};

// ============================================================================
// BUTTON RIPPLE EFFECT
// ============================================================================
calculateBtn.addEventListener('click', (e) => {
// ... Ripple effect logic ...
const ripple = document.createElement('span');
const rect = calculateBtn.getBoundingClientRect();
const diameter = Math.max(calculateBtn.clientWidth, calculateBtn.clientHeight);
const radius = diameter / 2;
ripple.style.width = ripple.style.height = `${diameter}px`;
ripple.style.left = `${e.clientX - rect.left - radius}px`;
ripple.style.top = `${e.clientY - rect.top - radius}px`;
ripple.classList.add('ripple');
calculateBtn.appendChild(ripple);
ripple.addEventListener('animationend', () => ripple.remove());

if (validateInputs()) {
performCalculation();
}
});

// ============================================================================
// INPUT VALIDATION
// ============================================================================
function validateInputs() {
// Check required fields
const requiredInputs = document.querySelectorAll('#spring-form [required]');
for (let input of requiredInputs) {
if (!input.value || input.value === '') {
const label = input.labels[0].textContent.split('(')[0].trim();
displayMessage(`‚ùå Error: "${label}" is required.`, "error");
input.focus();
return false;
}
}

// Get all input values
const d = parseFloat(document.getElementById('wire-diameter').value);
const Do = parseFloat(document.getElementById('outer-diameter').value);
const F1 = parseFloat(document.getElementById('force-1').value);
const L1 = parseFloat(document.getElementById('length-1').value);
const F2 = parseFloat(document.getElementById('force-2').value);
const L2 = parseFloat(document.getElementById('length-2').value);

// Validation checks
if (isNaN(d) || d <= 0) { displayMessage('‚ùå Wire diameter must be a positive number.', 'error'); return false; }
if (isNaN(Do) || Do <= 0) { displayMessage('‚ùå Outer diameter must be a positive number.', 'error'); return false; }
if (Do <= d) { displayMessage('‚ùå Outer diameter must be greater than wire diameter.', 'error'); return false; }
if ((Do - d) / d < 3) { displayMessage('‚ö†Ô∏è Warning: Spring index will be less than 3, which is extremely difficult to manufacture.', 'warning'); }
if (F2 <= F1) { displayMessage('‚ùå Force 2 must be greater than Force 1.', 'error'); return false; }
if (L1 <= L2) { displayMessage('‚ùå Length 1 must be greater than Length 2 (spring compresses from L1 to L2).', 'error'); return false; }
if (F1 < 0) { displayMessage('‚ùå Force 1 cannot be negative.', 'error'); return false; }

return true;
}

// ============================================================================
// MAIN CALCULATION ENGINE
// ============================================================================
function performCalculation() {
try {
// Clear previous results
calculationStepsDiv.innerHTML = '';
recommendationsDiv.innerHTML = '';

// Gather inputs
const inputs = {
materialKey: document.getElementById('material-type').value,
d: parseFloat(document.getElementById('wire-diameter').value),
Do: parseFloat(document.getElementById('outer-diameter').value),
endType: document.getElementById('end-type').value,
F1: parseFloat(document.getElementById('force-1').value),
L1: parseFloat(document.getElementById('length-1').value),
F2: parseFloat(document.getElementById('force-2').value),
L2: parseFloat(document.getElementById('length-2').value),
applicationType: document.getElementById('application-type').value,
temp: parseFloat(document.getElementById('temp').value),
surfaceCondition: document.getElementById('surface-condition').value,
reliability: parseFloat(document.getElementById('reliability').value)
};

const material = materialData[inputs.materialKey];
const endType = endTypeData[inputs.endType];

// Initialize results object
let results = { warnings: [], failures: [], passes: [] };

// =====================================================================
// STEP 1: BASIC GEOMETRIC PARAMETERS
// =====================================================================
const D = inputs.Do - inputs.d; // Mean diameter (mm)
const C = D / inputs.d; // Spring index

addCalculationStep(1, 'üìê Basic Geometric Parameters',
`$$D = D_o - d$$$$C = \\frac{D}{d}$$`,
`Mean Coil Diameter: D = ${inputs.Do} - ${inputs.d} = <strong>${D.toFixed(3)} mm</strong><br>Spring Index: C = ${D.toFixed(3)} / ${inputs.d} = <strong>${C.toFixed(3)}</strong><br><br><em>The spring index C is a critical parameter that affects manufacturability and stress.<br>Recommended range: 4 ‚â§ C ‚â§ 12</em>`,
`D = ${D.toFixed(3)} mm | C = ${C.toFixed(3)}`);

// Check spring index
if (C < 4) { results.warnings.push('Spring index C < 4: Difficult to manufacture, high forming stresses.'); }
else if (C > 12) { results.warnings.push('Spring index C > 12: Spring may be prone to tangling and buckling.'); }
else { results.passes.push(`Spring index C = ${C.toFixed(2)} is within optimal range (4-12).`); }

// =====================================================================
// STEP 2: SPRING RATE CALCULATION
// =====================================================================
const k = (inputs.F2 - inputs.F1) / (inputs.L1 - inputs.L2); // N/mm

addCalculationStep(2, '‚ö° Spring Rate (Stiffness)',
`$$k = \\frac{F_2 - F_1}{L_1 - L_2}$$`,
`Spring Rate: k = (${inputs.F2} - ${inputs.F1}) / (${inputs.L1} - ${inputs.L2})<br>k = ${(inputs.F2 - inputs.F1).toFixed(3)} / ${(inputs.L1 - inputs.L2).toFixed(3)}`,
`k = ${k.toFixed(4)} N/mm`);

// =====================================================================
// STEP 3: TEMPERATURE-CORRECTED MATERIAL PROPERTIES
// =====================================================================
const tempFactor = calculateTemperatureFactor(material, inputs.temp);
const G = material.G * tempFactor.shearModulus; // Temperature-corrected shear modulus (GPa)
const E = material.E * tempFactor.youngsModulus; // Temperature-corrected Young's modulus (GPa)

let tempWarning = '';
if (inputs.temp > material.maxTemp) {
tempWarning = `<br><strong>‚ö†Ô∏è WARNING:</strong> Operating temperature (${inputs.temp}¬∞C) exceeds recommended maximum (${material.maxTemp}¬∞C) for ${material.name}.`;
results.failures.push(`Temperature ${inputs.temp}¬∞C exceeds material limit ${material.maxTemp}¬∞C`);
} else if (inputs.temp < -40) {
tempWarning = `<br><strong>‚ö†Ô∏è WARNING:</strong> Low temperature operation may affect ductility.`;
results.warnings.push(`Low temperature operation (${inputs.temp}¬∞C) - verify material ductility.`);
}

addCalculationStep(3, 'üå°Ô∏è Temperature-Corrected Material Properties',
`Temperature effects on modulus: multiplicative factor based on temperature`,
`Material: <strong>${material.name}</strong><br>Operating Temperature: ${inputs.temp}¬∞C (Max recommended: ${material.maxTemp}¬∞C)<br>Shear Modulus (G) at ${inputs.temp}¬∞C: ${G.toFixed(2)} GPa (20¬∞C value: ${material.G} GPa)<br>Young's Modulus (E) at ${inputs.temp}¬∞C: ${E.toFixed(2)} GPa (20¬∞C value: ${material.E} GPa)<br>Temperature Factor: ${(tempFactor.shearModulus * 100).toFixed(1)}% of room temperature value${tempWarning}`,
`G = ${G.toFixed(2)} GPa | E = ${E.toFixed(2)} GPa`);

// =====================================================================
// STEP 4: NUMBER OF ACTIVE COILS
// =====================================================================
const G_MPa = G * 1000; // Convert GPa to MPa
const Na = (G_MPa * Math.pow(inputs.d, 4)) / (8 * Math.pow(D, 3) * k);
const Nt = Na + endType.coils;

addCalculationStep(4, 'üîÑ Number of Coils',
`$$N_a = \\frac{G d^4}{8 D^3 k}$$$$N_t = N_a + N_{ends}$$`,
`Active Coils: N<sub>a</sub> = (${G_MPa} √ó ${inputs.d}<sup>4</sup>) / (8 √ó ${D.toFixed(3)}<sup>3</sup> √ó ${k.toFixed(4)})<br>N<sub>a</sub> = ${(G_MPa * Math.pow(inputs.d, 4)).toExponential(3)} / ${(8 * Math.pow(D, 3) * k).toExponential(3)}<br>N<sub>a</sub> = ${Na.toFixed(3)} coils<br><br>End Type: <strong>${endType.name}</strong> adds ${endType.coils} coils<br>Total Coils: N<sub>t</sub> = ${Na.toFixed(3)} + ${endType.coils}`,
`N<sub>a</sub> = ${Na.toFixed(2)} | N<sub>t</sub> = ${Nt.toFixed(2)} coils`);

if (Na < 3) {
results.warnings.push(`Low number of active coils (${Na.toFixed(1)}): Spring rate may be inconsistent.`);
}

// =====================================================================
// STEP 5: FREE LENGTH AND SOLID HEIGHT
// =====================================================================
const y1 = inputs.F1 / k; // Deflection at F1
const L0 = inputs.L1 + y1; // Free length
const Ls = inputs.d * Nt; // Solid height
const y_solid = L0 - Ls; // Maximum deflection to solid
const F_solid = k * y_solid; // Force at solid height

addCalculationStep(5, 'üìè Length Analysis',
`$$L_0 = L_1 + \\frac{F_1}{k}$$$$L_s = d \\times N_t$$$$y_{solid} = L_0 - L_s$$$$F_{solid} = k \\times y_{solid}$$`,
`Deflection at Force 1: y<sub>1</sub> = ${inputs.F1} / ${k.toFixed(4)} = ${y1.toFixed(3)} mm<br>Free Length: L<sub>0</sub> = ${inputs.L1} + ${y1.toFixed(3)} = <strong>${L0.toFixed(3)} mm</strong><br>Solid Height: L<sub>s</sub> = ${inputs.d} √ó ${Nt.toFixed(2)} = <strong>${Ls.toFixed(3)} mm</strong><br>Maximum Deflection: y<sub>solid</sub> = ${L0.toFixed(3)} - ${Ls.toFixed(3)} = ${y_solid.toFixed(3)} mm<br>Force at Solid: F<sub>solid</sub> = ${k.toFixed(4)} √ó ${y_solid.toFixed(3)} = <strong>${F_solid.toFixed(2)} N</strong>`,
`L<sub>0</sub> = ${L0.toFixed(2)} mm | L<sub>s</sub> = ${Ls.toFixed(2)} mm | F<sub>solid</sub> = ${F_solid.toFixed(1)} N`);

// Check clash allowance
const clash_allowance = inputs.L2 - Ls;
if (clash_allowance < 1) {
results.failures.push(`Insufficient clash allowance: ${clash_allowance.toFixed(2)} mm (minimum 1 mm recommended).`);
} else if (clash_allowance < 2) {
results.warnings.push(`Low clash allowance: ${clash_allowance.toFixed(2)} mm (2-3 mm recommended).`);
} else {
results.passes.push(`Clash allowance: ${clash_allowance.toFixed(2)} mm - adequate.`);
}

// =====================================================================
// STEP 6: WAHL CORRECTION FACTOR
// =====================================================================
const Kw = ((4 * C - 1) / (4 * C - 4)) + (0.615 / C);
const Ks = (4 * C + 2) / (4 * C - 3); // Static stress correction (for comparison)

addCalculationStep(6, 'üîß Wahl Correction Factor',
`$$K_w = \\frac{4C - 1}{4C - 4} + \\frac{0.615}{C}$$`,
`The Wahl factor accounts for stress concentration due to curvature and direct shear.<br><br>K<sub>w</sub> = (4 √ó ${C.toFixed(3)} - 1) / (4 √ó ${C.toFixed(3)} - 4) + 0.615 / ${C.toFixed(3)}<br>K<sub>w</sub> = ${((4 * C - 1) / (4 * C - 4)).toFixed(4)} + ${(0.615 / C).toFixed(4)}<br><br>For reference: K<sub>s</sub> (Bergstr√§sser) = ${Ks.toFixed(4)}`,
`K<sub>w</sub> = ${Kw.toFixed(4)}`);

// =====================================================================
// STEP 7: SHEAR STRESS ANALYSIS
// =====================================================================
const tau_1 = Kw * (8 * inputs.F1 * D) / (Math.PI * Math.pow(inputs.d, 3)); // Stress at F1 (MPa)
const tau_2 = Kw * (8 * inputs.F2 * D) / (Math.PI * Math.pow(inputs.d, 3)); // Stress at F2 (MPa)
const tau_solid = Kw * (8 * F_solid * D) / (Math.PI * Math.pow(inputs.d, 3)); // Stress at solid (MPa)
const tau_mean = (tau_1 + tau_2) / 2; // Mean stress
const tau_alt = (tau_2 - tau_1) / 2; // Alternating stress

addCalculationStep(7, 'üìä Shear Stress Analysis',
`$$\\tau = K_w \\frac{8 F D}{\\pi d^3}$$`,
`<strong>Stress at Force 1 (F<sub>1</sub> = ${inputs.F1} N):</strong><br>œÑ<sub>1</sub> = ${Kw.toFixed(4)} √ó (8 √ó ${inputs.F1} √ó ${D.toFixed(3)}) / (œÄ √ó ${inputs.d}<sup>3</sup>)<br>œÑ<sub>1</sub> = <strong>${tau_1.toFixed(2)} MPa</strong><br><br>
<strong>Stress at Force 2 (F<sub>2</sub> = ${inputs.F2} N):</strong><br>œÑ<sub>2</sub> = ${Kw.toFixed(4)} √ó (8 √ó ${inputs.F2} √ó ${D.toFixed(3)}) / (œÄ √ó ${inputs.d}<sup>3</sup>)<br>œÑ<sub>2</sub> = <strong>${tau_2.toFixed(2)} MPa</strong><br><br>
<strong>Stress at Solid Height (F<sub>solid</sub> = ${F_solid.toFixed(2)} N):</strong><br>œÑ<sub>solid</sub> = ${Kw.toFixed(4)} √ó (8 √ó ${F_solid.toFixed(2)} √ó ${D.toFixed(3)}) / (œÄ √ó ${inputs.d}<sup>3</sup>)<br>œÑ<sub>solid</sub> = <strong>${tau_solid.toFixed(2)} MPa</strong><br><br>
<strong>For Fatigue Analysis:</strong><br>Mean Stress: œÑ<sub>m</sub> = (${tau_1.toFixed(2)} + ${tau_2.toFixed(2)}) / 2 = ${tau_mean.toFixed(2)} MPa<br>Alternating Stress: œÑ<sub>a</sub> = (${tau_2.toFixed(2)} - ${tau_1.toFixed(2)}) / 2 = ${tau_alt.toFixed(2)} MPa`,
`œÑ<sub>1</sub> = ${tau_1.toFixed(1)} MPa | œÑ<sub>2</sub> = ${tau_2.toFixed(1)} MPa | œÑ<sub>solid</sub> = ${tau_solid.toFixed(1)} MPa`);

// =====================================================================
// STEP 8: MATERIAL STRENGTH PROPERTIES
// =====================================================================
const Sut = material.A * Math.pow(inputs.d, material.b) * tempFactor.tensileStrength;
const Ssy = 0.577 * Sut; // Shear yield strength (von Mises criterion)
const Ssu = 0.67 * Sut; // Ultimate shear strength

// Set removal - springs are typically compressed to solid height during manufacturing
const setRemovalFactor = inputs.surfaceCondition === 'not-removed' ? 1.0 : 1.15;
const Ssy_corrected = Ssy * setRemovalFactor;

addCalculationStep(8, 'üí™ Material Strength Properties',
`$$S_{ut} = A \\cdot d^b \\cdot f_{temp}$$$$S_{sy} = 0.577 \\cdot S_{ut}$$$$S_{su} = 0.67 \\cdot S_{ut}$$`,
`<strong>Ultimate Tensile Strength:</strong><br>S<sub>ut</sub> = ${material.A} √ó ${inputs.d}<sup>${material.b}</sup> √ó ${tempFactor.tensileStrength.toFixed(3)}<br>S<sub>ut</sub> = <strong>${Sut.toFixed(2)} MPa</strong><br><br>
<strong>Torsional Yield Strength (von Mises):</strong><br>S<sub>sy</sub> = 0.577 √ó ${Sut.toFixed(2)} = ${Ssy.toFixed(2)} MPa<br>Surface Condition: <strong>${inputs.surfaceCondition}</strong><br>Set Removal Factor: ${setRemovalFactor}<br>S<sub>sy,corrected</sub> = <strong>${Ssy_corrected.toFixed(2)} MPa</strong><br><br>
<strong>Ultimate Shear Strength:</strong><br>S<sub>su</sub> = 0.67 √ó ${Sut.toFixed(2)} = <strong>${Ssu.toFixed(2)} MPa</strong>`,
`S<sub>ut</sub> = ${Sut.toFixed(0)} MPa | S<sub>sy</sub> = ${Ssy_corrected.toFixed(0)} MPa`);

// =====================================================================
// STEP 9: STATIC SAFETY FACTORS
// =====================================================================
const FS_1 = Ssy_corrected / tau_1;
const FS_2 = Ssy_corrected / tau_2;
const FS_solid = Ssy_corrected / tau_solid;

// Determine required safety factor based on application
let requiredFS = 1.2; // Minimum for static loading
if (inputs.applicationType === 'severe') requiredFS = 2.0;
else if (inputs.applicationType === 'light') requiredFS = 1.5;
else if (inputs.applicationType === 'average') requiredFS = 1.3;

let fs_status = '';
let fs_class = '';
if (FS_solid < 1.0) {
fs_status = '‚ùå FAIL - Yielding will occur at solid height';
fs_class = 'fail';
results.failures.push(`Factor of safety at solid height (${FS_solid.toFixed(2)}) < 1.0 - Spring will yield!`);
} else if (FS_solid < requiredFS) {
fs_status = `‚ö†Ô∏è WARNING - Factor of safety below recommended minimum (${requiredFS})`;
fs_class = 'warning';
results.warnings.push(`Factor of safety at solid height (${FS_solid.toFixed(2)}) below recommended (${requiredFS}).`);
} else {
fs_status = '‚úÖ PASS - Adequate safety factor';
fs_class = 'pass';
results.passes.push(`Factor of safety at solid height: ${FS_solid.toFixed(2)} (required: ${requiredFS}).`);
}

addCalculationStep(9, 'üõ°Ô∏è Static Safety Factors',
`$$FS = \\frac{S_{sy}}{\\tau}$$`,
`<strong>Factor of Safety at Force 1:</strong><br>FS<sub>1</sub> = ${Ssy_corrected.toFixed(2)} / ${tau_1.toFixed(2)} = <strong>${FS_1.toFixed(2)}</strong><br><br>
<strong>Factor of Safety at Force 2 (Working Load):</strong><br>FS<sub>2</sub> = ${Ssy_corrected.toFixed(2)} / ${tau_2.toFixed(2)} = <strong>${FS_2.toFixed(2)}</strong><br><br>
<strong>Factor of Safety at Solid Height:</strong><br>FS<sub>solid</sub> = ${Ssy_corrected.toFixed(2)} / ${tau_solid.toFixed(2)} = <strong>${FS_solid.toFixed(2)}</strong><br><br>
Application Type: <strong>${inputs.applicationType}</strong><br>Required Minimum FS: <strong>${requiredFS}</strong><br><br>
<span class="pass-indicator ${fs_class}">${fs_status}</span>`,
`FS<sub>solid</sub> = ${FS_solid.toFixed(2)} (Required: ${requiredFS})`);

// =====================================================================
// STEP 10: FATIGUE ANALYSIS (Modified Goodman Criterion)
// =====================================================================
if (inputs.applicationType !== 'static') {
// Calculate endurance limit in shear
const Se_base = material.Se_percent * Ssu; // Base endurance limit
const ka = material.surfaceFactor; // Surface finish factor
let kb = 1.0; // Size factor (conservative for springs)
if (inputs.d > 10) kb = 0.85;
else if (inputs.d > 5) kb = 0.9;
const kc = 1.0; // Load factor (already in shear)
const kd = tempFactor.enduranceLimit; // Temperature factor
const ke = material.reliability[inputs.reliability]; // Reliability factor

// Apply shot peening benefit
let kf = 1.0; // Miscellaneous effects factor
if (inputs.surfaceCondition === 'peened') {
kf = 1.4; // Shot peening can increase fatigue strength by 40%
}

const Se = Se_base * ka * kb * kc * kd * ke * kf;

// Modified Goodman criterion
const Ssa = 1 / ((tau_alt / Se) + (tau_mean / Ssu)); // This is 1/FS_fatigue, should be tau_alt/Ssa
const FS_fatigue = Se / tau_alt * (1 - (tau_mean / Ssu)); // Rearranged Goodman
// Let's use the standard FS form: 1/n = (tau_a / Se) + (tau_m / Ssu)
const FS_fatigue_goodman = 1 / ((tau_alt / Se) + (tau_mean / Ssu));


let fatigue_status = '';
let fatigue_class = '';
if (FS_fatigue_goodman < 1.0) {
fatigue_status = '‚ùå FAIL - Fatigue failure expected';
fatigue_class = 'fail';
results.failures.push(`Fatigue factor of safety (${FS_fatigue_goodman.toFixed(2)}) < 1.0 - Fatigue failure likely!`);
} else if (FS_fatigue_goodman < 1.5) {
fatigue_status = '‚ö†Ô∏è WARNING - Low fatigue safety margin';
fatigue_class = 'warning';
results.warnings.push(`Fatigue factor of safety (${FS_fatigue_goodman.toFixed(2)}) is low.`);
} else {
fatigue_status = '‚úÖ PASS - Adequate fatigue life expected';
fatigue_class = 'pass';
results.passes.push(`Fatigue factor of safety: ${FS_fatigue_goodman.toFixed(2)}.`);
}

// Estimate fatigue life using Basquin's equation
const fatigueLifeCycles = estimateFatigueLife(tau_alt, tau_mean, Se, Ssu);

addCalculationStep(10, '‚ôæÔ∏è Fatigue Life Analysis (Modified Goodman)',
`$$S_e = S_{e,base} \\cdot k_a \\cdot k_b \\cdot k_c \\cdot k_d \\cdot k_e \\cdot k_f$$$$FS_{fatigue} = \\frac{1}{\\frac{\\tau_a}{S_e} + \\frac{\\tau_m}{S_{su}}}$$`,
`<strong>Endurance Limit Calculation:</strong><br>Base Endurance Limit: S<sub>e,base</sub> = ${material.Se_percent} √ó ${Ssu.toFixed(2)} = ${Se_base.toFixed(2)} MPa<br>Surface Factor (k<sub>a</sub>): ${ka.toFixed(3)}<br>Size Factor (k<sub>b</sub>): ${kb.toFixed(3)}<br>Load Factor (k<sub>c</sub>): ${kc.toFixed(3)}<br>Temperature Factor (k<sub>d</sub>): ${kd.toFixed(3)}<br>Reliability Factor (k<sub>e</sub>) for ${(inputs.reliability * 100).toFixed(1)}%: ${ke.toFixed(3)}<br>Miscellaneous Factor (k<sub>f</sub>) [${inputs.surfaceCondition}]: ${kf.toFixed(3)}<br><strong>Corrected Endurance Limit: S<sub>e</sub> = ${Se.toFixed(2)} MPa</strong><br><br>
<strong>Modified Goodman Analysis:</strong><br>Alternating Stress: œÑ<sub>a</sub> = ${tau_alt.toFixed(2)} MPa<br>Mean Stress: œÑ<sub>m</sub> = ${tau_mean.toFixed(2)} MPa<br>Ultimate Shear Strength: S<sub>su</sub> = ${Ssu.toFixed(2)} MPa<br><br>
<strong>Fatigue Factor of Safety:</strong><br>FS<sub>fatigue</sub> = 1 / ((${tau_alt.toFixed(2)} / ${Se.toFixed(2)}) + (${tau_mean.toFixed(2)} / ${Ssu.toFixed(2)}))<br>FS<sub>fatigue</sub> = <strong>${FS_fatigue_goodman.toFixed(2)}</strong><br><br>
<strong>Estimated Fatigue Life:</strong> ${fatigueLifeCycles}<br><br>
<span class="pass-indicator ${fatigue_class}">${fatigue_status}</span>`,
`FS<sub>fatigue</sub> = ${FS_fatigue_goodman.toFixed(2)} | Life: ${fatigueLifeCycles}`);
}

// =====================================================================
// STEP 11: BUCKLING STABILITY ANALYSIS
// =====================================================================
const slenderness = L0 / D;
// Critical length ratio from standard buckling curves
// Based on end fixity coefficient
let lambda_crit;
if (endType.buckling === 0.5) lambda_crit = 5.26; // Fixed-fixed (approximates squared & ground)
else if (endType.buckling === 0.707) lambda_crit = 3.72; // Fixed-hinged (approximates squared)
else lambda_crit = 2.63; // Hinged-hinged (approximates plain)

// Actual critical buckling length
const Lcrit = lambda_crit * D;
const buckling_ratio = L0 / Lcrit;

let buckling_status = '';
let buckling_class = '';
let buckling_recommendation = '';

if (slenderness > lambda_crit) {
buckling_status = '‚ùå CRITICAL - Spring WILL buckle under load';
buckling_class = 'fail';
buckling_recommendation = 'Spring MUST be guided in a hole or over a rod. Consider reducing free length or increasing mean diameter.';
results.failures.push(`Buckling ratio ${buckling_ratio.toFixed(2)} > 1.0 - Spring requires guidance!`);
} else {
buckling_status = '‚úÖ PASS - Spring is stable against buckling';
buckling_class = 'pass';
buckling_recommendation = 'No guidance required for buckling stability.';
results.passes.push(`Buckling ratio ${buckling_ratio.toFixed(2)} < 1.0 - stable design.`);
}

addCalculationStep(11, 'üìê Buckling Stability Analysis',
`$$\\lambda = \\frac{L_0}{D}$$$$\\lambda_{crit} = f(end\\ type)$$`,
`<strong>Slenderness Ratio:</strong><br>Œª = L<sub>0</sub> / D = ${L0.toFixed(2)} / ${D.toFixed(3)} = <strong>${slenderness.toFixed(3)}</strong><br><br>
<strong>End Condition:</strong> ${endType.name}<br>End Fixity Coefficient (Approx): Œ± = ${endType.buckling}<br>Critical Slenderness Ratio: Œª<sub>crit</sub> = <strong>${lambda_crit.toFixed(2)}</strong><br>Critical Length: L<sub>crit</sub> = ${lambda_crit.toFixed(2)} √ó ${D.toFixed(3)} = <strong>${Lcrit.toFixed(2)} mm</strong><br><br>
<strong>Buckling Ratio:</strong> L<sub>0</sub> / L<sub>crit</sub> = ${L0.toFixed(2)} / ${Lcrit.toFixed(2)} = <strong>${buckling_ratio.toFixed(3)}</strong><br>(Ratio > 1.0 indicates potential buckling)<br><br>
<span class="pass-indicator ${buckling_class}">${buckling_status}</span><br><br>
<strong>Recommendation:</strong> ${buckling_recommendation}`,
`Œª = ${slenderness.toFixed(2)} | Œª<sub>crit</sub> = ${lambda_crit.toFixed(2)} | Ratio = ${buckling_ratio.toFixed(2)}`);

// =====================================================================
// STEP 12: NATURAL FREQUENCY & SURGE ANALYSIS
// =====================================================================
const volume = (Math.PI / 4) * Math.pow(inputs.d, 2) * Math.PI * D * Na; // mm^3
const mass = volume * (material.density / 1e9); // kg (density in kg/m^3, volume in mm^3)
const freq_fundamental = (1 / (2 * Math.PI)) * Math.sqrt((k * 1000) / mass); // Hz

// Surge frequency (first natural frequency of spring itself)
const W = Math.PI * D * Na * (material.density / 1e9) * (Math.PI / 4) * Math.pow(inputs.d, 2); // Weight of active coils in kg
const g = 9.81; // m/s^2
const W_N = W * g; // N
const f_surge_simple = (1 / 2) * Math.sqrt( (k * 1000 * g) / W_N); // Hz, simplified formula

let freq_status = '';
let freq_class = '';
if (f_surge_simple < freq_fundamental * 15) { // Check against a theoretical operating freq
freq_status = '‚ö†Ô∏è WARNING - Potential resonance issues';
freq_class = 'warning';
results.warnings.push(`Surge frequency (${f_surge_simple.toFixed(0)} Hz) may interfere with operating frequency.`);
} else {
freq_status = '‚úÖ PASS - Adequate frequency separation';
freq_class = 'pass';
results.passes.push(`Surge frequency (${f_surge_simple.toFixed(0)} Hz) is high.`);
}

addCalculationStep(12, 'üåä Natural Frequency & Surge Analysis',
`$$f_{surge} \\approx \\frac{1}{2} \\sqrt{\\frac{k g}{W_{active}}}$$`,
`<strong>Spring Active Mass Calculation:</strong><br>Active Wire Volume: ${volume.toFixed(2)} mm¬≥<br>Material Density: ${material.density} kg/m¬≥<br>Spring Active Mass: m<sub>active</sub> = <strong>${mass.toFixed(6)} kg</strong><br><br>
<strong>System Natural Frequency (as mass-spring):</strong><br>f<sub>n</sub> = (1 / 2œÄ) √ó ‚àö(${(k * 1000).toFixed(2)} N/m / ${mass.toFixed(6)} kg)<br>f<sub>n</sub> = <strong>${freq_fundamental.toFixed(2)} Hz</strong> (This is the freq *if* the spring was the only mass)<br><br>
<strong>Surge Frequency (First Mode, approx):</strong><br>f<sub>surge</sub> = <strong>${f_surge_simple.toFixed(2)} Hz</strong><br><br>
To avoid resonance, operating frequency should be < f<sub>surge</sub> / 15 = ${(f_surge_simple / 15).toFixed(2)} Hz<br><br>
<span class="pass-indicator ${freq_class}">${freq_status}</span>`,
`f<sub>surge</sub> = ${f_surge_simple.toFixed(1)} Hz`);

// =====================================================================
// STEP 13: ENERGY STORAGE CAPACITY
// =====================================================================
const U_max = 0.5 * k * Math.pow(y_solid, 2); // Maximum energy at solid height (N¬∑mm = mJ)
const y_working_range = inputs.L1 - inputs.L2;
const U_at_L1 = 0.5 * k * Math.pow(y1, 2);
const U_at_L2 = 0.5 * k * Math.pow(y1 + y_working_range, 2);
const U_working = U_at_L2 - U_at_L1; // Energy stored *in the working range*

addCalculationStep(13, '‚ö° Energy Storage Capacity',
`$$U = \\frac{1}{2} k y^2$$`,
`<strong>Energy Stored in Working Range (L‚ÇÅ to L‚ÇÇ):</strong><br>
U @ L‚ÇÇ: ${U_at_L2.toFixed(2)} N¬∑mm<br>
U @ L‚ÇÅ: ${U_at_L1.toFixed(2)} N¬∑mm<br>
U<sub>working</sub> = ${U_at_L2.toFixed(2)} - ${U_at_L1.toFixed(2)} = <strong>${U_working.toFixed(2)} N¬∑mm (mJ)</strong><br><br>
<strong>Maximum Energy Storage (at solid):</strong><br>Deflection: y<sub>max</sub> = ${y_solid.toFixed(3)} mm<br>U<sub>max</sub> = 0.5 √ó ${k.toFixed(4)} √ó ${Math.pow(y_solid, 2).toFixed(3)}<br>U<sub>max</sub> = <strong>${U_max.toFixed(2)} N¬∑mm (mJ)</strong><br>= ${(U_max / 1000).toFixed(4)} J`,
`U<sub>working</sub> = ${U_working.toFixed(1)} mJ | U<sub>max</sub> = ${U_max.toFixed(1)} mJ`);


// =====================================================================
// FINAL DESIGN VERDICT
// =====================================================================
let overall_verdict = '';
let overall_class = '';

if (results.failures.length > 0) {
overall_verdict = '‚ùå DESIGN FAILS - Critical issues must be resolved';
overall_class = 'fail';
} else if (results.warnings.length > 0) {
overall_verdict = '‚ö†Ô∏è DESIGN ACCEPTABLE WITH WARNINGS - Review recommendations';
overall_class = 'warning';
} else {
overall_verdict = '‚úÖ DESIGN PASSES - All criteria met successfully';
overall_class = 'safe';
}

const verdictDiv = document.createElement('div');
verdictDiv.className = `final-verdict ${overall_class}`;
verdictDiv.innerHTML = `<div style="font-size: 1.8rem; margin-bottom: 15px;">${overall_verdict}</div><div style="font-size: 1rem; font-weight: normal; margin-top: 10px;">${results.passes.length} checks passed | ${results.warnings.length} warnings | ${results.failures.length} failures</div>`;
calculationStepsDiv.appendChild(verdictDiv);

// =====================================================================
// DESIGN SUMMARY TABLE
// =====================================================================
const summaryHTML = `
<h4 style="margin-top: 30px; color: var(--primary-color);">üìã Design Summary Table</h4>
<table class="summary-table">
<thead><tr><th>Parameter</th><th>Symbol</th><th>Value</th><th>Units</th><th>Status</th></tr></thead>
<tbody>
<tr><td>Material</td><td>-</td><td>${material.name}</td><td>-</td><td><span class="pass-indicator pass">‚úì</span></td></tr>
<tr><td>Wire Diameter</td><td>d</td><td>${inputs.d.toFixed(3)}</td><td>mm</td><td><span class="pass-indicator pass">‚úì</span></td></tr>
<tr><td>Outer Diameter</td><td>D<sub>o</sub></td><td>${inputs.Do.toFixed(3)}</td><td>mm</td><td><span class="pass-indicator pass">‚úì</span></td></tr>
<tr><td>Mean Diameter</td><td>D</td><td>${D.toFixed(3)}</td><td>mm</td><td><span class="pass-indicator pass">‚úì</span></td></tr>
<tr><td>Spring Index</td><td>C</td><td>${C.toFixed(3)}</td><td>-</td><td><span class="pass-indicator ${C >= 4 && C <= 12 ? 'pass' : 'warning'}">${C >= 4 && C <= 12 ? '‚úì' : '‚ö†'}</span></td></tr>
<tr><td>Active Coils</td><td>N<sub>a</sub></td><td>${Na.toFixed(2)}</td><td>coils</td><td><span class="pass-indicator pass">‚úì</span></td></tr>
<tr><td>Total Coils</td><td>N<sub>t</sub></td><td>${Nt.toFixed(2)}</td><td>coils</td><td><span class="pass-indicator pass">‚úì</span></td></tr>
<tr><td>Spring Rate</td><td>k</td><td>${k.toFixed(4)}</td><td>N/mm</td><td><span class="pass-indicator pass">‚úì</span></td></tr>
<tr><td>Free Length</td><td>L<sub>0</sub></td><td>${L0.toFixed(3)}</td><td>mm</td><td><span class="pass-indicator pass">‚úì</span></td></tr>
<tr><td>Solid Height</td><td>L<sub>s</sub></td><td>${Ls.toFixed(3)}</td><td>mm</td><td><span class="pass-indicator pass">‚úì</span></td></tr>
<tr><td>Force at Solid</td><td>F<sub>solid</sub></td><td>${F_solid.toFixed(2)}</td><td>N</td><td><span class="pass-indicator pass">‚úì</span></td></tr>
<tr><td>Max Shear Stress</td><td>œÑ<sub>solid</sub></td><td>${tau_solid.toFixed(2)}</td><td>MPa</td><td><span class="pass-indicator ${tau_solid < Ssy_corrected ? 'pass' : 'fail'}">${tau_solid < Ssy_corrected ? '‚úì' : '‚úó'}</span></td></tr>
<tr><td>Yield Strength</td><td>S<sub>sy</sub></td><td>${Ssy_corrected.toFixed(2)}</td><td>MPa</td><td><span class="pass-indicator pass">‚úì</span></td></tr>
<tr><td>Safety Factor (Solid)</td><td>FS<sub>solid</sub></td><td>${FS_solid.toFixed(2)}</td><td>-</td><td><span class="pass-indicator ${FS_solid >= requiredFS ? 'pass' : (FS_solid >= 1.0 ? 'warning' : 'fail')}">${FS_solid >= requiredFS ? '‚úì' : (FS_solid >= 1.0 ? '‚ö†' : '‚úó')}</span></td></tr>
${inputs.applicationType !== 'static' ? `<tr><td>Fatigue Safety Factor</td><td>FS<sub>fatigue</sub></td><td>${FS_fatigue_goodman ? FS_fatigue_goodman.toFixed(2) : 'N/A'}</td><td>-</td><td><span class="pass-indicator ${FS_fatigue_goodman >= 1.5 ? 'pass' : (FS_fatigue_goodman >= 1.0 ? 'warning' : 'fail')}">${FS_fatigue_goodman >= 1.5 ? '‚úì' : (FS_fatigue_goodman >= 1.0 ? '‚ö†' : '‚úó')}</span></td></tr>` : ''}
<tr><td>Buckling Ratio</td><td>L<sub>0</sub>/L<sub>crit</sub></td><td>${buckling_ratio.toFixed(3)}</td><td>-</td><td><span class="pass-indicator ${buckling_ratio < 1.0 ? 'pass' : (buckling_ratio < 1.5 ? 'warning' : 'fail')}">${buckling_ratio < 1.0 ? '‚úì' : (buckling_ratio < 1.5 ? '‚ö†' : '‚úó')}</span></td></tr>
<tr><td>Surge Frequency</td><td>f<sub>surge</sub></td><td>${f_surge_simple.toFixed(2)}</td><td>Hz</td><td><span class="pass-indicator ${f_surge_simple > freq_fundamental * 15 ? 'pass' : 'warning'}">${f_surge_simple > freq_fundamental * 15 ? '‚úì' : '‚ö†'}</span></td></tr>
</tbody>
</table>`;
const summaryDiv = document.createElement('div');
summaryDiv.innerHTML = summaryHTML;
calculationStepsDiv.appendChild(summaryDiv);


// =====================================================================
// RECOMMENDATIONS
// =====================================================================
let recommendationsHTML = '<ul>';

// Add all passes
if (results.passes.length > 0) {
recommendationsHTML += '<li><strong style="color: var(--success-color);">‚úÖ Successful Checks:</strong><ul>';
results.passes.forEach(pass => { recommendationsHTML += `<li>${pass}</li>`; });
recommendationsHTML += '</ul></li>';
}
// Add all warnings
if (results.warnings.length > 0) {
recommendationsHTML += '<li><strong style="color: var(--warning-color);">‚ö†Ô∏è Warnings (Review Recommended):</strong><ul>';
results.warnings.forEach(warning => { recommendationsHTML += `<li>${warning}</li>`; });
recommendationsHTML += '</ul></li>';
}
// Add all failures
if (results.failures.length > 0) {
recommendationsHTML += '<li><strong style="color: var(--fail-color);">‚ùå Critical Issues (Must Fix):</strong><ul>';
results.failures.forEach(failure => { recommendationsHTML += `<li>${failure}</li>`; });
recommendationsHTML += '</ul></li>';
}

// General recommendations
recommendationsHTML += `
<li><strong>üìê Manufacturing Tolerances:</strong>
<ul><li>Wire diameter tolerance (DIN EN 10218-2): Check standard for specific grade.</li>
<li>Spring rate tolerance (DIN EN 15800): ¬±${(k * 0.10).toFixed(4)} N/mm (Typical ¬±5-10%)</li>
<li>Free length tolerance (DIN 2095): ¬±${(L0 * 0.015).toFixed(2)} mm (Varies with L/D ratio)</li></ul>
</li>
<li><strong>üìã Applicable Standards:</strong>
<ul><li>DIN EN 13906-1 - Helical Compression Springs (Design Calculation)</li>
<li>ISO 2162 - Technical Product Documentation - Springs</li>
<li>DIN 2095 - Helical Compression Springs (Quality Requirements)</li>
</ul>
</li>
<li><strong>üîß Installation Guidelines:</strong>
<ul><li>Clash allowance between L‚ÇÇ and L<sub>s</sub>: ${clash_allowance.toFixed(2)} mm</li>
<li>Max recommended deflection: ${(y_solid * 0.85).toFixed(2)} mm (85% of solid)</li>
<li>Preload force (F‚ÇÅ): ${inputs.F1} N at length ${inputs.L1} mm</li>
${buckling_ratio > 1.0 ? `<li><strong>‚ö†Ô∏è Spring requires guidance:</strong> Install over a rod (Max Rod √ò ‚âà ${(D - inputs.d - 0.5).toFixed(1)} mm) or in a hole (Min Hole √ò ‚âà ${(inputs.Do + 0.5).toFixed(1)} mm)</li>` : ''}
</ul>
</li>
<li><strong>üéØ Optimization Suggestions:</strong>
<ul>
${C < 4 ? '<li>Increase mean diameter or decrease wire diameter to improve spring index.</li>' : ''}
${C > 12 ? '<li>Decrease mean diameter or increase wire diameter to improve spring index.</li>' : ''}
${FS_solid < requiredFS ? '<li>Consider increasing wire diameter, changing material, or reducing operating force.</li>' : ''}
${buckling_ratio > 1.0 ? '<li>Reduce free length, increase mean diameter, or change end type to improve buckling stability.</li>' : ''}
${inputs.applicationType !== 'static' && FS_fatigue_goodman < 1.5 ? '<li>Consider shot peening, set removal, or reducing stress range to improve fatigue life.</li>' : ''}
</ul>
</li>
<li><strong>üî¨ Testing Recommendations:</strong>
<ul><li>Verify spring rate by load testing at 2 points (L‚ÇÅ and L‚ÇÇ)</li>
<li>Measure solid height under compression</li>
<li>Verify free length and squareness (per DIN 2095)</li>
${inputs.applicationType !== 'static' ? '<li>Perform fatigue testing for critical applications (e.g., > 10‚Å∂ cycles)</li>' : ''}
</ul>
</li>`;

recommendationsHTML += '</ul>';
recommendationsDiv.innerHTML = recommendationsHTML;

// Typeset MathJax and show results
if (window.MathJax) {
MathJax.typesetPromise([calculationStepsDiv]).catch((err) => console.error('MathJax error:', err));
}

resultContainer.classList.add('show');
setTimeout(() => {
resultContainer.scrollIntoView({ behavior: 'smooth', block: 'start' });
}, 300);

} catch (error) {
console.error('Calculation error:', error);
displayMessage(`Calculation error: ${error.message}. Please check your inputs and try again.`, 'error');
}
}

// ============================================================================
// HELPER FUNCTION: TEMPERATURE CORRECTION FACTOR
// ============================================================================
function calculateTemperatureFactor(material, temp) {
const T = temp; // Temp in ¬∞C
let shearModulus = 1.0;
let tensileStrength = 1.0;
let enduranceLimit = 1.0;

if (T > 20) {
const tempRise = T - 20;
if (material.name.includes('Inconel')) {
// Inconel maintains strength better at high temp
if (T > 650) { shearModulus = 0.8; tensileStrength = 0.6; }
else if (T > 500) { shearModulus = 0.9; tensileStrength = 0.8; }
else if (T > 300) { shearModulus = 0.95; tensileStrength = 0.9; }
} else if (material.name.includes('Stainless')) {
// Stainless steel
if (T > 250) { shearModulus = 0.85; tensileStrength = 0.8; }
else if (T > 150) { shearModulus = 0.9; tensileStrength = 0.9; }
} else {
// Carbon steel alloys (A228, A227, A229, A231)
if (T > 200) { shearModulus = 0.9; tensileStrength = 0.8; }
else if (T > 100) { shearModulus = 0.95; tensileStrength = 0.95; }
}
// General reduction for fatigue
enduranceLimit = Math.max(0.5, 1.0 - (tempRise * 0.001)); 
} else if (T < -20) {
// Low temperature - slight increase in strength but reduced ductility
shearModulus = 1.02; // Small increase
tensileStrength = 1.05; // Small increase
enduranceLimit = 1.0; // Conservative - no benefit for fatigue
}

// Ensure factors don't go negative or exceed reasonable bounds
shearModulus = Math.max(0.3, Math.min(1.1, shearModulus));
let youngsModulus = shearModulus; // Approximate
tensileStrength = Math.max(0.3, Math.min(1.1, tensileStrength));
enduranceLimit = Math.max(0.3, Math.min(1.0, enduranceLimit));

return {
shearModulus,
youngsModulus,
tensileStrength,
enduranceLimit
};
}

// ============================================================================
// HELPER FUNCTION: ESTIMATE FATIGUE LIFE
// ============================================================================
function estimateFatigueLife(tau_alt, tau_mean, Se, Ssu) {
// Using Basquin's equation: Nf = (Sf / tau_alt)^(1/b)
// where b is the fatigue strength exponent (typically -0.1 to -0.15 for springs)
const b = -0.12; // Typical for spring steels

// Goodman correction for mean stress effect
const tau_eq = tau_alt / (1 - (tau_mean / Ssu));

if (tau_eq <= Se) {
return '> 10<sup>7</sup> cycles (Infinite Life)';
}

// For finite life
// Use S-N curve approximation
const S_f_1000 = 0.9 * Ssu; // Strength at 1000 cycles
const N_f = Math.pow( (tau_eq / S_f_1000) , (1/b) ) * 1000;


if (N_f >= 1e7) return '> 10<sup>7</sup> cycles (Infinite Life)';
else if (N_f >= 1e6) return `~${(N_f / 1e6).toPrecision(2)} √ó 10<sup>6</sup> cycles`;
else if (N_f >= 1e3) return `~${(N_f / 1e3).toPrecision(2)} √ó 10<sup>3</sup> cycles`;
else return `< 1000 cycles (Low cycle fatigue)`;
}


// ============================================================================
// HELPER FUNCTION: ADD CALCULATION STEP
// ============================================================================
function addCalculationStep(step, title, formula, calculation, result) {
const stepContainer = document.createElement('div');
stepContainer.className = 'calculation-step-container';
stepContainer.style.animationDelay = `${step * 0.1}s`;

let content = `<div class="step-header"><span><strong>Step ${step}:</strong> ${title}</span></div>
<div class="step-content">`;

if (formula) { content += `<p class="formula">${formula}</p>`; }
if (calculation) { content += `<div style="margin: 15px 0;">${calculation}</div>`; }
if (result) { content += `<p class="final-result"><strong>Result:</strong> ${result}</p>`; }

content += `</div>`;
stepContainer.innerHTML = content;
calculationStepsDiv.appendChild(stepContainer);
}

// ============================================================================
// HELPER FUNCTION: DISPLAY MESSAGE
// ============================================================================
function displayMessage(message, type = "error") {
const messageBox = document.getElementById('custom-message-box');
messageBox.textContent = message;
messageBox.className = 'show';

if (type === "error") {
messageBox.style.backgroundColor = 'var(--fail-color)';
messageBox.style.color = 'white';
} else if (type === "warning") {
messageBox.style.backgroundColor = 'var(--warning-color)';
messageBox.style.color = 'white';
} else {
messageBox.style.backgroundColor = 'var(--success-color)';
messageBox.style.color = 'white';
}

setTimeout(() => {
messageBox.classList.remove('show');
}, 5000);
}

// ============================================================================
// THEME TOGGLE (From Reynolds File)
// ============================================================================
const themeSwitch = document.getElementById('theme-switch');
const body = document.body;
// Check local storage for theme
const currentTheme = localStorage.getItem('theme');
if (currentTheme === 'dark-mode') {
body.classList.add('dark-mode');
themeSwitch.checked = true;
}

themeSwitch.addEventListener('change', () => {
if (themeSwitch.checked) {
body.classList.add('dark-mode');
localStorage.setItem('theme', 'dark-mode');
} else {
body.classList.remove('dark-mode');
localStorage.setItem('theme', 'light-mode');
}
});
});
</script>
</body>
</html>
