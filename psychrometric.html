<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Psychrometric Calculator - Design Calculators</title>
    <meta name="description" content="Professional Psychrometric Calculator for HVAC engineers. Calculates Dew Point, Wet Bulb, Enthalpy, Humidity Ratio, and Specific Volume. Includes altitude correction and psychrometric chart visualization.">
    <meta name="keywords" content="psychrometric calculator, hvac calculator, dew point, wet bulb, enthalpy, humidity ratio, moist air properties, air conditioning sizing, ashrae">
    <meta name="author" content="Design Calculators">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://designcalculators.co.in/psychrometric" />

    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5936527763614780" crossorigin="anonymous"></script>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-23Y1V450SR"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-23Y1V450SR');
    </script>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Montserrat:wght@700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$']],
                displayMath: [['$$', '$$']]
            },
            svg: { fontCache: 'global' },
            options: {
                processHtmlClass: 'math-content',
                ignoreHtmlClass: 'no-mathjax'
            }
        };
    </script>
    <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">

    <style>
        /* Exact Theme Variables */
        :root {
            --primary: #1E3A8A;
            --secondary: #2563EB;
            --accent: #F59E0B;
            --success: #10B981;
            --danger: #DC2626;
            --warning: #F59E0B;
            --bg: #F8FAFC;
            --card: #FFFFFF;
            --text: #4B5563;
            --heading: #111827;
            --footer-bg: #0F172A;
            --border: #E2E8F0;
            --grad: linear-gradient(135deg, var(--primary), var(--secondary));
            --grad-dark: linear-gradient(135deg, #0F172A, #1E293B);
            --shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
            --shadow-lg: 0 10px 20px rgba(0, 0, 0, 0.1);
            
            --reset-button-bg: var(--accent);
            --reset-button-hover-bg: #DAA520;
            --clear-button-bg: var(--secondary);
            --clear-button-hover-bg: var(--primary);
            
            --ok-color: var(--success);
            --error-color: var(--danger);
            --warning-color: var(--warning);
        }

        /* Dark mode variables */
        body.dark-mode {
            --primary: #10B981;
            --secondary: #34D399;
            --bg: #0F172A;
            --card: #1E293B;
            --text: #CBD5E1;
            --heading: #F1F5F9;
            --footer-bg: #020617;
            --border: #334155;
            
            --reset-button-bg: var(--accent);
            --reset-button-hover-bg: #DAA520;
            --clear-button-bg: var(--secondary);
            --clear-button-hover-bg: var(--primary);
        }

        /* General Body Styling */
        body {
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding: 0;
            background: var(--bg);
            color: var(--text);
            line-height: 1.7;
            transition: background-color 0.3s, color 0.3s;
        }

        .container {
            max-width: 1280px;
            margin: 0 auto;
            padding: 0 24px;
        }

        /* Header styles */
        header {
            background: var(--grad);
            color: white;
            padding: 24px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .logo-container {
            display: flex;
            flex-direction: column;
            text-decoration: none;
            color: white;
        }
        .logo-text {
            font-size: 1.75rem;
            font-weight: 800;
            font-family: 'Montserrat', sans-serif;
        }
        .logo-subtitle {
            font-size: 0.8rem;
            margin: 4px 0 0 0;
            color: #E0E7FF;
            opacity: 0.9;
        }
        .nav-links {
            display: flex;
            gap: 24px;
            list-style: none;
            margin: 0;
            padding: 0;
        }
        .nav-links a {
            color: white;
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s;
        }
        .nav-links a:hover { color: var(--accent); }
        .theme-toggle {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .switch {
            position: relative;
            width: 56px;
            height: 30px;
        }
        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0,0,0,0.2);
            transition: .4s;
            border-radius: 30px;
        }
        .slider:before {
            position: absolute;
            content: "";
            height: 22px;
            width: 22px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        input:checked + .slider {
            background-color: var(--accent);
        }
        input:checked + .slider:before {
            transform: translateX(26px);
        }

        main {
            padding: 40px 0;
        }

        /* Main Card Styling */
        .tool-container {
            background-color: var(--card);
            border-radius: 12px;
            padding: 30px;
            box-shadow: var(--shadow);
            margin-bottom: 30px;
            border: 1px solid var(--border);
            transition: transform 0.3s ease-in-out;
        }

        .tool-container:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }

        .tool-container h2 {
            color: var(--primary);
            border-bottom: 3px solid var(--primary);
            padding-bottom: 15px;
            margin-top: 0;
            margin-bottom: 20px;
            font-family: 'Montserrat', sans-serif;
            font-size: 1.8rem;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .tool-description {
            margin-bottom: 20px;
            color: var(--text);
            font-size: 1.05rem;
        }

        /* Footer styles */
        footer {
            background: var(--grad-dark);
            color: #CBD5E1;
            padding: 50px 0 20px 0;
            margin-top: 60px;
        }
        .footer-content {
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 40px;
            margin-bottom: 30px;
        }
        .footer-col {
            flex: 1;
            min-width: 200px;
        }
        .footer-col h4 {
            color: white;
            margin-bottom: 15px;
            font-weight: 700;
        }
        .footer-col ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        .footer-col a {
            color: #CBD5E1;
            text-decoration: none;
            transition: color 0.3s;
        }
        .footer-col a:hover {
            color: var(--accent);
        }
        .social-buttons {
            display: flex;
            gap: 12px;
            margin-top: 15px;
        }
        .social-btn {
            width: 40px;
            height: 40px;
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            border-radius: 50%;
            font-size: 1.1rem;
            transition: transform 0.3s;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        .social-btn:hover {
            transform: translateY(-4px);
        }
        .social-btn.linkedin { background-color: #0A66C2; }
        .social-btn.youtube { background-color: #FF0000; }
        .social-btn.twitter { background-color: #1DA1F2; }
        .social-btn.facebook { background-color: #1877F2; }
        .social-btn.whatsapp { background-color: #25D366; }
        .footer-disclaimer {
            text-align: center;
            padding-top: 25px;
            border-top: 1px solid #334155;
            max-width: 800px;
            margin: 0 auto;
            font-size: 0.9rem;
        }
        .footer-bottom {
            text-align: center;
            padding-top: 20px;
            font-size: 0.9rem;
            color: #94A3B8;
        }

        /* Forms and Results */
        .calculator-form {
            background-color: var(--card);
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
            box-shadow: none;
        }
        
        .form-section {
            background-color: var(--bg);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 25px;
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.05);
            /* Fixed: Changed opacity from 0 to 1 to ensure visibility */
            opacity: 1;
            transform: translateY(0);
            transition: opacity 0.5s ease-out, transform 0.5s ease-out;
        }

        .form-section h3 {
            color: var(--secondary);
            margin-top: 0;
            margin-bottom: 15px;
            border-bottom: 1px dashed var(--border);
            padding-bottom: 10px;
        }

        .form-group {
            margin-bottom: 15px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--heading);
        }
        
        .form-group input, .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--border);
            border-radius: 6px;
            /* Improved: Changed background from var(--bg) to var(--card) for better contrast */
            background-color: var(--card);
            color: var(--text);
            box-sizing: border-box;
            transition: border-color 0.3s, box-shadow 0.3s;
            font-size: 1rem;
        }
        
        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
        }
        
        /* Buttons */
        .calculate-btn {
            background: var(--grad);
            color: white;
            border: none;
            padding: 16px 30px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: 700;
            margin-top: 25px;
            transition: all 0.3s;
            width: auto;
            min-width: 220px;
            box-shadow: 0 4px 12px rgba(30, 58, 138, 0.3);
            letter-spacing: 0.5px;
            text-transform: uppercase;
        }
        
        .calculate-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(30, 58, 138, 0.4);
        }

        .reset-btn {
            background-color: var(--reset-button-bg);
            color: #333;
            border: none;
            padding: 16px 30px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: 700;
            margin-top: 25px;
            margin-left: 15px;
            transition: all 0.3s;
            width: auto;
            min-width: 150px;
            box-shadow: 0 4px 12px rgba(245, 158, 11, 0.3);
            letter-spacing: 0.5px;
            text-transform: uppercase;
        }

        .reset-btn:hover {
            background-color: var(--reset-button-hover-bg);
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(245, 158, 11, 0.4);
        }

        .clear-results-btn {
            background-color: var(--clear-button-bg);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9em;
            font-weight: 700;
            margin-top: 15px;
            transition: all 0.3s;
            box-shadow: var(--shadow);
        }

        .clear-results-btn:hover {
            background-color: var(--clear-button-hover-bg);
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .result-container {
            margin-top: 30px;
            padding: 30px;
            border-radius: 12px;
            background-color: var(--card);
            box-shadow: var(--shadow);
            border: 1px solid var(--border);
            display: none;
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.5s ease-in-out, transform 0.5s ease-in-out;
        }
        
        .result-container.show {
            opacity: 1;
            transform: translateY(0);
        }

        .result-container h3 {
            color: var(--primary);
            margin-bottom: 20px;
            text-align: center;
            font-family: 'Montserrat', sans-serif;
            font-size: 1.8rem;
        }
        
        .result-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 25px;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: var(--shadow);
        }
        
        .result-table th, .result-table td {
            padding: 16px;
            text-align: left;
            border-bottom: 1px solid var(--border);
            transition: background-color 0.3s;
        }
        
        .result-table th {
            background: var(--grad);
            font-weight: 700;
            color: white;
        }

        .result-table tr:last-child td {
            border-bottom: none;
        }
        
        .result-table tr:nth-child(even) {
            background-color: var(--bg);
        }

        .result-table tbody tr:hover {
            background-color: var(--border);
        }
        
        .result-table td:first-child {
            font-weight: 600;
            color: var(--heading);
        }

        /* Tooltip */
        .tooltip {
            position: relative;
            display: inline-block;
        }
        
        .tooltip .tooltiptext {
            visibility: hidden;
            width: 250px;
            background-color: #333;
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 8px;
            position: absolute;
            z-index: 10;
            bottom: 125%;
            left: 50%;
            margin-left: -125px;
            opacity: 0;
            transition: opacity 0.3s, transform 0.3s;
            transform: translateY(10px);
            font-size: 0.85em;
            font-family: 'Inter', sans-serif;
            line-height: 1.4;
        }
        
        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
            transform: translateY(0);
        }
        
        .info-icon {
            color: var(--primary);
            margin-left: 5px;
            cursor: help;
        }

        /* Message Box */
        #custom-message-box {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            padding: 16px 28px;
            border-radius: 8px;
            box-shadow: 0 6px 16px rgba(0,0,0,0.25);
            z-index: 10000;
            font-weight: 600;
            color: white;
            opacity: 0;
            transition: all 0.4s;
            display: none;
            align-items: center;
            justify-content: center;
            min-width: 250px;
        }
        #custom-message-box.show {
            display: flex;
            opacity: 1;
            top: 30px;
        }

        /* Calculation Steps */
        .steps-container {
            display: none;
            margin-top: 30px;
        }
        .steps-container.active {
            display: block;
        }
        .step-card {
            background: var(--card);
            border-radius: 12px;
            padding: 25px 30px;
            box-shadow: var(--shadow);
            border: 1px solid var(--border);
            animation: slideIn 0.6s ease-out;
            transition: all 0.3s;
            margin-bottom: 25px;
        }
        @keyframes slideIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .step-card h4 {
            color: var(--primary);
            margin: 0 0 20px 0;
            font-size: 1.4rem;
            font-family: 'Montserrat', sans-serif;
            display: flex;
            align-items: center;
        }
        .step-card .number {
            display: inline-block;
            width: 40px;
            height: 40px;
            background: var(--primary);
            color: white;
            border-radius: 50%;
            text-align: center;
            line-height: 40px;
            font-weight: 700;
            margin-right: 15px;
            font-size: 1.3rem;
            flex-shrink: 0;
        }
        .step-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
            align-items: start;
        }
        @media (max-width: 768px) {
            .step-content { grid-template-columns: 1fr; }
        }
        .step-content .formula-block {
            background: var(--bg);
            border-radius: 8px;
            padding: 20px;
            font-size: 1rem;
            border: 1px solid var(--border);
        }
        .step-content .formula {
            background: var(--bg);
            border-left: 3px solid var(--accent);
            padding: 15px;
            margin: 12px 0;
            font-size: 1rem;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            overflow-x: auto;
        }
        .step-value {
            font-size: 2.2rem;
            font-weight: 800;
            color: var(--success);
            margin: 10px 0;
            line-height: 1.2;
        }
        .step-unit {
            font-size: 1rem;
            color: var(--text);
            opacity: 0.8;
            font-weight: 500;
            margin-left: 5px;
        }
        .step-explanation {
            font-size: 1.05rem;
            line-height: 1.8;
        }
        
        .button-wrapper {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 15px;
            width: 100%;
            padding-top: 20px;
        }

        .form-group input:focus, .form-group select:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(30, 58, 138, 0.1);
            outline: none;
        }
        body.dark-mode .form-group input:focus, 
        body.dark-mode .form-group select:focus { 
             box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1);
        }

        /* Psychrometric Chart Visualization */
        .chart-container {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 30px;
            margin-bottom: 20px;
            padding: 20px;
            background-color: var(--bg);
            border-radius: 8px;
            box-shadow: var(--shadow);
            border: 1px solid var(--border);
            flex-direction: column;
            position: relative;
        }
        .chart-container svg {
            width: 100%;
            max-width: 600px;
            height: auto;
            border: 1px solid var(--border);
            border-radius: 5px;
            background-color: var(--card);
        }
        .status-display {
            font-weight: bold;
            font-size: 1.2em;
            margin-top: 15px;
            padding: 10px 20px;
            border-radius: 5px;
            text-align: center;
            width: 80%;
            background-color: var(--secondary);
            color: white;
        }

        /* LONG FORM THEORY STYLES */
        .education-section {
            margin-top: 60px;
            margin-bottom: 60px;
            background: var(--card);
            border-radius: 12px;
            padding: 40px;
            box-shadow: var(--shadow);
            border: 1px solid var(--border);
        }
        
        .education-section h2 {
            color: var(--primary);
            border-bottom: 3px solid var(--primary);
            padding-bottom: 15px;
            margin-top: 0;
            font-family: 'Montserrat', sans-serif;
            font-size: 2rem;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .education-section h3 {
            color: var(--heading);
            margin-top: 40px;
            margin-bottom: 20px;
            font-family: 'Montserrat', sans-serif;
            font-size: 1.5rem;
            border-left: 5px solid var(--accent);
            padding-left: 15px;
        }

        .long-text p {
            font-size: 1.05rem;
            line-height: 1.8;
            margin-bottom: 20px;
            color: var(--text);
            text-align: justify;
        }

        .insight-card, .danger-box, .success-box, .standard-box {
            border-radius: 12px;
            padding: 25px;
            margin: 25px 0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            transition: all 0.3s;
        }
        
        .insight-card {
            background: linear-gradient(135deg, var(--card), rgba(37,99,235,0.03));
            border-left: 5px solid var(--secondary);
        }
        .insight-card:hover { transform: translateX(5px); box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
        
        .danger-box {
            background: linear-gradient(135deg, rgba(220,38,38,0.1), rgba(220,38,38,0.02));
            border-left: 5px solid var(--danger);
        }
        
        .success-box {
            background: linear-gradient(135deg, rgba(16,185,129,0.1), rgba(16,185,129,0.02));
            border-left: 5px solid var(--success);
        }
        
        .standard-box {
            background-color: var(--bg);
            border: 1px solid var(--border);
            border-left: 5px solid var(--primary);
        }

        .insight-card h4, .danger-box h4, .success-box h4, .standard-box h4 {
            margin-top: 0;
            font-size: 1.25rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .insight-card h4 { color: var(--secondary); }
        .danger-box h4 { color: var(--danger); }
        .success-box h4 { color: var(--success); }
        .standard-box h4 { color: var(--primary); }
        
        /* Table Styles for Theory */
        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 25px 0;
            font-size: 0.95rem;
        }
        .comparison-table th, .comparison-table td {
            border: 1px solid var(--border);
            padding: 12px;
            text-align: left;
        }
        .comparison-table th {
            background-color: var(--primary);
            color: white;
        }
        .comparison-table tr:nth-child(even) {
            background-color: var(--bg);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .container { padding: 0 15px; }
            .navbar { flex-direction: column; gap: 20px; }
            .nav-links { flex-direction: column; gap: 12px; text-align: center; }
            .form-row { grid-template-columns: 1fr; }
            .tool-container, .education-section, .result-container { padding: 20px; }
            .footer-content { flex-direction: column; gap: 25px; }
            .long-text p { text-align: left; }
        }
    </style>
</head>
<body>
    <div id="custom-message-box" class="message-box"></div>

    <header>
        <div class="container">
            <nav class="navbar">
                <a class='logo-container' href='/'>
                    <span class="logo-text">Design Calculators</span>
                    <p class="logo-subtitle">Inspired by standards such as IEC, IEEE, ISA, ASME, and API.</p>
                </a>
                <ul class="nav-links">
                    <li><a href='/'>Home</a></li>
                    <li><a href="articles">Articles</a></li>
                    <li><a href="indexmech">Mechanical</a></li>
                    <li><a href="indexele">Electrical</a></li>
                    <li><a href="indexinst">Instrumentation</a></li>
                </ul>
                <div class="theme-toggle">
                    <i class="fas fa-sun"></i>
                    <label class="switch">
                        <input type="checkbox" id="theme-switch">
                        <span class="slider"></span>
                    </label>
                    <i class="fas fa-moon"></i>
                </div>
            </nav>
        </div>
    </header>

    <main class="container">
        <div class="tool-container">
            <h2><i class="fas fa-cloud"></i> Psychrometric Properties Calculator</h2>
            
            <div class="tool-description">
                <p>An essential tool for HVAC engineers to determine state points of moist air. Calculate <strong>Dew Point</strong>, <strong>Wet Bulb</strong>, <strong>Enthalpy</strong>, <strong>Humidity Ratio</strong>, and more. Accurately corrects for <strong>Altitude/Pressure</strong> using ASHRAE Fundamentals logic.</p>
            </div>

            <div class="calculator-form">
                <form id="psych-calculator-form">
                    <div class="form-section">
                        <h3><i class="fas fa-thermometer-half"></i> Air State Conditions</h3>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="tdb">Dry Bulb Temperature ($T_{db}$) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Standard thermometer reading.</span></span></label>
                                <input type="number" id="tdb" step="0.1" value="25" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="second-input-type">Second Variable Type <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Select which property you know.</span></span></label>
                                <select id="second-input-type">
                                    <option value="rh">Relative Humidity (RH %)</option>
                                    <option value="tw">Wet Bulb Temperature ($T_{wb}$)</option>
                                    <option value="tdp">Dew Point Temperature ($T_{dp}$)</option>
                                </select>
                            </div>

                            <div class="form-group" id="input-group-rh">
                                <label for="rh-val">Relative Humidity (%) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Percent saturation.</span></span></label>
                                <input type="number" id="rh-val" step="0.1" value="50" min="0" max="100">
                            </div>

                            <div class="form-group hidden" id="input-group-tw" style="display:none;">
                                <label for="tw-val">Wet Bulb Temperature ($T_{wb}$) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Temperature from a wet-wick thermometer.</span></span></label>
                                <input type="number" id="tw-val" step="0.1" value="18">
                            </div>

                            <div class="form-group hidden" id="input-group-tdp" style="display:none;">
                                <label for="tdp-val">Dew Point Temperature ($T_{dp}$) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Temperature at which condensation begins.</span></span></label>
                                <input type="number" id="tdp-val" step="0.1" value="13">
                            </div>
                        </div>

                        <div style="margin-top: 20px; padding-top:15px; border-top: 1px dashed var(--border);">
                             <div class="form-row">
                                <div class="form-group">
                                    <label for="pressure">Atmospheric Pressure ($P_{atm}$) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Standard sea level is 101325 Pa.</span></span></label>
                                    <div style="display: flex; gap: 10px;">
                                        <input type="number" id="pressure" step="1" value="101325" required>
                                        <select id="pressure-unit" style="width: 120px;">
                                            <option value="pa">Pascals (Pa)</option>
                                            <option value="kpa">kPa</option>
                                            <option value="bar">bar</option>
                                            <option value="psi">psi</option>
                                            <option value="atm">atm</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="altitude">Or Estimate from Altitude (m) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Overwrites pressure field.</span></span></label>
                                    <div style="display: flex; gap: 10px;">
                                        <input type="number" id="altitude" step="10" placeholder="e.g. 0">
                                        <button type="button" id="set-altitude-btn" style="background:var(--secondary); color:white; border:none; padding:0 15px; border-radius:6px; cursor:pointer;">Set</button>
                                    </div>
                                </div>
                             </div>
                        </div>
                    </div>
                    
                    <div class="button-wrapper">
                        <button type="button" id="calculate-btn" class="calculate-btn"><i class="fas fa-calculator"></i> Calculate Properties</button>
                        <button type="button" id="reset-form-btn" class="reset-btn"><i class="fas fa-sync-alt"></i> Reset</button>
                    </div>
                </form>
            </div>
        </div>

        <div id="result-container" class="result-container">
            <h3><i class="fas fa-clipboard-check"></i> Psychrometric Report</h3>
            
            <div class="chart-container">
                <p style="margin-bottom: 25px; font-weight: bold; color: var(--secondary);">Psychrometric Chart Location (Schematic)</p>
                <svg viewBox="0 0 400 300" preserveAspectRatio="xMidYMid meet" id="psych-chart-svg">
                    <line x1="40" y1="260" x2="380" y2="260" stroke="#333" stroke-width="2" /> <line x1="380" y1="260" x2="380" y2="20" stroke="#333" stroke-width="2" /> <text x="210" y="290" font-size="12" text-anchor="middle">Dry Bulb Temperature ($T_{db}$)</text>
                    <text x="390" y="140" font-size="12" text-anchor="middle" transform="rotate(-90, 390, 140)">Humidity Ratio ($W$)</text>

                    <path d="M 40,260 Q 120,250 200,150 T 350,20" fill="none" stroke="#10B981" stroke-width="2" />
                    <text x="150" y="100" font-size="10" fill="#10B981">Saturation Curve (100% RH)</text>

                    <path d="M 60,260 Q 130,255 210,180 T 360,80" fill="none" stroke="#ccc" stroke-dasharray="4,4" /> <path d="M 100,260 Q 160,258 240,220 T 370,160" fill="none" stroke="#ccc" stroke-dasharray="4,4" /> <circle id="chart-point" cx="-10" cy="-10" r="6" fill="var(--danger)" stroke="white" stroke-width="2" />
                    <text id="chart-point-label" x="-20" y="-20" font-size="12" fill="var(--danger)" font-weight="bold"></text>
                </svg>
                <p class="status-display" id="state-summary">State: Undefined</p>
            </div>

            <div id="steps-container" class="steps-container math-content">
                </div>

            <table class="result-table">
                <thead>
                    <tr>
                        <th>Property</th>
                        <th>Value</th>
                        <th>Unit</th>
                    </tr>
                </thead>
                <tbody id="result-table-body">
                    </tbody>
            </table>
            
            <div style="display: flex; justify-content: center; margin-top: 20px;">
                <button type="button" id="clear-results-btn" class="clear-results-btn"><i class="fas fa-times-circle"></i> Clear Results</button>
            </div>
        </div>

        <div id="education-section" class="education-section long-text">
            <h2><i class="fas fa-book-open"></i> The Ultimate Guide to Psychrometrics</h2>
            
            <div class="insight-card">
                <h4><i class="fas fa-info-circle"></i> What is Psychrometrics?</h4>
                <p>Psychrometrics is the field of engineering concerned with the physical and thermodynamic properties of gas-vapor mixtures. In the context of HVAC (Heating, Ventilation, and Air Conditioning), it specifically refers to the study of <strong>Moist Air</strong>—a mixture of dry air and water vapor.</p>
                <p>Understanding these properties is the foundation of designing any air conditioning system. Whether you are cooling a data center, drying pharmaceutical powders, or simply keeping a home comfortable, you are manipulating the state points on the Psychrometric Chart.</p>
            </div>

            <h3>1. The "Big Three" Temperatures</h3>
            <p>Confusing these three temperatures is the most common mistake for students and junior engineers. They are distinct properties that define the state of the air.</p>
            
            <table class="comparison-table">
                <thead>
                    <tr>
                        <th>Property</th>
                        <th>Symbol</th>
                        <th>Definition</th>
                        <th>Measurement</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Dry Bulb</strong></td>
                        <td>$T_{db}$</td>
                        <td>The true thermodynamic temperature of the air. It is a measure of sensible heat only.</td>
                        <td>Standard thermometer or thermocouple.</td>
                    </tr>
                    <tr>
                        <td><strong>Wet Bulb</strong></td>
                        <td>$T_{wb}$</td>
                        <td>The lowest temperature that can be reached by evaporating water into the air adiabatically. It indicates the total heat (enthalpy) of the air.</td>
                        <td>Thermometer with a wet wick over the bulb, exposed to moving air.</td>
                    </tr>
                    <tr>
                        <td><strong>Dew Point</strong></td>
                        <td>$T_{dp}$</td>
                        <td>The temperature at which moisture begins to condense out of the air. It is a direct measure of the absolute amount of water in the air.</td>
                        <td>Chilled mirror hygrometer.</td>
                    </tr>
                </tbody>
            </table>

            <div class="danger-box">
                <h4><i class="fas fa-exclamation-triangle"></i> Why Wet Bulb Matters</h4>
                <p>Wet bulb temperature is critical for <strong>Cooling Towers</strong> and <strong>Evaporative Coolers</strong>. A cooling tower can never cool water below the ambient wet bulb temperature. If the $T_{db}$ is 35°C but the $T_{wb}$ is 28°C, your cooling tower water will likely be around 31°C-32°C. Ignoring $T_{wb}$ leads to undersized cooling equipment.</p>
            </div>

            <h3>2. Enthalpy ($h$): The Energy Content</h3>
            <p>Enthalpy is the total energy content of the moist air, usually expressed in kJ/kg of dry air. It is the sum of two components:</p>
            <ol>
                <li><strong>Sensible Heat:</strong> The energy associated with the temperature of the air and water vapor. ($1.006 \times T$)</li>
                <li><strong>Latent Heat:</strong> The energy stored in the phase change of the water vapor. ($W \times 2501$)</li>
            </ol>
            <div class="math-content standard-box">
                <h4><i class="fas fa-calculator"></i> The Formula</h4>
                <p class="formula">$$h = 1.006 \cdot T_{db} + W \cdot (2501 + 1.86 \cdot T_{db})$$</p>
                <p>Where $W$ is the Humidity Ratio (kg water / kg dry air). Note that the Latent Heat term ($W \times 2501$) is often massive compared to the sensible term. Removing humidity (Latent Cooling) requires significant energy.</p>
            </div>

            <h3>3. Humidity: Relative vs. Absolute</h3>
            <p><strong>Relative Humidity (RH)</strong> tells you how "full" the air is of water vapor compared to how much it <em>could</em> hold at that temperature. It is useful for human comfort (we feel comfortable between 40-60% RH) and material safety.</p>
            <p><strong>Humidity Ratio ($W$)</strong>, also called Specific Humidity, is the actual mass of water in the air (kg of water per kg of dry air). It is useful for calculations. When air is heated or cooled sensibly (without adding/removing water), RH changes drastically, but $W$ stays constant.</p>

            <h3>4. The Altitude Effect</h3>
            <div class="success-box">
                <h4><i class="fas fa-arrow-up"></i> Pressure Changes Everything</h4>
                <p>Standard psychrometric charts are plotted at Sea Level (101.325 kPa). If you are designing for Denver, Johannesburg, or Mexico City, you <strong>cannot</strong> use a standard chart.</p>
                <p>As altitude increases, atmospheric pressure ($P_{atm}$) decreases. For a given temperature and humidity ratio, moist air at high altitude has a <strong>higher specific volume</strong> (it's less dense). This affects fan sizing and coil performance significantly. This calculator automatically corrects for pressure using the ideal gas relationships.</p>
            </div>

            <h3>5. Practical Application: Cooling Load</h3>
            <p>To calculate the cooling capacity required to cool air from State 1 to State 2:</p>
            <p class="formula">$$Q_{total} = \dot{m} \times (h_1 - h_2)$$</p>
            <p>Where $\dot{m}$ is the mass flow rate of air. This total load ($Q_{total}$) can be split into Sensible and Latent loads:</p>
            <ul>
                <li><strong>Sensible Load ($Q_s$):</strong> $1.2 \times L/s \times \Delta T$ (Approx at Sea Level)</li>
                <li><strong>Latent Load ($Q_l$):</strong> $3010 \times L/s \times \Delta W$ (Approx at Sea Level)</li>
            </ul>
        </div>
    </main>

    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-col">
                    <h4>Design Calculators</h4>
                    <p style="font-size: 0.9rem; line-height: 1.6; margin-bottom: 15px;">If you find this tool helpful, please consider sharing it with your colleagues!</p>
                    <div class="social-buttons">
                        <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://designcalculators.co.in" target="_blank" rel="noopener noreferrer" class="social-btn linkedin" title="LinkedIn"><i class="fab fa-linkedin-in"></i></a>
                        <a href="https://www.youtube.com/@designcalculators" target="_blank" rel="noopener noreferrer" class="social-btn youtube" title="YouTube"><i class="fab fa-youtube"></i></a>
                        <a href="https://twitter.com/intent/tweet?url=https://designcalculators.co.in" target="_blank" rel="noopener noreferrer" class="social-btn twitter" title="Twitter"><i class="fab fa-twitter"></i></a>
                        <a href="https://www.facebook.com/sharer/sharer.php?u=https://designcalculators.co.in" target="_blank" rel="noopener noreferrer" class="social-btn facebook" title="Facebook"><i class="fab fa-facebook-f"></i></a>
                        <a href="https://api.whatsapp.com/send?text=Check%20out%20this%20amazing%20engineering%20resource%20https://designcalculators.co.in" target="_blank" rel="noopener noreferrer" class="social-btn whatsapp" title="WhatsApp"><i class="fab fa-whatsapp"></i></a>
                    </div>
                </div>
                <div class="footer-col">
                    <h4>Quick Links</h4>
                    <ul>
                        <li><a href='/'>Home</a></li>
                        <li><a href="indexele">Electrical</a></li>
                        <li><a href="indexmech">Mechanical</a></li>
                        <li><a href="indexinst">Instrumentation</a></li>
                    </ul>
                </div>
                <div class="footer-col">
                    <h4>Resources</h4>
                    <ul>
                        <li><a href="about">About Us</a></li>
                        <li><a href="contact">Contact</a></li>
                        <li><a href="faq">FAQ</a></li>
                        <li><a href="privacy-policy">Privacy Policy</a></li>
                        <li><a href="terms-of-service">Terms of Service</a></li>
                    </ul>
                </div>
                <div class="footer-col">
                    <h4>More</h4>
                    <ul>
                        <li><a href='/articles'>Articles & Whitepapers</a></li>
                        <li><a href='/sitemap2'>Sitemap</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-disclaimer">
                <p>This tool offers general guidance. Results should be reviewed for accuracy and compliance with relevant project standards and regulations before use.</p>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 Design Calculators. Created by <span style="color: var(--secondary); font-weight: bold;">A Sharma</span>. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // --- Elements ---
            const tdbInput = document.getElementById('tdb');
            const secondInputType = document.getElementById('second-input-type');
            
            const groupRh = document.getElementById('input-group-rh');
            const groupTw = document.getElementById('input-group-tw');
            const groupTdp = document.getElementById('input-group-tdp');
            
            const rhInput = document.getElementById('rh-val');
            const twInput = document.getElementById('tw-val');
            const tdpInput = document.getElementById('tdp-val');
            
            const pressureInput = document.getElementById('pressure');
            const pressureUnitSelect = document.getElementById('pressure-unit');
            const altitudeInput = document.getElementById('altitude');
            const setAltitudeBtn = document.getElementById('set-altitude-btn');
            
            const calculateBtn = document.getElementById('calculate-btn');
            const resetFormBtn = document.getElementById('reset-form-btn');
            const clearResultsBtn = document.getElementById('clear-results-btn');
            
            const resultContainer = document.getElementById('result-container');
            const stepsContainer = document.getElementById('steps-container');
            const resultTableBody = document.getElementById('result-table-body');
            
            const chartPoint = document.getElementById('chart-point');
            const chartPointLabel = document.getElementById('chart-point-label');
            const stateSummary = document.getElementById('state-summary');

            // --- Toggle Inputs ---
            secondInputType.addEventListener('change', function() {
                groupRh.style.display = 'none';
                groupTw.style.display = 'none';
                groupTdp.style.display = 'none';
                
                if(this.value === 'rh') groupRh.style.display = 'block';
                else if(this.value === 'tw') groupTw.style.display = 'block';
                else if(this.value === 'tdp') groupTdp.style.display = 'block';
            });

            // --- Altitude Helper ---
            setAltitudeBtn.addEventListener('click', function() {
                const h = parseFloat(altitudeInput.value);
                if (!isNaN(h)) {
                    // Standard Atmosphere: P = 101325 * (1 - 2.25577e-5 * h)^5.25588
                    const P_pa = 101325 * Math.pow((1 - 2.25577e-5 * h), 5.25588);
                    
                    // Update Pressure Input based on selected unit
                    const unit = pressureUnitSelect.value;
                    let val = P_pa;
                    if(unit === 'kpa') val = P_pa / 1000;
                    if(unit === 'bar') val = P_pa / 100000;
                    if(unit === 'psi') val = P_pa / 6894.76;
                    if(unit === 'atm') val = P_pa / 101325;
                    
                    pressureInput.value = val.toFixed(2);
                    displayMessage(`Pressure set for ${h}m altitude.`, "info");
                }
            });

            // --- Calculation Engine ---
            
            // 1. Saturation Pressure (Tetens Equation) - Returns Pa
            function getSatVapPres(T_c) {
                if (T_c >= 0) {
                    return 610.78 * Math.exp((17.27 * T_c) / (T_c + 237.3));
                } else {
                    return 610.78 * Math.exp((21.875 * T_c) / (T_c + 265.5));
                }
            }

            // 2. Inverse Tetens (Get T from P_sat) - Returns C
            function getDewPointFromPvap(Pv_pa) {
                // T = (237.3 * ln(Pv/610.78)) / (17.27 - ln(Pv/610.78))
                // Check bounds
                if (Pv_pa <= 0) return -273.15;
                const lnP = Math.log(Pv_pa / 610.78);
                return (237.3 * lnP) / (17.27 - lnP);
            }

            // 3. Wet Bulb Iteration (Bisection Method)
            function calculateTwFromTdbAndPv(Tdb, Pv, Patm) {
                // Goal: Find Tw such that the psychrometric eq matches Pv
                // Pv = Psat(Tw) - Patm * A * (Tdb - Tw)
                // Where A is psychrometric constant approx 0.000666 (degC^-1)
                
                let low = -100;
                let high = Tdb;
                let Tw_guess = Tdb;
                
                for(let i=0; i<50; i++) {
                    Tw_guess = (low + high) / 2;
                    const Psat_Tw = getSatVapPres(Tw_guess);
                    // Standard Carrier equation coeff for A (approx 6.66e-4)
                    const Pv_calc = Psat_Tw - Patm * 0.000666 * (Tdb - Tw_guess);
                    
                    if (Math.abs(Pv_calc - Pv) < 0.1) break; // Precision threshold
                    
                    if (Pv_calc > Pv) {
                        high = Tw_guess; // Need lower Psat, so lower Tw
                    } else {
                        low = Tw_guess;
                    }
                }
                return Tw_guess;
            }

            function solvePsych() {
                // Inputs
                const Tdb = parseFloat(tdbInput.value);
                const pVal = parseFloat(pressureInput.value);
                const pUnit = pressureUnitSelect.value;
                
                // Convert P to Pa
                let Patm = 101325;
                if(pUnit === 'pa') Patm = pVal;
                if(pUnit === 'kpa') Patm = pVal * 1000;
                if(pUnit === 'bar') Patm = pVal * 100000;
                if(pUnit === 'psi') Patm = pVal * 6894.76;
                if(pUnit === 'atm') Patm = pVal * 101325;

                const mode = secondInputType.value;
                let Pv = 0; // Partial vapor pressure (Pa)
                let Tw_final = 0;
                let Tdp_final = 0;
                let RH_final = 0;

                // Calculate Pv based on input mode
                const Psat_db = getSatVapPres(Tdb);

                if (mode === 'rh') {
                    RH_final = parseFloat(rhInput.value);
                    Pv = Psat_db * (RH_final / 100);
                    Tdp_final = getDewPointFromPvap(Pv);
                    Tw_final = calculateTwFromTdbAndPv(Tdb, Pv, Patm);
                } 
                else if (mode === 'tdp') {
                    Tdp_final = parseFloat(tdpInput.value);
                    if (Tdp_final > Tdb) { displayMessage("Dew point cannot be higher than Dry Bulb", "error"); return; }
                    Pv = getSatVapPres(Tdp_final);
                    RH_final = (Pv / Psat_db) * 100;
                    Tw_final = calculateTwFromTdbAndPv(Tdb, Pv, Patm);
                } 
                else if (mode === 'tw') {
                    Tw_final = parseFloat(twInput.value);
                    if (Tw_final > Tdb) { displayMessage("Wet bulb cannot be higher than Dry Bulb", "error"); return; }
                    
                    const Psat_wb = getSatVapPres(Tw_final);
                    // Pv = Psat_wb - Patm * A * (Tdb - Tw)
                    Pv = Psat_wb - Patm * 0.000666 * (Tdb - Tw_final);
                    
                    RH_final = (Pv / Psat_db) * 100;
                    Tdp_final = getDewPointFromPvap(Pv);
                }

                // Bound checks
                if(RH_final > 100) RH_final = 100; // Physical limit
                if(RH_final < 0) RH_final = 0;

                // Derived Properties
                // Humidity Ratio W (kg/kg) = 0.62198 * Pv / (Patm - Pv)
                const W = 0.62198 * Pv / (Patm - Pv);
                
                // Enthalpy h (kJ/kg) = 1.006*Tdb + W*(2501 + 1.86*Tdb)
                const h = 1.006 * Tdb + W * (2501 + 1.86 * Tdb);
                
                // Specific Volume v (m3/kg) = (Ra * T) / P
                // Ra for moist air approx 287.058 (1 + 1.6078 W) / (1 + W) -- standard approx:
                // v = (Ra * T_kelvin * (1 + 1.6078 * W)) / Patm 
                const T_kelvin = Tdb + 273.15;
                const v = (287.058 * T_kelvin * (1 + 1.6078 * W)) / Patm;

                // --- Display Results ---
                resultTableBody.innerHTML = '';
                addResultRow("Dry Bulb Temperature ($T_{db}$)", Tdb.toFixed(2), "°C");
                addResultRow("Wet Bulb Temperature ($T_{wb}$)", Tw_final.toFixed(2), "°C");
                addResultRow("Dew Point Temperature ($T_{dp}$)", Tdp_final.toFixed(2), "°C");
                addResultRow("Relative Humidity (RH)", RH_final.toFixed(1), "%");
                addResultRow("Humidity Ratio ($W$)", W.toFixed(5), "kg/kg"); // High precision needed
                addResultRow("Specific Enthalpy ($h$)", h.toFixed(2), "kJ/kg");
                addResultRow("Specific Volume ($v$)", v.toFixed(3), "m³/kg");
                addResultRow("Vapor Pressure ($P_v$)", Pv.toFixed(0), "Pa");

                // --- Update Chart ---
                updateChart(Tdb, W);
                
                // --- Update Steps ---
                renderSteps(Tdb, Patm, Pv, W, h);

                resultContainer.style.display = 'block';
                setTimeout(() => {
                    resultContainer.classList.add('show');
                }, 10);
            }

            function updateChart(T, W) {
                // Map T (0 to 50) to X (40 to 380)
                // Map W (0 to 0.030) to Y (260 to 20)
                const xMin = 0, xMax = 50;
                const yMin = 0, yMax = 0.030;
                
                const svgW = 340; // 380-40
                const svgH = 240; // 260-20
                
                let px = 40 + ((T - xMin) / (xMax - xMin)) * svgW;
                let py = 260 - ((W - yMin) / (yMax - yMin)) * svgH;
                
                // Constraints
                if(px < 40) px = 40; if(px > 380) px = 380;
                if(py < 20) py = 20; if(py > 260) py = 260;

                chartPoint.setAttribute('cx', px);
                chartPoint.setAttribute('cy', py);
                
                chartPointLabel.setAttribute('x', px + 10);
                chartPointLabel.setAttribute('y', py - 10);
                chartPointLabel.textContent = `(${T.toFixed(1)}°C, ${(W*1000).toFixed(1)}g)`;
                
                stateSummary.textContent = `State Point: ${T.toFixed(1)}°C Tdb / ${(W*1000).toFixed(2)} g/kg Moisture`;
            }

            function renderSteps(Tdb, Patm, Pv, W, h) {
                let html = '';
                
                html += `<div class="step-card">
                    <h4><span class="number">1</span>Vapor Pressure ($P_v$)</h4>
                    <div class="step-explanation">
                        <p>Based on the inputs, the partial pressure of water vapor is determined.</p>
                        <div class="formula-block">
                            $$P_v = ${Pv.toFixed(1)} \\text{ Pa}$$
                        </div>
                        <p>Saturation Pressure at ${Tdb}°C is approx ${getSatVapPres(Tdb).toFixed(1)} Pa.</p>
                    </div>
                </div>`;
                
                html += `<div class="step-card math-content">
                    <h4><span class="number">2</span>Humidity Ratio ($W$)</h4>
                    <div class="step-content">
                        <div class="step-explanation">
                            <p>Mass of water per mass of dry air.</p>
                            <div class="formula-block">
                                $$W = 0.62198 \\times \\frac{P_v}{P_{atm} - P_v}$$
                                $$W = 0.62198 \\times \\frac{${Pv.toFixed(0)}}{${Patm.toFixed(0)} - ${Pv.toFixed(0)}} = \\mathbf{${W.toFixed(5)}}$$
                            </div>
                        </div>
                    </div>
                </div>`;
                
                html += `<div class="step-card math-content">
                    <h4><span class="number">3</span>Specific Enthalpy ($h$)</h4>
                    <div class="step-explanation">
                        <p>Total energy (Sensible + Latent).</p>
                        <div class="formula-block">
                            $$h = 1.006 T_{db} + W(2501 + 1.86 T_{db})$$
                            $$h = 1.006(${Tdb}) + ${W.toFixed(4)}(2501 + 1.86(${Tdb})) = \\mathbf{${h.toFixed(2)} \\text{ kJ/kg}}$$
                        </div>
                    </div>
                </div>`;

                stepsContainer.innerHTML = html;
                stepsContainer.classList.add('active');
                
                if (window.MathJax) {
                    window.MathJax.typesetPromise([stepsContainer]);
                }
            }

            function addResultRow(label, value, unit) {
                const row = resultTableBody.insertRow();
                row.insertCell().innerHTML = `<strong>${label}</strong>`;
                row.insertCell().innerHTML = value;
                row.insertCell().innerHTML = unit;
            }

            function displayMessage(msg, type) {
                const box = document.getElementById('custom-message-box');
                box.textContent = msg;
                box.className = `message-box ${type === 'error' ? 'error' : ''} show`;
                
                if (type === "error") {
                    box.style.backgroundColor = 'var(--danger)';
                    box.style.color = 'white';
                } else {
                    box.style.backgroundColor = 'var(--success)';
                    box.style.color = 'white';
                }
                
                setTimeout(() => box.classList.remove('show'), 3000);
            }

            // --- Init ---
            calculateBtn.addEventListener('click', solvePsych);
            resetFormBtn.addEventListener('click', () => {
                document.getElementById('psych-calculator-form').reset();
                resultContainer.style.display = 'none';
            });
            clearResultsBtn.addEventListener('click', () => {
                resultContainer.style.display = 'none';
            });
            
            // Theme toggle logic (inherited)
            const themeSwitch = document.getElementById('theme-switch');
            if (themeSwitch) {
                if (localStorage.getItem('theme') === 'dark') {
                    document.body.classList.add('dark-mode');
                    themeSwitch.checked = true;
                }
                themeSwitch.addEventListener('change', function() {
                    if (this.checked) {
                        document.body.classList.add('dark-mode');
                        localStorage.setItem('theme', 'dark');
                    } else {
                        document.body.classList.remove('dark-mode');
                        localStorage.setItem('theme', 'light');
                    }
                });
            }
        });
    </script>
</body>
</html>
