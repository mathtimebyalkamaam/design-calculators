<!DOCTYPE html>
<html lang="en">    
<head>
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5936527763614780"
     crossorigin="anonymous"></script>
                <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-23Y1V450SR"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-23Y1V450SR');   
   </script>
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5936527763614780"
     crossorigin="anonymous"></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Neutral Earth Fault Current - Design Calculators - Electrical</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- MathJax for LaTeX rendering -->
    <script type="text/javascript" id="MathJax-script" async
        src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
    </script>
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="icon" href="/favicon.ico" type="image/x-icon">

    <style>
        /* Basic CSS Variables for a consistent theme (Blue-based) */
        :root {
            --primary-color: #007bff; /* Blue */
            --secondary-color: #0056b3; /* Darker Blue */
            --accent-color: #28a745; /* Green for success/highlight */
            --bg-color: #f8f9fa; /* Light background */
            --card-bg: #ffffff; /* White card background */
            --text-color: #343a40; /* Dark grey text */
            --header-bg: #2C3E50; /* Dark Blue Grey */
            --footer-bg: #212529; /* Even darker footer */
            --border-color: #dee2e6;
            --card-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15);
            --hover-color: #e9ecef;
            --input-bg: #ffffff;
            --input-border: #ced4da;
            --button-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            --form-row-gap: 25px; /* Consistent gap */
        }

        /* Dark Mode Variables */
        body.dark-mode {
            --primary-color: #66b3ff; /* Lighter Blue for dark mode */
            --secondary-color: #3385ff;
            --accent-color: #2ecc71; /* Green */
            --bg-color: #2c3e50; /* Dark blue-grey */
            --card-bg: #34495e; /* Slightly lighter dark blue-grey */
            --text-color: #ecf0f1; /* Light text */
            --header-bg: #2c3e50;
            --footer-bg: #2c3e50;
            --border-color: #4a627a;
            --card-shadow: 0 0.5rem 1.5rem rgba(0, 0, 0, 0.4);
            --hover-color: #4a627a;
            --input-bg: #4a627a;
            --input-border: #6c88a4;
            --button-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        }

        /* General Body Styling */
        body {
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding: 0;
            background-color: var(--bg-color);
            color: var(--text-color);
            line-height: 1.6;
            transition: background-color 0.5s ease-in-out, color 0.5s ease-in-out;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .container {
            max-width: 960px;
            margin: 0 auto;
            padding: 20px;
            width: 100%;
            box-sizing: border-box;
        }

        header {
            background-color: var(--header-bg);
            color: white;
            padding: 25px 0;
            text-align: center;
            box-shadow: var(--card-shadow);
            position: relative;
            animation: fadeInDown 1s ease-out;
        }

        header h1 {
            margin: 0;
            font-size: 2.8em;
            color: var(--primary-color);
            letter-spacing: 1px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
        }

        header .subtitle {
            margin: 5px 0 0;
            font-size: 1.1em;
            color: #bdc3c7;
        }

        main {
            flex: 1;
            padding: 30px 0;
            animation: fadeInUp 1s ease-out 0.3s forwards;
            opacity: 0; /* Start hidden for animation */
        }

        .tool-container {
            background-color: var(--card-bg);
            border-radius: 12px;
            padding: 30px;
            box-shadow: var(--card-shadow);
            margin-bottom: 20px;
            border: 1px solid var(--border-color);
            transition: transform 0.3s ease-in-out, box-shadow 0.3s ease-in-out;
        }

        .tool-container:hover {
            transform: translateY(-5px);
            box-shadow: 0 0.75rem 1.5rem rgba(0, 0, 0, 0.2);
        }

        .tool-container h2 {
            color: var(--primary-color);
            border-bottom: 2px solid var(--primary-color);
            padding-bottom: 15px;
            margin-top: 0;
            margin-bottom: 25px;
            font-size: 2em;
            text-align: center;
        }

        .tool-description {
            margin-bottom: 30px;
            color: var(--text-color);
            font-size: 1.1em;
            text-align: justify;
        }

        .back-button {
            display: inline-flex;
            align-items: center;
            background-color: var(--primary-color);
            color: white;
            padding: 12px 20px;
            border-radius: 8px;
            text-decoration: none;
            margin-bottom: 25px;
            transition: background-color 0.3s ease-in-out, transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
            font-weight: bold;
            box-shadow: var(--button-shadow);
        }

        .back-button i {
            margin-right: 8px;
        }

        .back-button:hover {
            background-color: var(--secondary-color);
            transform: translateY(-2px);
            box-shadow: 0 6px 10px rgba(0, 0, 0, 0.2);
        }

        /* Theme Toggle */
        .theme-toggle {
            position: absolute;
            top: 25px;
            right: 25px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .theme-toggle .light-icon,
        .theme-toggle .dark-icon {
            color: white;
            font-size: 1.3em;
            transition: color 0.3s ease-in-out;
        }

        .switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 34px;
        }

        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 34px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 26px;
            width: 26px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .slider {
            background-color: var(--primary-color);
        }

        input:focus + .slider {
            box-shadow: 0 0 1px var(--primary-color);
        }

        input:checked + .slider:before {
            transform: translateX(26px);
        }

        /* Footer Styling */
        footer {
            background-color: var(--footer-bg);
            color: white;
            padding: 30px 0;
            text-align: center;
            box-shadow: 0 -0.5rem 1rem rgba(0, 0, 0, 0.15);
            margin-top: 40px;
            animation: fadeInUp 1s ease-out 0.5s forwards;
            opacity: 0; /* Start hidden for animation */
        }
        
        footer .container {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-around;
            align-items: flex-start;
            gap: 20px;
        }

        footer .disclaimer, footer .social-share, footer .credit {
            flex: 1 1 280px;
            padding: 15px;
            border-radius: 8px;
            background-color: rgba(255, 255, 255, 0.05);
            box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.1);
        }

        footer .disclaimer h3, footer .social-share h3, footer .credit h3 {
            color: var(--primary-color);
            margin-bottom: 15px;
            font-size: 1.4em;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            padding-bottom: 10px;
        }
        footer .credit p {
            font-size: 0.95em;
            color: #bdc3c7;
            margin: 10px 0;
        }

        footer .disclaimer p {
            font-size: 0.95em;
            color: #bdc3c7;
        }

        .social-buttons {
            margin-top: 20px;
            display: flex;
            justify-content: center;
            gap: 12px;
        }

        .social-btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 45px;
            height: 45px;
            border-radius: 50%;
            color: white;
            text-decoration: none;
            font-size: 1.4em;
            transition: transform 0.3s ease-in-out, box-shadow 0.3s ease-in-out, background-color 0.3s ease-in-out;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .social-btn:hover {
            transform: translateY(-5px) scale(1.1);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
        }

        .social-btn.linkedin { background-color: #0A66C2; }
        .social-btn.facebook { background-color: #1877F2; }
        .social-btn.twitter { background-color: #1DA1F2; }
        .social-btn.whatsapp { background-color: #25D366; }
        .social-btn.reddit { background-color: #FF4500; }

        /* Styles for Calculator Forms and Results */
        .calculator-form {
            background-color: var(--card-bg);
            border-radius: 12px;
            padding: 30px;
            margin-top: 25px;
            box-shadow: var(--card-shadow);
            border: 1px solid var(--border-color);
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: var(--text-color);
            font-size: 1.05em;
        }
        
        .form-group input, .form-group select {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--input-border);
            border-radius: 6px;
            background-color: var(--input-bg);
            color: var(--text-color);
            box-sizing: border-box;
            font-size: 1em;
            transition: border-color 0.3s ease-in-out, box-shadow 0.3s ease-in-out;
        }

        .form-group input:focus, .form-group select:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25); /* Blue shadow for focus */
            outline: none;
        }
        
        .form-row {
            display: flex;
            gap: var(--form-row-gap);
            flex-wrap: wrap;
        }
        
        .form-row .form-group {
            flex: 1 1 calc(50% - (var(--form-row-gap) / 2));
            min-width: 250px; /* Ensure minimum width for smaller screens */
            box-sizing: border-box;
        }
        
        .calculate-btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: bold;
            margin-top: 20px;
            transition: background-color 0.3s ease-in-out, transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
            box-shadow: var(--button-shadow);
            width: auto;
            display: block;
            margin-left: auto;
            margin-right: auto;
        }
        
        .calculate-btn:hover {
            background-color: var(--secondary-color);
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.25);
        }

        .calculate-btn:active {
            transform: translateY(0);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.15);
        }
        
        .result-container {
            margin-top: 40px;
            padding: 30px;
            border-radius: 12px;
            background-color: var(--card-bg);
            box-shadow: var(--card-shadow);
            display: none; /* Hidden by default */
            opacity: 0; /* Start hidden for animation */
            transition: opacity 0.6s ease-out; /* Only opacity transition */
            border: 1px solid var(--border-color);
        }
        
        .result-container.show {
            opacity: 1;
        }

        .result-container h3 {
            color: var(--primary-color);
            margin-bottom: 20px;
            font-size: 1.8em;
            text-align: center;
            border-bottom: 2px solid var(--primary-color);
            padding-bottom: 10px;
        }
        
        .result-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            border-radius: 8px;
            overflow: hidden; /* Ensures rounded corners on table */
        }
        
        .result-table th, .result-table td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
        }
        
        .result-table th {
            background-color: var(--hover-color);
            font-weight: bold;
            color: var(--primary-color);
            text-transform: uppercase;
            font-size: 0.95em;
        }

        .result-table tbody tr:nth-child(even) {
            background-color: rgba(0, 0, 0, 0.02);
        }

        .result-table tbody tr:hover {
            background-color: var(--hover-color);
            transition: background-color 0.3s ease-in-out;
        }
        
        .standard-reference {
            margin-top: 25px;
            font-style: italic;
            font-size: 0.95rem;
            background-color: var(--hover-color);
            padding: 15px;
            border-radius: 8px;
            border: 1px dashed var(--primary-color);
            color: var(--text-color);
        }
        
        .info-icon {
            color: var(--primary-color);
            margin-left: 8px;
            cursor: help;
            font-size: 0.9em;
            transition: transform 0.2s ease-in-out;
        }

        .info-icon:hover {
            transform: scale(1.2);
        }
        
        .tooltip {
            position: relative;
            display: inline-block;
        }
        
        .tooltip .tooltiptext {
            visibility: hidden;
            width: 250px;
            background-color: #333;
            color: #fff;
            text-align: center;
            border-radius: 8px;
            padding: 10px;
            position: absolute;
            z-index: 10;
            bottom: 125%;
            left: 50%;
            margin-left: -125px;
            opacity: 0;
            transition: opacity 0.3s ease-in-out;
            font-size: 0.85em;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        
        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }

        /* Custom message box style */
        #custom-message-box {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            padding: 15px 25px;
            border-radius: 8px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
            z-index: 1000;
            font-weight: bold;
            color: white;
            opacity: 0;
            transition: opacity 0.5s ease-in-out, background-color 0.3s ease-in-out;
            display: none;
            min-width: 250px;
            text-align: center;
        }

        /* Styles for calculation details */
        #calculation-details {
            background-color: var(--hover-color);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 25px;
            font-size: 0.95em;
            box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.05);
        }
        #calculation-details h4 {
            color: var(--secondary-color);
            margin-top: 0;
            margin-bottom: 15px;
            font-size: 1.3em;
            text-align: center;
        }
        #calculation-details p.formula {
            font-family: 'Times New Roman', serif;
            font-style: italic;
            font-size: 1.2em;
            text-align: center;
            padding: 12px 0;
            background-color: var(--hover-color);
            border-radius: 6px;
            margin: 15px 0;
            overflow-x: auto;
            border: 1px dashed var(--primary-color);
        }
        #calculation-details p.calculation-step {
            font-family: 'Courier New', monospace;
            background-color: var(--hover-color);
            padding: 8px 15px;
            border-radius: 5px;
            margin-bottom: 8px;
            border-left: 4px solid var(--accent-color);
        }
        #calculation-details ul {
            list-style-type: none;
            padding-left: 0;
            margin-top: 15px;
        }
        #calculation-details ul li {
            margin-bottom: 8px;
            padding-left: 25px;
            position: relative;
        }
        #calculation-details ul li::before {
            content: "\f058"; /* FontAwesome check-circle icon */
            font-family: "Font Awesome 5 Free";
            font-weight: 900;
            color: var(--accent-color);
            position: absolute;
            left: 0;
            top: 0;
        }

        /* Animations */
        @keyframes fadeInDown {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Animation for input group visibility change */
        .form-row.hidden-input {
            opacity: 0;
            height: 0;
            overflow: hidden;
            transition: opacity 0.5s ease-out, height 0.5s ease-out;
            margin-bottom: 0 !important; /* Override margin for smooth collapse */
        }
        .form-row:not(.hidden-input) {
            opacity: 1;
            height: auto; /* Or a specific max-height if content is variable */
            transition: opacity 0.5s ease-out, height 0.5s ease-out;
        }


        /* Responsive adjustments */
        @media (max-width: 768px) {
            header h1 {
                font-size: 2em;
            }
            header .subtitle {
                font-size: 0.9em;
            }
            .theme-toggle {
                position: static;
                justify-content: center;
                margin-top: 15px;
            }
            .tool-container, .calculator-form, .result-container {
                padding: 20px;
            }
            .tool-container h2 {
                font-size: 1.6em;
            }
            .form-row {
                flex-direction: column;
                gap: 0;
            }
            .form-row .form-group {
                flex: 1 1 100%;
                min-width: unset;
            }
            .back-button {
                width: 100%;
                justify-content: center;
            }
            footer .container {
                flex-direction: column;
                align-items: center;
            }
            footer .disclaimer, footer .social-share, footer .credit {
                flex: 1 1 100%;
                width: 100%;
            }
        }

        @media (max-width: 480px) {
            .container {
                padding: 15px;
            }
            header {
                padding: 15px 0;
            }
            header h1 {
                font-size: 1.8em;
            }
            .back-button {
                padding: 10px 15px;
                font-size: 0.9em;
            }
            .calculate-btn {
                padding: 12px 20px;
                font-size: 1em;
            }
            .result-table th, .result-table td {
                padding: 10px;
                font-size: 0.9em;
            }
            .tooltip .tooltiptext {
                width: 180px;
                margin-left: -90px;
                font-size: 0.8em;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <h1>Design Calculators - Electrical</h1>
            <p class="subtitle">Electrical Calculations Made Easy â€” Learn with Every Step</p>
            <div class="theme-toggle">
                <span class="light-icon"><i class="fas fa-sun"></i></span>
                <label class="switch">
                    <input type="checkbox" id="theme-switch">
                    <span class="slider round"></span>
                </label>
                <span class="dark-icon"><i class="fas fa-moon"></i></span>
            </div>
        </div>
    </header>

    <main class="container">
        <a href="indexEle.html" class="back-button"><i class="fas fa-arrow-left"></i> Back to Tools</a>
        
        <div class="tool-container">
            <h2>Neutral Earth Fault Current Calculator</h2>
            
            <div class="tool-description">
                <p>This calculator determines the neutral earth fault current for three common earthing systems: Solidly Earthed, Resistive Earthed, and Isolated/Unearthed systems. Accurate calculation of earth fault currents is crucial for the proper design of earthing systems, selection of protective devices, and ensuring safety in electrical installations. This tool adheres to fundamental principles outlined in international standards such as **IEC 60364 (Low-voltage electrical installations)**, **IEEE Std 80 (Guide for Safety in AC Substation Grounding)**, and **IEEE Std 141 (Recommended Practice for Electric Power Distribution for Industrial Plants - Red Book)**.</p>
            </div>
        
            <div class="calculator-form">
                <form id="neutral-earth-fault-form">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="system-type">Earthing System Type <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Select the type of earthing system used in the electrical network.</span></span></label>
                            <select id="system-type" required>
                                <option value="solid">Solidly Earthed System</option>
                                <option value="resistive">Resistive Earthed System</option>
                                <option value="isolated">Isolated/Unearthed System</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="system-voltage">System Line-to-Line Voltage (V) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">The nominal line-to-line voltage of the three-phase system.</span></span></label>
                            <input type="number" id="system-voltage" min="1" step="1" value="400" required>
                        </div>
                    </div>
                    
                    <!-- Inputs for Solidly Earthed System -->
                    <div id="solid-earthed-inputs" class="form-row">
                        <div class="form-group">
                            <label for="source-zero-sequence-resistance-solid">Source Zero-Sequence Resistance (R0,source in &Omega;) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">The resistive component of the zero-sequence impedance from the source.</span></span></label>
                            <input type="number" id="source-zero-sequence-resistance-solid" min="0" step="0.001" value="0.01" required>
                        </div>
                        <div class="form-group">
                            <label for="source-zero-sequence-reactance-solid">Source Zero-Sequence Reactance (X0,source in &Omega;) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">The reactive component of the zero-sequence impedance from the source.</span></span></label>
                            <input type="number" id="source-zero-sequence-reactance-solid" min="0" step="0.001" value="0.05" required>
                        </div>
                    </div>

                    <!-- Inputs for Resistive Earthed System -->
                    <div id="resistive-earthed-inputs" class="form-row hidden-input">
                        <div class="form-group">
                            <label for="neutral-resistor-resistance">Neutral Earthing Resistance (RN in &Omega;) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Resistance of the neutral grounding resistor. This is the primary impedance limiting fault current.</span></span></label>
                            <input type="number" id="neutral-resistor-resistance" min="0.1" step="0.1" value="10" required>
                        </div>
                        <div class="form-group">
                            <label for="source-zero-sequence-resistance-resistive">Source Zero-Sequence Resistance (R0,source in &Omega;) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">The resistive component of the zero-sequence impedance from the source, added to the neutral resistor.</span></span></label>
                            <input type="number" id="source-zero-sequence-resistance-resistive" min="0" step="0.001" value="0.01" required>
                        </div>
                    </div>
                    <div id="resistive-earthed-inputs-row2" class="form-row hidden-input">
                        <div class="form-group">
                            <label for="source-zero-sequence-reactance-resistive">Source Zero-Sequence Reactance (X0,source in &Omega;) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">The reactive component of the zero-sequence impedance from the source.</span></span></label>
                            <input type="number" id="source-zero-sequence-reactance-resistive" min="0" step="0.001" value="0.05" required>
                        </div>
                        <!-- Empty div to maintain layout if needed, or remove if only one input -->
                        <div class="form-group"></div> 
                    </div>


                    <!-- Inputs for Isolated/Unearthed System -->
                    <div id="isolated-earthed-inputs" class="form-row hidden-input">
                        <div class="form-group">
                            <label for="total-system-capacitance">Total System Capacitance to Earth (Ct in &mu;F) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">The total phase-to-earth capacitance of the entire system, including cables, motor windings, etc. This is difficult to determine precisely without detailed system data. Typical values are 0.1-1.0 &mu;F per km of cable or 0.05-0.5 &mu;F per MVA of transformer capacity.</span></span></label>
                            <input type="number" id="total-system-capacitance" min="0.01" step="0.01" value="0.5" required>
                        </div>
                        <div class="form-group">
                            <label for="system-frequency">System Frequency (Hz) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">The operating frequency of the electrical system (e.g., 50 or 60 Hz).</span></span></label>
                            <input type="number" id="system-frequency" min="50" max="60" step="1" value="50" required>
                        </div>
                    </div>
                    
                    <button type="button" id="calculate-fault-btn" class="calculate-btn">Calculate Fault Current</button>
                </form>
            </div>
            
            <div id="result-container" class="result-container">
                <h3>Calculation Results</h3>
                <div id="calculation-details">
                    <!-- Calculation steps and formulas will be inserted here -->
                </div>
                <table class="result-table">
                    <thead>
                        <tr>
                            <th>Parameter</th>
                            <th>Value</th>
                        </tr>
                    </thead>
                    <tbody id="result-table-body">
                        <!-- Results will be dynamically inserted here -->
                    </tbody>
                </table>
                <div class="standard-reference" id="standard-reference">
                    <!-- Standard reference text and importance explanation will be inserted here -->
                </div>
            </div>
        </div>
    </main>

    <footer>
        <div class="container">
            <div class="disclaimer">
                
                <p>Disclaimer: Always verify calculation results against applicable engineering standards and guidelines.</p>
            </div>
            <div class="credit">
                <h3>Credit</h3>
                <p>Developed by A Sharma</p>
                <p>&copy; 2025 Design Calculators</p>
            </div>
            <div class="social-share">
                <h3>Share This Tool</h3>
                <div class="social-buttons">
                    <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://designcalculators.co.in&title=Neutral%20Earth%20Fault%20Current%20Calculator" target="_blank" class="social-btn linkedin"><i class="fab fa-linkedin"></i></a>
                    <a href="https://www.facebook.com/sharer/sharer.php?u=https://designcalculators.co.in" target="_blank" class="social-btn facebook"><i class="fab fa-facebook"></i></a>
                    <a href="https://twitter.com/intent/tweet?text=Check%20out%20this%20Neutral%20Earth%20Fault%20Current%20Calculator!&url=https://designcalculators.co.in" target="_blank" class="social-btn twitter"><i class="fab fa-twitter"></i></a>
                    <a href="https://api.whatsapp.com/send?text=Check%20out%20this%20Neutral%20Earth%20Fault%20Current%20Calculator!%20https://designcalculators.co.in" target="_blank" class="social-btn whatsapp"><i class="fab fa-whatsapp"></i></a>
                    <a href="https://www.reddit.com/submit?url=https://designcalculators.co.in&title=Neutral%20Earth%20Fault%20Current%20Calculator" target="_blank" class="social-btn reddit"><i class="fab fa-reddit"></i></a>
                </div>
            </div>
        </div>
    </footer>
    
    <div id="custom-message-box"></div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const systemTypeSelect = document.getElementById('system-type');
            const solidEarthedInputs = document.getElementById('solid-earthed-inputs');
            const resistiveEarthedInputs = document.getElementById('resistive-earthed-inputs');
            const resistiveEarthedInputsRow2 = document.getElementById('resistive-earthed-inputs-row2'); // New row for resistive
            const isolatedEarthedInputs = document.getElementById('isolated-earthed-inputs');

            const calculateBtn = document.getElementById('calculate-fault-btn');
            const resultContainer = document.getElementById('result-container');
            const resultTableBody = document.getElementById('result-table-body');
            const standardReference = document.getElementById('standard-reference');
            const calculationDetailsDiv = document.getElementById('calculation-details');

            // Function to display messages (replaces alert())
            function displayMessage(message, type = "info") {
                let messageBox = document.getElementById('custom-message-box');
                if (!messageBox) {
                    messageBox = document.createElement('div');
                    messageBox.id = 'custom-message-box';
                    document.body.appendChild(messageBox);
                }

                messageBox.textContent = message;
                messageBox.style.display = 'block';

                if (type === "error") {
                    messageBox.style.backgroundColor = '#dc3545'; // Red
                } else if (type === "warning") {
                    messageBox.style.backgroundColor = '#ffc107'; // Amber
                    messageBox.style.color = '#333';
                } else {
                    messageBox.style.backgroundColor = '#28a745'; // Green
                    messageBox.style.color = 'white';
                }
                messageBox.style.opacity = 1;

                // Clear any existing timeout to prevent multiple messages overlapping
                if (messageBox.timeoutId) {
                    clearTimeout(messageBox.timeoutId);
                }

                messageBox.timeoutId = setTimeout(() => {
                    messageBox.style.opacity = 0;
                    setTimeout(() => { messageBox.style.display = 'none';}, 500); // Wait for fade out then hide
                }, 5000);
            }

            // Function to toggle input visibility based on system type
            function toggleInputVisibility() {
                const selectedType = systemTypeSelect.value;
                
                // Hide all and remove required attributes
                solidEarthedInputs.classList.add('hidden-input');
                resistiveEarthedInputs.classList.add('hidden-input');
                resistiveEarthedInputsRow2.classList.add('hidden-input'); // Hide new row
                isolatedEarthedInputs.classList.add('hidden-input');

                document.querySelectorAll('#solid-earthed-inputs input').forEach(input => input.removeAttribute('required'));
                document.querySelectorAll('#resistive-earthed-inputs input').forEach(input => input.removeAttribute('required'));
                document.querySelectorAll('#resistive-earthed-inputs-row2 input').forEach(input => input.removeAttribute('required')); // New row
                document.querySelectorAll('#isolated-earthed-inputs input').forEach(input => input.removeAttribute('required'));
                
                // Set default values for all inputs regardless of visibility
                // This ensures that even hidden inputs have a default if they become visible later
                document.getElementById('system-voltage').value = '400';
                document.getElementById('source-zero-sequence-resistance-solid').value = '0.01';
                document.getElementById('source-zero-sequence-reactance-solid').value = '0.05';
                // Removed earth-electrode-resistance as it's not in this app's HTML
                document.getElementById('neutral-resistor-resistance').value = '10';
                document.getElementById('source-zero-sequence-resistance-resistive').value = '0.01';
                document.getElementById('source-zero-sequence-reactance-resistive').value = '0.05';
                document.getElementById('total-system-capacitance').value = '0.5';
                document.getElementById('system-frequency').value = '50';

                // Show relevant inputs and set required attributes
                if (selectedType === 'solid') {
                    solidEarthedInputs.classList.remove('hidden-input');
                    document.getElementById('source-zero-sequence-resistance-solid').setAttribute('required', 'true');
                    document.getElementById('source-zero-sequence-reactance-solid').setAttribute('required', 'true');
                    // Removed earth-electrode-resistance as it's not in this app's HTML
                } else if (selectedType === 'resistive') {
                    resistiveEarthedInputs.classList.remove('hidden-input');
                    resistiveEarthedInputsRow2.classList.remove('hidden-input'); // Show new row
                    document.getElementById('neutral-resistor-resistance').setAttribute('required', 'true');
                    document.getElementById('source-zero-sequence-resistance-resistive').setAttribute('required', 'true');
                    document.getElementById('source-zero-sequence-reactance-resistive').setAttribute('required', 'true'); // New row
                } else if (selectedType === 'isolated') {
                    isolatedEarthedInputs.classList.remove('hidden-input');
                    document.getElementById('total-system-capacitance').setAttribute('required', 'true');
                    document.getElementById('system-frequency').setAttribute('required', 'true');
                }
            }

            // Initial call to set correct visibility on page load
            toggleInputVisibility();
            systemTypeSelect.addEventListener('change', toggleInputVisibility);

            calculateBtn.addEventListener('click', function() {
                const systemType = systemTypeSelect.value;
                const systemVoltage = parseFloat(document.getElementById('system-voltage').value);
                const phaseVoltage = systemVoltage / Math.sqrt(3); // For 3-phase systems

                let faultCurrent = 0;
                let calculationHtml = '<h4>Detailed Calculation Steps:</h4>';
                let importanceText = '';

                // Input validation for common fields
                if (isNaN(systemVoltage) || systemVoltage <= 0) {
                    displayMessage("Please enter a valid positive System Line-to-Line Voltage.", "error");
                    return;
                }

                calculationHtml += `<p><strong>Given Parameters:</strong></p>`;
                calculationHtml += `<ul>
                    <li>System Type: ${systemType.charAt(0).toUpperCase() + systemType.slice(1)} Earthed System</li>
                    <li>System Line-to-Line Voltage ($$V_{L-L}$$): ${systemVoltage.toFixed(2)} V</li>
                    <li>Phase-to-Neutral Voltage ($$V_{L-N} = V_{L-L} / \\sqrt{3}$$): ${phaseVoltage.toFixed(2)} V</li>
                </ul>`;

                if (systemType === 'solid') {
                    const R0_source_solid = parseFloat(document.getElementById('source-zero-sequence-resistance-solid').value);
                    const X0_source_solid = parseFloat(document.getElementById('source-zero-sequence-reactance-solid').value);
                    // Removed earthElectrodeResistance as it's not in this app's HTML

                    if (isNaN(R0_source_solid) || R0_source_solid < 0 || isNaN(X0_source_solid) || X0_source_solid < 0) {
                        displayMessage("Please enter valid non-negative values for Source Zero-Sequence Resistance and Reactance.", "error");
                        return;
                    }
                    
                    const Z0_source_magnitude = Math.sqrt(R0_source_solid * R0_source_solid + X0_source_solid * X0_source_solid);

                    if (Z0_source_magnitude === 0) {
                        faultCurrent = Infinity; // Represents a very large fault current
                        displayMessage("Source impedance is zero, indicating an extremely high fault current. In reality, some impedance always exists.", "warning");
                    } else {
                        faultCurrent = phaseVoltage / Z0_source_magnitude;
                    }

                    calculationHtml += `<p><strong>Calculation for Solidly Earthed System:</strong></p>`;
                    calculationHtml += `<p>In a solidly earthed system, the neutral point is directly connected to earth, providing a low-impedance path for earth fault currents. The magnitude of the fault current is primarily limited by the system's inherent zero-sequence impedance from the source up to the fault point.</p>`;
                    calculationHtml += `<p class="formula">$$Z_{0,source} = \\sqrt{R_{0,source}^2 + X_{0,source}^2}$$</p>`;
                    calculationHtml += `<p class="formula">$$I_{f} = \\frac{V_{L-N}}{Z_{0,source}}$$</p>`;
                    calculationHtml += `<ul>
                        <li>Source Zero-Sequence Resistance ($$R_{0,source}$$): ${R0_source_solid.toFixed(3)} &Omega;</li>
                        <li>Source Zero-Sequence Reactance ($$X_{0,source}$$): ${X0_source_solid.toFixed(3)} &Omega;</li>
                        <li>Calculated Source Zero-Sequence Impedance ($$Z_{0,source}$$): ${Z0_source_magnitude.toFixed(3)} &Omega;</li>
                    </ul>`;
                    calculationHtml += `<p class="calculation-step">
                        $$I_f = ${phaseVoltage.toFixed(2)} / ${Z0_source_magnitude.toFixed(3)} = ${faultCurrent === Infinity ? "\\text{Very High}" : faultCurrent.toFixed(2)} \\text{ A}$$
                    </p>`;
                    importanceText = `
                        <h3>Importance of Neutral Earth Fault Current Calculation for Solidly Earthed Systems:</h3>
                        <p>In solidly earthed systems, the earth fault current can be very high, often comparable to three-phase short-circuit currents. This high current is essential for:</p>
                        <ul>
                            <li><strong>Rapid Protection Operation:</strong> High fault currents allow protective devices (e.g., circuit breakers, fuses) to operate quickly, isolating the fault and minimizing damage to equipment.</li>
                            <li><strong>Voltage Stability:</strong> It helps maintain stable system voltages during fault conditions by keeping the neutral point near earth potential.</li>
                            <li><strong>Safety:</strong> While a low impedance path is good for protection, high fault currents can lead to high touch and step voltages, which pose a significant risk to personnel. Proper earthing design (as per IEC 60364-4-41 and IEEE Std 80) is crucial to manage these hazards.</li>
                        </ul>
                        <p>Understanding this magnitude is critical for proper sizing of protective devices, earthing conductors, and ensuring the safety of personnel and equipment.</p>
                        <p class="standard-reference"><em>Note: For precise fault current calculations (e.g., for protection coordination), a full symmetrical component analysis including positive, negative, and zero sequence impedances (as per IEC 60909 or IEEE Std 141) is generally required. This calculator provides a simplified estimation based on the dominant zero-sequence impedance.</em></p>
                    `;

                } else if (systemType === 'resistive') {
                    const neutralResistorResistance = parseFloat(document.getElementById('neutral-resistor-resistance').value);
                    const R0_source_resistive = parseFloat(document.getElementById('source-zero-sequence-resistance-resistive').value);
                    const X0_source_resistive = parseFloat(document.getElementById('source-zero-sequence-reactance-resistive').value);

                    if (isNaN(neutralResistorResistance) || neutralResistorResistance <= 0) {
                        displayMessage("Please enter a valid positive Neutral Earthing Resistance.", "error");
                        return;
                    }
                    if (isNaN(R0_source_resistive) || R0_source_resistive < 0 || isNaN(X0_source_resistive) || X0_source_resistive < 0) {
                        displayMessage("Please enter valid non-negative values for Source Zero-Sequence Resistance and Reactance.", "error");
                        return;
                    }
                    
                    const totalResistance = neutralResistorResistance + R0_source_resistive;
                    const totalImpedanceMagnitude = Math.sqrt(totalResistance * totalResistance + X0_source_resistive * X0_source_resistive);
                    faultCurrent = phaseVoltage / totalImpedanceMagnitude;

                    calculationHtml += `<p><strong>Calculation for Resistive Earthed System:</strong></p>`;
                    calculationHtml += `<p>In a resistive earthed system, a resistor is connected between the neutral point and earth. This resistor deliberately limits the earth fault current to a predetermined low or medium value, typically from a few amperes to a few hundred amperes.</p>`;
                    calculationHtml += `<p class="formula">$$Z_{total} = \\sqrt{(R_N + R_{0,source})^2 + X_{0,source}^2}$$</p>`;
                    calculationHtml += `<p class="formula">$$I_{f} = \\frac{V_{L-N}}{Z_{total}}$$</p>`;
                    calculationHtml += `<ul>
                        <li>Neutral Earthing Resistance ($$R_N$$): ${neutralResistorResistance.toFixed(2)} &Omega;</li>
                        <li>Source Zero-Sequence Resistance ($$R_{0,source}$$): ${R0_source_resistive.toFixed(3)} &Omega;</li>
                        <li>Source Zero-Sequence Reactance ($$X_{0,source}$$): ${X0_source_resistive.toFixed(3)} &Omega;</li>
                        <li>Total Resistance ($$R_N + R_{0,source}$$): ${totalResistance.toFixed(3)} &Omega;</li>
                        <li>Calculated Total Impedance ($$Z_{total}$$): ${totalImpedanceMagnitude.toFixed(3)} &Omega;</li>
                    </ul>`;
                    calculationHtml += `<p class="calculation-step">
                        $$I_f = ${phaseVoltage.toFixed(2)} / ${totalImpedanceMagnitude.toFixed(3)} = ${faultCurrent.toFixed(2)} \\text{ A}$$
                    </p>`;
                    importanceText = `
                        <h3>Importance of Neutral Earth Fault Current Calculation for Resistive Earthed Systems:</h3>
                        <p>Resistive earthing is chosen to limit the earth fault current to a level that is high enough for reliable operation of protective relays, but low enough to reduce arc flash hazards, minimize equipment damage, and control transient overvoltages.</p>
                        <ul>
                            <li><strong>Damage Control:</strong> Lower fault currents significantly reduce thermal and mechanical damage to electrical equipment at the fault location.</li>
                            <li><strong>Arc Flash Mitigation:</strong> Reduced fault current leads to lower incident energy, improving safety for personnel.</li>
                            <li><strong>Transient Overvoltage Control:</strong> The resistor helps damp out transient overvoltages that can occur during intermittent earth faults.</li>
                            <li><strong>Reliable Protection:</strong> While current is limited, it's maintained at a level detectable by standard overcurrent relays.</li>
                        </ul>
                        <p>Accurate calculation ensures the resistor is sized correctly to achieve these protective benefits while maintaining system reliability, following standards like IEEE Std 141 (Red Book) and IEC 60364.</p>
                        <p class="standard-reference"><em>Note: While this formula is widely accepted for resistive earthing, comprehensive fault studies for complex systems may still utilize symmetrical components to account for all system impedances.</em></p>
                    `;

                } else if (systemType === 'isolated') {
                    const totalSystemCapacitance = parseFloat(document.getElementById('total-system-capacitance').value); // in microfarads
                    const systemFrequency = parseFloat(document.getElementById('system-frequency').value);

                    if (isNaN(totalSystemCapacitance) || totalSystemCapacitance <= 0) {
                        displayMessage("Please enter a valid positive Total System Capacitance to Earth.", "error");
                        return;
                    }
                    if (isNaN(systemFrequency) || (systemFrequency !== 50 && systemFrequency !== 60)) {
                        displayMessage("Please enter a valid System Frequency (50 or 60 Hz).", "error");
                        return;
                    }

                    // Convert capacitance from microfarads to Farads
                    const capacitanceFarads = totalSystemCapacitance * 1e-6;
                    faultCurrent = 3 * (2 * Math.PI * systemFrequency * capacitanceFarads) * phaseVoltage;

                    calculationHtml += `<p><strong>Calculation for Isolated/Unearthed System:</strong></p>`;
                    calculationHtml += `<p>In an isolated (or unearthed) system, the neutral point is not intentionally connected to earth. The earth fault current is predominantly capacitive, flowing through the distributed capacitance between the system conductors and earth.</p>`;
                    calculationHtml += `<p class="formula">$$I_{f} = 3 \\times 2 \\pi f C_t V_{L-N}$$</p>`;
                    calculationHtml += `<ul>
                        <li>Total System Capacitance to Earth ($$C_t$$): ${totalSystemCapacitance.toFixed(2)} &mu;F (${capacitanceFarads.toExponential(2)} F)</li>
                        <li>System Frequency ($$f$$): ${systemFrequency.toFixed(0)} Hz</li>
                    </ul>`;
                    calculationHtml += `<p class="calculation-step">
                        $$I_f = 3 \\times 2 \\pi \\times ${systemFrequency.toFixed(0)} \\times ${capacitanceFarads.toExponential(2)} \\times ${phaseVoltage.toFixed(2)} = ${faultCurrent.toFixed(3)} \\text{ A}$$
                    </p>`;
                    importanceText = `
                        <h3>Importance of Neutral Earth Fault Current Calculation for Isolated/Unearthed Systems:</h3>
                        <p>Isolated systems have very low earth fault currents, which has certain advantages and disadvantages:</p>
                        <ul>
                            <li><strong>Continuity of Supply:</strong> The system can often continue to operate with a single phase-to-earth fault without immediate tripping, allowing for controlled shutdown.</li>
                            <li><strong>Reduced Equipment Damage:</strong> The very low current causes minimal damage at the fault point.</li>
                            <li><strong>High Transient Overvoltages:</strong> A major disadvantage is the potential for severe and dangerous transient overvoltages, which can occur during intermittent earth faults.</li>
                            <li><strong>Fault Location Difficulty:</strong> Due to low current, fault detection and location can be challenging, often requiring specialized earth fault monitoring devices.</li>
                        </ul>
                        <p>Calculating this small capacitive current is important for understanding system behavior during a fault, assessing the risk of overvoltages, and planning for fault detection and location strategies. Relevant standards include IEC 60364-4-41.</p>
                        <p class="standard-reference"><em>Note: The total system capacitance ($C_t$) is often difficult to determine precisely. This calculation provides an estimation based on the provided total capacitance. More detailed analysis would involve considering capacitance of individual components like cables and windings.</em></p>
                    `;
                }

                // Display summarized results in the table
                resultTableBody.innerHTML = ''; // Clear previous results
                
                function addResultRow(parameter, value) {
                    const row = resultTableBody.insertRow();
                    const paramCell = row.insertCell();
                    const valueCell = row.insertCell();
                    paramCell.innerHTML = parameter; /* Use innerHTML for MathJax symbols */
                    valueCell.innerHTML = value; /* Use innerHTML for MathJax symbols */
                }

                addResultRow("Earthing System Type", systemType.charAt(0).toUpperCase() + systemType.slice(1) + " Earthed System");
                addResultRow("System Line-to-Line Voltage", systemVoltage.toFixed(2) + " V");
                addResultRow("Phase-to-Neutral Voltage", phaseVoltage.toFixed(2) + " V");
                addResultRow("Calculated Earth Fault Current", faultCurrent === Infinity ? "Very High (Bolted Fault)" : faultCurrent.toFixed(3) + " A");
                
                // Add system-specific parameters to results table
                if (systemType === 'solid') {
                    const R0_source_solid = parseFloat(document.getElementById('source-zero-sequence-resistance-solid').value);
                    const X0_source_solid = parseFloat(document.getElementById('source-zero-sequence-reactance-solid').value);
                    const Z0_source_magnitude = Math.sqrt(R0_source_solid * R0_source_solid + X0_source_solid * X0_source_solid);
                    addResultRow("Source Zero-Sequence Resistance (R0,source)", R0_source_solid.toFixed(3) + " &Omega;");
                    addResultRow("Source Zero-Sequence Reactance (X0,source)", X0_source_solid.toFixed(3) + " &Omega;");
                    addResultRow("Source Zero-Sequence Impedance (Z0,source)", Z0_source_magnitude.toFixed(3) + " &Omega;");
                    // Removed earth-electrode-resistance as it's not in this app's HTML
                } else if (systemType === 'resistive') {
                    const neutralResistorResistance = parseFloat(document.getElementById('neutral-resistor-resistance').value);
                    const R0_source_resistive = parseFloat(document.getElementById('source-zero-sequence-resistance-resistive').value);
                    const X0_source_resistive = parseFloat(document.getElementById('source-zero-sequence-reactance-resistive').value);
                    const totalResistance = neutralResistorResistance + R0_source_resistive;
                    const totalImpedanceMagnitude = Math.sqrt(totalResistance * totalResistance + X0_source_resistive * X0_source_resistive);

                    addResultRow("Neutral Earthing Resistance (RN)", neutralResistorResistance.toFixed(2) + " &Omega;");
                    addResultRow("Source Zero-Sequence Resistance (R0,source)", R0_source_resistive.toFixed(3) + " &Omega;");
                    addResultRow("Source Zero-Sequence Reactance (X0,source)", X0_source_resistive.toFixed(3) + " &Omega;");
                    addResultRow("Total Impedance (Z_total)", totalImpedanceMagnitude.toFixed(3) + " &Omega;");
                } else if (systemType === 'isolated') {
                    addResultRow("Total System Capacitance to Earth", parseFloat(document.getElementById('total-system-capacitance').value).toFixed(2) + " &mu;F");
                    addResultRow("System Frequency", parseFloat(document.getElementById('system-frequency').value).toFixed(0) + " Hz");
                }

                calculationDetailsDiv.innerHTML = calculationHtml;
                standardReference.innerHTML = importanceText;

                // Trigger MathJax to render the new content
                if (window.MathJax) {
                    window.MathJax.typesetPromise([calculationDetailsDiv, standardReference]);
                }

                resultContainer.style.display = 'block';
                // Add 'show' class to trigger animation
                setTimeout(() => {
                    resultContainer.classList.add('show');
                    resultContainer.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }, 50); // Small delay to ensure display:block applies first
            });

            // Theme switch logic
            const themeSwitch = document.getElementById('theme-switch');
            if (themeSwitch) {
                // Check for saved theme preference
                if (localStorage.getItem('theme') === 'dark') {
                    document.body.classList.add('dark-mode');
                    themeSwitch.checked = true;
                }

                themeSwitch.addEventListener('change', function() {
                    if (this.checked) {
                        document.body.classList.add('dark-mode');
                        localStorage.setItem('theme', 'dark');
                    } else {
                        document.body.classList.remove('dark-mode');
                        localStorage.setItem('theme', 'light');
                    }
                });
            }
        });
    </script>
</body>
</html>



