<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced Electrical Breaker Sizing Tool | Design Calculators</title>
    <meta name="description" content="Professional electrical breaker sizing tool for motors, transformers, and incomers. Calculates FLA, thermal/magnetic trip settings, and fault current per NEC/IEC.">
    <meta name="keywords" content="breaker sizing calculator, electrical calculator, motor breaker, transformer protection, fault current, NEC, IEC, MCCB, ACB">
    <meta name="author" content="Design Calculators">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://designcalculators.co.in/breaker-sizing.html" />

    <!-- AdSense & Google Analytics -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5936527763614780" crossorigin="anonymous"></script>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-23Y1V450SR"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-23Y1V450SR');
    </script>

    <!-- Fonts and Icons -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Montserrat:wght@700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- MathJax for formula rendering -->
    <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <!-- Favicons -->
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">

    <!-- Combined and Merged CSS -->
    <style>
        /* Base styles from Pipe Flow Calculator */
        :root {
            --primary-color: #1E3A8A;
            --secondary-color: #2563EB;
            --accent-color: #F59E0B;
            --success-color: #10B981;
            --bg-color: #F8FAFC;
            --card-bg: #FFFFFF;
            --text-color: #4B5563;
            --heading-color: #111827;
            --footer-bg: #0F172A;
            --border-color: #E2E8F0;
            --gradient-primary: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            --gradient-dark: linear-gradient(135deg, #0F172A, #1E293B);
            --card-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            --hover-color: #e2e6ea;
            --input-focus-shadow: 0 0 0 3px rgba(30, 58, 138, 0.25); /* Adjusted for blue theme */
        }

        body.dark-mode {
            --primary-color: #10B981;
            --secondary-color: #34D399;
            --bg-color: #0F172A;
            --card-bg: #1E293B;
            --text-color: #CBD5E1;
            --heading-color: #F1F5F9;
            --footer-bg: #020617;
            --border-color: #334155;
            --hover-color: #1E293B;
            --input-focus-shadow: 0 0 0 3px rgba(16, 185, 129, 0.5); /* Adjusted for green theme */
        }

        * { box-sizing: border-box; }
        html { scroll-behavior: smooth; }
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            line-height: 1.8; /* Changed from 1.6 for readability */
            transition: background-color 0.3s, color 0.3s;
            overflow-x: hidden;
            margin: 0;
            padding: 0;
        }
        .container { 
            max-width: 1280px; /* Wider container from pipe-flow */
            margin: 0 auto; 
            padding: 0 24px; 
        }

        /* HEADER Styles from Pipe Flow */
        .header {
            background: var(--gradient-primary);
            color: white;
            padding: 24px 0;
            position: relative;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .logo-container {
            display: flex;
            align-items: center;
            gap: 16px;
            text-decoration: none;
            color: white;
        }
        .logo-text {
            font-size: 1.75rem;
            font-weight: 800;
            font-family: 'Montserrat', sans-serif;
        }
        .nav-links {
            display: flex;
            gap: 24px;
            align-items: center;
            list-style: none;
            margin: 0;
            padding: 0;
        }
        .nav-links a {
            color: white;
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s;
        }
        .nav-links a:hover { color: var(--accent-color); }

        /* Theme Toggle Styles from Pipe Flow */
        .theme-toggle {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .theme-toggle .icon {
            color: white;
            font-size: 1.2rem;
        }
        .switch {
            position: relative;
            display: inline-block;
            width: 56px;
            height: 30px;
        }
        .switch input { opacity: 0; width: 0; height: 0; }
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0,0,0,0.2);
            transition: .4s;
            border-radius: 30px;
        }
        .slider:before {
            position: absolute;
            content: "";
            height: 22px;
            width: 22px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        input:checked + .slider { background-color: var(--accent-color); }
        input:checked + .slider:before { transform: translateX(26px); }

        /* Main Content Styles */
        main { padding: 40px 0; }
        .tool-container {
            background-color: var(--card-bg);
            border-radius: 12px; /* Softer radius */
            padding: 30px; /* More padding */
            box-shadow: var(--card-shadow);
            margin-bottom: 30px;
        }
        .tool-container h2 {
            color: var(--primary-color);
            border-bottom: 3px solid var(--primary-color);
            padding-bottom: 15px;
            margin-top: 0;
            margin-bottom: 25px;
            font-family: 'Montserrat', sans-serif;
            font-size: 1.8rem;
        }
        .tool-container h3 {
            color: var(--heading-color);
            font-family: 'Montserrat', sans-serif;
            font-size: 1.5rem;
            margin-top: 25px;
            margin-bottom: 20px;
        }
        .tool-description {
            margin-bottom: 25px;
            color: var(--text-color);
            font-size: 1rem;
            line-height: 1.8;
        }
        
        /* Form Styles (Merged) */
        .calculator-form {
            background-color: var(--card-bg);
            border-radius: 12px;
            padding: 25px;
            margin-top: 25px;
            /* box-shadow: var(--card-shadow); Removed, as parent .tool-container has it */
        }
        .form-group { margin-bottom: 20px; }
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--heading-color);
        }
        .form-group input, .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--border-color); /* Thicker border */
            border-radius: 6px;
            background-color: var(--bg-color);
            color: var(--text-color);
            box-sizing: border-box;
            transition: all 0.3s;
            font-size: 1rem;
        }
        .form-group input:focus, .form-group select:focus {
            border-color: var(--primary-color);
            box-shadow: var(--input-focus-shadow);
            outline: none;
        }
        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }
        
        .calculate-btn {
            background: var(--gradient-primary);
            color: white;
            border: none;
            padding: 16px 30px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: 700;
            margin-top: 15px;
            transition: all 0.3s;
            width: 100%;
            box-shadow: 0 4px 12px rgba(30, 58, 138, 0.3);
        }
        .calculate-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(30, 58, 138, 0.4);
        }
        .calculate-btn:active {
            transform: translateY(0);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        /* Result Container Styles (from Electrical) */
        .result-container {
            margin-top: 40px;
            padding: 30px;
            border-radius: 12px;
            background-color: var(--card-bg);
            box-shadow: var(--card-shadow);
            display: none;
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.5s ease-out, transform 0.5s ease-out;
        }
        .result-container.show {
            display: block;
            opacity: 1;
            transform: translateY(0);
        }
        .result-container h3 {
            color: var(--primary-color);
            margin-bottom: 25px;
            font-family: 'Montserrat', sans-serif;
            font-size: 1.6rem;
        }

        /* Result Table Styles (from Electrical) */
        .result-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            border-radius: 8px;
            overflow: hidden;
            display: none; /* Hidden by default for animation */
            opacity: 0;
            transform: translateY(10px);
            transition: opacity 0.5s ease-out, transform 0.5s ease-out;
        }
        .result-table.show {
            display: table;
            opacity: 1;
            transform: translateY(0);
        }
        .result-table th, .result-table td {
            padding: 14px;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
        }
        .result-table th {
            background: var(--gradient-primary);
            color: white;
            font-weight: 700;
        }
        .result-table tr:nth-child(even) {
            background-color: rgba(0,0,0,0.02);
        }
        .result-table tbody tr {
            opacity: 0;
            transform: translateX(-20px);
            animation: fadeInSlideIn 0.5s forwards;
        }
        @keyframes fadeInSlideIn {
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        /* Standard Reference / Tooltip Styles */
        .standard-reference {
            margin-top: 25px;
            font-style: italic;
            font-size: 0.95rem;
            padding: 15px;
            background: linear-gradient(135deg, rgba(245,158,11,0.1), rgba(245,158,11,0.05));
            border-left: 4px solid var(--accent-color);
            border-radius: 6px;
            line-height: 1.7;
        }
        .info-icon {
            color: var(--primary-color);
            margin-left: 6px;
            cursor: help;
            font-size: 0.9rem;
        }
        .tooltip {
            position: relative;
            display: inline-block;
        }
        .tooltip .tooltiptext {
            visibility: hidden;
            width: 260px;
            background-color: #333;
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 10px;
            position: absolute;
            z-index: 1000;
            bottom: 130%;
            left: 50%;
            margin-left: -130px;
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 0.85rem;
            line-height: 1.5;
            white-space: normal;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
        }
        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }

        /* Custom Message Box Style */
        #custom-message-box {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            padding: 16px 28px;
            border-radius: 8px;
            box-shadow: 0 6px 16px rgba(0,0,0,0.25);
            z-index: 10000;
            font-weight: 600;
            color: white;
            opacity: 0;
            transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
        }
        #custom-message-box.show { opacity: 1; }

        /* Calculation Details Styles (from Electrical) */
        .calculation-section {
            background-color: var(--bg-color);
            border: 2px solid var(--border-color);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 25px;
            font-size: 0.95rem;
            opacity: 0;
            transform: translateY(10px);
            transition: opacity 0.5s ease-out, transform 0.5s ease-out;
        }
        .calculation-section.show {
            opacity: 1;
            transform: translateY(0);
        }
        .calculation-section h4 {
            color: var(--secondary-color);
            margin-top: 0;
            margin-bottom: 15px;
            font-size: 1.2rem;
        }
        .calculation-section p.formula {
            font-family: 'Times New Roman', serif;
            font-size: 1.1rem;
            text-align: center;
            padding: 15px;
            background-color: var(--hover-color);
            border-radius: 6px;
            margin: 15px 0;
            overflow-x: auto;
        }
        .calculation-section p.calculation-step {
            font-family: 'Courier New', monospace;
            background-color: var(--hover-color);
            padding: 8px 12px;
            border-radius: 4px;
            margin-bottom: 8px;
            line-height: 1.6;
        }
        .calculation-section ul {
            list-style-type: disc;
            margin-left: 25px;
            padding-left: 0;
        }
        .calculation-section ul li {
            margin-bottom: 8px;
            line-height: 1.7;
        }

        /* Loading Spinner (from Electrical) */
        .loading-spinner {
            border: 4px solid rgba(255, 255, 255, 0.3); /* Adjusted for button */
            border-left-color: #ffffff; /* Adjusted for button */
            border-radius: 50%;
            width: 20px; /* Smaller for button */
            height: 20px; /* Smaller for button */
            animation: spin 1s linear infinite;
            display: inline-block;
            vertical-align: middle;
            margin-left: 10px;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* New Content Block Styles */
        .content-block {
            background-color: var(--card-bg);
            border-radius: 12px;
            padding: 30px;
            box-shadow: var(--card-shadow);
            margin-bottom: 30px;
            margin-top: 30px; /* Added margin top */
        }
        .content-block h2 {
            color: var(--primary-color);
            border-bottom: 3px solid var(--primary-color);
            padding-bottom: 15px;
            margin-top: 0;
            margin-bottom: 25px;
            font-family: 'Montserrat', sans-serif;
            font-size: 1.8rem;
        }
        .content-block h3 {
            color: var(--heading-color);
            font-family: 'Montserrat', sans-serif;
            font-size: 1.4rem;
            margin-top: 25px;
            margin-bottom: 15px;
        }
        .content-block p, .content-block li {
            font-size: 1rem;
            line-height: 1.8;
            color: var(--text-color);
        }
        .content-block ul {
            list-style-type: disc;
            margin-left: 20px;
            padding-left: 5px;
        }
        .content-block li {
            margin-bottom: 10px;
        }
        .content-block strong {
            color: var(--heading-color);
        }


        /* FOOTER Styles from Pipe Flow */
        footer {
            background: var(--gradient-dark);
            color: #CBD5E1;
            padding: 50px 0 20px 0;
        }
        .footer-content {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            flex-wrap: wrap;
            gap: 40px;
            margin-bottom: 30px;
        }
        .footer-col {
            flex: 1;
            min-width: 200px;
        }
        .footer-col h4 {
            font-size: 1.1rem;
            color: white;
            margin-bottom: 15px;
            font-weight: 700;
        }
        .footer-col ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        .footer-col ul li { margin-bottom: 10px; }
        .footer-col a {
            color: #CBD5E1;
            text-decoration: none;
            transition: color 0.3s;
            font-size: 0.95rem;
        }
        .footer-col a:hover { color: var(--accent-color); }
        .footer-disclaimer {
            text-align: center;
            margin: 30px auto;
            padding-top: 25px;
            border-top: 1px solid #334155;
            max-width: 800px;
            font-size: 0.9rem;
            line-height: 1.6;
        }
        .footer-bottom {
            text-align: center;
            padding-top: 20px;
            font-size: 0.9rem;
            color: #94A3B8;
        }
        .creator-name {
            color: var(--secondary-color);
            font-weight: bold;
        }
        .social-buttons {
            display: flex;
            gap: 12px;
            margin-top: 15px;
        }
        .social-btn {
            width: 40px;
            height: 40px;
            display: inline-flex;
            justify-content: center;
            align-items: center;
            color: white;
            border-radius: 50%;
            text-decoration: none;
            font-size: 1.1rem;
            transition: transform 0.3s, box-shadow 0.3s;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        .social-btn:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 16px rgba(0,0,0,0.3);
        }
        .social-btn.linkedin { background-color: #0A66C2; }
        .social-btn.youtube { background-color: #FF0000; }
        .social-btn.twitter { background-color: #1DA1F2; }
        .social-btn.facebook { background-color: #1877F2; }
        .social-btn.whatsapp { background-color: #25D366; }

        /* Responsive Media Queries */
        @media (max-width: 768px) {
            .container { padding: 0 15px; }
            .navbar { flex-direction: column; gap: 20px; }
            .nav-links { flex-direction: column; gap: 12px; text-align: center; }
            .form-row { grid-template-columns: 1fr; }
            .tool-container { padding: 20px; }
            .footer-content { flex-direction: column; gap: 25px; }
            .theme-toggle {
                position: relative; /* Change from absolute */
                top: 0;
                right: 0;
                margin-top: 15px; /* Add space */
            }
        }
    </style>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    
    <!-- NEW HEADER (from Pipe Flow) -->
    <header class="header">
        <div class="header-bg-animation"></div>
        <div class="container">
            <nav class="navbar">
                <a href="/" class="logo-container">
                    <img src="logo.png" alt="Design Calculators Logo" class="logo">
                    <span class="logo-text">Design Calculators</span>
                </a>

                <div class="nav-menu">
                    <button class="mobile-menu-toggle" aria-label="Toggle menu">
                        <i class="fas fa-bars"></i>
                    </button>

                    <ul class="nav-links">
                        <li><a href="/index.html">Home</a></li>
                        
    <li class="dropdown">
        <a href="/indexele.html" class="dropdown-toggle">Electrical <i class="fas fa-chevron-down" style="font-size: 0.7em; margin-left: 4px;"></i></a>
        <div class="dropdown-menu">
            <div class="repo-grid"><div><a href="/arcflash.html">Arc Flash Calculator</a><a href="/breaker-sizing.html">Breaker Sizing</a><a href="/cable-thermal-rating.html">Cable Ampacity</a><a href="/comm-cable-loss.html">Comm Cable Loss</a><a href="/earth-conductor-size.html">Earth Conductor Size</a><a href="/generatorsizing.html">Generator Sizing</a><a href="/harmonicsanalyser.html">Harmonics Analyser</a><a href="/insulationresistance.html">Insulation Resistance</a><a href="/logicgate.html">Logic Gates Simulator</a><a href="/motor-starting.html">Motor Starting Current</a><a href="/pcbtrace.html">PCB Trace Width</a><a href="/protection-device.html">Protection Device</a><a href="/resistor.html">Resistor Color Code</a><a href="/solarcable.html">Solar Cable Sizing</a><a href="/systemxrcalculator.html">System X/R Ratio</a><a href="/transmissionline.html">Transmission Line</a><a href="/vfd-selection.html">VFD Selection Tool</a></div><div><a href="/batterylife.html">Battery Life Estimator</a><a href="/busbarampacity.html">Busbar Ampacity</a><a href="/cablepulling.html">Cable Pulling Tension</a><a href="/conduit-fill.html">Conduit Fill Calculator</a><a href="/earthingfaultsimulator.html">Earthing Fault Simulator</a><a href="/grounding.html">Grounding System Design</a><a href="/hvac-sizing.html">HVAC Sizing Calculator</a><a href="/lcresonancecalculator.html">LC Resonance Calculator</a><a href="/maintenance-guide.html">Maintenance Guide</a><a href="/nemaipconvertor.html">NEMA to IP Converter</a><a href="/power-factor.html">Power Factor Correction</a><a href="/relay-coordination.html">Relay Coordination</a><a href="/short-circuit.html">Short Circuit Current</a><a href="/solarpvarray.html">Solar PV Array</a><a href="/transformer-calculator.html">Transformer Calculator</a><a href="/unit-converter.html">Unit Converter</a><a href="/voltage-drop.html">Voltage Drop Calculator</a></div><div><a href="/battery-sizing.html">Battery Sizing (AH)</a><a href="/busbarshortcircuit.html">Busbar Short Circuit</a><a href="/cable-sizing.html">Cable Sizing Calculator</a><a href="/ctsaturation.html">CT Saturation</a><a href="/equipment-relay.html">Equipment Relay Setting</a><a href="/harmonic-distortion.html">Harmonic Distortion</a><a href="/industriallighting.html">Industrial Lighting</a><a href="/lighting-calulator.html">Lighting Calculator</a><a href="/motor-efficiency.html">Motor Efficiency</a><a href="/neutral-earth-fault-current.html">Neutral Earth Fault</a><a href="/powertriangletool.html">Power Triangle</a><a href="/electricalresidentialload.html">Residential Load Calc</a><a href="/skindepth.html">Skin Depth Calculator</a><a href="/symmetricalcomponents.html">Symmetrical Components</a><a href="/transformerinrush.html">Transformer Inrush</a><a href="/ups-sizing.html">UPS Sizing</a></div>
            </div>
            <div class="view-all-container">
                <a href="/indexele.html" class="view-all-link">View All Electrical Tools â†’</a>
            </div>
        </div>
    </li>
                        
    <li class="dropdown">
        <a href="/indexinst.html" class="dropdown-toggle">Instrumentation <i class="fas fa-chevron-down" style="font-size: 0.7em; margin-left: 4px;"></i></a>
        <div class="dropdown-menu">
            <div class="repo-grid"><div><a href="/adc-resolution.html">ADC Resolution</a><a href="/capillarylengthtemperatureerror.html">Capillary Error</a><a href="/cv-kv-valve.html">Cv/Kv Valve Sizing</a><a href="/dp-level.html">DP Level Measurement</a><a href="/hydrostatic-level.html">Hydrostatic Level</a><a href="/instrument-range.html">Instrument Range</a><a href="/loop-impedance.html">Loop Impedance</a><a href="/orifice-plate.html">Orifice Plate Beta</a><a href="/pid-tuning.html">PID Tuning</a><a href="/profibus.html">Profibus Calculator</a><a href="/tempsensorresponse.html">Response Time (Tau)</a><a href="/rtd-lead-comp.html">RTD Lead Wire Comp.</a><a href="/sealfluidzeroshift.html">Seal Fluid Shift</a><a href="/snr-calculator.html">SNR Calculator</a><a href="/thermocoupleextensioncable.html">TC Extension Cable</a><a href="/thermowellwakefreq.html">Thermowell Frequency</a><a href="/pressuretransmitteroverrange.html">Tx Overrange</a><a href="/valvecavitationcalculator.html">Valve Cavitation</a><a href="/vibrationtransmitter.html">Vibration Tx</a><a href="/zoneclassificationhelper.html">Zone Classification</a></div><div><a href="/baud-rate.html">Baud Rate Calculator</a><a href="/gascompressibility.html">Compressibility (Z)</a><a href="/dbcalculator.html">dB Gain/Loss Calc</a><a href="/flowprofiledistortioncalculator.html">Flow Distortion</a><a href="/impulselinefreezing.html">Impulse Freezing</a><a href="/intrinsic-safety.html">Intrinsic Safety Loop</a><a href="/measurement.html">Measurement Uncertainty</a><a href="/ph-temp-comp.html">pH Temp Compensation</a><a href="/plcscantime.html">PLC Scan Time</a><a href="/pressurereliefvalve.html">PRV Sizing (API 520)</a><a href="/reynoldsnumbercal.html">Reynolds Number</a><a href="/rtdselfheating.html">RTD Self-Heating</a><a href="/signal-scaling.html">Signal Scaling</a><a href="/staticheadcal.html">Static Head</a><a href="/temperaturesensorlag.html">Temp Sensor Lag</a><a href="/thermowell-wake.html">Thermowell Wake</a><a href="/ultrasoniclevel.html">Ultrasonic Level</a><a href="/valve-cv.html">Valve Cv Viewer</a><a href="/wetlegdensitycompensation.html">Wet Leg Compensation</a></div><div><a href="/capacitance-level.html">Capacitance Level</a><a href="/controlvalvenoise.html">Control Valve Noise</a><a href="/dp-flow-conversion.html">DP Flow Conversion</a><a href="/hartdevices.html">HART Devices</a><a href="/impulse-pressure-drop.html">Impulse Pressure Drop</a><a href="/junctionbox.html">Junction Box Sizing</a><a href="/orifice-flow.html">Orifice Flow Calculator</a><a href="/pid-symbol-library.html">PID Symbol Library</a><a href="/power-supply-load.html">Power Supply Load</a><a href="/prvsizing.html">Relief Orifice Area</a><a href="/rtdexcitationcurrentselection.html">RTD Excitation</a><a href="/rtd-tc-conversion.html">RTD/TC Conversion</a><a href="/sil.html">SIL Calculator</a><a href="/steamflow.html">Steam Flow</a><a href="/thermocouplecjccalculator.html">Thermocouple CJC</a><a href="/turndown.html">Turndown Ratio</a><a href="/controlvalveauthority.html">Valve Authority</a><a href="/controlvalveleakage.html">Valve Leakage Class</a><a href="/wirelesshart.html">WirelessHART Range</a></div>
            </div>
            <div class="view-all-container">
                <a href="/indexinst.html" class="view-all-link">View All Instrumentation Tools â†’</a>
            </div>
        </div>
    </li>
                        
    <li class="dropdown">
        <a href="/indexmech.html" class="dropdown-toggle">Mechanical <i class="fas fa-chevron-down" style="font-size: 0.7em; margin-left: 4px;"></i></a>
        <div class="dropdown-menu">
            <div class="repo-grid"><div><a href="/aircompressorfad.html">Air Compressor FAD</a><a href="/asme-vessel.html">ASME Vessel Design</a><a href="/belt-pulley.html">Belt & Pulley</a><a href="/bolt-torque.html">Bolt Torque</a><a href="/controlvalveactuator.html">Control Valve Actuator</a><a href="/frictionfactortool.html">Darcy Friction Factor</a><a href="/fatigue.html">Fatigue Analysis</a><a href="/fuel-combustion.html">Fuel Combustion</a><a href="/gas.html">Gas Properties</a><a href="/heat-exchanger.html">Heat Exchanger</a><a href="/hydroliccylinder.html">Hydraulic Cylinder</a><a href="/material-compatibility.html">Material Compatibility</a><a href="/nozzle-reinforcement.html">Nozzle Reinforcement</a><a href="/openchannelflow.html">Open Channel Flow</a><a href="/pipescheduletool.html">Pipe Schedule & Stress</a><a href="/pump-head.html">Pump Head</a><a href="/shaft-power-torque.html">Shaft Power & Torque</a><a href="/steam-table.html">Steam Table</a><a href="/vibrationanalysis.html">Vibration Analysis</a></div><div><a href="/air-flow-duct.html">Air Flow Duct Sizing</a><a href="/beam-deflection.html">Beam Deflection</a><a href="/bernoulli-equation.html">Bernoulli Equation</a><a href="/chiller-capacity.html">Chiller Capacity</a><a href="/cooling-tower-sizing.html">Cooling Tower Sizing</a><a href="/darcy-weisbach.html">Darcy-Weisbach</a><a href="/finned-tube-heat-transfer.html">Finned Tube Heat</a><a href="/furnace-heat-duty.html">Furnace Heat Duty</a><a href="/gear-design.html">Gear Design</a><a href="/heat-loss-pipes.html">Heat Loss Pipes</a><a href="/jacketed-vessel-heat-transfer.html">Jacketed Vessel</a><a href="/metalweight.html">Metal Weight Calculator</a><a href="/nptbspthreadcalculator.html">NPT/BSP Threads</a><a href="/overall-heat-transfer.html">Overall Heat Transfer</a><a href="/pipe-stress-flexibility.html">Pipe Stress</a><a href="/pump-power.html">Pump Power</a><a href="/specific-heat-enthalpy.html">Specific Heat</a><a href="/storage-tank-volume.html">Storage Tank Volume</a><a href="/weldingstress.html">Welding Stress</a></div><div><a href="/allowable-stress-safety-factor.html">Allowable Stress</a><a href="/bearinglife.html">Bearing Life Calculator</a><a href="/boiler-efficiency.html">Boiler Efficiency</a><a href="/compressor-power.html">Compressor Power</a><a href="/corrosion-rate.html">Corrosion Rate</a><a href="/fan-laws.html">Fan Laws</a><a href="/foundation.html">Foundation Design</a><a href="/gas-laws.html">Gas Laws</a><a href="/hardness.html">Hardness Converter</a><a href="/conduction-convection-radiation.html">Heat Transfer Modes</a><a href="/machining.html">Machining Calculator</a><a href="/momentofinertia.html">Moment of Inertia</a><a href="/oring.html">O-Ring Sizing</a><a href="/pipe-flow.html">Pipe Flow Calculator</a><a href="/psychrometric.html">Psychrometric Calc</a><a href="/reynolds-number.html">Reynolds Number</a><a href="/spring.html">Spring Design</a><a href="/thermal-expansion.html">Thermal Expansion</a></div>
            </div>
            <div class="view-all-container">
                <a href="/indexmech.html" class="view-all-link">View All Mechanical Tools â†’</a>
            </div>
        </div>
    </li>
                        <li><a href="/index.html#articles">Articles</a></li>
                        <li><a href="/sitemap2.html">Site Map</a></li>
                    </ul>

                    <div class="theme-toggle">
                        <i class="fas fa-sun icon"></i>
                        <label class="switch">
                            <input type="checkbox" id="theme-switch">
                            <span class="slider"></span>
                        </label>
                        <i class="fas fa-moon icon"></i>
                    </div>
                </div>
            </nav>
    </header>

    <!-- MAIN CONTENT (from Electrical, "Back" button removed) -->
    <main class="container">
        <!-- Back button removed from here -->
        <div class="tool-container">
            <h2>Advanced Electrical Breaker Sizing and Selection Tool</h2>
            <div class="tool-description">
                <p>This powerful calculator assists in sizing circuit breakers and determining their thermal and magnetic trip settings for a wide range of industrial applications, adhering to international electrical standards like IEC and NEC. It provides detailed calculations and recommendations for optimal system protection and coordination.</p>
            </div>
            <div class="calculator-form">
                <form id="electrical-calculations-form">
                    <!-- Motor Breaker Calculation Section -->
                    <h3>Motor Circuit Breaker Calculation</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="motor-power-unit">Motor Power Unit <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Select the unit for motor power (Horsepower or Kilowatts).</span></span></label>
                            <select id="motor-power-unit" required>
                                <option value="hp">HP (Horsepower)</option>
                                <option value="kw">kW (Kilowatts)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="motor-power">Motor Power <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">The rated power of the motor.</span></span></label>
                            <input type="number" id="motor-power" min="0.1" step="0.1" value="37" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="motor-type">Motor Type <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Select motor type for specific starting current characteristics (e.g., Squirrel Cage, Synchronous).</span></span></label>
                            <select id="motor-type" required>
                                <option value="squirrel-cage">Squirrel Cage Induction Motor</option>
                                <option value="synchronous">Synchronous Motor</option>
                                <option value="wound-rotor">Wound Rotor Induction Motor</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="motor-starting-method">Motor Starting Method <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">The method used to start the motor, affecting its starting current (e.g., Direct Online, Star-Delta).</span></span></label>
                            <select id="motor-starting-method" required>
                                <option value="dol">Direct Online (DOL)</option>
                                <option value="star-delta">Star-Delta</option>
                                <option value="soft-starter">Soft Starter</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="voltage-type">System Voltage Type <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Specify if the system is Single Phase or Three Phase.</span></span></label>
                            <select id="voltage-type" required>
                                <option value="three-phase">Three Phase</option>
                                <option value="single-phase">Single Phase</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="system-voltage">System Voltage (V) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Nominal system voltage (e.g., 400V, 480V, 230V).</span></span></label>
                            <input type="number" id="system-voltage" min="1" step="1" value="400" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="power-factor">Power Factor (PF) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Motor power factor (e.g., 0.8 lagging). Enter as a decimal (0.0 to 1.0).</span></span></label>
                            <input type="number" id="power-factor" min="0.1" max="1" step="0.01" value="0.8" required>
                        </div>
                        <div class="form-group">
                            <label for="efficiency">Motor Efficiency (%) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Motor efficiency (e.g., 90%). Enter as a percentage.</span></span></label>
                            <input type="number" id="efficiency" min="1" max="100" step="0.1" value="90" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="cable-type">Cable Insulation Type <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Common types are PVC (75°C) or XLPE (90°C). This affects cable ampacity.</span></span></label>
                            <select id="cable-type" required>
                                <option value="75">PVC (75°C)</option>
                                <option value="90">XLPE (90°C)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="installation-method">Installation Method <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">How the cable is installed (e.g., in conduit, open air). Affects ampacity.</span></span></label>
                            <select id="installation-method" required>
                                <option value="conduit">In Conduit/Tray</option>
                                <option value="open-air">Open Air</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="ambient-temp">Ambient Temperature (°C) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">The maximum ambient temperature around the cable and breaker. Standard is 30°C.</span></span></label>
                            <input type="number" id="ambient-temp" min="0" step="1" value="30" required>
                        </div>
                        <div class="form-group">
                            <label for="number-of-conductors">Number of Current-Carrying Conductors <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Number of active conductors in conduit/bundle (e.g., 3 for 3-phase, 4 for 3-phase+N).</span></span></label>
                            <input type="number" id="number-of-conductors" min="2" step="1" value="3" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="cable-length">Cable Length (m) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Total length of the cable run in meters. Used for voltage drop calculation.</span></span></label>
                            <input type="number" id="cable-length" min="1" step="1" value="50" required>
                        </div>
                        <div class="form-group">
                            <label for="conductor-material">Conductor Material <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Material of the cable conductor (Copper or Aluminum). Affects resistance.</span></span></label>
                            <select id="conductor-material" required>
                                <option value="copper">Copper</option>
                                <option value="aluminum">Aluminum</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="conductor-size-selection">Assumed Conductor Size (mm²) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Select a common conductor size for voltage drop calculation. This is for illustrative purposes.</span></span></label>
                            <select id="conductor-size-selection" required>
                                <option value="1.5">1.5 mm²</option>
                                <option value="2.5">2.5 mm²</option>
                                <option value="4">4 mm²</option>
                                <option value="6">6 mm²</option>
                                <option value="10">10 mm²</option>
                                <option value="16">16 mm²</option>
                                <option value="25">25 mm²</option>
                                <option value="35">35 mm²</option>
                                <option value="50">50 mm²</option>
                                <option value="70">70 mm²</option>
                                <option value="95">95 mm²</option>
                                <option value="120">120 mm²</option>
                                <option value="150">150 mm²</option>
                                <option value="185">185 mm²</option>
                                <option value="240">240 mm²</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="overload-protection-factor">Overload Protection Factor (%) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Factor for continuous load. Typically 125% for motors (NEC 430.32).</span></span></label>
                            <input type="number" id="overload-protection-factor" min="100" max="150" step="5" value="125" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="breaker-type">Breaker Type <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Common types like MCCB, ACB, MCB. MCCB is typically for industrial motor applications.</span></span></label>
                            <select id="breaker-type" required>
                                <option value="mccb">Moulded Case Circuit Breaker (MCCB)</option>
                                <option value="acb">Air Circuit Breaker (ACB)</option>
                                <option value="mcb">Miniature Circuit Breaker (MCB)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="short-circuit-current">Available Short Circuit Current (kA) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">The maximum fault current available at the breaker's location (e.g., 20 kA).</span></span></label>
                            <input type="number" id="short-circuit-current" min="0.1" step="0.1" value="20" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="device-coordination">Device Coordination Strategy <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Select coordination strategy (e.g., Selective, Fully Coordinated).</span></span></label>
                            <select id="device-coordination" required>
                                <option value="selective">Selective Coordination</option>
                                <option value="fully-coordinated">Fully Coordinated</option>
                                <option value="none">No Specific Coordination</option>
                            </select>
                        </div>
                    </div>
                    <button type="button" id="calculate-motor-breaker-btn" class="calculate-btn">
                        Calculate Motor Breaker <span id="motor-loading-spinner" class="loading-spinner" style="display:none;"></span>
                    </button>
                    
                    <hr style="margin: 30px 0; border-color: var(--border-color);">
                    
                    <!-- PCC/MCC Incomer Breaker Calculation Section -->
                    <h3>PCC/MCC Incomer Breaker Calculation</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="pcc-mcc-load-unit">Total Connected Load Unit <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Unit for the total connected load (kVA or kW).</span></span></label>
                            <select id="pcc-mcc-load-unit" required>
                                <option value="kVA">kVA</option>
                                <option value="kW">kW</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="pcc-mcc-total-load">Total Connected Load <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Sum of all connected loads to the PCC/MCC.</span></span></label>
                            <input type="number" id="pcc-mcc-total-load" min="0.1" step="0.1" value="500" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="pcc-mcc-demand-factor">Demand Factor (%) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Ratio of maximum demand to total connected load. Typically < 100%.</span></span></label>
                            <input type="number" id="pcc-mcc-demand-factor" min="1" max="100" step="1" value="70" required>
                        </div>
                        <div class="form-group">
                            <label for="pcc-mcc-diversity-factor">Diversity Factor (%) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Ratio of sum of individual maximum demands to the overall maximum demand. Typically > 100%.</span></span></label>
                            <input type="number" id="pcc-mcc-diversity-factor" min="100" step="1" value="120" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="pcc-mcc-future-expansion">Future Expansion (%) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Percentage for anticipated load growth.</span></span></label>
                            <input type="number" id="pcc-mcc-future-expansion" min="0" step="1" value="20" required>
                        </div>
                        <div class="form-group">
                            <label for="pcc-mcc-voltage">System Voltage (V) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Nominal system voltage for the PCC/MCC.</span></span></label>
                            <input type="number" id="pcc-mcc-voltage" min="1" step="1" value="400" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="pcc-mcc-voltage-type">System Voltage Type <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Specify if the system is Single Phase or Three Phase.</span></span></label>
                            <select id="pcc-mcc-voltage-type" required>
                                <option value="three-phase">Three Phase</option>
                                <option value="single-phase">Single Phase</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="pcc-mcc-power-factor">Power Factor (PF) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Overall power factor of the PCC/MCC loads.</span></span></label>
                            <input type="number" id="pcc-mcc-power-factor" min="0.1" max="1" step="0.01" value="0.85" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="pcc-mcc-breaker-type">Breaker Type <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Common types like ACB, MCCB for incomers.</span></span></label>
                            <select id="pcc-mcc-breaker-type" required>
                                <option value="acb">Air Circuit Breaker (ACB)</option>
                                <option value="mccb">Moulded Case Circuit Breaker (MCCB)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="pcc-mcc-short-circuit-current">Available Short Circuit Current (kA) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Max fault current at incomer location.</span></span></label>
                            <input type="number" id="pcc-mcc-short-circuit-current" min="0.1" step="0.1" value="50" required>
                        </div>
                    </div>
                    <button type="button" id="calculate-pcc-mcc-breaker-btn" class="calculate-btn">
                        Calculate PCC/MCC Breaker <span id="pcc-mcc-loading-spinner" class="loading-spinner" style="display:none;"></span>
                    </button>
                    
                    <hr style="margin: 30px 0; border-color: var(--border-color);">
                    
                    <!-- Transformer Breaker Calculation Section -->
                    <h3>Transformer Breaker Calculation</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="transformer-kVA">Transformer kVA Rating <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Rated power of the transformer in kVA.</span></span></label>
                            <input type="number" id="transformer-kVA" min="1" step="1" value="1000" required>
                        </div>
                        <div class="form-group">
                            <label for="transformer-primary-voltage">Primary Voltage (V) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Nominal voltage on the primary side of the transformer.</span></span></label>
                            <input type="number" id="transformer-primary-voltage" min="1" step="1" value="11000" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="transformer-secondary-voltage">Secondary Voltage (V) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Nominal voltage on the secondary side of the transformer.</span></span></label>
                            <input type="number" id="transformer-secondary-voltage" min="1" step="1" value="400" required>
                        </div>
                        <div class="form-group">
                            <label for="transformer-impedance">Transformer Impedance (Z%) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Percentage impedance of the transformer. Important for fault current calculation.</span></span></label>
                            <input type="number" id="transformer-impedance" min="1" max="10" step="0.1" value="5" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="transformer-connection-type">Transformer Connection Type <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Common connection types (e.g., Delta-Wye). Affects fault current calculation.</span></span></label>
                            <select id="transformer-connection-type" required>
                                <option value="delta-wye">Delta-Wye (Dy)</option>
                                <option value="wye-wye">Wye-Wye (Yy)</option>
                                <option value="delta-delta">Delta-Delta (Dd)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="transformer-breaker-type">Breaker Type (Primary/Secondary) <span class="tooltip"><i class="fas fa-info-circle info-icon"></i><span class="tooltiptext">Common types like ACB, MCCB.</span></span></label>
                            <select id="transformer-breaker-type" required>
                                <option value="acb">Air Circuit Breaker (ACB)</option>
                                <option value="mccb">Moulded Case Circuit Breaker (MCCB)</option>
                                <option value="vcb">Vacuum Circuit Breaker (VCB)</option>
                            </select>
                        </div>
                    </div>
                    <button type="button" id="calculate-transformer-breaker-btn" class="calculate-btn">
                        Calculate Transformer Breaker <span id="transformer-loading-spinner" class="loading-spinner" style="display:none;"></span>
                    </button>
                </form>
            </div>
            
            <!-- Result Container (Shared for all calculators) -->
            <div id="result-container" class="result-container">
                <h3>Calculation Results</h3>
                
                <!-- Motor Results -->
                <div id="motor-calculation-details" class="calculation-section"></div>
                <table class="result-table" id="motor-result-table">
                    <thead><tr><th colspan="2">Motor Circuit Breaker Results</th></tr></thead>
                    <tbody id="motor-result-table-body"></tbody>
                </table>
                
                <!-- PCC/MCC Results -->
                <div id="pcc-mcc-calculation-details" class="calculation-section" style="margin-top: 30px;"></div>
                <table class="result-table" id="pcc-mcc-result-table" style="margin-top: 15px;">
                    <thead><tr><th colspan="2">PCC/MCC Incomer Breaker Results</th></tr></thead>
                    <tbody id="pcc-mcc-result-table-body"></tbody>
                </table>
                
                <!-- Transformer Results -->
                <div id="transformer-calculation-details" class="calculation-section" style="margin-top: 30px;"></div>
                <table class="result-table" id="transformer-result-table" style="margin-top: 15px;">
                    <thead><tr><th colspan="2">Transformer Breaker Results</th></tr></thead>
                    <tbody id="transformer-result-table-body"></tbody>
                </table>
                
                <!-- Standard Reference (Shared) -->
                <div class="standard-reference" id="standard-reference">
                    <!-- Standard reference text will be inserted here by JS -->
                </div>
            </div>
        </div>
    </main>

    <!-- NEW CONTENT BLOCK for AdSense -->
    <div class="container">
        <div class="content-block">
            <h2>Understanding Breaker Sizing: Key Concepts</h2>
            <p>Properly sizing a circuit breaker is critical for both safety and reliability. A breaker that is too small will cause nuisance tripping, while one that is too large will fail to protect equipment and cables from dangerous overloads and short circuits. This calculator uses fundamental principles outlined in standards like the NEC (National Electrical Code) and IEC (International Electrotechnical Commission) to provide a comprehensive recommendation. Here are the key concepts this tool evaluates:</p>

            <h3>1. Full Load Amps (FLA)</h3>
            <p><strong>What it is:</strong> This is the rated current a motor or transformer draws while operating at its maximum rated power (HP or kW/kVA). It is the baseline value for all protection calculations. The calculator finds this using the power formula:</p>
            <ul>
                <li><strong>Three Phase:</strong> `Current (A) = (Power (kW) * 1000) / (Voltage (V) * Power Factor * Efficiency * 1.732)`</li>
                <li><strong>Single Phase:</strong> `Current (A) = (Power (kW) * 1000) / (Voltage (V) * Power Factor * Efficiency)`</li>
            </ul>

            <h3>2. Overload Protection (Thermal Trip)</h3>
            <p><strong>What it is:</strong> This function protects the circuit from currents that are slightly above the FLA but persist for a long time, which can cause cables and windings to overheat and melt. This is handled by the <strong>thermal trip</strong> (or long-time delay, `L`) setting on a breaker.</p>
            <ul>
                <li><strong>How it's set:</strong> Standards typically require this to be set at 115% to 125% of the FLA. This slight overhead allows for small, temporary fluctuations without tripping, but will trip if the overload condition continues.</li>
            </ul>

            <h3>3. Short Circuit Protection (Magnetic Trip)</h3>
            <p><strong>What it is:</strong> This function provides near-instantaneous protection against extremely high currents caused by a short circuit (e.g., a phase-to-ground or phase-to-phase fault). This is handled by the <strong>magnetic trip</strong> (or instantaneous, `I`) setting.</p>
            <ul>
                <li><strong>How it's set:</strong> This setting must be high enough to avoid tripping during the motor's normal starting <strong>inrush current</strong> (see below), but low enough to trip instantly during a fault. This is why the calculator provides a *range* (e.g., 500A to 1000A).</li>
            </ul>

            <h3>4. Motor Inrush Current</h3>
            <p><strong>What it is:</strong> When a motor (especially a "squirrel-cage" type) starts "Direct Online (DOL)", it can momentarily draw 6 to 8 times its FLA. This is a normal part of its operation. The breaker's magnetic trip must be set *above* this inrush current to prevent tripping every time the motor starts. Starting methods like "Star-Delta" or "Soft Starter" are used specifically to reduce this inrush current, allowing for a more sensitive magnetic setting.</p>

            <h3>5. Breaking Capacity (Icu / Ics)</h3>
            <p><strong>What it is:</strong> This is the *maximum* fault current a breaker can safely interrupt without destroying itself. The "Available Short Circuit Current" you input is the worst-case fault current that your power system can deliver to that point. The breaker you select *must* have a breaking capacity (e.g., 25kA, 50kA) equal to or greater than this value.</p>
            <ul>
                <li><strong>Icu (Ultimate Breaking Capacity):</strong> The max current the breaker can interrupt once (it may be damaged but will have saved the circuit).</li>
                <li><strong>Ics (Service Breaking Capacity):</strong> The max current the breaker can interrupt multiple times and remain in service. This is a measure of its robustness.</li>
            </ul>
            
            <h3>6. Coordination (Selectivity)</h3>
            <p><strong>What it is:</strong> In a large system, you don't want a small fault on a single motor to trip the main incomer breaker for the entire building. <strong>Selective Coordination</strong> ensures that only the breaker *closest* to the fault trips, isolating the problem while keeping the rest of the system online. This is achieved by carefully setting the time-delay and instantaneous trip levels of breakers in series (e.g., the motor breaker is set to trip faster than the MCC incomer, which is set to trip faster than the main transformer breaker).</p>
        </div>
    </div>

    <!-- NEW FOOTER (from Pipe Flow) -->
        <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-left">
                    <a href="/" class="footer-logo">
                        <img src="logo.png" alt="Design Calculators Logo" loading="lazy" decoding="async">
                        <span class="footer-logo-text">Design Calculators</span>
                    </a>
                    <p class="footer-description">A comprehensive engineering calculator hub based on IEC, IEEE, and
                        global standards.</p>
                    <div class="social-buttons">
                        <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://designcalculators.co.in"
                            target="_blank" rel="noopener noreferrer" class="social-btn linkedin"
                            aria-label="LinkedIn"><i class="fab fa-linkedin-in"></i></a>
                        <a href="https://www.youtube.com/@designcalculators" target="_blank" rel="noopener noreferrer"
                            class="social-btn youtube" aria-label="YouTube"><i class="fab fa-youtube"></i></a>
                        <a href="https://twitter.com/intent/tweet?url=https://designcalculators.co.in&text=Check%20out%20this%20amazing%20engineering%20calculator%20hub!"
                            target="_blank" rel="noopener noreferrer" class="social-btn twitter" aria-label="Twitter"><i
                                class="fab fa-twitter"></i></a>
                        <a href="https://www.facebook.com/sharer/sharer.php?u=https://designcalculators.co.in"
                            target="_blank" rel="noopener noreferrer" class="social-btn facebook"
                            aria-label="Facebook"><i class="fab fa-facebook-f"></i></a>
                        <a href="https://api.whatsapp.com/send?text=Check%20out%20this%20amazing%20engineering%20resource:%20https://designcalculators.co.in"
                            target="_blank" rel="noopener noreferrer" class="social-btn whatsapp"
                            aria-label="WhatsApp"><i class="fab fa-whatsapp"></i></a>
                    </div>
                </div>
                <div class="footer-right">
                    <div class="footer-col">
                        <h4>Quick Links</h4>
                        <ul>
                            <li><a href='/indexele.html'>Electrical Tools</a></li>
                            <li><a href='/indexmech.html'>Mechanical Tools</a></li>
                            <li><a href='/indexinst.html'>Instrumentation Tools</a></li>
                            <li><a href='/about.html'>About Us</a></li>
                            <li><a href='/faq.html'>FAQ</a></li>
                        </ul>
                    </div>
                    <div class="footer-col">
                        <h4>Learn More</h4>
                        <ul>
                            <li><a href="https://www.youtube.com/@designcalculators" target="_blank"
                                    rel="noopener noreferrer">YouTube Channel</a></li>
                            <li><a href='/contact.html'>Contact Us</a></li>
                            <li><a href='/privacy-policy.html'>Privacy Policy</a></li>
                            <li><a href='/terms-of-service.html'>Terms of Service</a></li>
                            <li><a href='/sitemap2.html'>Sitemap</a></li>
                        </ul>
                    </div>
                    <div class="footer-col">
                        <h4>Our Network</h4>
                        <ul>
                            <li style="margin-bottom: 12px;">
                                <a href="https://reliabilitytools.co.in/" target="_blank" rel="noopener"
                                   style="font-weight: 600; display: block; margin-bottom: 2px;">Reliability Tools</a>
                                <span style="font-size: 0.85rem; color: #94a3b8; line-height: 1.3; display: block;">Reliability
                                    & maintenance engineering calculators.</span>
                            </li>
                            <li style="margin-bottom: 12px;">
                                <a href="https://electrosafe.homes/" target="_blank" rel="noopener"
                                   style="font-weight: 600; display: block; margin-bottom: 2px;">ElectroSafe</a>
                                <span style="font-size: 0.85rem; color: #94a3b8; line-height: 1.3; display: block;">Dedicated
                                    to home electrical safety & protection.</span>
                            </li>
                            <li>
                                <a href="https://knowyourname.co.in/" target="_blank" rel="noopener"
                                   style="font-weight: 600; display: block; margin-bottom: 2px;">KnowYourName</a>
                                <span style="font-size: 0.85rem; color: #94a3b8; line-height: 1.3; display: block;">Scientific
                                    name analysis: Phonetics, Ergonomics & Acoustics.</span>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="footer-disclaimer">
                <p>All calculations are for preliminary engineering design guidance. Final designs must comply with all applicable local and international standards (including but not limited to ASHRAE 90.1, ARI 550/590). Always verify calculations and consult with a licensed professional engineer before implementation or construction.</p>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 Design Calculators. Created by <span style="color: var(--secondary); font-weight: bold;">Anil Sharma</span>. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <!-- Custom Message Box for JS -->
    <div id="custom-message-box"></div>

    <!-- ORIGINAL JAVASCRIPT (Unchanged) -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Start of IIFE to encapsulate all script logic
            (function() {
                // Changed const to var for top-level DOM element references
                var calculateMotorBtn = document.getElementById('calculate-motor-breaker-btn');
                var calculatePccMccBtn = document.getElementById('calculate-pcc-mcc-breaker-btn');
                var calculateTransformerBtn = document.getElementById('calculate-transformer-breaker-btn');

                var motorLoadingSpinner = document.getElementById('motor-loading-spinner');
                var pccMccLoadingSpinner = document.getElementById('pcc-mcc-loading-spinner');
                var transformerLoadingSpinner = document.getElementById('transformer-loading-spinner');

                var resultContainer = document.getElementById('result-container');
                var motorCalculationDetailsDiv = document.getElementById('motor-calculation-details');
                var motorResultTableBody = document.getElementById('motor-result-table-body');
                var motorResultTable = document.getElementById('motor-result-table');

                var pccMccCalculationDetailsDiv = document.getElementById('pcc-mcc-calculation-details');
                var pccMccResultTableBody = document.getElementById('pcc-mcc-result-table-body');
                var pccMccResultTable = document.getElementById('pcc-mcc-result-table');

                var transformerCalculationDetailsDiv = document.getElementById('transformer-calculation-details');
                var transformerResultTableBody = document.getElementById('transformer-result-table-body');
                var transformerResultTable = document.getElementById('transformer-result-table');

                var standardReference = document.getElementById('standard-reference');
                
                // Set default values for inputs
                // Motor Section
                document.getElementById('motor-power-unit').value = 'kw';
                document.getElementById('motor-power').value = 37;
                document.getElementById('motor-type').value = 'squirrel-cage';
                document.getElementById('motor-starting-method').value = 'dol';
                document.getElementById('voltage-type').value = 'three-phase';
                document.getElementById('system-voltage').value = 400;
                document.getElementById('power-factor').value = 0.8;
                document.getElementById('efficiency').value = 90;
                document.getElementById('cable-type').value = 75;
                document.getElementById('installation-method').value = 'conduit';
                document.getElementById('ambient-temp').value = 30;
                document.getElementById('number-of-conductors').value = 3;
                document.getElementById('cable-length').value = 50;
                document.getElementById('conductor-material').value = 'copper';
                document.getElementById('conductor-size-selection').value = 16;
                document.getElementById('overload-protection-factor').value = 125;
                document.getElementById('breaker-type').value = 'mccb';
                document.getElementById('short-circuit-current').value = 20;
                document.getElementById('device-coordination').value = 'selective';

                // PCC/MCC Section
                document.getElementById('pcc-mcc-load-unit').value = 'kVA';
                document.getElementById('pcc-mcc-total-load').value = 500;
                document.getElementById('pcc-mcc-demand-factor').value = 70;
                document.getElementById('pcc-mcc-diversity-factor').value = 120;
                document.getElementById('pcc-mcc-future-expansion').value = 20;
                document.getElementById('pcc-mcc-voltage').value = 400;
                document.getElementById('pcc-mcc-voltage-type').value = 'three-phase';
                document.getElementById('pcc-mcc-power-factor').value = 0.85;
                document.getElementById('pcc-mcc-breaker-type').value = 'acb';
                document.getElementById('pcc-mcc-short-circuit-current').value = 50;

                // Transformer Section
                document.getElementById('transformer-kVA').value = 1000;
                document.getElementById('transformer-primary-voltage').value = 11000;
                document.getElementById('transformer-secondary-voltage').value = 400;
                document.getElementById('transformer-impedance').value = 5;
                document.getElementById('transformer-connection-type').value = 'delta-wye';
                document.getElementById('transformer-breaker-type').value = 'acb';

                // Standard reference text
                const standardReferenceText = "Electrical system design, including breaker sizing, cable selection, and fault current analysis, is governed by international standards such as the National Electrical Code (NEC) in North America and IEC 60364 series (Electrical installations of buildings), IEC 60947 series (Low-voltage switchgear and controlgear), and IEC 60076 series (Power transformers) internationally. Key considerations include continuous load current, motor starting characteristics, cable ampacity adjustments, voltage drop limits, short-circuit current ratings, and protective device coordination. Always refer to the latest edition of relevant codes, manufacturer data sheets, and local regulations for accurate and compliant design.";

                // Function to hide all calculation details and result tables
                function hideAllResults() {
                    motorCalculationDetailsDiv.classList.remove('show');
                    motorResultTable.classList.remove('show');
                    pccMccCalculationDetailsDiv.classList.remove('show');
                    pccMccResultTable.classList.remove('show');
                    transformerCalculationDetailsDiv.classList.remove('show');
                    transformerResultTable.classList.remove('show');
                    resultContainer.classList.remove('show'); // Hide main result container too
                }
                
                // Event listener for Motor Breaker Calculation
                calculateMotorBtn.addEventListener('click', function() {
                    hideAllResults(); // Hide all other results
                    motorLoadingSpinner.style.display = 'inline-block';
                    calculateMotorBtn.disabled = true; // Disable button during calc

                    setTimeout(() => {
                        const motorResults = calculateMotorBreaker();
                        if (motorResults) {
                            displayMotorResults(motorResults);
                            resultContainer.classList.add('show'); // Show main result container
                            motorResultTable.scrollIntoView({ behavior: 'smooth' });
                        }
                        motorLoadingSpinner.style.display = 'none';
                        calculateMotorBtn.disabled = false; // Re-enable button
                        standardReference.textContent = standardReferenceText;
                    }, 800);
                });
                
                // Event listener for PCC/MCC Incomer Breaker Calculation
                calculatePccMccBtn.addEventListener('click', function() {
                    hideAllResults(); // Hide all other results
                    pccMccLoadingSpinner.style.display = 'inline-block';
                    calculatePccMccBtn.disabled = true; // Disable button

                    setTimeout(() => {
                        const pccMccResults = calculatePCCMCCBreaker();
                        if (pccMccResults) {
                            displayPCCMCCResults(pccMccResults);
                            resultContainer.classList.add('show'); // Show main result container
                            pccMccResultTable.scrollIntoView({ behavior: 'smooth' });
                        }
                        pccMccLoadingSpinner.style.display = 'none';
                        calculatePccMccBtn.disabled = false; // Re-enable
                        standardReference.textContent = standardReferenceText;
                    }, 800);
                });
                
                // Event listener for Transformer Breaker Calculation
                calculateTransformerBtn.addEventListener('click', function() {
                    hideAllResults(); // Hide all other results
                    transformerLoadingSpinner.style.display = 'inline-block';
                    calculateTransformerBtn.disabled = true; // Disable button

                    setTimeout(() => {
                        const transformerResults = calculateTransformerBreaker();
                        if (transformerResults) {
                            displayTransformerResults(transformerResults);
                            resultContainer.classList.add('show'); // Show main result container
                            transformerResultTable.scrollIntoView({ behavior: 'smooth' });
                        }
                        transformerLoadingSpinner.style.display = 'none';
                        calculateTransformerBtn.disabled = false; // Re-enable
                        standardReference.textContent = standardReferenceText;
                    }, 800);
                });
                
                // --- Helper function to add rows to tables with animation ---
                function addResultRow(tableBody, parameter, value, delay) {
                    const row = tableBody.insertRow();
                    const paramCell = row.insertCell();
                    const valueCell = row.insertCell();
                    paramCell.textContent = parameter;
                    valueCell.innerHTML = `<strong>${value}</strong>`; // Make value bold
                    row.style.animationDelay = `${delay}s`;
                }
                
                // --- Function to display messages (replaces alert()) ---
                function displayMessage(message, type = "info") {
                    let messageBox = document.getElementById('custom-message-box');
                    // No need to re-create if it's in the HTML
                    
                    messageBox.textContent = message;
                    if (type === "error") {
                        messageBox.style.backgroundColor = '#dc3545'; /* Red */
                    } else if (type === "warning") {
                        messageBox.style.backgroundColor = '#ffc107'; /* Amber */
                        messageBox.style.color = '#333';
                    } else {
                        messageBox.style.backgroundColor = '#28a745'; /* Green */
                        messageBox.style.color = 'white'; // Ensure text is white on green
                    }
                    messageBox.classList.add('show');

                    // Hide after 5 seconds
                    setTimeout(() => {
                        messageBox.classList.remove('show');
                    }, 5000);
                }
                
                // --- Motor Breaker Calculation Logic ---
                function calculateMotorBreaker() {
                    const motorPowerUnit = document.getElementById('motor-power-unit').value;
                    const motorPower = parseFloat(document.getElementById('motor-power').value);
                    const motorType = document.getElementById('motor-type').value;
                    const motorStartingMethod = document.getElementById('motor-starting-method').value;
                    const voltageType = document.getElementById('voltage-type').value;
                    const systemVoltage = parseFloat(document.getElementById('system-voltage').value);
                    const powerFactor = parseFloat(document.getElementById('power-factor').value);
                    const efficiency = parseFloat(document.getElementById('efficiency').value) / 100;
                    const cableType = parseFloat(document.getElementById('cable-type').value);
                    const installationMethod = document.getElementById('installation-method').value;
                    const ambientTemp = parseFloat(document.getElementById('ambient-temp').value);
                    const numberOfConductors = parseInt(document.getElementById('number-of-conductors').value);
                    const cableLength = parseFloat(document.getElementById('cable-length').value);
                    const conductorMaterial = document.getElementById('conductor-material').value;
                    const conductorSizeSelected = parseFloat(document.getElementById('conductor-size-selection').value);
                    const overloadProtectionFactor = parseFloat(document.getElementById('overload-protection-factor').value);
                    const breakerType = document.getElementById('breaker-type').value;
                    const shortCircuitCurrent = parseFloat(document.getElementById('short-circuit-current').value);
                    // Removed redundant declaration of deviceCoordination
                    const selectedDeviceCoordination = document.getElementById('device-coordination').value;

                    // Input validation (basic, more comprehensive validation can be added)
                    if (isNaN(motorPower) || isNaN(systemVoltage) || isNaN(powerFactor) || isNaN(efficiency) ||
                        isNaN(ambientTemp) || isNaN(numberOfConductors) || isNaN(cableLength) ||
                        isNaN(overloadProtectionFactor) || isNaN(shortCircuitCurrent) || isNaN(conductorSizeSelected)) {
                        displayMessage("Motor Breaker: Please fill in all required fields with valid numbers.", "error");
                        return null;
                    }
                    if (motorPower <= 0 || systemVoltage <= 0 || powerFactor <= 0 || powerFactor > 1 || efficiency <= 0 || efficiency > 1 ||
                        ambientTemp < 0 || numberOfConductors < 2 || cableLength <= 0 || overloadProtectionFactor < 100 || overloadProtectionFactor > 150 ||
                        shortCircuitCurrent <= 0) {
                        displayMessage("Motor Breaker: Please enter valid positive values for all inputs. Power Factor and Efficiency should be between 0 and 1 (or 100%). Ambient temperature non-negative. Number of conductors >= 2. Cable length > 0. Overload protection factor between 100 and 150.", "error");
                        return null;
                    }

                    let calculationHtml = '<h4>Motor Circuit Breaker Calculation Steps:</h4>';
                    
                    // Step 1: Calculate Motor Full Load Amps (FLA) from Motor Power
                    let motorFLA;
                    const KW_TO_HP = 0.7457;

                    let motorPowerKW = motorPower;
                    if (motorPowerUnit === 'hp') {
                        motorPowerKW = motorPower * KW_TO_HP;
                    }

                    if (voltageType === 'three-phase') {
                        motorFLA = (motorPowerKW * 1000) / (Math.sqrt(3) * systemVoltage * powerFactor * efficiency);
                        calculationHtml += `<p><strong>1. Calculate Motor Full Load Amps (FLA):</strong></p>`;
                        calculationHtml += `<p>For a Three-Phase system:</p>`;
                        calculationHtml += `<p class="formula">$$I_{\\text{FLA}} = \\frac{P_{\\text{kW}} \\times 1000}{\\sqrt{3} \\times V \\times PF \\times \\eta}$$</p>`;
                        calculationHtml += `<p class="calculation-step">I_FLA = (${motorPowerKW.toFixed(2)} x 1000) / (1.732 x ${systemVoltage.toFixed(0)} x ${powerFactor.toFixed(2)} x ${efficiency.toFixed(2)}) = ${motorFLA.toFixed(2)} A</p>`;
                    } else { // Single-phase
                        motorFLA = (motorPowerKW * 1000) / (systemVoltage * powerFactor * efficiency);
                        calculationHtml += `<p><strong>1. Calculate Motor Full Load Amps (FLA):</strong></p>`;
                        calculationHtml += `<p>For a Single-Phase system:</p>`;
                        calculationHtml += `<p class="formula">$$I_{\\text{FLA}} = \\frac{P_{\\text{kW}} \\times 1000}{V \\times PF \\times \\eta}$$</p>`;
                        calculationHtml += `<p class="calculation-step">I_FLA = (${motorPowerKW.toFixed(2)} x 1000) / (${systemVoltage.toFixed(0)} x ${powerFactor.toFixed(2)} x ${efficiency.toFixed(2)}) = ${motorFLA.toFixed(2)} A</p>`;
                    }

                    // Step 2: Calculate Continuous Current for Breaker Sizing
                    const continuousCurrent = motorFLA * (overloadProtectionFactor / 100);
                    calculationHtml += `<p><strong>2. Calculate Continuous Current for Breaker Sizing:</strong></p>`;
                    calculationHtml += `<p class="formula">$$I_{\\text{continuous}} = \\text{FLA} \\times \\frac{\\text{Overload Protection Factor}}{100}$$</p>`;
                    calculationHtml += `<p class="calculation-step">I_continuous = ${motorFLA.toFixed(2)} A x ${overloadProtectionFactor.toFixed(0)} / 100 = ${continuousCurrent.toFixed(2)} A</p>`;

                    // Step 3: Determine Cable Ampacity Adjustment Factors
                    let tempCorrectionFactor;
                    if (cableType === 75) { /* ... logic ... */ tempCorrectionFactor = (ambientTemp <= 20) ? 1.05 : (ambientTemp <= 25) ? 1.00 : (ambientTemp <= 30) ? 0.96 : (ambientTemp <= 35) ? 0.91 : (ambientTemp <= 40) ? 0.87 : (ambientTemp <= 45) ? 0.82 : (ambientTemp <= 50) ? 0.76 : 0.0; } else { /* ... logic ... */ tempCorrectionFactor = (ambientTemp <= 20) ? 1.04 : (ambientTemp <= 25) ? 1.00 : (ambientTemp <= 30) ? 0.97 : (ambientTemp <= 35) ? 0.94 : (ambientTemp <= 40) ? 0.91 : (ambientTemp <= 45) ? 0.87 : (ambientTemp <= 50) ? 0.84 : 0.0; }
                    let bundleCorrectionFactor;
                    if (numberOfConductors <= 3) bundleCorrectionFactor = 1.00; else if (numberOfConductors <= 6) bundleCorrectionFactor = 0.80; else if (numberOfConductors <= 9) bundleCorrectionFactor = 0.70; else if (numberOfConductors <= 20) bundleCorrectionFactor = 0.50; else bundleCorrectionFactor = 0.45;

                    calculationHtml += `<p><strong>3. Determine Cable Ampacity Adjustment Factors:</strong></p>`;
                    calculationHtml += `<p class="calculation-step">Temperature Correction Factor = ${tempCorrectionFactor.toFixed(2)}, Bundle Correction Factor = ${bundleCorrectionFactor.toFixed(2)}</p>`;

                    // Step 4: Calculate Minimum Required Conductor Ampacity
                    const minRequiredConductorAmpacity = continuousCurrent;
                    calculationHtml += `<p><strong>4. Calculate Minimum Required Conductor Ampacity:</strong></p>`;
                    calculationHtml += `<p class="calculation-step">Min Required Conductor Ampacity = ${minRequiredConductorAmpacity.toFixed(2)} A</p>`;

                    // Step 5: Calculate Voltage Drop
                    const cableData = { /* ... data ... */
                        'copper': {
                            1.5: { R: 12.1, X: 0.09 }, 2.5: { R: 7.41, X: 0.09 }, 4: { R: 4.61, X: 0.09 },
                            6: { R: 3.08, X: 0.09 }, 10: { R: 1.83, X: 0.08 }, 16: { R: 1.15, X: 0.08 },
                            25: { R: 0.727, X: 0.08 }, 35: { R: 0.524, X: 0.08 }, 50: { R: 0.387, X: 0.08 },
                            70: { R: 0.268, X: 0.08 }, 95: { R: 0.193, X: 0.08 }, 120: { R: 0.153, X: 0.08 },
                            150: { R: 0.124, X: 0.08 }, 185: { R: 0.0991, X: 0.08 }, 240: { R: 0.0754, X: 0.08 }
                        },
                        'aluminum': {
                            1.5: { R: 19.8, X: 0.09 }, 2.5: { R: 12.0, X: 0.09 }, 4: { R: 7.41, X: 0.09 },
                            6: { R: 4.95, X: 0.09 }, 10: { R: 2.95, X: 0.08 }, 16: { R: 1.84, X: 0.08 },
                            25: { R: 1.18, X: 0.08 }, 35: { R: 0.85, X: 0.08 }, 50: { R: 0.628, X: 0.08 },
                            70: { R: 0.443, X: 0.08 }, 95: { R: 0.32, X: 0.08 }, 120: { R: 0.253, X: 0.08 },
                            150: { R: 0.206, X: 0.08 }, 185: { R: 0.164, X: 0.08 }, 240: { R: 0.125, X: 0.08 }
                        }
                    };
                    const selectedConductorData = cableData[conductorMaterial][conductorSizeSelected];
                    let voltageDrop = 0;
                    let percentVoltageDrop = 0;
                    if (selectedConductorData) {
                        const R = selectedConductorData.R;
                        const X = selectedConductorData.X;
                        const cosPhi = powerFactor;
                        const sinPhi = Math.sqrt(1 - (powerFactor * powerFactor));
                        if (voltageType === 'three-phase') {
                            voltageDrop = (Math.sqrt(3) * cableLength * continuousCurrent * (R * cosPhi + X * sinPhi)) / 1000;
                        } else {
                            voltageDrop = (2 * cableLength * continuousCurrent * (R * cosPhi + X * sinPhi)) / 1000;
                        }
                        percentVoltageDrop = (voltageDrop / systemVoltage) * 100;
                    }
                    calculationHtml += `<p><strong>5. Calculate Voltage Drop:</strong></p>`;
                    if (selectedConductorData) {
                        calculationHtml += `<p class="calculation-step">Voltage Drop = ${voltageDrop.toFixed(2)} V (${percentVoltageDrop.toFixed(2)}%)</p>`;
                        if (percentVoltageDrop > 5) {
                             calculationHtml += `<p class="calculation-step" style="color:red; background-color: #fdd;">Warning: Voltage drop (${percentVoltageDrop.toFixed(2)}%) exceeds typical 5% limit. Consider a larger conductor size.</p>`;
                        }
                    } else {
                        calculationHtml += `<p class="calculation-step">Voltage Drop calculation skipped due to missing conductor data.</p>`;
                    }

                    // Step 6: Calculate Breaker Frame Size
                    const standardBreakerSizes = [15, 20, 25, 30, 35, 40, 45, 50, 60, 70, 80, 90, 100, 110, 125, 150, 175, 200, 225, 250, 300, 350, 400, 450, 500, 600, 700, 800, 1000, 1200, 1600, 2000, 2500, 3000, 4000, 5000, 6000];
                    let selectedBreakerFrameSize = standardBreakerSizes.find(size => size >= continuousCurrent);
                    if (!selectedBreakerFrameSize) { selectedBreakerFrameSize = standardBreakerSizes[standardBreakerSizes.length - 1]; }
                    calculationHtml += `<p><strong>6. Calculate Breaker Frame Size:</strong></p>`;
                    calculationHtml += `<p class="calculation-step">Selected Breaker Frame Size (next standard size >= ${continuousCurrent.toFixed(2)} A) = ${selectedBreakerFrameSize.toFixed(0)} A</p>`;

                    // Step 7: Thermal Trip Setting
                    const thermalTripSetting = motorFLA * (overloadProtectionFactor / 100);
                    calculationHtml += `<p><strong>7. Determine Thermal Trip Setting (Long-Time Delay):</strong></p>`;
                    calculationHtml += `<p class="calculation-step">Thermal Trip Setting = ${thermalTripSetting.toFixed(2)} A (This is the ideal setting, typically adjustable on MCCB/ACB)</p>`;

                    // Step 8: Magnetic Trip Setting
                    let motorTypeStartingFactor;
                    switch(motorType) { case 'squirrel-cage': motorTypeStartingFactor = 6; break; case 'synchronous': motorTypeStartingFactor = 3.5; break; case 'wound-rotor': motorTypeStartingFactor = 2.5; break; default: motorTypeStartingFactor = 6; }
                    let startingMethodReductionFactor;
                    switch(motorStartingMethod) { case 'dol': startingMethodReductionFactor = 1.0; break; case 'star-delta': startingMethodReductionFactor = 1 / Math.sqrt(3); break; case 'soft-starter': startingMethodReductionFactor = 0.5; break; default: startingMethodReductionFactor = 1.0; }
                    const effectiveStartingCurrentFactor = motorTypeStartingFactor * startingMethodReductionFactor;
                    const estimatedStartingCurrent = motorFLA * effectiveStartingCurrentFactor;
                    let minMagneticTripFactor = 7; let maxMagneticTripFactor = 10;
                    if (breakerType === 'acb') { minMagneticTripFactor = 5; maxMagneticTripFactor = 8; } else if (breakerType === 'mcb') { minMagneticTripFactor = 5; maxMagneticTripFactor = 10; } // Note: MCB types (B, C, D) have fixed magnetic trips
                    
                    let magneticTripLowerBound = Math.max(estimatedStartingCurrent * 1.1, motorFLA * minMagneticTripFactor); // Must be > inrush
                    let magneticTripUpperBound = motorFLA * maxMagneticTripFactor;
                    
                    // Round to reasonable values
                    magneticTripLowerBound = Math.ceil(magneticTripLowerBound / 50) * 50;
                    magneticTripUpperBound = Math.ceil(magneticTripUpperBound / 50) * 50;
                    
                    if (magneticTripLowerBound > magneticTripUpperBound) {
                        magneticTripLowerBound = magneticTripUpperBound; // Fix potential crossover
                    }

                    calculationHtml += `<p><strong>8. Determine Magnetic Trip Setting (Instantaneous Trip):</strong></p>`;
                    calculationHtml += `<p class="calculation-step">Estimated Inrush Current = ${motorFLA.toFixed(2)} A x ${effectiveStartingCurrentFactor.toFixed(2)} = ${estimatedStartingCurrent.toFixed(2)} A</p>`;
                    calculationHtml += `<p class="calculation-step">Suggested Magnetic Trip Range (must be > inrush): ${magneticTripLowerBound.toFixed(0)} A to ${magneticTripUpperBound.toFixed(0)} A</p>`;

                    // Step 9: Calculate Short Circuit Breaking Capacity
                    const requiredBreakingCapacity = shortCircuitCurrent;
                    calculationHtml += `<p><strong>9. Determine Short Circuit Breaking Capacity (Icu/Ics):</strong></p>`;
                    calculationHtml += `<p class="calculation-step">Minimum Required Breaking Capacity (must be >= Available Fault Current) = ${requiredBreakingCapacity.toFixed(2)} kA</p>`;

                    // Step 10: Device Coordination Considerations
                    let coordinationRecommendation = "";
                    if (selectedDeviceCoordination === 'selective') { coordinationRecommendation = "Selective coordination ensures only the faulted section is isolated. This requires time-delay settings on the breaker."; } else if (selectedDeviceCoordination === 'fully-coordinated') { coordinationRecommendation = "Fully coordinated systems minimize disruption. This requires detailed analysis of upstream/downstream breaker trip curves."; } else { coordinationRecommendation = "No specific coordination strategy selected. Upstream breakers may trip on a motor fault."; }
                    calculationHtml += `<p><strong>10. Device Coordination Strategy:</strong></p>`;
                    calculationHtml += `<p class="calculation-step">${coordinationRecommendation}</p>`;
                    
                    return {
                        html: calculationHtml,
                        results: {
                            motorPower: `${motorPower.toFixed(2)} ${motorPowerUnit.toUpperCase()}`,
                            calculatedMotorFLA: motorFLA.toFixed(2) + " A",
                            motorType: motorType.split('-').map(word => word.charAt(0).toUpperCase() + word.slice(1)).join(' '),
                            motorStartingMethod: motorStartingMethod.split('-').map(word => word.charAt(0).toUpperCase() + word.slice(1)).join(' '),
                            systemVoltage: systemVoltage.toFixed(0) + " V (" + voltageType.split('-').map(word => word.charAt(0).toUpperCase() + word.slice(1)).join(' ') + ")",
                            powerFactor: powerFactor.toFixed(2),
                            motorEfficiency: (efficiency * 100).toFixed(1) + "%",
                            cableInsulationType: cableType + "°C",
                            installationMethod: installationMethod === "conduit" ? "In Conduit/Tray" : "Open Air",
                            ambientTemperature: ambientTemp.toFixed(1) + "°C",
                            numberOfConductors: numberOfConductors,
                            cableLength: cableLength.toFixed(0) + " m",
                            conductorMaterial: conductorMaterial.charAt(0).toUpperCase() + conductorMaterial.slice(1),
                            assumedConductorSize: conductorSizeSelected + " mm²",
                            calculatedVoltageDrop: `${voltageDrop.toFixed(2)} V (${percentVoltageDrop.toFixed(2)}%) ${percentVoltageDrop > 5 ? ' (High!)' : ''}`,
                            overloadProtectionFactor: overloadProtectionFactor.toFixed(0) + "%",
                            selectedBreakerType: breakerType.toUpperCase(),
                            availableShortCircuitCurrent: shortCircuitCurrent.toFixed(2) + " kA",
                            deviceCoordinationStrategy: selectedDeviceCoordination.split('-').map(word => word.charAt(0).toUpperCase() + word.slice(1)).join(' '),
                            recommendedBreakerFrameSize: selectedBreakerFrameSize.toFixed(0) + " A",
                            recommendedThermalTripSetting: thermalTripSetting.toFixed(2) + " A",
                            recommendedMagneticTripRange: `${magneticTripLowerBound.toFixed(0)} A to ${magneticTripUpperBound.toFixed(0)} A`,
                            minimumRequiredBreakingCapacity: requiredBreakingCapacity.toFixed(2) + " kA"
                        }
                    };
                }
                
                // --- PCC/MCC Incomer Breaker Calculation Logic ---
                function calculatePCCMCCBreaker() {
                    const pccMccLoadUnit = document.getElementById('pcc-mcc-load-unit').value;
                    const pccMccTotalLoad = parseFloat(document.getElementById('pcc-mcc-total-load').value);
                    const pccMccDemandFactor = parseFloat(document.getElementById('pcc-mcc-demand-factor').value) / 100;
                    const pccMccDiversityFactor = parseFloat(document.getElementById('pcc-mcc-diversity-factor').value) / 100;
                    const pccMccFutureExpansion = parseFloat(document.getElementById('pcc-mcc-future-expansion').value) / 100;
                    const pccMccVoltage = parseFloat(document.getElementById('pcc-mcc-voltage').value);
                    const pccMccVoltageType = document.getElementById('pcc-mcc-voltage-type').value;
                    const pccMccPowerFactor = parseFloat(document.getElementById('pcc-mcc-power-factor').value);
                    const pccMccBreakerType = document.getElementById('pcc-mcc-breaker-type').value;
                    const pccMccShortCircuitCurrent = parseFloat(document.getElementById('pcc-mcc-short-circuit-current').value);

                    // Input validation
                    if (isNaN(pccMccTotalLoad) || isNaN(pccMccDemandFactor) || isNaN(pccMccDiversityFactor) ||
                        isNaN(pccMccFutureExpansion) || isNaN(pccMccVoltage) || isNaN(pccMccPowerFactor) ||
                        isNaN(pccMccShortCircuitCurrent)) {
                        displayMessage("PCC/MCC Breaker: Please fill in all required fields with valid numbers.", "error");
                        return null;
                    }
                    if (pccMccTotalLoad <= 0 || pccMccDemandFactor <= 0 || pccMccDemandFactor > 1 ||
                        pccMccDiversityFactor < 1 || pccMccFutureExpansion < 0 || pccMccVoltage <= 0 ||
                        pccMccPowerFactor <= 0 || pccMccPowerFactor > 1 || pccMccShortCircuitCurrent <= 0) {
                        displayMessage("PCC/MCC Breaker: Please enter valid positive values. Demand Factor (0-100%), Diversity Factor (>=100%), Future Expansion (>=0%).", "error");
                        return null;
                    }

                    let calculationHtml = '<h4>PCC/MCC Incomer Breaker Calculation Steps:</h4>';

                    // Step 1: Calculate Design Load
                    let diversifiedLoadKVA;
                    let totalConnectedLoadKVA = pccMccTotalLoad;
                    if (pccMccLoadUnit === 'kW') {
                        // Convert kW to kVA using the power factor
                        totalConnectedLoadKVA = pccMccTotalLoad / pccMccPowerFactor;
                    }

                    // Diversified Load = (Total Connected Load * Demand Factor) / Diversity Factor
                    // Then add future expansion
                    diversifiedLoadKVA = (totalConnectedLoadKVA * pccMccDemandFactor) / pccMccDiversityFactor;
                    const designLoadKVA = diversifiedLoadKVA * (1 + pccMccFutureExpansion);

                    calculationHtml += `<p><strong>1. Calculate Design Load:</strong></p>`;
                    calculationHtml += `<p>The design load considers the total connected load, demand factor (simultaneous operation), diversity factor (non-simultaneous peak demands), and future expansion.</p>`;
                    calculationHtml += `<p class="formula">$$P_{\\text{diversified, kVA}} = \\frac{P_{\\text{connected, kVA}} \\times \\text{Demand Factor}}{\\text{Diversity Factor}}$$</p>`;
                    calculationHtml += `<p class="formula">$$P_{\\text{design, kVA}} = P_{\\text{diversified, kVA}} \\times (1 + \\text{Future Expansion})$$</p>`;
                    calculationHtml += `<p class="calculation-step">Total Connected Load = ${pccMccTotalLoad.toFixed(2)} ${pccMccLoadUnit.toUpperCase()}</p>`;
                    if (pccMccLoadUnit === 'kW') {
                        calculationHtml += `<p class="calculation-step">Converted Total Connected Load = ${totalConnectedLoadKVA.toFixed(2)} kVA (at PF ${pccMccPowerFactor.toFixed(2)})</p>`;
                    }
                    calculationHtml += `<p class="calculation-step">Diversified Load = (${totalConnectedLoadKVA.toFixed(2)} kVA x ${pccMccDemandFactor.toFixed(2)}) / ${pccMccDiversityFactor.toFixed(2)} = ${diversifiedLoadKVA.toFixed(2)} kVA</p>`;
                    calculationHtml += `<p class="calculation-step">Design Load = ${diversifiedLoadKVA.toFixed(2)} kVA x (1 + ${pccMccFutureExpansion.toFixed(2)}) = ${designLoadKVA.toFixed(2)} kVA</p>`;

                    // Step 2: Calculate Design Current
                    let designCurrent;
                    if (pccMccVoltageType === 'three-phase') {
                        // I = (kVA * 1000) / (sqrt(3) * V)
                        designCurrent = (designLoadKVA * 1000) / (Math.sqrt(3) * pccMccVoltage);
                        calculationHtml += `<p><strong>2. Calculate Design Current:</strong></p>`;
                        calculationHtml += `<p>For a Three-Phase system:</p>`;
                        calculationHtml += `<p class="formula">$$I_{\\text{design}} = \\frac{P_{\\text{design, kVA}} \\times 1000}{\\sqrt{3} \\times V}$$</p>`;
                        calculationHtml += `<p class="calculation-step">I_design = (${designLoadKVA.toFixed(2)} x 1000) / (1.732 x ${pccMccVoltage.toFixed(0)}) = ${designCurrent.toFixed(2)} A</p>`;
                    } else { // Single-phase
                        // I = (kVA * 1000) / V
                        designCurrent = (designLoadKVA * 1000) / pccMccVoltage;
                        calculationHtml += `<p><strong>2. Calculate Design Current:</strong></p>`;
                        calculationHtml += `<p>For a Single-Phase system:</p>`;
                        calculationHtml += `<p class="formula">$$I_{\\text{design}} = \\frac{P_{\\text{design, kVA}} \\times 1000}{V}$$</p>`;
                        calculationHtml += `<p class="calculation-step">I_design = (${designLoadKVA.toFixed(2)} x 1000) / (${pccMccVoltage.toFixed(0)}) = ${designCurrent.toFixed(2)} A</p>`;
                    }
                    
                    // Step 3: Select Breaker Frame Size (typically 125% of design current for continuous loads)
                    const requiredContinuousCurrent = designCurrent * 1.25; // NEC 210.19(A)(1) for continuous loads
                    const standardBreakerSizes = [100, 125, 150, 175, 200, 225, 250, 300, 350, 400, 450, 500, 600, 700, 800, 1000, 1200, 1600, 2000, 2500, 3000, 4000, 5000, 6000];
                    let selectedBreakerFrameSize = standardBreakerSizes.find(size => size >= requiredContinuousCurrent);
                    if (!selectedBreakerFrameSize) { selectedBreakerFrameSize = standardBreakerSizes[standardBreakerSizes.length - 1]; }
                    calculationHtml += `<p><strong>3. Select Breaker Frame Size:</strong></p>`;
                    calculationHtml += `<p class="calculation-step">Required Continuous Current (125% of Design Current) = ${requiredContinuousCurrent.toFixed(2)} A</p>`;
                    calculationHtml += `<p class="calculation-step">Selected Breaker Frame Size (next standard size) = ${selectedBreakerFrameSize.toFixed(0)} A</p>`;

                    // Step 4: Determine Thermal Trip Setting (typically 100% of design current, or adjustable range)
                    // For incomers, thermal trip is usually set to match or slightly exceed the design current.
                    const thermalTripSetting = designCurrent;
                    calculationHtml += `<p><strong>4. Determine Thermal Trip Setting:</strong></p>`;
                    calculationHtml += `<p class="formula">$$I_{\\text{thermal, trip}} \\approx I_{\\text{design}}$$</p>`;
                    calculationHtml += `<p class="calculation-step">Recommended Thermal Trip Setting = ${thermalTripSetting.toFixed(2)} A (Adjustable, set to match design load)</p>`;

                    // Step 5: Determine Magnetic Trip Setting (Instantaneous Trip)
                    // For incomers, magnetic trip is usually set higher to allow for downstream fault clearing.
                    // A common range is 5-10 times the breaker's nominal rating or adjustable range.
                    const minMagneticTripFactor = 5; // 500%
                    const maxMagneticTripFactor = 10; // 1000%
                    let magneticTripLowerBound = selectedBreakerFrameSize * minMagneticTripFactor;
                    let magneticTripUpperBound = selectedBreakerFrameSize * maxMagneticTripFactor;
                    magneticTripLowerBound = Math.ceil(magneticTripLowerBound / 100) * 100; // Round to nearest 100A
                    magneticTripUpperBound = Math.ceil(magneticTripUpperBound / 100) * 100;

                    calculationHtml += `<p><strong>5. Determine Magnetic Trip Setting (Instantaneous Trip):</strong></p>`;
                    calculationHtml += `<p class="calculation-step">This setting is set high to allow downstream motor breakers to clear their own faults (coordination).</p>`;
                    calculationHtml += `<p class="calculation-step">Suggested Magnetic Trip Range: ${magneticTripLowerBound.toFixed(0)} A to ${magneticTripUpperBound.toFixed(0)} A</p>`;

                    // Step 6: Determine Short Circuit Breaking Capacity (Icu/Ics)
                    const requiredBreakingCapacity = pccMccShortCircuitCurrent;
                    calculationHtml += `<p><strong>6. Determine Short Circuit Breaking Capacity (Icu/Ics):</strong></p>`;
                    calculationHtml += `<p class="calculation-step">Minimum Required Breaking Capacity = ${requiredBreakingCapacity.toFixed(2)} kA</p>`;
                    
                    return {
                        html: calculationHtml,
                        results: {
                            totalConnectedLoad: `${pccMccTotalLoad.toFixed(2)} ${pccMccLoadUnit.toUpperCase()}`,
                            designLoad: `${designLoadKVA.toFixed(2)} kVA`,
                            designCurrent: `${designCurrent.toFixed(2)} A`,
                            selectedBreakerFrameSize: `${selectedBreakerFrameSize.toFixed(0)} A`,
                            recommendedThermalTripSetting: `${thermalTripSetting.toFixed(2)} A`,
                            recommendedMagneticTripRange: `${magneticTripLowerBound.toFixed(0)} A to ${magneticTripUpperBound.toFixed(0)} A`,
                            minimumRequiredBreakingCapacity: `${requiredBreakingCapacity.toFixed(2)} kA`,
                            breakerType: pccMccBreakerType.toUpperCase()
                        }
                    };
                }
                
                // --- Transformer Breaker Calculation Logic ---
                function calculateTransformerBreaker() {
                    const transformerKVA = parseFloat(document.getElementById('transformer-kVA').value);
                    const primaryVoltage = parseFloat(document.getElementById('transformer-primary-voltage').value);
                    const secondaryVoltage = parseFloat(document.getElementById('transformer-secondary-voltage').value);
                    const transformerImpedance = parseFloat(document.getElementById('transformer-impedance').value) / 100; // Convert to decimal
                    const transformerConnectionType = document.getElementById('transformer-connection-type').value;
                    const transformerBreakerType = document.getElementById('transformer-breaker-type').value;

                    // Input validation
                    if (isNaN(transformerKVA) || isNaN(primaryVoltage) || isNaN(secondaryVoltage) ||
                        isNaN(transformerImpedance)) {
                        displayMessage("Transformer Breaker: Please fill in all required fields with valid numbers.", "error");
                        return null;
                    }
                    if (transformerKVA <= 0 || primaryVoltage <= 0 || secondaryVoltage <= 0 ||
                        transformerImpedance <= 0 || transformerImpedance > 0.2) { // Z% typically 1-20%
                        displayMessage("Transformer Breaker: Please enter valid positive values. Impedance should be between 1% and 20%.", "error");
                        return null;
                    }

                    let calculationHtml = '<h4>Transformer Breaker Calculation Steps:</h4>';

                    // Step 1: Calculate Transformer Full Load Currents (Primary and Secondary)
                    const primaryFLA = (transformerKVA * 1000) / (Math.sqrt(3) * primaryVoltage);
                    const secondaryFLA = (transformerKVA * 1000) / (Math.sqrt(3) * secondaryVoltage);

                    calculationHtml += `<p><strong>1. Calculate Transformer Full Load Currents:</strong></p>`;
                    calculationHtml += `<p class="formula">$$I_{\\text{FLA}} = \\frac{\\text{kVA} \\times 1000}{\\sqrt{3} \\times V}$$</p>`;
                    calculationHtml += `<p class="calculation-step">Primary FLA = (${transformerKVA.toFixed(0)} x 1000) / (1.732 x ${primaryVoltage.toFixed(0)}) = ${primaryFLA.toFixed(2)} A</p>`;
                    calculationHtml += `<p class="calculation-step">Secondary FLA = (${transformerKVA.toFixed(0)} x 1000) / (1.732 x ${secondaryVoltage.toFixed(0)}) = ${secondaryFLA.toFixed(2)} A</p>`;

                    // Step 2: Determine Primary Breaker Rating
                    // NEC 450.3(A) allows primary protection up to 125% (if FLA > 9A) or 150%
                    // We will use 125% as a standard practice for continuous load.
                    const primaryBreakerRating = primaryFLA * 1.25;
                    const standardBreakerSizes = [15, 20, 25, 30, 35, 40, 45, 50, 60, 70, 80, 90, 100, 110, 125, 150, 175, 200, 225, 250, 300, 350, 400, 450, 500, 600, 700, 800, 1000, 1200, 1600, 2000, 2500, 3000, 4000, 5000, 6000];
                    let selectedPrimaryBreakerSize = standardBreakerSizes.find(size => size >= primaryBreakerRating);
                    if (!selectedPrimaryBreakerSize) { selectedPrimaryBreakerSize = standardBreakerSizes[standardBreakerSizes.length - 1]; }

                    calculationHtml += `<p><strong>2. Determine Primary Breaker Rating:</strong></p>`;
                    calculationHtml += `<p class="calculation-step">Required Primary Breaker Rating (125% of FLA) = ${primaryBreakerRating.toFixed(2)} A</p>`;
                    calculationHtml += `<p class="calculation-step">Selected Primary Breaker Size (next standard size) = ${selectedPrimaryBreakerSize.toFixed(0)} A</p>`;

                    // Step 3: Determine Secondary Breaker Rating
                    // NEC 450.3(B) allows secondary protection up to 125% of FLA.
                    const secondaryBreakerRating = secondaryFLA * 1.25;
                    let selectedSecondaryBreakerSize = standardBreakerSizes.find(size => size >= secondaryBreakerRating);
                    if (!selectedSecondaryBreakerSize) { selectedSecondaryBreakerSize = standardBreakerSizes[standardBreakerSizes.length - 1]; }

                    calculationHtml += `<p><strong>3. Determine Secondary Breaker Rating:</strong></p>`;
                    calculationHtml += `<p class="calculation-step">Required Secondary Breaker Rating (125% of FLA) = ${secondaryBreakerRating.toFixed(2)} A</p>`;
                    calculationHtml += `<p class="calculation-step">Selected Secondary Breaker Size (next standard size) = ${selectedSecondaryBreakerSize.toFixed(0)} A</p>`;

                    // Step 4: Calculate Secondary Side Fault Current
                    // Isc = Secondary FLA / (Z% / 100)
                    const secondaryFaultCurrent = secondaryFLA / transformerImpedance;
                    calculationHtml += `<p><strong>4. Calculate Secondary Side Fault Current:</strong></p>`;
                    calculationHtml += `<p>This is the maximum fault current the transformer can deliver. The secondary breaker's breaking capacity (Icu) must be higher than this value.</p>`;
                    calculationHtml += `<p class="formula">$$I_{\\text{sc, secondary}} = \\frac{\\text{Secondary FLA}}{Z_{\\text{pu}}}$$</p>`;
                    calculationHtml += `<p class="calculation-step">Secondary Fault Current = ${secondaryFLA.toFixed(2)} A / ${transformerImpedance.toFixed(3)} = ${secondaryFaultCurrent.toFixed(2)} A (${(secondaryFaultCurrent / 1000).toFixed(2)} kA)</p>`;
                    
                    // Step 5: Inrush Current (for magnetic trip consideration)
                    // Typically 10-12 times FLA for 0.1 seconds.
                    const inrushCurrent = primaryFLA * 12;
                     calculationHtml += `<p><strong>5. Consider Transformer Inrush Current:</strong></p>`;
                    calculationHtml += `<p class="calculation-step">Estimated Inrush Current (Primary side) ≈ 12 x ${primaryFLA.toFixed(2)} A = ${inrushCurrent.toFixed(2)} A</p>`;
                    calculationHtml += `<p class="calculation-step">The primary breaker's instantaneous trip must be set above this value, or have a time delay, to prevent tripping on energization.</p>`;

                    return {
                        html: calculationHtml,
                        results: {
                            transformerKVA: `${transformerKVA.toFixed(0)} kVA`,
                            primaryVoltage: `${primaryVoltage.toFixed(0)} V`,
                            secondaryVoltage: `${secondaryVoltage.toFixed(0)} V`,
                            transformerImpedance: `${(transformerImpedance * 100).toFixed(1)}%`,
                            primaryFLA: `${primaryFLA.toFixed(2)} A`,
                            secondaryFLA: `${secondaryFLA.toFixed(2)} A`,
                            selectedPrimaryBreakerSize: `${selectedPrimaryBreakerSize.toFixed(0)} A`,
                            selectedSecondaryBreakerSize: `${selectedSecondaryBreakerSize.toFixed(0)} A`,
                            secondaryFaultCurrent: `${(secondaryFaultCurrent / 1000).toFixed(2)} kA`,
                            breakerType: transformerBreakerType.toUpperCase()
                        }
                    };
                }

                // --- Functions to display results in their respective sections ---
                function displayMotorResults(data) {
                    motorCalculationDetailsDiv.innerHTML = data.html;
                    if (window.MathJax && window.MathJax.typesetPromise) { window.MathJax.typesetPromise([motorCalculationDetailsDiv]).catch(err => console.error(err)); }
                    motorCalculationDetailsDiv.classList.add('show');
                    motorResultTableBody.innerHTML = ''; // Clear previous results
                    let animationDelay = 0;
                    const delayIncrement = 0.05;
                    for (const key in data.results) {
                        addResultRow(motorResultTableBody, key.replace(/([A-Z])/g, ' $1').replace(/^./, str => str.toUpperCase()), data.results[key], animationDelay);
                        animationDelay += delayIncrement;
                    }
                    motorResultTable.classList.add('show');
                }

                function displayPCCMCCResults(data) {
                    pccMccCalculationDetailsDiv.innerHTML = data.html;
                    if (window.MathJax && window.MathJax.typesetPromise) { window.MathJax.typesetPromise([pccMccCalculationDetailsDiv]).catch(err => console.error(err)); }
                    pccMccCalculationDetailsDiv.classList.add('show');
                    pccMccResultTableBody.innerHTML = '';
                    let animationDelay = 0;
                    const delayIncrement = 0.05;
                    for (const key in data.results) {
                        addResultRow(pccMccResultTableBody, key.replace(/([A-Z])/g, ' $1').replace(/^./, str => str.toUpperCase()), data.results[key], animationDelay);
                        animationDelay += delayIncrement;
                    }
                    pccMccResultTable.classList.add('show');
                }

                function displayTransformerResults(data) {
                    transformerCalculationDetailsDiv.innerHTML = data.html;
                    if (window.MathJax && window.MathJax.typesetPromise) { window.MathJax.typesetPromise([transformerCalculationDetailsDiv]).catch(err => console.error(err)); }
                    transformerCalculationDetailsDiv.classList.add('show');
                    transformerResultTableBody.innerHTML = '';
                    let animationDelay = 0;
                    const delayIncrement = 0.05;
                    for (const key in data.results) {
                        addResultRow(transformerResultTableBody, key.replace(/([A-Z])/g, ' $1').replace(/^./, str => str.toUpperCase()), data.results[key], animationDelay);
                        animationDelay += delayIncrement;
                    }
                    transformerResultTable.classList.add('show');
G                }
                
                // Theme switch logic
                const themeSwitch = document.getElementById('theme-switch');
                if (themeSwitch) {
                    // Set initial theme based on localStorage
                    if (localStorage.getItem('theme') === 'dark') {
                        document.body.classList.add('dark-mode');
                        themeSwitch.checked = true;
                    } else {
                         document.body.classList.remove('dark-mode');
                        themeSwitch.checked = false;
                    }
                    
                    // Add change event listener
                    themeSwitch.addEventListener('change', function() {
                        if (this.checked) {
                            document.body.classList.add('dark-mode');
                            localStorage.setItem('theme', 'dark');
                        } else {
                            document.body.classList.remove('dark-mode');
                            localStorage.setItem('theme', 'light');
                        }
                    });
                }
            })(); // End of IIFE
        });
    </script>
</body>
</html>

